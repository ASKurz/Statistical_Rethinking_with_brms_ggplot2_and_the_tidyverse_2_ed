<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="A. Solomon Kurz">
<meta name="dcterms.date" content="2026-01-26">

<title>Statistical rethinking 2 with brms and the tidyverse</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./01.html" rel="next">
<link href="./mischa_favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-234273d1456647dabc34a594ac50e507.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-7d082c015fa132ca880f975003d7bf2f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Statistical rethinking 2 with brms and the tidyverse">
<meta property="og:description" content="version 0.5.0">
<meta property="og:site_name" content="*Statistical rethinking* 2 with brms and the tidyverse">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./index.html">Preface</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./"><em>Statistical rethinking</em> 2 with brms and the tidyverse</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">The Golem of Prague</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Small Worlds and Large Worlds</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Sampling the Imaginary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Geocentric Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">The Many Variables &amp; The Spurious Waffles</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The Haunted DAG &amp; The Causal Terror</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Ulysses’ Compass</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Conditional Manatees</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Markov Chain Monte Carlo</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Big Entropy and the Generalized Linear Model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">God Spiked the Integers</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Monsters and Mixtures</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Models With Memory</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Adventures in Covariance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Missing Data and Other Opportunities</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Generalized Linear Madness</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title"><del>Horoscopes</del> Insights</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#preface" id="toc-preface" class="nav-link active" data-scroll-target="#preface">Preface</a></li>
  <li><a href="#what-and-why" id="toc-what-and-why" class="nav-link" data-scroll-target="#what-and-why">What and why</a>
  <ul>
  <li><a href="#my-assumptions-about-you" id="toc-my-assumptions-about-you" class="nav-link" data-scroll-target="#my-assumptions-about-you">My assumptions about you</a></li>
  <li><a href="#how-to-use-and-understand-this-project" id="toc-how-to-use-and-understand-this-project" class="nav-link" data-scroll-target="#how-to-use-and-understand-this-project">How to use and understand this project</a></li>
  <li><a href="#r-setup" id="toc-r-setup" class="nav-link" data-scroll-target="#r-setup"><strong>R</strong> setup</a></li>
  <li><a href="#we-have-updates" id="toc-we-have-updates" class="nav-link" data-scroll-target="#we-have-updates">We have updates</a>
  <ul>
  <li><a href="#version-0.1.0" id="toc-version-0.1.0" class="nav-link" data-scroll-target="#version-0.1.0">Version 0.1.0</a></li>
  <li><a href="#version-0.1.1" id="toc-version-0.1.1" class="nav-link" data-scroll-target="#version-0.1.1">Version 0.1.1</a></li>
  <li><a href="#version-0.2.0" id="toc-version-0.2.0" class="nav-link" data-scroll-target="#version-0.2.0">Version 0.2.0</a></li>
  <li><a href="#version-0.3.0" id="toc-version-0.3.0" class="nav-link" data-scroll-target="#version-0.3.0">Version 0.3.0</a></li>
  <li><a href="#version-0.4.0" id="toc-version-0.4.0" class="nav-link" data-scroll-target="#version-0.4.0">Version 0.4.0</a></li>
  <li><a href="#version-0.5.0" id="toc-version-0.5.0" class="nav-link" data-scroll-target="#version-0.5.0">Version 0.5.0</a></li>
  <li><a href="#were-not-done-yet-and-i-could-use-your-help" id="toc-were-not-done-yet-and-i-could-use-your-help" class="nav-link" data-scroll-target="#were-not-done-yet-and-i-could-use-your-help">We’re not done yet and I could use your help</a></li>
  </ul></li>
  <li><a href="#thank-yous-are-in-order" id="toc-thank-yous-are-in-order" class="nav-link" data-scroll-target="#thank-yous-are-in-order">Thank-you’s are in order</a></li>
  <li><a href="#license-and-citation" id="toc-license-and-citation" class="nav-link" data-scroll-target="#license-and-citation">License and citation</a></li>
  <li><a href="#comments" id="toc-comments" class="nav-link" data-scroll-target="#comments">Comments</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><em>Statistical rethinking</em> 2 with brms and the tidyverse</h1>
<p class="subtitle lead">version 0.5.0</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>A. Solomon Kurz </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 26, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="preface" class="level1 unnumbered">
<h1 class="unnumbered">Preface</h1>
</section>
<section id="what-and-why" class="level1 unnumbered">
<h1 class="unnumbered">What and why</h1>
<p>This ebook is based on the second edition of <a href="https://xcelab.net/rm/">Richard McElreath</a>’s <span class="citation" data-cites="mcelreathStatisticalRethinkingBayesian2020">(<a href="references.html#ref-mcelreathStatisticalRethinkingBayesian2020" role="doc-biblioref">2020</a>)</span> text, <a href="https://xcelab.net/rm/statistical-rethinking/"><em>Statistical rethinking: A Bayesian course with examples in R and Stan</em></a>. My contributions show how to fit the models he covered with <a href="https://www.simtech.uni-stuttgart.de/exc/people/Buerkner/">Paul Bürkner</a>’s <a href="https://github.com/paul-buerkner/brms"><strong>brms</strong> package</a> <span class="citation" data-cites="R-brms burknerBrmsPackageBayesian2017 burknerAdvancedBayesianMultilevel2018">(<a href="references.html#ref-burknerBrmsPackageBayesian2017" role="doc-biblioref">Bürkner, 2017</a>, <a href="references.html#ref-burknerAdvancedBayesianMultilevel2018" role="doc-biblioref">2018</a>, <a href="references.html#ref-R-brms" role="doc-biblioref">2022</a>)</span>, which makes it easy to fit Bayesian regression models in <strong>R</strong> <span class="citation" data-cites="R-base">(<a href="references.html#ref-R-base" role="doc-biblioref">R Core Team, 2022</a>)</span> using Hamiltonian Monte Carlo. I also prefer plotting and data wrangling with the packages from the <a href="https://www.tidyverse.org/"><strong>tidyverse</strong></a> <span class="citation" data-cites="R-tidyverse wickhamWelcomeTidyverse2019">(<a href="references.html#ref-wickhamWelcomeTidyverse2019" role="doc-biblioref">Wickham et al., 2019</a>; <a href="references.html#ref-R-tidyverse" role="doc-biblioref">Wickham, 2022</a>)</span>. So we’ll be using those methods, too.</p>
<p>Are you looking for the companion ebook for McElreath’s 1st edition? <a href="https://solomon.quarto.pub/sr/">Click here.</a></p>
<section id="my-assumptions-about-you" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="my-assumptions-about-you">My assumptions about you</h2>
<p>If you’re looking at this project, I’m guessing you’re either a graduate student, a post-graduate academic or a researcher of some sort, which suggests you have at least a 101-level foundation in statistics. If you’re rusty, consider checking out the free text books by <a href="https://bookdown.org/roback/bookdown-BeyondMLR/">Roback and Legler</a> <span class="citation" data-cites="roback2021beyond">(<a href="references.html#ref-roback2021beyond" role="doc-biblioref">2021</a>)</span> or <a href="https://learningstatisticswithr.com/">Navarro</a> <span class="citation" data-cites="navarroLearningStatistics2019">(<a href="references.html#ref-navarroLearningStatistics2019" role="doc-biblioref">2019</a>)</span> before diving into <em>Statistical rethinking</em>. I’m also assuming you understand the rudiments of <strong>R</strong> and have at least a vague idea about what the <strong>tidyverse</strong> is. If you’re totally new to <strong>R</strong>, consider starting with Peng’s <span class="citation" data-cites="pengProgrammingDataScience2022">(<a href="references.html#ref-pengProgrammingDataScience2022" role="doc-biblioref">2022</a>)</span> <a href="https://bookdown.org/rdpeng/rprogdatascience/"><em>R programming for data science</em></a>. For an introduction to the <strong>tidyvese</strong>-style of data analysis, the best source I’ve found is Grolemund and Wickham’s <span class="citation" data-cites="grolemundDataScience2017">(<a href="references.html#ref-grolemundDataScience2017" role="doc-biblioref">2017</a>)</span> <a href="http://r4ds.had.co.nz"><em>R for data science</em></a> (<em>R4DS</em>), which I extensively link to throughout this project. Another nice alternative is Baumer, Kaplan, and Horton’s <span class="citation" data-cites="baumerMocernDataScienceR2021">(<a href="references.html#ref-baumerMocernDataScienceR2021" role="doc-biblioref">2021</a>)</span>, <a href="https://mdsr-book.github.io/mdsr2e/"><em>Modern data science with R</em></a>.</p>
<p>However, you do not need to be totally fluent in statistics or <strong>R</strong>. Otherwise why would you need this project, anyway? IMO, the most important things are curiosity, a willingness to try, and persistent tinkering. I love this stuff. Hopefully you will, too.</p>
</section>
<section id="how-to-use-and-understand-this-project" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="how-to-use-and-understand-this-project">How to use and understand this project</h2>
<p>This project is not meant to stand alone. It’s a supplement to the second edition of McElreath’s text. I follow the structure of his text, chapter by chapter, translating his analyses into <strong>brms</strong> and <strong>tidyverse</strong>-style code. However, some of the sections in the text are composed entirely of equations or prose, leaving us nothing to translate. When we run into those sections, the corresponding sections in this project will sometimes be blank or omitted, though I do highlight some of the important points in quotes and prose of my own. So I imagine students might reference this project as they progress through McElreath’s text. I also imagine working data analysts might use this project in conjunction with the text as they flip to the specific sections that seem relevant to solving their data challenges.</p>
<p>I reproduce the bulk of the figures in the text, too. The plots in the first few chapters are the closest to those in the text. However, I’m passionate about data visualization and like to play around with <a href="https://github.com/EmilHvitfeldt/r-color-palettes">color palettes</a>, formatting templates, and other conventions quite a bit. As a result, the plots in each chapter have their own look and feel. For more on some of these topics, check out chapters <a href="https://r4ds.had.co.nz/data-visualisation.html">3</a>, <a href="https://r4ds.had.co.nz/exploratory-data-analysis.html">7</a>, and <a href="https://r4ds.had.co.nz/graphics-for-communication.html">28</a> in <em>R4DS</em>; Healy’s <span class="citation" data-cites="healyDataVisualization2018">(<a href="references.html#ref-healyDataVisualization2018" role="doc-biblioref">2018</a>)</span> <a href="https://socviz.co"><em>Data visualization: A practical introduction</em></a>; Wilke’s <span class="citation" data-cites="wilkeFundamentalsDataVisualization2019">(<a href="references.html#ref-wilkeFundamentalsDataVisualization2019" role="doc-biblioref">2019</a>)</span> <a href="https://serialmentor.com/dataviz/"><em>Fundamentals of data visualization</em></a>; or Wickham’s <span class="citation" data-cites="wickhamGgplot2ElegantGraphics2016">(<a href="references.html#ref-wickhamGgplot2ElegantGraphics2016" role="doc-biblioref">2016</a>)</span> <a href="https://ggplot2-book.org/"><em>ggplot2: Elegant graphics for data analysis</em></a>.</p>
<p>In this project, I use a handful of formatting conventions gleaned from <a href="https://r4ds.had.co.nz/introduction.html#running-r-code"><em>R4DS</em></a>, <a href="https://style.tidyverse.org/"><em>The tidyverse style guide</em></a> <span class="citation" data-cites="wickhamTidyverseStyleGuide2020">(<a href="references.html#ref-wickhamTidyverseStyleGuide2020" role="doc-biblioref">Wickham, 2020</a>)</span>, and <a href="https://bookdown.org/yihui/rmarkdown/software-info.html"><em>R markdown: The definitive guide</em></a> <span class="citation" data-cites="xieMarkdownDefinitiveGuide2020">(<a href="references.html#ref-xieMarkdownDefinitiveGuide2020" role="doc-biblioref">Xie et al., 2020</a>)</span>.</p>
<ul>
<li><strong>R</strong> code blocks and their output appear in a gray background. E.g.,</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<ul>
<li><strong>R</strong> and the names of specific package (e.g., <strong>brms</strong>) are in <strong>boldface</strong> font.</li>
<li>Functions are in a typewriter font and followed by parentheses, all atop a gray background (e.g., <code>brm()</code>).</li>
<li>When I want to make explicit the package a given function comes from, I insert the double-colon operator <code>::</code> between the package name and the function (e.g., <code>tidybayes::median_qi()</code>).</li>
<li><strong>R</strong> objects, such as data or function arguments, are in typewriter font atop gray backgrounds (e.g., <code>chimpanzees</code>, <code>.width = 0.5</code>).</li>
<li>You can detect hyperlinks by their typical <a href="https://solomonkurz.netlify.app/">blue-colored font</a>.</li>
<li>In the text, McElreath indexed his models with names like <code>m4.1</code> (i.e., the first model of <a href="04.html" class="quarto-xref"><span>4&nbsp; Geocentric Models</span></a>). I primarily followed that convention, but replaced the <code>m</code> with a <code>b</code> to stand for the <strong>brms</strong> package.</li>
</ul>
</section>
<section id="r-setup" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="r-setup"><strong>R</strong> setup</h2>
<p>To get the full benefit from this ebook, you’ll need some software. Happily, everything will be free (provided you have access to a decent personal computer and an good internet connection).</p>
<p>First, you’ll need to install <strong>R</strong>, which you can learn about at <a href="https://cran.r-project.org/">https://cran.r-project.org/</a>.</p>
<p>Though not necessary, your <strong>R</strong> experience might be more enjoyable if done through the free RStudio interface, which you can learn about at <a href="https://posit.co/products/open-source/rstudio/">https://posit.co/products/open-source/rstudio/</a>.</p>
<p>Once you have installed <strong>R</strong>, execute the following to install the bulk of the add-on packages. This will probably take a few minutes to finish. Go make yourself a coffee.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ape"</span>, <span class="st">"bayesplot"</span>, <span class="st">"brms"</span>, <span class="st">"broom"</span>, <span class="st">"dagitty"</span>, <span class="st">"devtools"</span>, <span class="st">"flextable"</span>, <span class="st">"GGally"</span>, <span class="st">"ggdag"</span>, <span class="st">"ggmcmc"</span>, <span class="st">"ggrepel"</span>, <span class="st">"ggthemes"</span>, <span class="st">"ggtree"</span>, <span class="st">"ghibli"</span>, <span class="st">"gtools"</span>, <span class="st">"invgamma"</span>, <span class="st">"loo"</span>, <span class="st">"patchwork"</span>, <span class="st">"posterior"</span>, <span class="st">"psych"</span>, <span class="st">"rcartocolor"</span>, <span class="st">"Rcpp"</span>, <span class="st">"remotes"</span>, <span class="st">"rstan"</span>, <span class="st">"santoku"</span>, <span class="st">"StanHeaders"</span>, <span class="st">"statebins"</span>, <span class="st">"tidybayes"</span>, <span class="st">"tidyverse"</span>, <span class="st">"viridis"</span>, <span class="st">"viridisLite"</span>, <span class="st">"wesanderson"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(packages, <span class="at">dependencies =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A few of the other packages are not officially available via the Comprehensive R Archive Network (CRAN; https://cran.r-project.org/). You can download them directly from GitHub by executing the following.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"stan-dev/cmdstanr"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"EdwinTh/dutchmasters"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"gadenbuie/ggpomological"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"GuangchuangYu/ggtree"</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"rmcelreath/rethinking"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"UrbanInstitute/urbnmapr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It’s possible you’ll have problems installing some of these packages. Here are some likely suspects and where you can find help:</p>
<ul>
<li>for difficulties installing <strong>brms</strong>, go to <a href="https://github.com/paul-buerkner/brms#how-do-i-install-brms">https://github.com/paul-buerkner/brms#how-do-i-install-brms</a> or search around in the <a href="https://discourse.mc-stan.org/c/interfaces/brms/36"><strong>brms</strong> section of the Stan forums</a>;</li>
<li>for difficulties installing <strong>cmdstanr</strong>, go to <a href="https://mc-stan.org/cmdstanr/articles/cmdstanr.html">https://mc-stan.org/cmdstanr/articles/cmdstanr.html</a>;</li>
<li>for difficulties installing <strong>rethinking</strong>, go to <a href="https://github.com/rmcelreath/rethinking#installation">https://github.com/rmcelreath/rethinking#installation</a>; and</li>
<li>for difficulties installing <strong>rstan</strong>, go to <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started">https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started</a>.</li>
</ul>
</section>
<section id="we-have-updates" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="we-have-updates">We have updates</h2>
<p>For a brief rundown of the version history, we have:</p>
<section id="version-0.1.0" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="version-0.1.0">Version 0.1.0</h3>
<p>I released the 0.1.0 version of this project in November 24, 2020. It was the first full-length and nearly complete draft including material from all the 17 chapters in McElreath’s source material. All <strong>brms</strong> models were fit with version 2.14.0+.</p>
</section>
<section id="version-0.1.1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="version-0.1.1">Version 0.1.1</h3>
<p>On December 2, 2020, I released a mini update designed to</p>
<ul>
<li>fix code breaks resulting from updates to the <a href="https://CRAN.R-project.org/package=broom"><strong>broom</strong> package</a> <span class="citation" data-cites="R-broom">(<a href="references.html#ref-R-broom" role="doc-biblioref">Robinson et al., 2022</a>)</span>, caught by <a href="https://github.com/jennybigman">Jenny Bigman</a>;</li>
<li>replace the soon-to-be retired <code>sample_n()</code> code with <code>slice_sample()</code>, caught by <a href="https://github.com/rpruim">Randall Pruim</a>;</li>
<li>and correct a few typos along the way.</li>
</ul>
</section>
<section id="version-0.2.0" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="version-0.2.0">Version 0.2.0</h3>
<p>On March 16, 2021, I released version 0.2.0, which included the following major improvements:</p>
<ul>
<li>a corrected workflow for fitting single-level b-spline models (<a href="04.html#sec-Splines" class="quarto-xref"><span>Splines</span></a>), thanks to <a href="https://github.com/sjwild">Stephen Wild</a>;</li>
<li>a refined workflow for fitting multilevel b-spline models using the <code>s()</code> function (<a href="04.html#sec-smooth-functions-with-s" class="quarto-xref"><span>Summary First bonus: Smooth functions with brms::s()</span></a>), thanks to <a href="https://github.com/gavinsimpson">Gavin Simpson</a>;</li>
<li>a new bonus section (<a href="04.html#sec-Group-predictors-with-matrix-columns" class="quarto-xref"><span>Second bonus: Group predictors with matrix columns</span></a>) on grouping predictors within matrix columns, thanks to insights from <span class="citation" data-cites="gelmanRegressionOtherStories2020">Gelman et al. (<a href="references.html#ref-gelmanRegressionOtherStories2020" role="doc-biblioref">2020</a>)</span> and <a href="https://discourse.mc-stan.org/t/fit-a-brm-model-with-an-array-of-predictors/20465">hints</a> from <a href="https://github.com/paul-buerkner">Paul-Christian Bürkner</a>;</li>
<li>a <strong>brms</strong> solution to the <span class="math inline">\(\sigma = 0.01\)</span> sixth-order polynomial model in <a href="07.html#sec-More-parameters-almost-always" class="quarto-xref"><span>More parameters (almost) always improve fit</span></a>, thanks again to Stephen Wild;</li>
<li>a workflow to reproduce the Metropolis simulation for <a href="09.html#sec-High-dimensional-problems" class="quarto-xref"><span>High-dimensional problems</span></a>, thanks to <a href="https://github.com/jameshenegan">James Henegan</a>;</li>
<li>a corrected workflow for taking <code>fitted()</code>-based random draws for the bonus material in <a href="13.html#sec-Lets-use-fitted-this-time" class="quarto-xref"><span>Bonus: Let’s use fitted() this time</span></a>, thanks to an exchange with <a href="https://github.com/lnalborczyk">Ladislas Nalborczyk</a>;</li>
<li>a <strong>brms</strong> solution to McElreath’s bivariate differential equation model in <a href="16.html#sec-Population-dynamics" class="quarto-xref"><span>Population dynamics</span></a>, thanks to <a href="https://github.com/mages">Markus Gesmann</a>;</li>
<li>better use of <code>geom_area()</code> throughout the book, thanks to insights from <a href="https://github.com/rpruim">Randall Pruim</a>;</li>
<li>the adoption of a <a href="https://github.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed/blob/master/CONTRIBUTING.md">CONTRIBUTING</a> section on GitHub, thanks to <a href="https://github.com/bwiernik">Brenton M. Wiernik</a>;</li>
<li>improved table workflow with the <strong>flextable</strong> package <span class="citation" data-cites="R-flextable">(<a href="references.html#ref-R-flextable" role="doc-biblioref">Gohel, 2022</a>)</span>; and</li>
<li>all models have been refit using <strong>brms</strong> version 2.15.0.</li>
</ul>
</section>
<section id="version-0.3.0" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="version-0.3.0">Version 0.3.0</h3>
<p>On September 28, 2022, I released version 0.3.0, which included the following major improvements:</p>
<ul>
<li>an <code>as_draws_df()</code>-oriented workflow to replace the depreciated <code>posterior_samples()</code> function;</li>
<li>better sampling in models in the first few due to changes in the <code>ub</code> argument;</li>
<li>more use of the uniform prior for <span class="math inline">\(\sigma\)</span> to better match the text, thanks to the improved <code>ub</code> argument;</li>
<li>a more <strong>tidyverse</strong>-oriented version of the <code>sim_happiness()</code> function in <a href="06.html#sec-Collider-bias" class="quarto-xref"><span>Collider bias</span></a>, thanks to <a href="https://github.com/rpruim">Randall Pruim</a></li>
<li>a more accurate depiction of entropy in Figure 10.2.b in <a href="10.html#sec-Gaussian" class="quarto-xref"><span>Gaussian</span></a>, thanks to help from <a href="https://github.com/hamedbh">Hamed Bastan-Hagh</a>,</li>
<li>a cross link to the first edition, thanks to a suggestion from <a href="https://github.com/wpetry">Will Petry</a>;</li>
<li>some corrected typos and updates to the links and citations; and</li>
<li>all models have been refit using <strong>brms</strong> version 2.18.0.</li>
</ul>
</section>
<section id="version-0.4.0" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="version-0.4.0">Version 0.4.0</h3>
<p>On January 26, 2023, I released version 0.4.0, which included:</p>
<ul>
<li>replacing my incorrect use of <code>tidyr::expand()</code> with a more appropriate <code>tidyr::expand_grid()</code> workflow, thanks to insights from <a href="https://github.com/dipetkov">Desislava Petkova</a>;</li>
<li>adopting the new <code>linewidth</code> argument for several <strong>ggplot2</strong> geoms (see <a href="https://www.tidyverse.org/blog/2022/08/ggplot2-3-4-0-size-to-linewidth/">here</a>); and</li>
<li>minor prose, hyperlink, and code edits throughout.</li>
</ul>
</section>
<section id="version-0.5.0" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="version-0.5.0">Version 0.5.0</h3>
<p>Welcome to version 0.5.0! Noteworthy changes include:</p>
<ul>
<li>switching to a <a href="https://quarto.org/docs/books/">Quarto ebook</a> format;</li>
<li>updating the code to better reflect <a href="https://style.tidyverse.org/">tidyverse-style guidelines</a>;</li>
<li>switching to the base pipe (<code>|&gt;</code>);</li>
<li>adding comments sections (e.g., <a href="https://solomon.quarto.pub/sr2/04.html#comments">here</a>) via <a href="https://giscus.app/">giscus</a>;</li>
<li>updating all <strong>brms</strong> model fits with version 2.23.0;</li>
<li>updating the Stan code for two of the bespoke models in <a href="16.html" class="quarto-xref"><span>16&nbsp; Generalized Linear Madness</span></a>;</li>
<li>introduced the very flat <span class="math inline">\(\operatorname{logistic}(0, 1)\)</span> prior for logistic regression models in <a href="11.html#sec-A-truly-flat-prior" class="quarto-xref"><span>Bonus: A truly flat prior</span></a>;</li>
<li>corrected the syntax for <code>dplyr::lag()</code>, thanks to <a href="https://github.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed/issues/50">James Fern</a>;</li>
<li>correcting some of the labels in Figure 15.4, thanks to <a href="https://github.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed/issues/51">Liam Haller</a>;</li>
<li>correcting an table in <a href="02.html#sec-Counting-possibilities" class="quarto-xref"><span>Counting possibilities</span></a>, thanks to <a href="https://github.com/chrisrider">Christopher Rider</a>; and</li>
<li>a few other minor prose and code edits throughout.</li>
</ul>
</section>
<section id="were-not-done-yet-and-i-could-use-your-help" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="were-not-done-yet-and-i-could-use-your-help">We’re not done yet and I could use your help</h3>
<p>Some areas of the book could use some fleshing out. The sections I’m particularly anxious to improve are</p>
<ul>
<li><a href="15.html#sec-Categorical-errors-and-discrete-absences" class="quarto-xref"><span>Categorical errors and discrete absences</span></a>, which may someday include a <strong>brms</strong> workflow for categorical missing data; and</li>
<li><a href="16.html#sec-Coding-the-statistical-model" class="quarto-xref"><span>Coding the statistical model</span></a>, which contains a mixture model that McElreath fit directly in Stan and I suspect may be possible in <strong>brms</strong> with a custom likelihood.</li>
</ul>
<p>If you have insights on how to improve these or any other sections, please share your thoughts on GitHub at <a href="https://github.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed/issues">https://github.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed/issues</a>. The contribution guidelines for this book are listed at <a href="https://github.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed/blob/master/CONTRIBUTING.md">https://github.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed/blob/master/CONTRIBUTING.md</a>.</p>
</section>
</section>
<section id="thank-yous-are-in-order" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="thank-yous-are-in-order">Thank-you’s are in order</h2>
<p>I’d like to thank the following for their helpful contributions:</p>
<ul>
<li>E. David Aja (<a href="https://github.com/edavidaja">@edavidaja</a>),</li>
<li>Monica Alexander (<a href="https://github.com/MJAlexander">@MJAlexander</a>),</li>
<li>Shaan Amin (<a href="https://github.com/Shaan-Amin">@Shaan-Amin</a>),</li>
<li>Malcolm Barrett (<a href="https://github.com/malcolmbarrett">@malcolmbarrett</a>),</li>
<li>Hamed Bastan-Hagh (<a href="https://github.com/hamedbh">@hamedbh</a>),</li>
<li>Adam Bear (<a href="https://github.com/adambear91">@adambear91</a>),</li>
<li>Jenny Bigman (<a href="https://github.com/jennybigman">@jennybigman</a>),</li>
<li>Louis Bliard (<a href="https://github.com/lbiard">@lbiard</a>),</li>
<li>Philipp Boersch-Supan (<a href="https://github.com/pboesu">@pboesu</a>),</li>
<li>Paul-Christian Bürkner (<a href="https://github.com/paul-buerkner">@paul-buerkner</a>),</li>
<li>Damien Croteau-Chonka (<a href="https://github.com/dcroteau-chonka">@dcroteau-chonka</a>),</li>
<li>James Fern (<a href="https://github.com/JFern83">@JFern83</a>),</li>
<li>Markus Gesmann (<a href="https://github.com/mages">@mages</a>),</li>
<li>Liam Haller (<a href="https://github.com/liamhaller">@liamhaller</a>),</li>
<li>James Henegan (<a href="https://github.com/jameshenegan">@jameshenegan</a>),</li>
<li>Matthijs Hollanders (<a href="https://github.com/mhollanders">@mhollanders</a>),</li>
<li>Mathieu Jones (<a href="https://github.com/00mathieu">@00mathieu</a>),</li>
<li>William Lai (<a href="https://github.com/williamlai2">@williamlai2</a>),</li>
<li>Sebastian Lobentanzer (<a href="https://github.com/slobentanzer">@slobentanzer</a>),</li>
<li>Ed Merkle (<a href="https://github.com/ecmerkle">@ecmerkle</a>),</li>
<li>Ladislas Nalborczyk (<a href="https://github.com/lnalborczyk">@lnalborczyk</a>),</li>
<li>Desislava Petkova (<a href="https://github.com/dipetkov">@dipetkov</a>),</li>
<li>Will Petry (<a href="https://github.com/wpetry">@wpetry</a>),</li>
<li>Randall Pruim (<a href="https://github.com/rpruim">@rpruim</a>),</li>
<li>Christopher Rider (<a href="https://github.com/chrisrider">@chrisrider</a>),</li>
<li>Gavin Simpson (<a href="https://github.com/gavinsimpson">@gavinsimpson</a>),</li>
<li>Kathleen Sprouffske (<a href="https://github.com/sprouffske">@sprouffske</a>)</li>
<li>Richard Torkar (<a href="https://github.com/torkar">@torkar</a>),</li>
<li>Michael S. Truong (<a href="https://github.com/emstruong">@emstruong</a>),</li>
<li>Brenton M. Wiernik (<a href="https://github.com/bwiernik">@bwiernik</a>),</li>
<li>Stephen Wild (<a href="https://github.com/sjwild">@sjwild</a>),</li>
<li>Donald R. Williams (<a href="https://github.com/donaldRwilliams">@donaldRwilliams</a>), and</li>
<li>Carson Zhang (<a href="https://github.com/cxzhang4">@cxzhang4</a>).</li>
</ul>
<p>Science is better when we work together.</p>
</section>
<section id="license-and-citation" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="license-and-citation">License and citation</h2>
<p>This book is licensed under the Creative Commons Zero v1.0 Universal license. You can learn the details, <a href="https://github.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed/blob/master/LICENSE">here</a>. In short, you can use my work. Just make sure you give me the appropriate credit the same way you would for any other scholarly resource. Here’s the citation information:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="sc">@</span>book{kurzStatisticalRethinkingSecondEd2026,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  title <span class="ot">=</span> {Statistical rethinking <span class="dv">2</span> with brms and the tidyverse},</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  author <span class="ot">=</span> {Kurz, A. Solomon},</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  year <span class="ot">=</span> {<span class="dv">2026</span>},</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  month <span class="ot">=</span> {jan},</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  edition <span class="ot">=</span> {version <span class="dv">0</span>.<span class="fl">5.0</span>},</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  url <span class="ot">=</span> {https<span class="sc">:</span><span class="er">//</span>solomon.quarto.pub<span class="sc">/</span>sr2<span class="sc">/</span>}</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="comments" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="comments">Comments</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-baumerMocernDataScienceR2021" class="csl-entry" role="listitem">
Baumer, B. S., Kaplan, D. T., &amp; Horton, N. J. (2021). <em>Modern data science with <span>R</span></em> (2nd edition). Taylor &amp; Francis Group, LLC. <a href="https://mdsr-book.github.io/mdsr2e/">https://mdsr-book.github.io/mdsr2e/</a>
</div>
<div id="ref-burknerBrmsPackageBayesian2017" class="csl-entry" role="listitem">
Bürkner, P.-C. (2017). <span class="nocase">brms</span>: <span>An R</span> package for <span>Bayesian</span> multilevel models using <span>Stan</span>. <em>Journal of Statistical Software</em>, <em>80</em>(1), 1–28. <a href="https://doi.org/10.18637/jss.v080.i01">https://doi.org/10.18637/jss.v080.i01</a>
</div>
<div id="ref-burknerAdvancedBayesianMultilevel2018" class="csl-entry" role="listitem">
Bürkner, P.-C. (2018). Advanced <span>Bayesian</span> multilevel modeling with the <span>R</span> package brms. <em>The R Journal</em>, <em>10</em>(1), 395–411. <a href="https://doi.org/10.32614/RJ-2018-017">https://doi.org/10.32614/RJ-2018-017</a>
</div>
<div id="ref-R-brms" class="csl-entry" role="listitem">
Bürkner, P.-C. (2022). <em><span class="nocase">brms</span>: <span>Bayesian</span> regression models using ’<span>Stan</span>’</em>. <a href="https://CRAN.R-project.org/package=brms">https://CRAN.R-project.org/package=brms</a>
</div>
<div id="ref-gelmanRegressionOtherStories2020" class="csl-entry" role="listitem">
Gelman, A., Hill, J., &amp; Vehtari, A. (2020). <em>Regression and other stories</em>. Cambridge University Press. <a href="https://doi.org/10.1017/9781139161879">https://doi.org/10.1017/9781139161879</a>
</div>
<div id="ref-R-flextable" class="csl-entry" role="listitem">
Gohel, D. (2022). <em><span class="nocase">flextable</span>: <span>Functions</span> for tabular reporting</em> [Manual]. <a href="https://CRAN.R-project.org/package=flextable">https://CRAN.R-project.org/package=flextable</a>
</div>
<div id="ref-grolemundDataScience2017" class="csl-entry" role="listitem">
Grolemund, G., &amp; Wickham, H. (2017). <em>R for data science</em>. O’Reilly. <a href="https://r4ds.had.co.nz">https://r4ds.had.co.nz</a>
</div>
<div id="ref-healyDataVisualization2018" class="csl-entry" role="listitem">
Healy, K. (2018). <em>Data visualization: <span>A</span> practical introduction</em>. Princeton University Press. <a href="https://socviz.co/">https://socviz.co/</a>
</div>
<div id="ref-mcelreathStatisticalRethinkingBayesian2020" class="csl-entry" role="listitem">
McElreath, R. (2020). <em>Statistical rethinking: <span>A Bayesian</span> course with examples in <span>R</span> and <span>Stan</span></em> (Second Edition). CRC Press. <a href="https://xcelab.net/rm/statistical-rethinking/">https://xcelab.net/rm/statistical-rethinking/</a>
</div>
<div id="ref-navarroLearningStatistics2019" class="csl-entry" role="listitem">
Navarro, D. (2019). <em>Learning statistics with <span>R</span></em>. <a href="https://learningstatisticswithr.com">https://learningstatisticswithr.com</a>
</div>
<div id="ref-pengProgrammingDataScience2022" class="csl-entry" role="listitem">
Peng, R. D. (2022). <em>R programming for data science</em>. <a href="https://bookdown.org/rdpeng/rprogdatascience/">https://bookdown.org/rdpeng/rprogdatascience/</a>
</div>
<div id="ref-R-base" class="csl-entry" role="listitem">
R Core Team. (2022). <em>R: <span>A</span> language and environment for statistical computing</em>. R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>
</div>
<div id="ref-roback2021beyond" class="csl-entry" role="listitem">
Roback, P., &amp; Legler, J. (2021). <em>Beyond multiple linear regression: <span>Applied</span> generalized linear models and multilevel models in <span>R</span></em>. CRC Press. <a href="https://bookdown.org/roback/bookdown-BeyondMLR/">https://bookdown.org/roback/bookdown-BeyondMLR/</a>
</div>
<div id="ref-R-broom" class="csl-entry" role="listitem">
Robinson, D., Hayes, A., &amp; Couch, S. (2022). <em><span class="nocase">broom</span>: <span>Convert</span> statistical objects into tidy tibbles</em> [Manual]. <a href="https://CRAN.R-project.org/package=broom">https://CRAN.R-project.org/package=broom</a>
</div>
<div id="ref-wickhamGgplot2ElegantGraphics2016" class="csl-entry" role="listitem">
Wickham, H. (2016). <em><span class="nocase">ggplot2</span>: <span>Elegant</span> graphics for data analysis</em>. Springer-Verlag New York. <a href="https://ggplot2-book.org/">https://ggplot2-book.org/</a>
</div>
<div id="ref-wickhamTidyverseStyleGuide2020" class="csl-entry" role="listitem">
Wickham, H. (2020). <em>The tidyverse style guide</em>. <a href="https://style.tidyverse.org/">https://style.tidyverse.org/</a>
</div>
<div id="ref-R-tidyverse" class="csl-entry" role="listitem">
Wickham, H. (2022). <em><span class="nocase">tidyverse</span>: <span>Easily</span> install and load the ’tidyverse’</em>. <a href="https://CRAN.R-project.org/package=tidyverse">https://CRAN.R-project.org/package=tidyverse</a>
</div>
<div id="ref-wickhamWelcomeTidyverse2019" class="csl-entry" role="listitem">
Wickham, H., Averick, M., Bryan, J., Chang, W., McGowan, L. D., François, R., Grolemund, G., Hayes, A., Henry, L., Hester, J., Kuhn, M., Pedersen, T. L., Miller, E., Bache, S. M., Müller, K., Ooms, J., Robinson, D., Seidel, D. P., Spinu, V., … Yutani, H. (2019). Welcome to the tidyverse. <em>Journal of Open Source Software</em>, <em>4</em>(43), 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>
</div>
<div id="ref-wilkeFundamentalsDataVisualization2019" class="csl-entry" role="listitem">
Wilke, C. O. (2019). <em>Fundamentals of data visualization</em>. <a href="https://clauswilke.com/dataviz/">https://clauswilke.com/dataviz/</a>
</div>
<div id="ref-xieMarkdownDefinitiveGuide2020" class="csl-entry" role="listitem">
Xie, Y., Allaire, J. J., &amp; Grolemund, G. (2020). <em>R markdown: <span>The</span> definitive guide</em>. <span>Chapman and Hall/CRC</span>. <a href="https://bookdown.org/yihui/rmarkdown/">https://bookdown.org/yihui/rmarkdown/</a>
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/solomon\.quarto\.pub\/sr2\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
<script>
  function loadGiscus() {
    // Function to get the theme based on body class
    const getTheme = () => {
      let baseTheme = document.getElementById('giscus-base-theme').value;
      let altTheme = document.getElementById('giscus-alt-theme').value;
      return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
    };
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed";
    script.dataset.repoId = "MDEwOlJlcG9zaXRvcnkxNjE5MTg0MTE=";
    script.dataset.category = "General";
    script.dataset.categoryId = "DIC_kwDOCaaty84C1AJZ";
    script.dataset.mapping = "title";
    script.dataset.reactionsEnabled = "1";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "top";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  }
  loadGiscus();
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
  </div>
  <div class="nav-page nav-page-next">
      <a href="./01.html" class="pagination-link" aria-label="The Golem of Prague">
        <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">The Golem of Prague</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>