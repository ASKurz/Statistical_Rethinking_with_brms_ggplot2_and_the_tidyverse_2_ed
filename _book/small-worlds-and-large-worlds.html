<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Small Worlds and Large Worlds | Statistical rethinking with brms, ggplot2, and the tidyverse: Second edition</title>
  <meta name="description" content="This book is an attempt to re-express the code in the second edition of McElreath’s textbook, ‘Statistical rethinking.’ His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Small Worlds and Large Worlds | Statistical rethinking with brms, ggplot2, and the tidyverse: Second edition" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book is an attempt to re-express the code in the second edition of McElreath’s textbook, ‘Statistical rethinking.’ His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="github-repo" content="ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Small Worlds and Large Worlds | Statistical rethinking with brms, ggplot2, and the tidyverse: Second edition" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This book is an attempt to re-express the code in the second edition of McElreath’s textbook, ‘Statistical rethinking.’ His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2020-10-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-golem-of-prague.html"/>
<link rel="next" href="sampling-the-imaginary.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#caution-work-in-progress"><i class="fa fa-check"></i>Caution: Work in progress</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#thank-yous-are-in-order"><i class="fa fa-check"></i>Thank-you’s are in order</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="the-golem-of-prague.html"><a href="the-golem-of-prague.html"><i class="fa fa-check"></i><b>1</b> The Golem of Prague</a><ul>
<li class="chapter" data-level="" data-path="the-golem-of-prague.html"><a href="the-golem-of-prague.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html"><i class="fa fa-check"></i><b>2</b> Small Worlds and Large Worlds</a><ul>
<li class="chapter" data-level="2.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#the-garden-of-forking-data"><i class="fa fa-check"></i><b>2.1</b> The garden of forking data</a><ul>
<li class="chapter" data-level="2.1.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#counting-possibilities."><i class="fa fa-check"></i><b>2.1.1</b> Counting possibilities.</a></li>
<li class="chapter" data-level="2.1.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#combining-other-information."><i class="fa fa-check"></i><b>2.1.2</b> Combining other information.</a></li>
<li class="chapter" data-level="2.1.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#from-counts-to-probability."><i class="fa fa-check"></i><b>2.1.3</b> From counts to probability.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#building-a-model"><i class="fa fa-check"></i><b>2.2</b> Building a model</a><ul>
<li class="chapter" data-level="2.2.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#a-data-story."><i class="fa fa-check"></i><b>2.2.1</b> A data story.</a></li>
<li class="chapter" data-level="2.2.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#bayesian-updating."><i class="fa fa-check"></i><b>2.2.2</b> Bayesian updating.</a></li>
<li class="chapter" data-level="2.2.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#evaluate."><i class="fa fa-check"></i><b>2.2.3</b> Evaluate.</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#components-of-the-model"><i class="fa fa-check"></i><b>2.3</b> Components of the model</a><ul>
<li class="chapter" data-level="2.3.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#variables."><i class="fa fa-check"></i><b>2.3.1</b> Variables.</a></li>
<li class="chapter" data-level="2.3.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#definitions."><i class="fa fa-check"></i><b>2.3.2</b> Definitions.</a></li>
<li class="chapter" data-level="2.3.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#a-model-is-born."><i class="fa fa-check"></i><b>2.3.3</b> A model is born.</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#making-the-model-go"><i class="fa fa-check"></i><b>2.4</b> Making the model go</a><ul>
<li class="chapter" data-level="2.4.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#bayes-theorem."><i class="fa fa-check"></i><b>2.4.1</b> Bayes’ theorem.</a></li>
<li class="chapter" data-level="2.4.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#motors."><i class="fa fa-check"></i><b>2.4.2</b> Motors.</a></li>
<li class="chapter" data-level="2.4.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#grid-approximation."><i class="fa fa-check"></i><b>2.4.3</b> Grid approximation.</a></li>
<li class="chapter" data-level="2.4.4" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#quadratic-approximation."><i class="fa fa-check"></i><b>2.4.4</b> Quadratic approximation.</a></li>
<li class="chapter" data-level="2.4.5" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#markov-chain-monte-carlo."><i class="fa fa-check"></i><b>2.4.5</b> Markov chain Monte Carlo.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html"><i class="fa fa-check"></i><b>3</b> Sampling the Imaginary</a><ul>
<li class="chapter" data-level="3.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-from-a-grid-approximate-posterior"><i class="fa fa-check"></i><b>3.1</b> Sampling from a grid-approximate posterior</a></li>
<li class="chapter" data-level="3.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-to-summarize"><i class="fa fa-check"></i><b>3.2</b> Sampling to summarize</a><ul>
<li class="chapter" data-level="3.2.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#intervals-of-defined-boundaries."><i class="fa fa-check"></i><b>3.2.1</b> Intervals of defined boundaries.</a></li>
<li class="chapter" data-level="3.2.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#intervals-of-defined-mass."><i class="fa fa-check"></i><b>3.2.2</b> Intervals of defined mass.</a></li>
<li class="chapter" data-level="3.2.3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#point-estimates."><i class="fa fa-check"></i><b>3.2.3</b> Point estimates.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-to-simulate-prediction"><i class="fa fa-check"></i><b>3.3</b> Sampling to simulate prediction</a><ul>
<li class="chapter" data-level="3.3.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#dummy-data."><i class="fa fa-check"></i><b>3.3.1</b> Dummy data.</a></li>
<li class="chapter" data-level="3.3.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#model-checking."><i class="fa fa-check"></i><b>3.3.2</b> Model checking.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#summary-lets-practice-with-brms"><i class="fa fa-check"></i><b>3.4</b> <del>Summary</del> Let’s practice with brms</a></li>
<li class="chapter" data-level="" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="geocentric-models.html"><a href="geocentric-models.html"><i class="fa fa-check"></i><b>4</b> Geocentric Models</a><ul>
<li class="chapter" data-level="4.1" data-path="geocentric-models.html"><a href="geocentric-models.html#why-normal-distributions-are-normal"><i class="fa fa-check"></i><b>4.1</b> Why normal distributions are normal</a><ul>
<li class="chapter" data-level="4.1.1" data-path="geocentric-models.html"><a href="geocentric-models.html#normal-by-addition."><i class="fa fa-check"></i><b>4.1.1</b> Normal by addition.</a></li>
<li class="chapter" data-level="4.1.2" data-path="geocentric-models.html"><a href="geocentric-models.html#normal-by-multiplication."><i class="fa fa-check"></i><b>4.1.2</b> Normal by multiplication.</a></li>
<li class="chapter" data-level="4.1.3" data-path="geocentric-models.html"><a href="geocentric-models.html#normal-by-log-multiplication."><i class="fa fa-check"></i><b>4.1.3</b> Normal by log-multiplication.</a></li>
<li class="chapter" data-level="4.1.4" data-path="geocentric-models.html"><a href="geocentric-models.html#using-gaussian-distributions."><i class="fa fa-check"></i><b>4.1.4</b> Using Gaussian distributions.</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="geocentric-models.html"><a href="geocentric-models.html#a-language-for-describing-models"><i class="fa fa-check"></i><b>4.2</b> A language for describing models</a><ul>
<li class="chapter" data-level="4.2.1" data-path="geocentric-models.html"><a href="geocentric-models.html#re-describing-the-globe-tossing-model."><i class="fa fa-check"></i><b>4.2.1</b> Re-describing the globe tossing model.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="geocentric-models.html"><a href="geocentric-models.html#a-gaussian-model-of-height"><i class="fa fa-check"></i><b>4.3</b> A Gaussian model of height</a><ul>
<li class="chapter" data-level="4.3.1" data-path="geocentric-models.html"><a href="geocentric-models.html#the-data."><i class="fa fa-check"></i><b>4.3.1</b> The data.</a></li>
<li class="chapter" data-level="4.3.2" data-path="geocentric-models.html"><a href="geocentric-models.html#the-model."><i class="fa fa-check"></i><b>4.3.2</b> The model.</a></li>
<li class="chapter" data-level="4.3.3" data-path="geocentric-models.html"><a href="geocentric-models.html#grid-approximation-of-the-posterior-distribution."><i class="fa fa-check"></i><b>4.3.3</b> Grid approximation of the posterior distribution.</a></li>
<li class="chapter" data-level="4.3.4" data-path="geocentric-models.html"><a href="geocentric-models.html#sampling-from-the-posterior."><i class="fa fa-check"></i><b>4.3.4</b> Sampling from the posterior.</a></li>
<li class="chapter" data-level="4.3.5" data-path="geocentric-models.html"><a href="geocentric-models.html#finding-the-posterior-distribution-with-quap-brm."><i class="fa fa-check"></i><b>4.3.5</b> Finding the posterior distribution with <del><code>quap</code></del> <code>brm()</code>.</a></li>
<li class="chapter" data-level="4.3.6" data-path="geocentric-models.html"><a href="geocentric-models.html#sampling-from-a-quap-brm-fit."><i class="fa fa-check"></i><b>4.3.6</b> Sampling from a <del><code>quap()</code></del> <code>brm()</code> fit.</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="geocentric-models.html"><a href="geocentric-models.html#linear-prediction"><i class="fa fa-check"></i><b>4.4</b> Linear prediction</a><ul>
<li class="chapter" data-level="4.4.1" data-path="geocentric-models.html"><a href="geocentric-models.html#the-linear-model-strategy."><i class="fa fa-check"></i><b>4.4.1</b> The linear model strategy.</a></li>
<li class="chapter" data-level="4.4.2" data-path="geocentric-models.html"><a href="geocentric-models.html#finding-the-posterior-distribution."><i class="fa fa-check"></i><b>4.4.2</b> Finding the posterior distribution.</a></li>
<li class="chapter" data-level="4.4.3" data-path="geocentric-models.html"><a href="geocentric-models.html#interpreting-the-posterior-distribution."><i class="fa fa-check"></i><b>4.4.3</b> Interpreting the posterior distribution.</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="geocentric-models.html"><a href="geocentric-models.html#curves-from-lines"><i class="fa fa-check"></i><b>4.5</b> Curves from lines</a><ul>
<li class="chapter" data-level="4.5.1" data-path="geocentric-models.html"><a href="geocentric-models.html#polynomial-regression"><i class="fa fa-check"></i><b>4.5.1</b> Polynomial regression</a></li>
<li class="chapter" data-level="4.5.2" data-path="geocentric-models.html"><a href="geocentric-models.html#splines."><i class="fa fa-check"></i><b>4.5.2</b> Splines.</a></li>
<li class="chapter" data-level="4.5.3" data-path="geocentric-models.html"><a href="geocentric-models.html#smooth-functions-for-a-rough-world."><i class="fa fa-check"></i><b>4.5.3</b> Smooth functions for a rough world.</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="geocentric-models.html"><a href="geocentric-models.html#summary-b-splines-with-brms"><i class="fa fa-check"></i><b>4.6</b> <del>Summary</del> B-splines with <strong>brms</strong></a></li>
<li class="chapter" data-level="" data-path="geocentric-models.html"><a href="geocentric-models.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html"><i class="fa fa-check"></i><b>5</b> The Many Variables &amp; The Spurious Waffles</a><ul>
<li class="chapter" data-level="5.1" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#spurious-associations"><i class="fa fa-check"></i><b>5.1</b> Spurious associations</a><ul>
<li class="chapter" data-level="5.1.1" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#think-before-you-regress."><i class="fa fa-check"></i><b>5.1.1</b> Think before you regress.</a></li>
<li class="chapter" data-level="5.1.2" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#testable-implications."><i class="fa fa-check"></i><b>5.1.2</b> Testable implications.</a></li>
<li class="chapter" data-level="5.1.3" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#multiple-regression-notation."><i class="fa fa-check"></i><b>5.1.3</b> Multiple regression notation.</a></li>
<li class="chapter" data-level="5.1.4" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#approximating-the-posterior."><i class="fa fa-check"></i><b>5.1.4</b> Approximating the posterior.</a></li>
<li class="chapter" data-level="5.1.5" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#plotting-multivariate-posteriors."><i class="fa fa-check"></i><b>5.1.5</b> Plotting multivariate posteriors.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#masked-relationship"><i class="fa fa-check"></i><b>5.2</b> Masked relationship</a></li>
<li class="chapter" data-level="5.3" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#categorical-varaibles"><i class="fa fa-check"></i><b>5.3</b> Categorical varaibles</a><ul>
<li class="chapter" data-level="5.3.1" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#binary-categories."><i class="fa fa-check"></i><b>5.3.1</b> Binary categories.</a></li>
<li class="chapter" data-level="5.3.2" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#many-categories."><i class="fa fa-check"></i><b>5.3.2</b> Many categories.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html"><i class="fa fa-check"></i><b>6</b> The Haunted DAG &amp; The Causal Terror</a><ul>
<li class="chapter" data-level="6.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#multicollinearity"><i class="fa fa-check"></i><b>6.1</b> Multicollinearity</a><ul>
<li class="chapter" data-level="6.1.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#multicollinear-legs."><i class="fa fa-check"></i><b>6.1.1</b> Multicollinear legs.</a></li>
<li class="chapter" data-level="6.1.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#multicollinear-milk."><i class="fa fa-check"></i><b>6.1.2</b> Multicollinear <code>milk</code>.</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#post-treatment-bias"><i class="fa fa-check"></i><b>6.2</b> Post-treatment bias</a><ul>
<li class="chapter" data-level="6.2.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#a-prior-is-born."><i class="fa fa-check"></i><b>6.2.1</b> A prior is born.</a></li>
<li class="chapter" data-level="6.2.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#blocked-by-consequence."><i class="fa fa-check"></i><b>6.2.2</b> Blocked by consequence.</a></li>
<li class="chapter" data-level="6.2.3" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#fungus-and-d-separation."><i class="fa fa-check"></i><b>6.2.3</b> Fungus and <span class="math inline">\(d\)</span>-separation.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#collider-bias"><i class="fa fa-check"></i><b>6.3</b> Collider bias</a><ul>
<li class="chapter" data-level="6.3.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#collider-of-false-sorrow."><i class="fa fa-check"></i><b>6.3.1</b> Collider of false sorrow.</a></li>
<li class="chapter" data-level="6.3.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#the-haunted-dag."><i class="fa fa-check"></i><b>6.3.2</b> The haunted DAG.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#confronting-confounding"><i class="fa fa-check"></i><b>6.4</b> Confronting confounding</a><ul>
<li class="chapter" data-level="6.4.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#shutting-the-backdoor."><i class="fa fa-check"></i><b>6.4.1</b> Shutting the backdoor.</a></li>
<li class="chapter" data-level="6.4.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#two-roads."><i class="fa fa-check"></i><b>6.4.2</b> Two roads.</a></li>
<li class="chapter" data-level="6.4.3" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#backdoor-waffles."><i class="fa fa-check"></i><b>6.4.3</b> Backdoor waffles.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#summary-and-a-little-more-practice"><i class="fa fa-check"></i><b>6.5</b> Summary [and a little more practice]</a></li>
<li class="chapter" data-level="" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ulysses-compass.html"><a href="ulysses-compass.html"><i class="fa fa-check"></i><b>7</b> Ulysses’ Compass</a><ul>
<li class="chapter" data-level="7.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#the-problem-with-parameters"><i class="fa fa-check"></i><b>7.1</b> The problem with parameters</a><ul>
<li class="chapter" data-level="7.1.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#more-parameters-almost-always-improve-fit."><i class="fa fa-check"></i><b>7.1.1</b> More parameters (almost) always improve fit.</a></li>
<li class="chapter" data-level="7.1.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#too-few-parameters-hurts-too."><i class="fa fa-check"></i><b>7.1.2</b> Too few parameters hurts, too.</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#entropy-and-accuracy"><i class="fa fa-check"></i><b>7.2</b> Entropy and accuracy</a><ul>
<li class="chapter" data-level="7.2.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#firing-the-weatherperson."><i class="fa fa-check"></i><b>7.2.1</b> Firing the weatherperson.</a></li>
<li class="chapter" data-level="7.2.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#information-and-uncertainty."><i class="fa fa-check"></i><b>7.2.2</b> Information and uncertainty.</a></li>
<li class="chapter" data-level="7.2.3" data-path="ulysses-compass.html"><a href="ulysses-compass.html#from-entropy-to-accuracy."><i class="fa fa-check"></i><b>7.2.3</b> From entropy to accuracy.</a></li>
<li class="chapter" data-level="7.2.4" data-path="ulysses-compass.html"><a href="ulysses-compass.html#estimating-divergence."><i class="fa fa-check"></i><b>7.2.4</b> Estimating divergence.</a></li>
<li class="chapter" data-level="7.2.5" data-path="ulysses-compass.html"><a href="ulysses-compass.html#scoring-the-right-data."><i class="fa fa-check"></i><b>7.2.5</b> Scoring the right data.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ulysses-compass.html"><a href="ulysses-compass.html#golem-taming-regularization"><i class="fa fa-check"></i><b>7.3</b> Golem taming: regularization</a></li>
<li class="chapter" data-level="7.4" data-path="ulysses-compass.html"><a href="ulysses-compass.html#predicting-predictive-accuracy"><i class="fa fa-check"></i><b>7.4</b> Predicting predictive accuracy</a><ul>
<li class="chapter" data-level="7.4.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#cross-validation."><i class="fa fa-check"></i><b>7.4.1</b> Cross-validation.</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="ulysses-compass.html"><a href="ulysses-compass.html#information-criteria"><i class="fa fa-check"></i><b>7.5</b> Information criteria</a><ul>
<li class="chapter" data-level="7.5.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#comparing-cv-psis-and-waic."><i class="fa fa-check"></i><b>7.5.1</b> Comparing CV, PSIS, and WAIC.</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="ulysses-compass.html"><a href="ulysses-compass.html#model-comparison"><i class="fa fa-check"></i><b>7.6</b> Model comparison</a><ul>
<li class="chapter" data-level="7.6.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#model-mis-selection."><i class="fa fa-check"></i><b>7.6.1</b> Model mis-selection.</a></li>
<li class="chapter" data-level="7.6.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#outliers-and-other-illusions."><i class="fa fa-check"></i><b>7.6.2</b> Outliers and other illusions.</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="ulysses-compass.html"><a href="ulysses-compass.html#summary-bonus-r2-talk"><i class="fa fa-check"></i><b>7.7</b> <del>Summary</del> Bonus: <span class="math inline">\(R^2\)</span> talk</a></li>
<li class="chapter" data-level="" data-path="ulysses-compass.html"><a href="ulysses-compass.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="conditional-manatees.html"><a href="conditional-manatees.html"><i class="fa fa-check"></i><b>8</b> Conditional Manatees</a><ul>
<li class="chapter" data-level="8.1" data-path="conditional-manatees.html"><a href="conditional-manatees.html#building-an-interaction."><i class="fa fa-check"></i><b>8.1</b> Building an interaction.</a><ul>
<li class="chapter" data-level="8.1.1" data-path="conditional-manatees.html"><a href="conditional-manatees.html#making-a-rugged-model."><i class="fa fa-check"></i><b>8.1.1</b> Making a rugged model.</a></li>
<li class="chapter" data-level="8.1.2" data-path="conditional-manatees.html"><a href="conditional-manatees.html#adding-an-indicator-variable-isnt-enough."><i class="fa fa-check"></i><b>8.1.2</b> Adding an indicator variable isn’t enough.</a></li>
<li class="chapter" data-level="8.1.3" data-path="conditional-manatees.html"><a href="conditional-manatees.html#adding-an-interaction-does-work."><i class="fa fa-check"></i><b>8.1.3</b> Adding an interaction does work.</a></li>
<li class="chapter" data-level="8.1.4" data-path="conditional-manatees.html"><a href="conditional-manatees.html#plotting-the-interaction."><i class="fa fa-check"></i><b>8.1.4</b> Plotting the interaction.</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="conditional-manatees.html"><a href="conditional-manatees.html#symmetry-of-interactions"><i class="fa fa-check"></i><b>8.2</b> Symmetry of interactions</a></li>
<li class="chapter" data-level="8.3" data-path="conditional-manatees.html"><a href="conditional-manatees.html#continuous-interactions"><i class="fa fa-check"></i><b>8.3</b> Continuous interactions</a><ul>
<li class="chapter" data-level="8.3.1" data-path="conditional-manatees.html"><a href="conditional-manatees.html#a-winter-flower."><i class="fa fa-check"></i><b>8.3.1</b> A winter flower.</a></li>
<li class="chapter" data-level="8.3.2" data-path="conditional-manatees.html"><a href="conditional-manatees.html#the-models."><i class="fa fa-check"></i><b>8.3.2</b> The models.</a></li>
<li class="chapter" data-level="8.3.3" data-path="conditional-manatees.html"><a href="conditional-manatees.html#plotting-posterior-predictions."><i class="fa fa-check"></i><b>8.3.3</b> Plotting posterior predictions.</a></li>
<li class="chapter" data-level="8.3.4" data-path="conditional-manatees.html"><a href="conditional-manatees.html#plotting-prior-predictions."><i class="fa fa-check"></i><b>8.3.4</b> Plotting prior predictions.</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="conditional-manatees.html"><a href="conditional-manatees.html#summary-bonus-conditional_effects"><i class="fa fa-check"></i><b>8.4</b> <del>Summary</del> Bonus: <code>conditional_effects()</code></a></li>
<li class="chapter" data-level="" data-path="conditional-manatees.html"><a href="conditional-manatees.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>9</b> Markov Chain Monte Carlo</a><ul>
<li class="chapter" data-level="9.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#good-king-markov-and-his-island-kingdom"><i class="fa fa-check"></i><b>9.1</b> Good King Markov and his island kingdom</a></li>
<li class="chapter" data-level="9.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#metropolis-algorithms"><i class="fa fa-check"></i><b>9.2</b> Metropolis algorithms</a><ul>
<li class="chapter" data-level="9.2.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#gibbs-sampling."><i class="fa fa-check"></i><b>9.2.1</b> Gibbs sampling.</a></li>
<li class="chapter" data-level="9.2.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#high-dimensional-problems."><i class="fa fa-check"></i><b>9.2.2</b> High-dimensional problems.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#hamiltonian-monte-carlo"><i class="fa fa-check"></i><b>9.3</b> Hamiltonian Monte Carlo</a><ul>
<li class="chapter" data-level="9.3.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#limitations."><i class="fa fa-check"></i><b>9.3.1</b> Limitations.</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#easy-hmc-ulam-brm"><i class="fa fa-check"></i><b>9.4</b> Easy HMC: <del>ulam</del> <code>brm()</code></a><ul>
<li class="chapter" data-level="9.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#preparation."><i class="fa fa-check"></i><b>9.4.1</b> Preparation.</a></li>
<li class="chapter" data-level="9.4.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#estimation."><i class="fa fa-check"></i><b>9.4.2</b> Estimation.</a></li>
<li class="chapter" data-level="9.4.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#sampling-again-in-parallel."><i class="fa fa-check"></i><b>9.4.3</b> Sampling again, in parallel.</a></li>
<li class="chapter" data-level="9.4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#visualization."><i class="fa fa-check"></i><b>9.4.4</b> Visualization.</a></li>
<li class="chapter" data-level="9.4.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#checking-the-chain."><i class="fa fa-check"></i><b>9.4.5</b> Checking the chain.</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#care-and-feeding-of-your-markov-chain."><i class="fa fa-check"></i><b>9.5</b> Care and feeding of your Markov chain.</a><ul>
<li class="chapter" data-level="9.5.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#how-many-samples-do-you-need"><i class="fa fa-check"></i><b>9.5.1</b> How many samples do you need?</a></li>
<li class="chapter" data-level="9.5.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#how-many-chains-do-you-need"><i class="fa fa-check"></i><b>9.5.2</b> How many chains do you need?</a></li>
<li class="chapter" data-level="9.5.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#taming-a-wild-chain."><i class="fa fa-check"></i><b>9.5.3</b> Taming a wild chain.</a></li>
<li class="chapter" data-level="9.5.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#non-identifiable-parameters."><i class="fa fa-check"></i><b>9.5.4</b> Non-identifiable parameters.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>10</b> Big Entropy and the Generalized Linear Model</a><ul>
<li class="chapter" data-level="10.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#maximum-entropy"><i class="fa fa-check"></i><b>10.1</b> Maximum entropy</a><ul>
<li class="chapter" data-level="10.1.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#gaussian."><i class="fa fa-check"></i><b>10.1.1</b> Gaussian.</a></li>
<li class="chapter" data-level="10.1.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#binomial."><i class="fa fa-check"></i><b>10.1.2</b> Binomial.</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#generalized-linear-models"><i class="fa fa-check"></i><b>10.2</b> Generalized linear models</a><ul>
<li class="chapter" data-level="10.2.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#meet-the-family."><i class="fa fa-check"></i><b>10.2.1</b> Meet the family.</a></li>
<li class="chapter" data-level="10.2.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#linking-linear-models-to-distributions."><i class="fa fa-check"></i><b>10.2.2</b> Linking linear models to distributions.</a></li>
<li class="chapter" data-level="10.2.3" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#omitted-variable-bias-again."><i class="fa fa-check"></i><b>10.2.3</b> Omitted variable bias again.</a></li>
<li class="chapter" data-level="10.2.4" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#absolute-and-relative-differences."><i class="fa fa-check"></i><b>10.2.4</b> Absolute and relative differences.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html"><i class="fa fa-check"></i><b>11</b> God Spiked the Integers</a><ul>
<li class="chapter" data-level="11.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#binomial-regression"><i class="fa fa-check"></i><b>11.1</b> Binomial regression</a><ul>
<li class="chapter" data-level="11.1.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#logistic-regression-prosocial-chimpanzees."><i class="fa fa-check"></i><b>11.1.1</b> Logistic regression: Prosocial chimpanzees.</a></li>
<li class="chapter" data-level="11.1.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#relative-shark-and-absolute-deer."><i class="fa fa-check"></i><b>11.1.2</b> Relative shark and absolute deer.</a></li>
<li class="chapter" data-level="11.1.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#aggregated-binomial-chimpanzees-again-condensed."><i class="fa fa-check"></i><b>11.1.3</b> Aggregated binomial: Chimpanzees again, condensed.</a></li>
<li class="chapter" data-level="11.1.4" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#aggregated-binomial-graduate-school-admissions."><i class="fa fa-check"></i><b>11.1.4</b> Aggregated binomial: Graduate school admissions.</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#poisson-regression"><i class="fa fa-check"></i><b>11.2</b> Poisson regression</a><ul>
<li class="chapter" data-level="11.2.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#example-oceanic-tool-complexity."><i class="fa fa-check"></i><b>11.2.1</b> Example: Oceanic tool complexity.</a></li>
<li class="chapter" data-level="11.2.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#negative-binomial-gamma-poisson-models."><i class="fa fa-check"></i><b>11.2.2</b> Negative binomial (gamma-Poisson) models.</a></li>
<li class="chapter" data-level="11.2.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#example-exposure-and-the-offset."><i class="fa fa-check"></i><b>11.2.3</b> Example: Exposure and the offset.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#multinomial-and-categorical-models"><i class="fa fa-check"></i><b>11.3</b> Multinomial and categorical models</a><ul>
<li class="chapter" data-level="11.3.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#predictors-matched-to-observations."><i class="fa fa-check"></i><b>11.3.1</b> Predictors matched to observations.</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#summary"><i class="fa fa-check"></i><b>11.4</b> Summary</a></li>
<li class="chapter" data-level="" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html"><i class="fa fa-check"></i><b>12</b> Monsters and Mixtures</a><ul>
<li class="chapter" data-level="12.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#over-dispersed-counts"><i class="fa fa-check"></i><b>12.1</b> Over-dispersed counts</a><ul>
<li class="chapter" data-level="12.1.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#beta-binomial."><i class="fa fa-check"></i><b>12.1.1</b> Beta-binomial.</a></li>
<li class="chapter" data-level="12.1.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#negative-binomial-or-gamma-poisson."><i class="fa fa-check"></i><b>12.1.2</b> Negative-binomial or gamma-Poisson.</a></li>
<li class="chapter" data-level="12.1.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#over-dispersion-entropy-and-information-criteria."><i class="fa fa-check"></i><b>12.1.3</b> Over-dispersion, entropy, and information criteria.</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#zero-inflated-outcomes"><i class="fa fa-check"></i><b>12.2</b> Zero-inflated outcomes</a><ul>
<li class="chapter" data-level="12.2.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#example-zero-inflated-poisson."><i class="fa fa-check"></i><b>12.2.1</b> Example: Zero-inflated Poisson.</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#ordered-categorical-outcomes"><i class="fa fa-check"></i><b>12.3</b> Ordered categorical outcomes</a><ul>
<li class="chapter" data-level="12.3.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#example-moral-intuition."><i class="fa fa-check"></i><b>12.3.1</b> Example: Moral intuition.</a></li>
<li class="chapter" data-level="12.3.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#describing-an-ordered-distribution-with-intercepts."><i class="fa fa-check"></i><b>12.3.2</b> Describing an ordered distribution with intercepts.</a></li>
<li class="chapter" data-level="12.3.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#adding-predictor-variables."><i class="fa fa-check"></i><b>12.3.3</b> Adding predictor variables.</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#ordered-categorical-predictors"><i class="fa fa-check"></i><b>12.4</b> Ordered categorical predictors</a></li>
<li class="chapter" data-level="12.5" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#summary-1"><i class="fa fa-check"></i><b>12.5</b> Summary</a></li>
<li class="chapter" data-level="" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="models-with-memory.html"><a href="models-with-memory.html"><i class="fa fa-check"></i><b>13</b> Models With Memory</a><ul>
<li class="chapter" data-level="13.1" data-path="models-with-memory.html"><a href="models-with-memory.html#example-multilevel-tadpoles"><i class="fa fa-check"></i><b>13.1</b> Example: Multilevel tadpoles</a></li>
<li class="chapter" data-level="13.2" data-path="models-with-memory.html"><a href="models-with-memory.html#varying-effects-and-the-underfittingoverfitting-trade-off"><i class="fa fa-check"></i><b>13.2</b> Varying effects and the underfitting/overfitting trade-off</a><ul>
<li class="chapter" data-level="13.2.1" data-path="models-with-memory.html"><a href="models-with-memory.html#the-model.-1"><i class="fa fa-check"></i><b>13.2.1</b> The model.</a></li>
<li class="chapter" data-level="13.2.2" data-path="models-with-memory.html"><a href="models-with-memory.html#assign-values-to-the-parameters."><i class="fa fa-check"></i><b>13.2.2</b> Assign values to the parameters.</a></li>
<li class="chapter" data-level="13.2.3" data-path="models-with-memory.html"><a href="models-with-memory.html#sumulate-survivors."><i class="fa fa-check"></i><b>13.2.3</b> Sumulate survivors.</a></li>
<li class="chapter" data-level="13.2.4" data-path="models-with-memory.html"><a href="models-with-memory.html#compute-the-no-pooling-estimates."><i class="fa fa-check"></i><b>13.2.4</b> Compute the no-pooling estimates.</a></li>
<li class="chapter" data-level="13.2.5" data-path="models-with-memory.html"><a href="models-with-memory.html#compute-the-partial-pooling-estimates."><i class="fa fa-check"></i><b>13.2.5</b> Compute the partial-pooling estimates.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="models-with-memory.html"><a href="models-with-memory.html#more-than-one-type-of-cluster"><i class="fa fa-check"></i><b>13.3</b> More than one type of cluster</a><ul>
<li class="chapter" data-level="13.3.1" data-path="models-with-memory.html"><a href="models-with-memory.html#multilevel-chimpanzees."><i class="fa fa-check"></i><b>13.3.1</b> Multilevel chimpanzees.</a></li>
<li class="chapter" data-level="13.3.2" data-path="models-with-memory.html"><a href="models-with-memory.html#even-more-clusters."><i class="fa fa-check"></i><b>13.3.2</b> Even more clusters.</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="models-with-memory.html"><a href="models-with-memory.html#divergent-transitions-and-non-centered-priors"><i class="fa fa-check"></i><b>13.4</b> Divergent transitions and non-centered priors</a><ul>
<li class="chapter" data-level="13.4.1" data-path="models-with-memory.html"><a href="models-with-memory.html#the-devils-funnel."><i class="fa fa-check"></i><b>13.4.1</b> The Devil’s Funnel.</a></li>
<li class="chapter" data-level="13.4.2" data-path="models-with-memory.html"><a href="models-with-memory.html#non-centered-chimpanzees."><i class="fa fa-check"></i><b>13.4.2</b> Non-centered chimpanzees.</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="models-with-memory.html"><a href="models-with-memory.html#multilevel-posterior-predictions"><i class="fa fa-check"></i><b>13.5</b> Multilevel posterior predictions</a><ul>
<li class="chapter" data-level="13.5.1" data-path="models-with-memory.html"><a href="models-with-memory.html#posterior-prediction-for-same-clusters."><i class="fa fa-check"></i><b>13.5.1</b> Posterior prediction for same clusters.</a></li>
<li class="chapter" data-level="13.5.2" data-path="models-with-memory.html"><a href="models-with-memory.html#posterior-prediction-for-new-clusters."><i class="fa fa-check"></i><b>13.5.2</b> Posterior prediction for new clusters.</a></li>
<li class="chapter" data-level="13.5.3" data-path="models-with-memory.html"><a href="models-with-memory.html#post-stratification."><i class="fa fa-check"></i><b>13.5.3</b> Post-stratification.</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="models-with-memory.html"><a href="models-with-memory.html#summary-bonus-post-stratification-in-an-example"><i class="fa fa-check"></i><b>13.6</b> <del>Summary</del> Bonus: Post-stratification in an example</a><ul>
<li class="chapter" data-level="13.6.1" data-path="models-with-memory.html"><a href="models-with-memory.html#meet-the-data."><i class="fa fa-check"></i><b>13.6.1</b> Meet the data.</a></li>
<li class="chapter" data-level="13.6.2" data-path="models-with-memory.html"><a href="models-with-memory.html#settle-the-mr-part-of-mrp."><i class="fa fa-check"></i><b>13.6.2</b> Settle the MR part of MRP.</a></li>
<li class="chapter" data-level="13.6.3" data-path="models-with-memory.html"><a href="models-with-memory.html#post-stratify-to-put-the-p-in-mrp."><i class="fa fa-check"></i><b>13.6.3</b> Post-stratify to put the P in MRP.</a></li>
<li class="chapter" data-level="13.6.4" data-path="models-with-memory.html"><a href="models-with-memory.html#wrap-this-mrp-up."><i class="fa fa-check"></i><b>13.6.4</b> Wrap this MRP up.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="models-with-memory.html"><a href="models-with-memory.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html"><i class="fa fa-check"></i><b>14</b> Adventures in Covariance</a><ul>
<li class="chapter" data-level="14.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#varying-slopes-by-construction"><i class="fa fa-check"></i><b>14.1</b> Varying slopes by construction</a><ul>
<li class="chapter" data-level="14.1.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#simulate-the-population."><i class="fa fa-check"></i><b>14.1.1</b> Simulate the population.</a></li>
<li class="chapter" data-level="14.1.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#simulate-observations."><i class="fa fa-check"></i><b>14.1.2</b> Simulate observations.</a></li>
<li class="chapter" data-level="14.1.3" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#the-varying-slopes-model."><i class="fa fa-check"></i><b>14.1.3</b> The varying slopes model.</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#advanced-varying-slopes"><i class="fa fa-check"></i><b>14.2</b> Advanced varying slopes</a></li>
<li class="chapter" data-level="14.3" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#instruments-and-causal-designs"><i class="fa fa-check"></i><b>14.3</b> Instruments and causal designs</a><ul>
<li class="chapter" data-level="14.3.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#instrumental-variables."><i class="fa fa-check"></i><b>14.3.1</b> Instrumental variables.</a></li>
<li class="chapter" data-level="14.3.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#other-designs."><i class="fa fa-check"></i><b>14.3.2</b> Other designs.</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#social-relations-as-correlated-varying-effects"><i class="fa fa-check"></i><b>14.4</b> Social relations as correlated varying effects</a></li>
<li class="chapter" data-level="14.5" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#continuous-categories-and-the-gaussian-process"><i class="fa fa-check"></i><b>14.5</b> Continuous categories and the Gaussian process</a><ul>
<li class="chapter" data-level="14.5.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#example-spatial-autocorrelation-in-oceanic-tools."><i class="fa fa-check"></i><b>14.5.1</b> Example: Spatial autocorrelation in Oceanic tools.</a></li>
<li class="chapter" data-level="14.5.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#example-phylogenetic-distance."><i class="fa fa-check"></i><b>14.5.2</b> Example: Phylogenetic distance.</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#summary-bonus-multilevel-growth-models-and-the-melsm"><i class="fa fa-check"></i><b>14.6</b> <del>Summary</del> Bonus: Multilevel growth models and the MELSM</a><ul>
<li class="chapter" data-level="14.6.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#borrow-some-data."><i class="fa fa-check"></i><b>14.6.1</b> Borrow some data.</a></li>
<li class="chapter" data-level="14.6.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#conventional-multilevel-growth-model."><i class="fa fa-check"></i><b>14.6.2</b> Conventional multilevel growth model.</a></li>
<li class="chapter" data-level="14.6.3" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#learn-more-about-your-data-with-the-melsm."><i class="fa fa-check"></i><b>14.6.3</b> Learn more about your data with the MELSM.</a></li>
<li class="chapter" data-level="14.6.4" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#time-to-go-multivariate."><i class="fa fa-check"></i><b>14.6.4</b> Time to go multivariate.</a></li>
<li class="chapter" data-level="14.6.5" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#growth-modelmelsm-wrap-up."><i class="fa fa-check"></i><b>14.6.5</b> Growth model/MELSM wrap-up.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#session-info-13"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Statistical rethinking</em> with brms, ggplot2, and the tidyverse: Second edition</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="small-worlds-and-large-worlds" class="section level1">
<h1><span class="header-section-number">2</span> Small Worlds and Large Worlds</h1>
<p>A while back The Oatmeal put together an <a href="http://theoatmeal.com/comics/columbus_day">infographic on Christopher Columbus</a>. I’m no historian and cannot vouch for its accuracy, so make of it what you will.</p>
<p>McElreath described the thrust of this chapter this way:</p>
<blockquote>
<p>In this chapter, you will begin to build Bayesian models. The way that Bayesian models learn from evidence is arguably optimal in the small world. When their assumptions approximate reality, they also perform well in the large world. But large world performance has to be demonstrated rather than logically deduced. <span class="citation">(McElreath, <a href="#ref-mcelreathStatisticalRethinkingBayesian2020" role="doc-biblioref">2020</a><a href="#ref-mcelreathStatisticalRethinkingBayesian2020" role="doc-biblioref">b</a>, p. 20)</span></p>
</blockquote>
<p>Indeed.</p>
<div id="the-garden-of-forking-data" class="section level2">
<h2><span class="header-section-number">2.1</span> The garden of forking data</h2>
<p>Gelman and Loken <span class="citation">(<a href="#ref-gelmanGardenForkingPaths2013" role="doc-biblioref">2013</a>)</span> wrote a <a href="https://stat.columbia.edu/~gelman/research/unpublished/p_hacking.pdf">great paper of a similar name</a> and topic. The titles from this section and Gelman and Loken’s paper have their origins in the short story by <a href="https://en.wikipedia.org/wiki/Jorge_Luis_Borges">Jorge Luis Borges</a> <span class="citation">(<a href="#ref-borgesjlJardinSenderosQue1941" role="doc-biblioref">1941</a>)</span>, <em>The garden of forking paths</em>. You can find copies of the original short story <a href="https://archive.org/stream/TheGardenOfForkingPathsJorgeLuisBorges1941/The-Garden-of-Forking-Paths-Jorge-Luis-Borges-1941_djvu.txt">here</a> or <a href="https://genius.com/Jorge-luis-borges-the-garden-of-forking-paths-annotated">here</a>. Here’s a snip:</p>
<blockquote>
<p>In all fictional works, each time a man is confronted with several alternatives, he chooses one and eliminates the others; in the fiction of Ts’ui Pên, he chooses–simultaneously–all of them. He creates, in this way, diverse futures, diverse times which themselves also proliferate and fork.
The choices we make in our data analyses proliferate and fork in this way, too.</p>
</blockquote>
<div id="counting-possibilities." class="section level3">
<h3><span class="header-section-number">2.1.1</span> Counting possibilities.</h3>
<p>Throughout this project, we’ll make extensive use packages from the <a href="https://www.tidyverse.org"><strong>tidyverse</strong></a> for data wrangling and plotting.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="small-worlds-and-large-worlds.html#cb3-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<p>If you are new to <strong>tidyverse</strong>-style syntax, possibly the oddest component is the pipe (i.e., <code>%&gt;%</code>). I’m not going to explain the <code>%&gt;%</code> in this project, but you might learn more about in <a href="https://www.youtube.com/watch?v=9yjhxvu-pDg">this brief clip</a>, starting around <a href="https://www.youtube.com/watch?v=K-ss_ag2k9E&amp;t=1285s">minute 21:25 in this talk by Wickham</a>, or in <a href="https://r4ds.had.co.nz/transform.html#combining-multiple-operations-with-the-pipe">Section 5.6.1</a> from Grolemund and Wickham’s <span class="citation">(<a href="#ref-grolemundDataScience2017" role="doc-biblioref">2017</a>)</span> <em>R for data science</em>. Really, all of Chapter 5 of <em>R4DS</em> is just great for new <strong>R</strong> and new <strong>tidyverse</strong> users. And <em>R4DS</em> Chapter 3 is a nice introduction to plotting with <strong>ggplot2</strong> <span class="citation">(Wickham, <a href="#ref-wickhamGgplot2ElegantGraphics2016" role="doc-biblioref">2016</a>; Wickham et al., <a href="#ref-R-ggplot2" role="doc-biblioref">2020</a>)</span>.</p>
<p>Other than the pipe, the other big thing to be aware of is <a href="https://tibble.tidyverse.org">tibbles</a> <span class="citation">(Müller &amp; Wickham, <a href="#ref-R-tibble" role="doc-biblioref">2020</a>)</span>. For our purposes, think of a tibble as a data object with two dimensions defined by rows and columns. Importantly, tibbles are just special types of <a href="https://bookdown.org/rdpeng/rprogdatascience/r-nuts-and-bolts.html#data-framesbookdown::preview_chapter(%2206.Rmd%22)">data frames</a>. So, whenever we talk about data frames, we’re usually talking about tibbles. For more on the topic, check out <a href="https://r4ds.had.co.nz/tibbles.html"><em>R4SD</em>, Chapter 10</a>.</p>
<p>If we’re willing to code the marbles as 0 = “white” 1 = “blue”, we can arrange the possibility data in a tibble as follows.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="small-worlds-and-large-worlds.html#cb4-1"></a>d &lt;-</span>
<span id="cb4-2"><a href="small-worlds-and-large-worlds.html#cb4-2"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">p1 =</span> <span class="dv">0</span>,</span>
<span id="cb4-3"><a href="small-worlds-and-large-worlds.html#cb4-3"></a>         <span class="dt">p2 =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)),</span>
<span id="cb4-4"><a href="small-worlds-and-large-worlds.html#cb4-4"></a>         <span class="dt">p3 =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)),</span>
<span id="cb4-5"><a href="small-worlds-and-large-worlds.html#cb4-5"></a>         <span class="dt">p4 =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)),</span>
<span id="cb4-6"><a href="small-worlds-and-large-worlds.html#cb4-6"></a>         <span class="dt">p5 =</span> <span class="dv">1</span>)</span>
<span id="cb4-7"><a href="small-worlds-and-large-worlds.html#cb4-7"></a></span>
<span id="cb4-8"><a href="small-worlds-and-large-worlds.html#cb4-8"></a><span class="kw">head</span>(d)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 5
##      p1    p2    p3    p4    p5
##   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
## 1     0     1     1     1     1
## 2     0     0     1     1     1
## 3     0     0     0     1     1
## 4     0     0     0     0     1</code></pre>
<p>You might depict the possibility data in a plot.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="small-worlds-and-large-worlds.html#cb6-1"></a>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-2"><a href="small-worlds-and-large-worlds.html#cb6-2"></a><span class="st">  </span><span class="kw">set_names</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-3"><a href="small-worlds-and-large-worlds.html#cb6-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-4"><a href="small-worlds-and-large-worlds.html#cb6-4"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>x, <span class="dt">names_to =</span> <span class="st">&quot;possibility&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-5"><a href="small-worlds-and-large-worlds.html#cb6-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">value =</span> value <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-6"><a href="small-worlds-and-large-worlds.html#cb6-6"></a><span class="st">  </span></span>
<span id="cb6-7"><a href="small-worlds-and-large-worlds.html#cb6-7"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> possibility, <span class="dt">fill =</span> value)) <span class="op">+</span></span>
<span id="cb6-8"><a href="small-worlds-and-large-worlds.html#cb6-8"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">5</span>) <span class="op">+</span></span>
<span id="cb6-9"><a href="small-worlds-and-large-worlds.html#cb6-9"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;navy&quot;</span>)) <span class="op">+</span></span>
<span id="cb6-10"><a href="small-worlds-and-large-worlds.html#cb6-10"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb6-11"><a href="small-worlds-and-large-worlds.html#cb6-11"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="02_files/figure-gfm/unnamed-chunk-4-1.png" width="120" style="display: block; margin: auto;" /></p>
<p>As a quick aside, check out Suzan Baert’s blog post <a href="https://suzan.rbind.io/2018/02/dplyr-tutorial-2/"><em>Data wrangling part 2: Transforming your columns into the right shape</em></a> for an extensive discussion on <code>dplyr::mutate()</code> and <code>tidyr::gather()</code>. The <code>tidyr::pivot_longer()</code> function is an updated variant of <code>gather()</code>, which we’ll be making extensive use of throughout this project. If you’re new to reshaping data with pivoting, check out the vignettes <a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">here</a> and <a href="https://tidyr.tidyverse.org/articles/pivot.html">here</a> <span class="citation">(<em>Pivot Data from Wide to Long Pivot_longer</em>, <a href="#ref-PivotDataWide2020" role="doc-biblioref">2020</a>; <em>Pivoting</em>, <a href="#ref-Pivoting2020" role="doc-biblioref">2020</a>)</span>.</p>
<p>Here’s the basic structure of the possibilities per marble draw.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="small-worlds-and-large-worlds.html#cb7-1"></a><span class="kw">tibble</span>(<span class="dt">draw    =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,</span>
<span id="cb7-2"><a href="small-worlds-and-large-worlds.html#cb7-2"></a>       <span class="dt">marbles =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-3"><a href="small-worlds-and-large-worlds.html#cb7-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">possibilities =</span> marbles <span class="op">^</span><span class="st"> </span>draw) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-4"><a href="small-worlds-and-large-worlds.html#cb7-4"></a><span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">draw</th>
<th align="right">marbles</th>
<th align="right">possibilities</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">4</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">4</td>
<td align="right">64</td>
</tr>
</tbody>
</table>
<p>If you walk that out a little, you can structure the data required to approach Figure 2.2.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="small-worlds-and-large-worlds.html#cb8-1"></a>(</span>
<span id="cb8-2"><a href="small-worlds-and-large-worlds.html#cb8-2"></a>  d &lt;-</span>
<span id="cb8-3"><a href="small-worlds-and-large-worlds.html#cb8-3"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">position =</span> <span class="kw">c</span>((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">0</span>, </span>
<span id="cb8-4"><a href="small-worlds-and-large-worlds.html#cb8-4"></a>                      (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>, </span>
<span id="cb8-5"><a href="small-worlds-and-large-worlds.html#cb8-5"></a>                      (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">3</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>),</span>
<span id="cb8-6"><a href="small-worlds-and-large-worlds.html#cb8-6"></a>         <span class="dt">draw     =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">1</span>, <span class="dv">4</span><span class="op">^</span><span class="dv">2</span>, <span class="dv">4</span><span class="op">^</span><span class="dv">3</span>)),</span>
<span id="cb8-7"><a href="small-worlds-and-large-worlds.html#cb8-7"></a>         <span class="dt">fill     =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;b&quot;</span>, <span class="st">&quot;w&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-8"><a href="small-worlds-and-large-worlds.html#cb8-8"></a><span class="st">           </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)))</span>
<span id="cb8-9"><a href="small-worlds-and-large-worlds.html#cb8-9"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 84 x 3
##    position  draw fill 
##       &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;
##  1     1        1 b    
##  2     2        1 w    
##  3     3        1 w    
##  4     4        1 w    
##  5     0.25     2 b    
##  6     0.5      2 w    
##  7     0.75     2 w    
##  8     1        2 w    
##  9     1.25     2 b    
## 10     1.5      2 w    
## # … with 74 more rows</code></pre>
<p>See what I did there with the parentheses? If you assign a value to an object in <strong>R</strong> (e.g., <code>dog &lt;- 1</code>) and just hit return, nothing will immediately pop up in the <a href="http://r4ds.had.co.nz/introduction.html#rstudio">console</a>. You have to actually execute <code>dog</code> before <strong>R</strong> will return <code>1</code>. But if you wrap the code within parentheses (e.g., <code>(dog &lt;- 1)</code>), <strong>R</strong> will perform the assignment and return the value as if you had executed <code>dog</code>.</p>
<p>But we digress. Here’s the initial plot.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="small-worlds-and-large-worlds.html#cb10-1"></a>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-2"><a href="small-worlds-and-large-worlds.html#cb10-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> position, <span class="dt">y =</span> draw, <span class="dt">fill =</span> fill)) <span class="op">+</span></span>
<span id="cb10-3"><a href="small-worlds-and-large-worlds.html#cb10-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb10-4"><a href="small-worlds-and-large-worlds.html#cb10-4"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values  =</span> <span class="kw">c</span>(<span class="st">&quot;navy&quot;</span>, <span class="st">&quot;white&quot;</span>)) <span class="op">+</span></span>
<span id="cb10-5"><a href="small-worlds-and-large-worlds.html#cb10-5"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb10-6"><a href="small-worlds-and-large-worlds.html#cb10-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb10-7"><a href="small-worlds-and-large-worlds.html#cb10-7"></a>        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</span></code></pre></div>
<p><img src="02_files/figure-gfm/unnamed-chunk-7-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>To my mind, the easiest way to connect the dots in the appropriate way is to make two auxiliary tibbles.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="small-worlds-and-large-worlds.html#cb11-1"></a><span class="co"># these will connect the dots from the first and second draws</span></span>
<span id="cb11-2"><a href="small-worlds-and-large-worlds.html#cb11-2"></a>(</span>
<span id="cb11-3"><a href="small-worlds-and-large-worlds.html#cb11-3"></a>  lines_<span class="dv">1</span> &lt;-</span>
<span id="cb11-4"><a href="small-worlds-and-large-worlds.html#cb11-4"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x    =</span> <span class="kw">rep</span>((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">each =</span> <span class="dv">4</span>),</span>
<span id="cb11-5"><a href="small-worlds-and-large-worlds.html#cb11-5"></a>         <span class="dt">xend =</span> ((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span>),</span>
<span id="cb11-6"><a href="small-worlds-and-large-worlds.html#cb11-6"></a>         <span class="dt">y    =</span> <span class="dv">1</span>,</span>
<span id="cb11-7"><a href="small-worlds-and-large-worlds.html#cb11-7"></a>         <span class="dt">yend =</span> <span class="dv">2</span>)</span>
<span id="cb11-8"><a href="small-worlds-and-large-worlds.html#cb11-8"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 16 x 4
##        x  xend     y  yend
##    &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     1  0.25     1     2
##  2     1  0.5      1     2
##  3     1  0.75     1     2
##  4     1  1        1     2
##  5     2  1.25     1     2
##  6     2  1.5      1     2
##  7     2  1.75     1     2
##  8     2  2        1     2
##  9     3  2.25     1     2
## 10     3  2.5      1     2
## 11     3  2.75     1     2
## 12     3  3        1     2
## 13     4  3.25     1     2
## 14     4  3.5      1     2
## 15     4  3.75     1     2
## 16     4  4        1     2</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="small-worlds-and-large-worlds.html#cb13-1"></a><span class="co"># these will connect the dots from the second and third draws</span></span>
<span id="cb13-2"><a href="small-worlds-and-large-worlds.html#cb13-2"></a>(</span>
<span id="cb13-3"><a href="small-worlds-and-large-worlds.html#cb13-3"></a>  lines_<span class="dv">2</span> &lt;-</span>
<span id="cb13-4"><a href="small-worlds-and-large-worlds.html#cb13-4"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x    =</span> <span class="kw">rep</span>(((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span>), <span class="dt">each =</span> <span class="dv">4</span>),</span>
<span id="cb13-5"><a href="small-worlds-and-large-worlds.html#cb13-5"></a>         <span class="dt">xend =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">3</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">4</span><span class="op">^</span><span class="dv">2</span>),</span>
<span id="cb13-6"><a href="small-worlds-and-large-worlds.html#cb13-6"></a>         <span class="dt">y    =</span> <span class="dv">2</span>,</span>
<span id="cb13-7"><a href="small-worlds-and-large-worlds.html#cb13-7"></a>         <span class="dt">yend =</span> <span class="dv">3</span>)</span>
<span id="cb13-8"><a href="small-worlds-and-large-worlds.html#cb13-8"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 64 x 4
##        x   xend     y  yend
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  0.25 0.0625     2     3
##  2  0.25 0.125      2     3
##  3  0.25 0.188      2     3
##  4  0.25 0.25       2     3
##  5  0.5  0.312      2     3
##  6  0.5  0.375      2     3
##  7  0.5  0.438      2     3
##  8  0.5  0.5        2     3
##  9  0.75 0.562      2     3
## 10  0.75 0.625      2     3
## # … with 54 more rows</code></pre>
<p>We can use the <code>lines_1</code> and <code>lines_2</code> data in the plot with two <code>geom_segment()</code> functions.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="small-worlds-and-large-worlds.html#cb15-1"></a>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb15-2"><a href="small-worlds-and-large-worlds.html#cb15-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> position, <span class="dt">y =</span> draw)) <span class="op">+</span></span>
<span id="cb15-3"><a href="small-worlds-and-large-worlds.html#cb15-3"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">1</span>,</span>
<span id="cb15-4"><a href="small-worlds-and-large-worlds.html#cb15-4"></a>               <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend,</span>
<span id="cb15-5"><a href="small-worlds-and-large-worlds.html#cb15-5"></a>                   <span class="dt">y =</span> y, <span class="dt">yend =</span> yend),</span>
<span id="cb15-6"><a href="small-worlds-and-large-worlds.html#cb15-6"></a>               <span class="dt">size  =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb15-7"><a href="small-worlds-and-large-worlds.html#cb15-7"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">2</span>,</span>
<span id="cb15-8"><a href="small-worlds-and-large-worlds.html#cb15-8"></a>               <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend,</span>
<span id="cb15-9"><a href="small-worlds-and-large-worlds.html#cb15-9"></a>                   <span class="dt">y =</span> y, <span class="dt">yend =</span> yend),</span>
<span id="cb15-10"><a href="small-worlds-and-large-worlds.html#cb15-10"></a>               <span class="dt">size  =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb15-11"><a href="small-worlds-and-large-worlds.html#cb15-11"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> fill),</span>
<span id="cb15-12"><a href="small-worlds-and-large-worlds.html#cb15-12"></a>             <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb15-13"><a href="small-worlds-and-large-worlds.html#cb15-13"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values  =</span> <span class="kw">c</span>(<span class="st">&quot;navy&quot;</span>, <span class="st">&quot;white&quot;</span>)) <span class="op">+</span></span>
<span id="cb15-14"><a href="small-worlds-and-large-worlds.html#cb15-14"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb15-15"><a href="small-worlds-and-large-worlds.html#cb15-15"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position  =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb15-16"><a href="small-worlds-and-large-worlds.html#cb15-16"></a>        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</span></code></pre></div>
<p><img src="02_files/figure-gfm/unnamed-chunk-9-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>We’ve generated the values for <code>position</code> (i.e., the <span class="math inline">\(x\)</span>-axis), in such a way that they’re all justified to the right, so to speak. But we’d like to center them. For <code>draw == 1</code>, we’ll need to subtract 0.5 from each. For <code>draw == 2</code>, we need to reduce the scale by a factor of 4 and we’ll then need to reduce the scale by another factor of 4 for <code>draw == 3</code>. The <code>ifelse()</code> function will be of use for that.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="small-worlds-and-large-worlds.html#cb16-1"></a>d &lt;-</span>
<span id="cb16-2"><a href="small-worlds-and-large-worlds.html#cb16-2"></a><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-3"><a href="small-worlds-and-large-worlds.html#cb16-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">denominator =</span> <span class="kw">ifelse</span>(draw <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="fl">.5</span>,</span>
<span id="cb16-4"><a href="small-worlds-and-large-worlds.html#cb16-4"></a>                              <span class="kw">ifelse</span>(draw <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, <span class="fl">.5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>,</span>
<span id="cb16-5"><a href="small-worlds-and-large-worlds.html#cb16-5"></a>                                     <span class="fl">.5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-6"><a href="small-worlds-and-large-worlds.html#cb16-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">position =</span> position <span class="op">-</span><span class="st"> </span>denominator)</span>
<span id="cb16-7"><a href="small-worlds-and-large-worlds.html#cb16-7"></a></span>
<span id="cb16-8"><a href="small-worlds-and-large-worlds.html#cb16-8"></a>d</span></code></pre></div>
<pre><code>## # A tibble: 84 x 4
##    position  draw fill  denominator
##       &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;
##  1    0.5       1 b           0.5  
##  2    1.5       1 w           0.5  
##  3    2.5       1 w           0.5  
##  4    3.5       1 w           0.5  
##  5    0.125     2 b           0.125
##  6    0.375     2 w           0.125
##  7    0.625     2 w           0.125
##  8    0.875     2 w           0.125
##  9    1.12      2 b           0.125
## 10    1.38      2 w           0.125
## # … with 74 more rows</code></pre>
<p>We’ll follow the same logic for the <code>lines_1</code> and <code>lines_2</code> data.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="small-worlds-and-large-worlds.html#cb18-1"></a>(</span>
<span id="cb18-2"><a href="small-worlds-and-large-worlds.html#cb18-2"></a>  lines_<span class="dv">1</span> &lt;-</span>
<span id="cb18-3"><a href="small-worlds-and-large-worlds.html#cb18-3"></a><span class="st">  </span>lines_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-4"><a href="small-worlds-and-large-worlds.html#cb18-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x    =</span> x <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>,</span>
<span id="cb18-5"><a href="small-worlds-and-large-worlds.html#cb18-5"></a>         <span class="dt">xend =</span> xend <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>)</span>
<span id="cb18-6"><a href="small-worlds-and-large-worlds.html#cb18-6"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 16 x 4
##        x  xend     y  yend
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1   0.5 0.125     1     2
##  2   0.5 0.375     1     2
##  3   0.5 0.625     1     2
##  4   0.5 0.875     1     2
##  5   1.5 1.12      1     2
##  6   1.5 1.38      1     2
##  7   1.5 1.62      1     2
##  8   1.5 1.88      1     2
##  9   2.5 2.12      1     2
## 10   2.5 2.38      1     2
## 11   2.5 2.62      1     2
## 12   2.5 2.88      1     2
## 13   3.5 3.12      1     2
## 14   3.5 3.38      1     2
## 15   3.5 3.62      1     2
## 16   3.5 3.88      1     2</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="small-worlds-and-large-worlds.html#cb20-1"></a>(</span>
<span id="cb20-2"><a href="small-worlds-and-large-worlds.html#cb20-2"></a>  lines_<span class="dv">2</span> &lt;-</span>
<span id="cb20-3"><a href="small-worlds-and-large-worlds.html#cb20-3"></a><span class="st">  </span>lines_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-4"><a href="small-worlds-and-large-worlds.html#cb20-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x    =</span> x <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>,</span>
<span id="cb20-5"><a href="small-worlds-and-large-worlds.html#cb20-5"></a>         <span class="dt">xend =</span> xend <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb20-6"><a href="small-worlds-and-large-worlds.html#cb20-6"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 64 x 4
##        x   xend     y  yend
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 0.125 0.0312     2     3
##  2 0.125 0.0938     2     3
##  3 0.125 0.156      2     3
##  4 0.125 0.219      2     3
##  5 0.375 0.281      2     3
##  6 0.375 0.344      2     3
##  7 0.375 0.406      2     3
##  8 0.375 0.469      2     3
##  9 0.625 0.531      2     3
## 10 0.625 0.594      2     3
## # … with 54 more rows</code></pre>
<p>Now the plot’s looking closer.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="small-worlds-and-large-worlds.html#cb22-1"></a>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb22-2"><a href="small-worlds-and-large-worlds.html#cb22-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> position, <span class="dt">y =</span> draw)) <span class="op">+</span></span>
<span id="cb22-3"><a href="small-worlds-and-large-worlds.html#cb22-3"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">1</span>,</span>
<span id="cb22-4"><a href="small-worlds-and-large-worlds.html#cb22-4"></a>               <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend,</span>
<span id="cb22-5"><a href="small-worlds-and-large-worlds.html#cb22-5"></a>                   <span class="dt">y =</span> y, <span class="dt">yend =</span> yend),</span>
<span id="cb22-6"><a href="small-worlds-and-large-worlds.html#cb22-6"></a>               <span class="dt">size  =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb22-7"><a href="small-worlds-and-large-worlds.html#cb22-7"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">2</span>,</span>
<span id="cb22-8"><a href="small-worlds-and-large-worlds.html#cb22-8"></a>               <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend,</span>
<span id="cb22-9"><a href="small-worlds-and-large-worlds.html#cb22-9"></a>                   <span class="dt">y =</span> y, <span class="dt">yend =</span> yend),</span>
<span id="cb22-10"><a href="small-worlds-and-large-worlds.html#cb22-10"></a>               <span class="dt">size  =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb22-11"><a href="small-worlds-and-large-worlds.html#cb22-11"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> fill),</span>
<span id="cb22-12"><a href="small-worlds-and-large-worlds.html#cb22-12"></a>             <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb22-13"><a href="small-worlds-and-large-worlds.html#cb22-13"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values  =</span> <span class="kw">c</span>(<span class="st">&quot;navy&quot;</span>, <span class="st">&quot;white&quot;</span>)) <span class="op">+</span></span>
<span id="cb22-14"><a href="small-worlds-and-large-worlds.html#cb22-14"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb22-15"><a href="small-worlds-and-large-worlds.html#cb22-15"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position  =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb22-16"><a href="small-worlds-and-large-worlds.html#cb22-16"></a>        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())</span></code></pre></div>
<p><img src="02_files/figure-gfm/unnamed-chunk-12-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>For the final step, we’ll use <code>coord_polar()</code> to change the <a href="http://sape.inf.usi.ch/quick-reference/ggplot2/coord">coordinate system</a>, giving the plot a mandala-like feel.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="small-worlds-and-large-worlds.html#cb23-1"></a>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb23-2"><a href="small-worlds-and-large-worlds.html#cb23-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> position, <span class="dt">y =</span> draw)) <span class="op">+</span></span>
<span id="cb23-3"><a href="small-worlds-and-large-worlds.html#cb23-3"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">1</span>,</span>
<span id="cb23-4"><a href="small-worlds-and-large-worlds.html#cb23-4"></a>               <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend,</span>
<span id="cb23-5"><a href="small-worlds-and-large-worlds.html#cb23-5"></a>                   <span class="dt">y =</span> y, <span class="dt">yend =</span> yend),</span>
<span id="cb23-6"><a href="small-worlds-and-large-worlds.html#cb23-6"></a>               <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb23-7"><a href="small-worlds-and-large-worlds.html#cb23-7"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">2</span>,</span>
<span id="cb23-8"><a href="small-worlds-and-large-worlds.html#cb23-8"></a>               <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend,</span>
<span id="cb23-9"><a href="small-worlds-and-large-worlds.html#cb23-9"></a>                   <span class="dt">y =</span> y, <span class="dt">yend =</span> yend),</span>
<span id="cb23-10"><a href="small-worlds-and-large-worlds.html#cb23-10"></a>               <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb23-11"><a href="small-worlds-and-large-worlds.html#cb23-11"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> fill),</span>
<span id="cb23-12"><a href="small-worlds-and-large-worlds.html#cb23-12"></a>             <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span></span>
<span id="cb23-13"><a href="small-worlds-and-large-worlds.html#cb23-13"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;navy&quot;</span>, <span class="st">&quot;white&quot;</span>)) <span class="op">+</span></span>
<span id="cb23-14"><a href="small-worlds-and-large-worlds.html#cb23-14"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb23-15"><a href="small-worlds-and-large-worlds.html#cb23-15"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.75</span>, <span class="dv">3</span>), <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb23-16"><a href="small-worlds-and-large-worlds.html#cb23-16"></a><span class="st">  </span><span class="kw">coord_polar</span>() <span class="op">+</span></span>
<span id="cb23-17"><a href="small-worlds-and-large-worlds.html#cb23-17"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb23-18"><a href="small-worlds-and-large-worlds.html#cb23-18"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</span></code></pre></div>
<p><img src="02_files/figure-gfm/unnamed-chunk-13-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>To make our version of Figure 2.3, we’ll have to add an index to tell us which paths remain logically valid after each choice. We’ll call the index <code>remain</code>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="small-worlds-and-large-worlds.html#cb24-1"></a>lines_<span class="dv">1</span> &lt;-</span>
<span id="cb24-2"><a href="small-worlds-and-large-worlds.html#cb24-2"></a><span class="st">  </span>lines_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb24-3"><a href="small-worlds-and-large-worlds.html#cb24-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">remain =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)),</span>
<span id="cb24-4"><a href="small-worlds-and-large-worlds.html#cb24-4"></a>                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span>)))</span>
<span id="cb24-5"><a href="small-worlds-and-large-worlds.html#cb24-5"></a>lines_<span class="dv">2</span> &lt;-</span>
<span id="cb24-6"><a href="small-worlds-and-large-worlds.html#cb24-6"></a><span class="st">  </span>lines_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb24-7"><a href="small-worlds-and-large-worlds.html#cb24-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">remain =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span>),</span>
<span id="cb24-8"><a href="small-worlds-and-large-worlds.html#cb24-8"></a>                    <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</span>
<span id="cb24-9"><a href="small-worlds-and-large-worlds.html#cb24-9"></a>                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">12</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>)))</span>
<span id="cb24-10"><a href="small-worlds-and-large-worlds.html#cb24-10"></a>d &lt;-</span>
<span id="cb24-11"><a href="small-worlds-and-large-worlds.html#cb24-11"></a><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb24-12"><a href="small-worlds-and-large-worlds.html#cb24-12"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">remain =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)),</span>
<span id="cb24-13"><a href="small-worlds-and-large-worlds.html#cb24-13"></a>                    <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)),</span>
<span id="cb24-14"><a href="small-worlds-and-large-worlds.html#cb24-14"></a>                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>),</span>
<span id="cb24-15"><a href="small-worlds-and-large-worlds.html#cb24-15"></a>                    <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</span>
<span id="cb24-16"><a href="small-worlds-and-large-worlds.html#cb24-16"></a>                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">12</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>))) </span>
<span id="cb24-17"><a href="small-worlds-and-large-worlds.html#cb24-17"></a><span class="co"># finally, the plot:</span></span>
<span id="cb24-18"><a href="small-worlds-and-large-worlds.html#cb24-18"></a>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb24-19"><a href="small-worlds-and-large-worlds.html#cb24-19"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> position, <span class="dt">y =</span> draw)) <span class="op">+</span></span>
<span id="cb24-20"><a href="small-worlds-and-large-worlds.html#cb24-20"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">1</span>,</span>
<span id="cb24-21"><a href="small-worlds-and-large-worlds.html#cb24-21"></a>               <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend,</span>
<span id="cb24-22"><a href="small-worlds-and-large-worlds.html#cb24-22"></a>                   <span class="dt">y =</span> y, <span class="dt">yend =</span> yend,</span>
<span id="cb24-23"><a href="small-worlds-and-large-worlds.html#cb24-23"></a>                   <span class="dt">alpha =</span> remain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()),</span>
<span id="cb24-24"><a href="small-worlds-and-large-worlds.html#cb24-24"></a>               <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb24-25"><a href="small-worlds-and-large-worlds.html#cb24-25"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">2</span>,</span>
<span id="cb24-26"><a href="small-worlds-and-large-worlds.html#cb24-26"></a>               <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend,</span>
<span id="cb24-27"><a href="small-worlds-and-large-worlds.html#cb24-27"></a>                   <span class="dt">y =</span> y, <span class="dt">yend =</span> yend,</span>
<span id="cb24-28"><a href="small-worlds-and-large-worlds.html#cb24-28"></a>                   <span class="dt">alpha =</span> remain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()),</span>
<span id="cb24-29"><a href="small-worlds-and-large-worlds.html#cb24-29"></a>               <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb24-30"><a href="small-worlds-and-large-worlds.html#cb24-30"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> fill, <span class="dt">alpha =</span> remain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()),</span>
<span id="cb24-31"><a href="small-worlds-and-large-worlds.html#cb24-31"></a>             <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span></span>
<span id="cb24-32"><a href="small-worlds-and-large-worlds.html#cb24-32"></a><span class="st">  </span><span class="co"># it&#39;s the alpha parameter that makes elements semitransparent</span></span>
<span id="cb24-33"><a href="small-worlds-and-large-worlds.html#cb24-33"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;navy&quot;</span>, <span class="st">&quot;white&quot;</span>)) <span class="op">+</span></span>
<span id="cb24-34"><a href="small-worlds-and-large-worlds.html#cb24-34"></a><span class="st">  </span><span class="kw">scale_alpha_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">5</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb24-35"><a href="small-worlds-and-large-worlds.html#cb24-35"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb24-36"><a href="small-worlds-and-large-worlds.html#cb24-36"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.75</span>, <span class="dv">3</span>), <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb24-37"><a href="small-worlds-and-large-worlds.html#cb24-37"></a><span class="st">  </span><span class="kw">coord_polar</span>() <span class="op">+</span></span>
<span id="cb24-38"><a href="small-worlds-and-large-worlds.html#cb24-38"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb24-39"><a href="small-worlds-and-large-worlds.html#cb24-39"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</span></code></pre></div>
<p><img src="02_files/figure-gfm/unnamed-chunk-14-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Letting “w” = a white dot and “b” = a blue dot, we might recreate the table in the middle of page 23 like so.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="small-worlds-and-large-worlds.html#cb25-1"></a><span class="co"># if we make two custom functions, here, it will simplify the code within `mutate()`, below</span></span>
<span id="cb25-2"><a href="small-worlds-and-large-worlds.html#cb25-2"></a>n_blue &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb25-3"><a href="small-worlds-and-large-worlds.html#cb25-3"></a>  <span class="kw">rowSums</span>(x <span class="op">==</span><span class="st"> &quot;b&quot;</span>)</span>
<span id="cb25-4"><a href="small-worlds-and-large-worlds.html#cb25-4"></a>}</span>
<span id="cb25-5"><a href="small-worlds-and-large-worlds.html#cb25-5"></a></span>
<span id="cb25-6"><a href="small-worlds-and-large-worlds.html#cb25-6"></a>n_white &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb25-7"><a href="small-worlds-and-large-worlds.html#cb25-7"></a>  <span class="kw">rowSums</span>(x <span class="op">==</span><span class="st"> &quot;w&quot;</span>)</span>
<span id="cb25-8"><a href="small-worlds-and-large-worlds.html#cb25-8"></a>}</span>
<span id="cb25-9"><a href="small-worlds-and-large-worlds.html#cb25-9"></a></span>
<span id="cb25-10"><a href="small-worlds-and-large-worlds.html#cb25-10"></a>t &lt;-</span>
<span id="cb25-11"><a href="small-worlds-and-large-worlds.html#cb25-11"></a><span class="st">  </span><span class="co"># for the first four columns, `p_` indexes position</span></span>
<span id="cb25-12"><a href="small-worlds-and-large-worlds.html#cb25-12"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">p_1 =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)),</span>
<span id="cb25-13"><a href="small-worlds-and-large-worlds.html#cb25-13"></a>         <span class="dt">p_2 =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)),</span>
<span id="cb25-14"><a href="small-worlds-and-large-worlds.html#cb25-14"></a>         <span class="dt">p_3 =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>)),</span>
<span id="cb25-15"><a href="small-worlds-and-large-worlds.html#cb25-15"></a>         <span class="dt">p_4 =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">1</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-16"><a href="small-worlds-and-large-worlds.html#cb25-16"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">draw 1: blue</span><span class="st">`</span>  =<span class="st"> </span><span class="kw">n_blue</span>(.),</span>
<span id="cb25-17"><a href="small-worlds-and-large-worlds.html#cb25-17"></a>         <span class="st">`</span><span class="dt">draw 2: white</span><span class="st">`</span> =<span class="st"> </span><span class="kw">n_white</span>(.),</span>
<span id="cb25-18"><a href="small-worlds-and-large-worlds.html#cb25-18"></a>         <span class="st">`</span><span class="dt">draw 3: blue</span><span class="st">`</span>  =<span class="st"> </span><span class="kw">n_blue</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-19"><a href="small-worlds-and-large-worlds.html#cb25-19"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">ways to produce</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">draw 1: blue</span><span class="st">`</span> <span class="op">*</span><span class="st"> `</span><span class="dt">draw 2: white</span><span class="st">`</span> <span class="op">*</span><span class="st"> `</span><span class="dt">draw 3: blue</span><span class="st">`</span>)</span>
<span id="cb25-20"><a href="small-worlds-and-large-worlds.html#cb25-20"></a>t <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-21"><a href="small-worlds-and-large-worlds.html#cb25-21"></a><span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">p_1</th>
<th align="left">p_2</th>
<th align="left">p_3</th>
<th align="left">p_4</th>
<th align="right">draw 1: blue</th>
<th align="right">draw 2: white</th>
<th align="right">draw 3: blue</th>
<th align="right">ways to produce</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">b</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="left">w</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>We’ll need new data for Figure 2.4. Here’s the initial primary data, <code>d</code>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="small-worlds-and-large-worlds.html#cb26-1"></a>d &lt;-</span>
<span id="cb26-2"><a href="small-worlds-and-large-worlds.html#cb26-2"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">position =</span> <span class="kw">c</span>((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">0</span>, </span>
<span id="cb26-3"><a href="small-worlds-and-large-worlds.html#cb26-3"></a>                      (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>, </span>
<span id="cb26-4"><a href="small-worlds-and-large-worlds.html#cb26-4"></a>                      (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">3</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>),</span>
<span id="cb26-5"><a href="small-worlds-and-large-worlds.html#cb26-5"></a>         <span class="dt">draw     =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">1</span>, <span class="dv">4</span><span class="op">^</span><span class="dv">2</span>, <span class="dv">4</span><span class="op">^</span><span class="dv">3</span>)))</span>
<span id="cb26-6"><a href="small-worlds-and-large-worlds.html#cb26-6"></a></span>
<span id="cb26-7"><a href="small-worlds-and-large-worlds.html#cb26-7"></a>(</span>
<span id="cb26-8"><a href="small-worlds-and-large-worlds.html#cb26-8"></a>  d &lt;-</span>
<span id="cb26-9"><a href="small-worlds-and-large-worlds.html#cb26-9"></a><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-10"><a href="small-worlds-and-large-worlds.html#cb26-10"></a><span class="st">  </span><span class="kw">bind_rows</span>(</span>
<span id="cb26-11"><a href="small-worlds-and-large-worlds.html#cb26-11"></a>    d, d</span>
<span id="cb26-12"><a href="small-worlds-and-large-worlds.html#cb26-12"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-13"><a href="small-worlds-and-large-worlds.html#cb26-13"></a><span class="st">  </span><span class="co"># here are the fill colors</span></span>
<span id="cb26-14"><a href="small-worlds-and-large-worlds.html#cb26-14"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fill =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)),</span>
<span id="cb26-15"><a href="small-worlds-and-large-worlds.html#cb26-15"></a>                  <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="dt">each  =</span> <span class="dv">2</span>)       <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)),</span>
<span id="cb26-16"><a href="small-worlds-and-large-worlds.html#cb26-16"></a>                  <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">4</span><span class="op">^</span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-17"><a href="small-worlds-and-large-worlds.html#cb26-17"></a><span class="st">  </span><span class="co"># now we need to shift the positions over in accordance with draw, like before</span></span>
<span id="cb26-18"><a href="small-worlds-and-large-worlds.html#cb26-18"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">denominator =</span> <span class="kw">ifelse</span>(draw <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="fl">.5</span>,</span>
<span id="cb26-19"><a href="small-worlds-and-large-worlds.html#cb26-19"></a>                              <span class="kw">ifelse</span>(draw <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, <span class="fl">.5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span>,</span>
<span id="cb26-20"><a href="small-worlds-and-large-worlds.html#cb26-20"></a>                                     <span class="fl">.5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-21"><a href="small-worlds-and-large-worlds.html#cb26-21"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">position =</span> position <span class="op">-</span><span class="st"> </span>denominator) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-22"><a href="small-worlds-and-large-worlds.html#cb26-22"></a><span class="st">  </span><span class="co"># here we&#39;ll add an index for which pie wedge we&#39;re working with</span></span>
<span id="cb26-23"><a href="small-worlds-and-large-worlds.html#cb26-23"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pie_index =</span> <span class="kw">rep</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">each =</span> <span class="kw">n</span>()<span class="op">/</span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-24"><a href="small-worlds-and-large-worlds.html#cb26-24"></a><span class="st">  </span><span class="co"># to get the position axis correct for pie_index == &quot;b&quot; or &quot;c&quot;, we&#39;ll need to offset</span></span>
<span id="cb26-25"><a href="small-worlds-and-large-worlds.html#cb26-25"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">position =</span> <span class="kw">ifelse</span>(pie_index <span class="op">==</span><span class="st"> &quot;a&quot;</span>, position,</span>
<span id="cb26-26"><a href="small-worlds-and-large-worlds.html#cb26-26"></a>                           <span class="kw">ifelse</span>(pie_index <span class="op">==</span><span class="st"> &quot;b&quot;</span>, position <span class="op">+</span><span class="st"> </span><span class="dv">4</span>,</span>
<span id="cb26-27"><a href="small-worlds-and-large-worlds.html#cb26-27"></a>                                  position <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>)))</span>
<span id="cb26-28"><a href="small-worlds-and-large-worlds.html#cb26-28"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 252 x 5
##    position  draw fill  denominator pie_index
##       &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;    
##  1    0.5       1 w           0.5   a        
##  2    1.5       1 b           0.5   a        
##  3    2.5       1 b           0.5   a        
##  4    3.5       1 b           0.5   a        
##  5    0.125     2 w           0.125 a        
##  6    0.375     2 b           0.125 a        
##  7    0.625     2 b           0.125 a        
##  8    0.875     2 b           0.125 a        
##  9    1.12      2 w           0.125 a        
## 10    1.38      2 b           0.125 a        
## # … with 242 more rows</code></pre>
<p>Both <code>lines_1</code> and <code>lines_2</code> require adjustments for <code>x</code> and <code>xend</code>. Our current approach is a nested <code>ifelse()</code>. Rather than copy and paste that multi-line <code>ifelse()</code> code for all four, let’s wrap it in a compact function, which we’ll call <code>move_over()</code>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="small-worlds-and-large-worlds.html#cb28-1"></a>move_over &lt;-<span class="st"> </span><span class="cf">function</span>(position, index) {</span>
<span id="cb28-2"><a href="small-worlds-and-large-worlds.html#cb28-2"></a>  <span class="kw">ifelse</span>(</span>
<span id="cb28-3"><a href="small-worlds-and-large-worlds.html#cb28-3"></a>    index <span class="op">==</span><span class="st"> &quot;a&quot;</span>, position,</span>
<span id="cb28-4"><a href="small-worlds-and-large-worlds.html#cb28-4"></a>    <span class="kw">ifelse</span>(</span>
<span id="cb28-5"><a href="small-worlds-and-large-worlds.html#cb28-5"></a>      index <span class="op">==</span><span class="st"> &quot;b&quot;</span>, position <span class="op">+</span><span class="st"> </span><span class="dv">4</span>, position <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span></span>
<span id="cb28-6"><a href="small-worlds-and-large-worlds.html#cb28-6"></a>    )</span>
<span id="cb28-7"><a href="small-worlds-and-large-worlds.html#cb28-7"></a>  )</span>
<span id="cb28-8"><a href="small-worlds-and-large-worlds.html#cb28-8"></a>}</span></code></pre></div>
<p>If you’re new to making your own <strong>R</strong> functions, check out <a href="http://r4ds.had.co.nz/functions.html">Chapter 19</a> of <em>R4DS</em> or <a href="https://bookdown.org/rdpeng/rprogdatascience/functions.html">Chapter 14</a> of <em>R programming for data science</em> <span class="citation">(Peng, <a href="#ref-pengProgrammingDataScience2019" role="doc-biblioref">2019</a>)</span>.</p>
<p>Anyway, now we’ll make our new <code>lines_1</code> and <code>lines_2</code> data, for which we’ll use <code>move_over()</code> to adjust their <code>x</code> and <code>xend</code> positions to the correct spots.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="small-worlds-and-large-worlds.html#cb29-1"></a>(</span>
<span id="cb29-2"><a href="small-worlds-and-large-worlds.html#cb29-2"></a>  lines_<span class="dv">1</span> &lt;-</span>
<span id="cb29-3"><a href="small-worlds-and-large-worlds.html#cb29-3"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x    =</span> <span class="kw">rep</span>((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>), <span class="dt">each =</span> <span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</span>
<span id="cb29-4"><a href="small-worlds-and-large-worlds.html#cb29-4"></a>         <span class="dt">xend =</span> ((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span>)        <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</span>
<span id="cb29-5"><a href="small-worlds-and-large-worlds.html#cb29-5"></a>         <span class="dt">y    =</span> <span class="dv">1</span>,</span>
<span id="cb29-6"><a href="small-worlds-and-large-worlds.html#cb29-6"></a>         <span class="dt">yend =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb29-7"><a href="small-worlds-and-large-worlds.html#cb29-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x    =</span> x <span class="op">-</span><span class="st"> </span><span class="fl">.5</span>,</span>
<span id="cb29-8"><a href="small-worlds-and-large-worlds.html#cb29-8"></a>         <span class="dt">xend =</span> xend <span class="op">-</span><span class="st"> </span><span class="fl">.5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb29-9"><a href="small-worlds-and-large-worlds.html#cb29-9"></a><span class="st">  </span><span class="co"># here we&#39;ll add an index for which pie wedge we&#39;re working with</span></span>
<span id="cb29-10"><a href="small-worlds-and-large-worlds.html#cb29-10"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pie_index =</span> <span class="kw">rep</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">each =</span> <span class="kw">n</span>()<span class="op">/</span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb29-11"><a href="small-worlds-and-large-worlds.html#cb29-11"></a><span class="st">  </span><span class="co"># to get the position axis correct for `pie_index == &quot;b&quot;` or `&quot;c&quot;`, we&#39;ll need to offset</span></span>
<span id="cb29-12"><a href="small-worlds-and-large-worlds.html#cb29-12"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x    =</span> <span class="kw">move_over</span>(<span class="dt">position =</span> x,    <span class="dt">index =</span> pie_index),</span>
<span id="cb29-13"><a href="small-worlds-and-large-worlds.html#cb29-13"></a>         <span class="dt">xend =</span> <span class="kw">move_over</span>(<span class="dt">position =</span> xend, <span class="dt">index =</span> pie_index))</span>
<span id="cb29-14"><a href="small-worlds-and-large-worlds.html#cb29-14"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 48 x 5
##        x  xend     y  yend pie_index
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    
##  1   0.5 0.125     1     2 a        
##  2   0.5 0.375     1     2 a        
##  3   0.5 0.625     1     2 a        
##  4   0.5 0.875     1     2 a        
##  5   1.5 1.12      1     2 a        
##  6   1.5 1.38      1     2 a        
##  7   1.5 1.62      1     2 a        
##  8   1.5 1.88      1     2 a        
##  9   2.5 2.12      1     2 a        
## 10   2.5 2.38      1     2 a        
## # … with 38 more rows</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="small-worlds-and-large-worlds.html#cb31-1"></a>(</span>
<span id="cb31-2"><a href="small-worlds-and-large-worlds.html#cb31-2"></a>  lines_<span class="dv">2</span> &lt;-</span>
<span id="cb31-3"><a href="small-worlds-and-large-worlds.html#cb31-3"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x    =</span> <span class="kw">rep</span>(((<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="dv">4</span>), <span class="dt">each =</span> <span class="dv">4</span>)  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</span>
<span id="cb31-4"><a href="small-worlds-and-large-worlds.html#cb31-4"></a>         <span class="dt">xend =</span> (<span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">^</span><span class="dv">3</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>)                 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</span>
<span id="cb31-5"><a href="small-worlds-and-large-worlds.html#cb31-5"></a>         <span class="dt">y    =</span> <span class="dv">2</span>,</span>
<span id="cb31-6"><a href="small-worlds-and-large-worlds.html#cb31-6"></a>         <span class="dt">yend =</span> <span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb31-7"><a href="small-worlds-and-large-worlds.html#cb31-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x    =</span> x <span class="op">-</span><span class="st"> </span><span class="fl">.5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">1</span>,</span>
<span id="cb31-8"><a href="small-worlds-and-large-worlds.html#cb31-8"></a>         <span class="dt">xend =</span> xend <span class="op">-</span><span class="st"> </span><span class="fl">.5</span> <span class="op">/</span><span class="st"> </span><span class="dv">4</span><span class="op">^</span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb31-9"><a href="small-worlds-and-large-worlds.html#cb31-9"></a><span class="st">  </span><span class="co"># here we&#39;ll add an index for which pie wedge we&#39;re working with</span></span>
<span id="cb31-10"><a href="small-worlds-and-large-worlds.html#cb31-10"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pie_index =</span> <span class="kw">rep</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">each =</span> <span class="kw">n</span>()<span class="op">/</span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb31-11"><a href="small-worlds-and-large-worlds.html#cb31-11"></a><span class="st">  </span><span class="co"># to get the position axis correct for `pie_index == &quot;b&quot;` or `&quot;c&quot;`, we&#39;ll need to offset</span></span>
<span id="cb31-12"><a href="small-worlds-and-large-worlds.html#cb31-12"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x    =</span> <span class="kw">move_over</span>(<span class="dt">position =</span> x,    <span class="dt">index =</span> pie_index),</span>
<span id="cb31-13"><a href="small-worlds-and-large-worlds.html#cb31-13"></a>         <span class="dt">xend =</span> <span class="kw">move_over</span>(<span class="dt">position =</span> xend, <span class="dt">index =</span> pie_index))</span>
<span id="cb31-14"><a href="small-worlds-and-large-worlds.html#cb31-14"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 192 x 5
##        x   xend     y  yend pie_index
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;    
##  1 0.125 0.0312     2     3 a        
##  2 0.125 0.0938     2     3 a        
##  3 0.125 0.156      2     3 a        
##  4 0.125 0.219      2     3 a        
##  5 0.375 0.281      2     3 a        
##  6 0.375 0.344      2     3 a        
##  7 0.375 0.406      2     3 a        
##  8 0.375 0.469      2     3 a        
##  9 0.625 0.531      2     3 a        
## 10 0.625 0.594      2     3 a        
## # … with 182 more rows</code></pre>
<p>For the last data wrangling step, we add the <code>remain</code> indices to help us determine which parts to make semitransparent. I’m not sure of a slick way to do this, so these are the result of brute force counting.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="small-worlds-and-large-worlds.html#cb33-1"></a>d &lt;-<span class="st"> </span></span>
<span id="cb33-2"><a href="small-worlds-and-large-worlds.html#cb33-2"></a><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-3"><a href="small-worlds-and-large-worlds.html#cb33-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">remain =</span> <span class="kw">c</span>(<span class="co">#pie_index == &quot;a&quot;</span></span>
<span id="cb33-4"><a href="small-worlds-and-large-worlds.html#cb33-4"></a>                    <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)),</span>
<span id="cb33-5"><a href="small-worlds-and-large-worlds.html#cb33-5"></a>                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span>),</span>
<span id="cb33-6"><a href="small-worlds-and-large-worlds.html#cb33-6"></a>                    <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</span>
<span id="cb33-7"><a href="small-worlds-and-large-worlds.html#cb33-7"></a>                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>),</span>
<span id="cb33-8"><a href="small-worlds-and-large-worlds.html#cb33-8"></a>                    <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</span>
<span id="cb33-9"><a href="small-worlds-and-large-worlds.html#cb33-9"></a>                    <span class="co"># pie_index == &quot;b&quot;</span></span>
<span id="cb33-10"><a href="small-worlds-and-large-worlds.html#cb33-10"></a>                    <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">each =</span> <span class="dv">2</span>),</span>
<span id="cb33-11"><a href="small-worlds-and-large-worlds.html#cb33-11"></a>                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>),</span>
<span id="cb33-12"><a href="small-worlds-and-large-worlds.html#cb33-12"></a>                    <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">each =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">2</span>),</span>
<span id="cb33-13"><a href="small-worlds-and-large-worlds.html#cb33-13"></a>                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>),</span>
<span id="cb33-14"><a href="small-worlds-and-large-worlds.html#cb33-14"></a>                    <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">8</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">2</span>),</span>
<span id="cb33-15"><a href="small-worlds-and-large-worlds.html#cb33-15"></a>                    <span class="co"># pie_index == &quot;c&quot;,</span></span>
<span id="cb33-16"><a href="small-worlds-and-large-worlds.html#cb33-16"></a>                    <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)),</span>
<span id="cb33-17"><a href="small-worlds-and-large-worlds.html#cb33-17"></a>                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span>),</span>
<span id="cb33-18"><a href="small-worlds-and-large-worlds.html#cb33-18"></a>                    <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)), </span>
<span id="cb33-19"><a href="small-worlds-and-large-worlds.html#cb33-19"></a>                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span>),</span>
<span id="cb33-20"><a href="small-worlds-and-large-worlds.html#cb33-20"></a>                    <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</span>
<span id="cb33-21"><a href="small-worlds-and-large-worlds.html#cb33-21"></a>                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span>)</span>
<span id="cb33-22"><a href="small-worlds-and-large-worlds.html#cb33-22"></a>                    )</span>
<span id="cb33-23"><a href="small-worlds-and-large-worlds.html#cb33-23"></a>         )</span>
<span id="cb33-24"><a href="small-worlds-and-large-worlds.html#cb33-24"></a></span>
<span id="cb33-25"><a href="small-worlds-and-large-worlds.html#cb33-25"></a>lines_<span class="dv">1</span> &lt;-</span>
<span id="cb33-26"><a href="small-worlds-and-large-worlds.html#cb33-26"></a><span class="st">  </span>lines_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-27"><a href="small-worlds-and-large-worlds.html#cb33-27"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">remain =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span>),</span>
<span id="cb33-28"><a href="small-worlds-and-large-worlds.html#cb33-28"></a>                    <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</span>
<span id="cb33-29"><a href="small-worlds-and-large-worlds.html#cb33-29"></a>                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>),</span>
<span id="cb33-30"><a href="small-worlds-and-large-worlds.html#cb33-30"></a>                    <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">each  =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">2</span>),</span>
<span id="cb33-31"><a href="small-worlds-and-large-worlds.html#cb33-31"></a>                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span>),</span>
<span id="cb33-32"><a href="small-worlds-and-large-worlds.html#cb33-32"></a>                    <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">0</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb33-33"><a href="small-worlds-and-large-worlds.html#cb33-33"></a>                    )</span>
<span id="cb33-34"><a href="small-worlds-and-large-worlds.html#cb33-34"></a>         )</span>
<span id="cb33-35"><a href="small-worlds-and-large-worlds.html#cb33-35"></a></span>
<span id="cb33-36"><a href="small-worlds-and-large-worlds.html#cb33-36"></a>lines_<span class="dv">2</span> &lt;-</span>
<span id="cb33-37"><a href="small-worlds-and-large-worlds.html#cb33-37"></a><span class="st">  </span>lines_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-38"><a href="small-worlds-and-large-worlds.html#cb33-38"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">remain =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>),</span>
<span id="cb33-39"><a href="small-worlds-and-large-worlds.html#cb33-39"></a>                    <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</span>
<span id="cb33-40"><a href="small-worlds-and-large-worlds.html#cb33-40"></a>                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">8</span>),</span>
<span id="cb33-41"><a href="small-worlds-and-large-worlds.html#cb33-41"></a>                    <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">8</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">2</span>),</span>
<span id="cb33-42"><a href="small-worlds-and-large-worlds.html#cb33-42"></a>                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span>),</span>
<span id="cb33-43"><a href="small-worlds-and-large-worlds.html#cb33-43"></a>                    <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rep</span>(., <span class="dt">times =</span> <span class="dv">3</span>),</span>
<span id="cb33-44"><a href="small-worlds-and-large-worlds.html#cb33-44"></a>                    <span class="kw">rep</span>(<span class="dv">0</span>,   <span class="dt">times =</span> <span class="dv">4</span>)</span>
<span id="cb33-45"><a href="small-worlds-and-large-worlds.html#cb33-45"></a>                    )</span>
<span id="cb33-46"><a href="small-worlds-and-large-worlds.html#cb33-46"></a>         )</span></code></pre></div>
<p>We’re finally ready to plot our Figure 2.4.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="small-worlds-and-large-worlds.html#cb34-1"></a>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb34-2"><a href="small-worlds-and-large-worlds.html#cb34-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> position, <span class="dt">y =</span> draw)) <span class="op">+</span></span>
<span id="cb34-3"><a href="small-worlds-and-large-worlds.html#cb34-3"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">8</span>), <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb34-4"><a href="small-worlds-and-large-worlds.html#cb34-4"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">1</span>,</span>
<span id="cb34-5"><a href="small-worlds-and-large-worlds.html#cb34-5"></a>               <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend,</span>
<span id="cb34-6"><a href="small-worlds-and-large-worlds.html#cb34-6"></a>                   <span class="dt">y =</span> y, <span class="dt">yend =</span> yend,</span>
<span id="cb34-7"><a href="small-worlds-and-large-worlds.html#cb34-7"></a>                   <span class="dt">alpha =</span> remain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()),</span>
<span id="cb34-8"><a href="small-worlds-and-large-worlds.html#cb34-8"></a>               <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb34-9"><a href="small-worlds-and-large-worlds.html#cb34-9"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> lines_<span class="dv">2</span>,</span>
<span id="cb34-10"><a href="small-worlds-and-large-worlds.html#cb34-10"></a>               <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> xend,</span>
<span id="cb34-11"><a href="small-worlds-and-large-worlds.html#cb34-11"></a>                   <span class="dt">y =</span> y, <span class="dt">yend =</span> yend,</span>
<span id="cb34-12"><a href="small-worlds-and-large-worlds.html#cb34-12"></a>                   <span class="dt">alpha =</span> remain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()),</span>
<span id="cb34-13"><a href="small-worlds-and-large-worlds.html#cb34-13"></a>               <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></span>
<span id="cb34-14"><a href="small-worlds-and-large-worlds.html#cb34-14"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> fill, <span class="dt">size =</span> draw, <span class="dt">alpha =</span> remain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.character</span>()),</span>
<span id="cb34-15"><a href="small-worlds-and-large-worlds.html#cb34-15"></a>             <span class="dt">shape =</span> <span class="dv">21</span>) <span class="op">+</span></span>
<span id="cb34-16"><a href="small-worlds-and-large-worlds.html#cb34-16"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;navy&quot;</span>, <span class="st">&quot;white&quot;</span>)) <span class="op">+</span></span>
<span id="cb34-17"><a href="small-worlds-and-large-worlds.html#cb34-17"></a><span class="st">  </span><span class="kw">scale_size_continuous</span>(<span class="dt">range =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="fl">1.5</span>)) <span class="op">+</span></span>
<span id="cb34-18"><a href="small-worlds-and-large-worlds.html#cb34-18"></a><span class="st">  </span><span class="kw">scale_alpha_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="fl">0.2</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb34-19"><a href="small-worlds-and-large-worlds.html#cb34-19"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">12</span>), <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb34-20"><a href="small-worlds-and-large-worlds.html#cb34-20"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.75</span>, <span class="fl">3.5</span>), <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb34-21"><a href="small-worlds-and-large-worlds.html#cb34-21"></a><span class="st">  </span><span class="kw">coord_polar</span>() <span class="op">+</span></span>
<span id="cb34-22"><a href="small-worlds-and-large-worlds.html#cb34-22"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb34-23"><a href="small-worlds-and-large-worlds.html#cb34-23"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</span></code></pre></div>
<p><img src="02_files/figure-gfm/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="combining-other-information." class="section level3">
<h3><span class="header-section-number">2.1.2</span> Combining other information.</h3>
<blockquote>
<p>We may have additional information about the relative plausibility of each conjecture. This information could arise from knowledge of how the contents of the bag were generated. It could also arise from previous data. Whatever the source, it would help to have a way to combine different sources of information to update the plausibilities. Luckily there is a natural solution: Just multiply the counts. (p. 25)</p>
</blockquote>
<p>Here’s a quick version of the table in the middle of page 25.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="small-worlds-and-large-worlds.html#cb35-1"></a>t &lt;-</span>
<span id="cb35-2"><a href="small-worlds-and-large-worlds.html#cb35-2"></a><span class="st">  </span>t <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-3"><a href="small-worlds-and-large-worlds.html#cb35-3"></a><span class="st">  </span><span class="kw">rename</span>(<span class="st">`</span><span class="dt">previous counts</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">ways to produce</span><span class="st">`</span>,</span>
<span id="cb35-4"><a href="small-worlds-and-large-worlds.html#cb35-4"></a>         <span class="st">`</span><span class="dt">ways to produce</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">draw 1: blue</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-5"><a href="small-worlds-and-large-worlds.html#cb35-5"></a><span class="st">  </span><span class="kw">select</span>(p_<span class="dv">1</span><span class="op">:</span>p_<span class="dv">4</span>, <span class="st">`</span><span class="dt">ways to produce</span><span class="st">`</span>, <span class="st">`</span><span class="dt">previous counts</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-6"><a href="small-worlds-and-large-worlds.html#cb35-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">new count</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">ways to produce</span><span class="st">`</span> <span class="op">*</span><span class="st"> `</span><span class="dt">previous counts</span><span class="st">`</span>)</span>
<span id="cb35-7"><a href="small-worlds-and-large-worlds.html#cb35-7"></a></span>
<span id="cb35-8"><a href="small-worlds-and-large-worlds.html#cb35-8"></a>t <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-9"><a href="small-worlds-and-large-worlds.html#cb35-9"></a><span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">p_1</th>
<th align="left">p_2</th>
<th align="left">p_3</th>
<th align="left">p_4</th>
<th align="right">ways to produce</th>
<th align="right">previous counts</th>
<th align="right">new count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">b</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">2</td>
<td align="right">8</td>
<td align="right">16</td>
</tr>
<tr class="even">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="left">w</td>
<td align="right">3</td>
<td align="right">9</td>
<td align="right">27</td>
</tr>
<tr class="odd">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="right">4</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>We might update to reproduce the table a the top of page 26, like this.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="small-worlds-and-large-worlds.html#cb36-1"></a>t &lt;-</span>
<span id="cb36-2"><a href="small-worlds-and-large-worlds.html#cb36-2"></a><span class="st">  </span>t <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-3"><a href="small-worlds-and-large-worlds.html#cb36-3"></a><span class="st">  </span><span class="kw">select</span>(p_<span class="dv">1</span><span class="op">:</span>p_<span class="dv">4</span>, <span class="st">`</span><span class="dt">new count</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-4"><a href="small-worlds-and-large-worlds.html#cb36-4"></a><span class="st">  </span><span class="kw">rename</span>(<span class="st">`</span><span class="dt">prior count</span><span class="st">`</span>   =<span class="st"> `</span><span class="dt">new count</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-5"><a href="small-worlds-and-large-worlds.html#cb36-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">factory count</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">0</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-6"><a href="small-worlds-and-large-worlds.html#cb36-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">new count</span><span class="st">`</span>     =<span class="st"> `</span><span class="dt">prior count</span><span class="st">`</span> <span class="op">*</span><span class="st"> `</span><span class="dt">factory count</span><span class="st">`</span>)</span>
<span id="cb36-7"><a href="small-worlds-and-large-worlds.html#cb36-7"></a></span>
<span id="cb36-8"><a href="small-worlds-and-large-worlds.html#cb36-8"></a>t <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-9"><a href="small-worlds-and-large-worlds.html#cb36-9"></a><span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">p_1</th>
<th align="left">p_2</th>
<th align="left">p_3</th>
<th align="left">p_4</th>
<th align="right">prior count</th>
<th align="right">factory count</th>
<th align="right">new count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">b</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">3</td>
<td align="right">3</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">w</td>
<td align="left">w</td>
<td align="right">16</td>
<td align="right">2</td>
<td align="right">32</td>
</tr>
<tr class="even">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="left">w</td>
<td align="right">27</td>
<td align="right">1</td>
<td align="right">27</td>
</tr>
<tr class="odd">
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="left">b</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>To learn more about <code>dplyr::select()</code> and <code>dplyr::rename()</code>, check out Baert’s exhaustive blog post, <a href="https://suzan.rbind.io/2018/01/dplyr-tutorial-1/"><em>Data wrangling part 1: Basic to advanced ways to select columns</em></a>.</p>
<div id="rethinking-original-ignorance." class="section level4">
<h4><span class="header-section-number">2.1.2.1</span> Rethinking: Original ignorance.</h4>
<blockquote>
<p>Which assumption should we use, when there is no previous infor- mation about the conjectures? The most common solution is to assign an equal number of ways that each conjecture could be correct, before seeing any data. This is sometimes known as the <strong>principle of indifference</strong>: When there is no reason to say that one conjecture is more plausible than another, weigh all of the conjectures equally. This book does not use nor endorse “ignorance” priors. As we’ll see in later chapters, the structure of the model and the scientific context always provide information that allows us to do better than ignorance. (p. 26, <strong>emphasis</strong> in the original)</p>
</blockquote>
</div>
</div>
<div id="from-counts-to-probability." class="section level3">
<h3><span class="header-section-number">2.1.3</span> From counts to probability.</h3>
<p>The opening sentences in this subsection are important: “It is helpful to think of this strategy as adhering to a principle of honest ignorance: <em>When we don’t know what caused the data, potential causes that may produce the data in more ways are more plausible</em>” (p. 26, <em>emphasis</em> in the original).</p>
<p>We can define our updated plausibility as</p>
<center>
<p>plausibility of <img src="pictures/theta_02.png" /> after seeing <img src="pictures/data_02.png" /></p>
<p><span class="math inline">\(\propto\)</span></p>
<p>ways <img src="pictures/theta_02.png" /> can produce <img src="pictures/data_02.png" /></p>
<p><span class="math inline">\(\times\)</span></p>
<p>prior plausibility of <img src="pictures/theta_02.png" />.</p>
</center>
<p>In other words,</p>
<center>
<p>plausibility of <span class="math inline">\(p\)</span> after <span class="math inline">\(D_\text{new}\)</span> <span class="math inline">\(\propto\)</span> ways <span class="math inline">\(p\)</span> can produce <span class="math inline">\(D_\text{new} \times\)</span> prior plausibility of <span class="math inline">\(p\)</span>.</p>
</center>
<p>But since we have to standardize the results to get them into a probability metric, the full equation is</p>
<p><span class="math display">\[\text{plausibility of } p \text{ after } D_\text{new} = \frac{\text{ ways } p \text{ can produce } D_\text{new} \times \text{ prior plausibility of } p}{\text{sum of the products}}.\]</span></p>
<p>You might make a version of the table in the middle of page 27 like this.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="small-worlds-and-large-worlds.html#cb37-1"></a>t <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb37-2"><a href="small-worlds-and-large-worlds.html#cb37-2"></a><span class="st">  </span><span class="kw">select</span>(p_<span class="dv">1</span><span class="op">:</span>p_<span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb37-3"><a href="small-worlds-and-large-worlds.html#cb37-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p                      =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">.25</span>),</span>
<span id="cb37-4"><a href="small-worlds-and-large-worlds.html#cb37-4"></a>         <span class="st">`</span><span class="dt">ways to produce data</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">0</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb37-5"><a href="small-worlds-and-large-worlds.html#cb37-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">plausibility =</span> <span class="st">`</span><span class="dt">ways to produce data</span><span class="st">`</span> <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(<span class="st">`</span><span class="dt">ways to produce data</span><span class="st">`</span>))</span></code></pre></div>
<pre><code>## # A tibble: 5 x 7
##   p_1   p_2   p_3   p_4       p `ways to produce data` plausibility
##   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;                  &lt;dbl&gt;        &lt;dbl&gt;
## 1 w     w     w     w      0                         0         0   
## 2 b     w     w     w      0.25                      3         0.15
## 3 b     b     w     w      0.5                       8         0.4 
## 4 b     b     b     w      0.75                      9         0.45
## 5 b     b     b     b      1                         0         0</code></pre>
<p>We just computed the plausibilities, but here’s McElreath’s <strong>R</strong> code 2.1.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="small-worlds-and-large-worlds.html#cb39-1"></a>ways &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">0</span>)</span>
<span id="cb39-2"><a href="small-worlds-and-large-worlds.html#cb39-2"></a></span>
<span id="cb39-3"><a href="small-worlds-and-large-worlds.html#cb39-3"></a>ways <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(ways)</span></code></pre></div>
<pre><code>## [1] 0.00 0.15 0.40 0.45 0.00</code></pre>
</div>
</div>
<div id="building-a-model" class="section level2">
<h2><span class="header-section-number">2.2</span> Building a model</h2>
<p>We might save our globe-tossing data in a tibble.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="small-worlds-and-large-worlds.html#cb41-1"></a>(d &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">toss =</span> <span class="kw">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>)))</span></code></pre></div>
<pre><code>## # A tibble: 9 x 1
##   toss 
##   &lt;chr&gt;
## 1 w    
## 2 l    
## 3 w    
## 4 w    
## 5 w    
## 6 l    
## 7 w    
## 8 l    
## 9 w</code></pre>
<div id="a-data-story." class="section level3">
<h3><span class="header-section-number">2.2.1</span> A data story.</h3>
<blockquote>
<p>Bayesian data analysis usually means producing a story for how the data came to be. This story may be <em>descriptive</em>, specifying associations that can be used to predict outcomes, given observations. Or it may be <em>causal</em>, a theory of how some events produce other events. Typically, any story you intend to be causal may also be descriptive. But many descriptive stories are hard to interpret causally. But all data stories are complete, in the sense that they are sufficient for specifying an algorithm for simulating new data. (p. 28, <em>emphasis</em> in the original)</p>
</blockquote>
</div>
<div id="bayesian-updating." class="section level3">
<h3><span class="header-section-number">2.2.2</span> Bayesian updating.</h3>
<p>Here we’ll add the cumulative number of trials, <code>n_trials</code>, and the cumulative number of successes, <code>n_successes</code> (i.e., <code>toss == "w"</code>), to the data.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="small-worlds-and-large-worlds.html#cb43-1"></a>(</span>
<span id="cb43-2"><a href="small-worlds-and-large-worlds.html#cb43-2"></a>  d &lt;-</span>
<span id="cb43-3"><a href="small-worlds-and-large-worlds.html#cb43-3"></a><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb43-4"><a href="small-worlds-and-large-worlds.html#cb43-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_trials  =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>,</span>
<span id="cb43-5"><a href="small-worlds-and-large-worlds.html#cb43-5"></a>         <span class="dt">n_success =</span> <span class="kw">cumsum</span>(toss <span class="op">==</span><span class="st"> &quot;w&quot;</span>))</span>
<span id="cb43-6"><a href="small-worlds-and-large-worlds.html#cb43-6"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 9 x 3
##   toss  n_trials n_success
##   &lt;chr&gt;    &lt;int&gt;     &lt;int&gt;
## 1 w            1         1
## 2 l            2         1
## 3 w            3         2
## 4 w            4         3
## 5 w            5         4
## 6 l            6         4
## 7 w            7         5
## 8 l            8         5
## 9 w            9         6</code></pre>
<p>Fair warning: We don’t learn the skills for making Figure 2.5 until later in the chapter. So consider the data wrangling steps in this section as something of a preview.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="small-worlds-and-large-worlds.html#cb45-1"></a>sequence_length &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb45-2"><a href="small-worlds-and-large-worlds.html#cb45-2"></a></span>
<span id="cb45-3"><a href="small-worlds-and-large-worlds.html#cb45-3"></a>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb45-4"><a href="small-worlds-and-large-worlds.html#cb45-4"></a><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(n_trials, toss, n_success), </span>
<span id="cb45-5"><a href="small-worlds-and-large-worlds.html#cb45-5"></a>         <span class="dt">p_water =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> sequence_length)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb45-6"><a href="small-worlds-and-large-worlds.html#cb45-6"></a><span class="st">  </span><span class="kw">group_by</span>(p_water) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb45-7"><a href="small-worlds-and-large-worlds.html#cb45-7"></a><span class="st"> </span><span class="co"># you can learn more about lagging here: https://www.rdocumentation.org/packages/stats/versions/3.5.1/topics/lag or here: https://dplyr.tidyverse.org/reference/lead-lag.html</span></span>
<span id="cb45-8"><a href="small-worlds-and-large-worlds.html#cb45-8"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">lagged_n_trials  =</span> <span class="kw">lag</span>(n_trials, <span class="dt">k =</span> <span class="dv">1</span>),</span>
<span id="cb45-9"><a href="small-worlds-and-large-worlds.html#cb45-9"></a>         <span class="dt">lagged_n_success =</span> <span class="kw">lag</span>(n_success, <span class="dt">k =</span> <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb45-10"><a href="small-worlds-and-large-worlds.html#cb45-10"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb45-11"><a href="small-worlds-and-large-worlds.html#cb45-11"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prior      =</span> <span class="kw">ifelse</span>(n_trials <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="fl">.5</span>,</span>
<span id="cb45-12"><a href="small-worlds-and-large-worlds.html#cb45-12"></a>                             <span class="kw">dbinom</span>(<span class="dt">x    =</span> lagged_n_success, </span>
<span id="cb45-13"><a href="small-worlds-and-large-worlds.html#cb45-13"></a>                                    <span class="dt">size =</span> lagged_n_trials, </span>
<span id="cb45-14"><a href="small-worlds-and-large-worlds.html#cb45-14"></a>                                    <span class="dt">prob =</span> p_water)),</span>
<span id="cb45-15"><a href="small-worlds-and-large-worlds.html#cb45-15"></a>         <span class="dt">likelihood =</span> <span class="kw">dbinom</span>(<span class="dt">x    =</span> n_success, </span>
<span id="cb45-16"><a href="small-worlds-and-large-worlds.html#cb45-16"></a>                             <span class="dt">size =</span> n_trials, </span>
<span id="cb45-17"><a href="small-worlds-and-large-worlds.html#cb45-17"></a>                             <span class="dt">prob =</span> p_water),</span>
<span id="cb45-18"><a href="small-worlds-and-large-worlds.html#cb45-18"></a>         <span class="dt">strip      =</span> <span class="kw">str_c</span>(<span class="st">&quot;n = &quot;</span>, n_trials)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb45-19"><a href="small-worlds-and-large-worlds.html#cb45-19"></a><span class="st">  </span><span class="co"># the next three lines allow us to normalize the prior and the likelihood, </span></span>
<span id="cb45-20"><a href="small-worlds-and-large-worlds.html#cb45-20"></a><span class="st">  </span><span class="co"># putting them both in a probability metric </span></span>
<span id="cb45-21"><a href="small-worlds-and-large-worlds.html#cb45-21"></a><span class="st">  </span><span class="kw">group_by</span>(n_trials) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb45-22"><a href="small-worlds-and-large-worlds.html#cb45-22"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prior      =</span> prior <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(prior),</span>
<span id="cb45-23"><a href="small-worlds-and-large-worlds.html#cb45-23"></a>         <span class="dt">likelihood =</span> likelihood <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(likelihood)) <span class="op">%&gt;%</span><span class="st">   </span></span>
<span id="cb45-24"><a href="small-worlds-and-large-worlds.html#cb45-24"></a><span class="st">  </span></span>
<span id="cb45-25"><a href="small-worlds-and-large-worlds.html#cb45-25"></a><span class="st">  </span><span class="co"># plot!</span></span>
<span id="cb45-26"><a href="small-worlds-and-large-worlds.html#cb45-26"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> p_water)) <span class="op">+</span></span>
<span id="cb45-27"><a href="small-worlds-and-large-worlds.html#cb45-27"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> prior), </span>
<span id="cb45-28"><a href="small-worlds-and-large-worlds.html#cb45-28"></a>            <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb45-29"><a href="small-worlds-and-large-worlds.html#cb45-29"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> likelihood)) <span class="op">+</span></span>
<span id="cb45-30"><a href="small-worlds-and-large-worlds.html#cb45-30"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;proportion water&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.5</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb45-31"><a href="small-worlds-and-large-worlds.html#cb45-31"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;plausibility&quot;</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb45-32"><a href="small-worlds-and-large-worlds.html#cb45-32"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb45-33"><a href="small-worlds-and-large-worlds.html#cb45-33"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>strip, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span></code></pre></div>
<p><img src="02_files/figure-gfm/unnamed-chunk-27-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>If it wasn’t clear in the code, the dashed curves are normalized prior densities. The solid ones are normalized likelihoods. If you don’t normalize (i.e., divide the density by the sum of the density), their respective heights don’t match up with those in the text. Furthermore, it’s the normalization that makes them directly comparable.</p>
<p>To learn more about <code>dplyr::group_by()</code> and its opposite <code>dplyr::ungroup()</code>, check out <a href="http://r4ds.had.co.nz/transform.html"><em>R4DS</em>, Chapter 5</a>. To learn about <code>tidyr::expand()</code>, go <a href="https://tidyr.tidyverse.org/reference/expand.html">here</a>.</p>
<div id="rethinking-sample-size-and-reliable-inference." class="section level4">
<h4><span class="header-section-number">2.2.2.1</span> Rethinking: Sample size and reliable inference.</h4>
<blockquote>
<p>It is common to hear that there is a minimum num- ber of observations for a useful statistical estimate. For example, there is a widespread superstition that 30 observations are needed before one can use a Gaussian distribution. Why? In non-Bayesian statistical inference, procedures are often justified by the method’s behavior at very large sample sizes, so-called <em>asymptotic</em> behavior. As a result, performance at small samples sizes is questionable.</p>
<p>In contrast, Bayesian estimates are valid for any sample size. This does not mean that more data isn’t helpful–it certainly is. Rather, the estimates have a clear and valid interpretation, no matter the sample size. But the price for this power is dependency upon the initial plausibilities, the prior. If the prior is a bad one, then the resulting inference will be misleading. There’s no free lunch,44 when it comes to learning about the world. (p. 31, <em>emphasis</em> in the original)</p>
</blockquote>
</div>
</div>
<div id="evaluate." class="section level3">
<h3><span class="header-section-number">2.2.3</span> Evaluate.</h3>
<blockquote>
<p>The Bayesian model learns in a way that is demonstrably optimal, provided that it accurately describes the real, large world. This is to say that your Bayesian machine guarantees perfect inference within the small world. No other way of using the available information, beginning with the same state of information, could do better.</p>
<p>Don’t get too excited about this logical virtue, however. The calculations may malfunction, so results always have to be checked. And if there are important differences between the model and reality, then there is no logical guarantee of large world performance. And even if the two worlds did match, any particular sample of data could still be misleading. (p. 31)</p>
</blockquote>
<div id="rethinking-deflationary-statistics." class="section level4">
<h4><span class="header-section-number">2.2.3.1</span> Rethinking: Deflationary statistics.</h4>
<blockquote>
<p>It may be that Bayesian inference is the best general purpose method of inference known. However, Bayesian inference is much less powerful than we’d like it to be. There is no approach to inference that provides universal guarantees. No branch of applied mathematics has unfettered access to reality, because math is not discovered, like the proton. Instead it is invented, like the shovel. (p. 32)</p>
</blockquote>
</div>
</div>
</div>
<div id="components-of-the-model" class="section level2">
<h2><span class="header-section-number">2.3</span> Components of the model</h2>
<p>We can sum up the components of the model as three things:</p>
<ol style="list-style-type: decimal">
<li>a likelihood function: “the number of ways each conjecture could produce an observation,”</li>
<li>one or more parameters: “the accumulated number of ways each conjecture cold produce the entire data,” and</li>
<li>a prior: “the initial plausibility of each conjectured cause of the data” (p. 32).</li>
</ol>
<div id="variables." class="section level3">
<h3><span class="header-section-number">2.3.1</span> Variables.</h3>
<blockquote>
<p>Variables are just symbols that can take on different values. In a scientific context, variables include things we wish to infer, such as proportions and rates, as well as things we might observe, the data….</p>
<p>Unobserved variables are usually called <strong>parameters</strong>. (p. 32, <strong>emphasis</strong> in the original)</p>
</blockquote>
</div>
<div id="definitions." class="section level3">
<h3><span class="header-section-number">2.3.2</span> Definitions.</h3>
<blockquote>
<p>Once we have the variables listed, we then have to define each of them. In defining each, we build a model that relates the variables to one another. Remember, the goal is to count all the ways the data could arise, given the assumptions. (p. 33)</p>
</blockquote>
<div id="observed-variables." class="section level4">
<h4><span class="header-section-number">2.3.2.1</span> Observed variables.</h4>
<blockquote>
<p>So that we don’t have to literally count, we can use a mathematical function that tells
us the right plausibility. In conventional statistics, a distribution function assigned to an observed variable is usually called a <strong>likelihood</strong>. (p. 33, <strong>emphasis</strong> in the original)</p>
</blockquote>
<p>If you let the count of water be <span class="math inline">\(w\)</span> and the count of land be <span class="math inline">\(l\)</span>, then the binomial likelihood for the globe-tossing data may be expressed as</p>
<p><span class="math display">\[\operatorname{Pr} (w, l| p) = \frac{(w + l)!}{w!l!} p^w (1 - p)^l.\]</span></p>
<p>As McElreath wrote, we can read that as: "<em>The counts of ‘water’ W and ‘land’ L are distributed binomially, with probability</em> <span class="math inline">\(p\)</span> <em>of ‘water’ on each toss</em>. (p. 33, <em>emphasis</em> in the original). Given a probability of .5, we can use the <code>dbinom()</code> function to determine the likelihood of 6 out of 9 tosses coming out water.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="small-worlds-and-large-worlds.html#cb46-1"></a><span class="kw">dbinom</span>(<span class="dt">x =</span> <span class="dv">6</span>, <span class="dt">size =</span> <span class="dv">9</span>, <span class="dt">prob =</span> <span class="fl">.5</span>)</span></code></pre></div>
<pre><code>## [1] 0.1640625</code></pre>
<p>McElreath suggested we change the values of <code>prob</code>. Here is a way to do so over the parameter space, <span class="math inline">\([0, 1]\)</span>.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="small-worlds-and-large-worlds.html#cb48-1"></a><span class="kw">tibble</span>(<span class="dt">prob =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">.01</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb48-2"><a href="small-worlds-and-large-worlds.html#cb48-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> prob, <span class="dt">y =</span> <span class="kw">dbinom</span>(<span class="dt">x =</span> <span class="dv">6</span>, <span class="dt">size =</span> <span class="dv">9</span>, <span class="dt">prob =</span> prob))) <span class="op">+</span></span>
<span id="cb48-3"><a href="small-worlds-and-large-worlds.html#cb48-3"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb48-4"><a href="small-worlds-and-large-worlds.html#cb48-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;probability&quot;</span>,</span>
<span id="cb48-5"><a href="small-worlds-and-large-worlds.html#cb48-5"></a>       <span class="dt">y =</span> <span class="st">&quot;binomial likelihood&quot;</span>) <span class="op">+</span></span>
<span id="cb48-6"><a href="small-worlds-and-large-worlds.html#cb48-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</span></code></pre></div>
<p><img src="02_files/figure-gfm/unnamed-chunk-29-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
<div id="unobserved-variables." class="section level4">
<h4><span class="header-section-number">2.3.2.2</span> Unobserved variables.</h4>
<blockquote>
<p>The distributions we assign to the observed variables typically have their own variables. In the binomial above, there is <span class="math inline">\(p\)</span>, the probability of sampling water. Since <span class="math inline">\(p\)</span> is not observed, we usually call it a parameter. Even though we cannot observe <span class="math inline">\(p\)</span>, we still have to define it. (p. 34)</p>
</blockquote>
</div>
<div id="overthinking-prior-as-a-probability-distribution" class="section level4">
<h4><span class="header-section-number">2.3.2.3</span> Overthinking: Prior as a probability distribution</h4>
<p>McElreath said that “for a uniform prior from <span class="math inline">\(a\)</span> to <span class="math inline">\(b\)</span>, the probability of any point in the interval is <span class="math inline">\(1 / (b - a)\)</span>” (p. 35). Let’s try that out. To keep things simple, we’ll hold <span class="math inline">\(a\)</span> constant while varying the values for <span class="math inline">\(b\)</span>.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="small-worlds-and-large-worlds.html#cb49-1"></a><span class="kw">tibble</span>(<span class="dt">a =</span> <span class="dv">0</span>,</span>
<span id="cb49-2"><a href="small-worlds-and-large-worlds.html#cb49-2"></a>       <span class="dt">b =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">9</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb49-3"><a href="small-worlds-and-large-worlds.html#cb49-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prob =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(b <span class="op">-</span><span class="st"> </span>a))</span></code></pre></div>
<pre><code>## # A tibble: 5 x 3
##       a     b  prob
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     0   1   1    
## 2     0   1.5 0.667
## 3     0   2   0.5  
## 4     0   3   0.333
## 5     0   9   0.111</code></pre>
<p>I like to verify things with plots.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="small-worlds-and-large-worlds.html#cb51-1"></a><span class="kw">tibble</span>(<span class="dt">a =</span> <span class="dv">0</span>,</span>
<span id="cb51-2"><a href="small-worlds-and-large-worlds.html#cb51-2"></a>       <span class="dt">b =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">9</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb51-3"><a href="small-worlds-and-large-worlds.html#cb51-3"></a><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(a, b), <span class="dt">parameter_space =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">9</span>, <span class="dt">length.out =</span> <span class="dv">500</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb51-4"><a href="small-worlds-and-large-worlds.html#cb51-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prob =</span> <span class="kw">dunif</span>(parameter_space, a, b),</span>
<span id="cb51-5"><a href="small-worlds-and-large-worlds.html#cb51-5"></a>         <span class="dt">b    =</span> <span class="kw">str_c</span>(<span class="st">&quot;b = &quot;</span>, b)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb51-6"><a href="small-worlds-and-large-worlds.html#cb51-6"></a><span class="st">  </span></span>
<span id="cb51-7"><a href="small-worlds-and-large-worlds.html#cb51-7"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> parameter_space, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> prob)) <span class="op">+</span></span>
<span id="cb51-8"><a href="small-worlds-and-large-worlds.html#cb51-8"></a><span class="st">  </span><span class="kw">geom_ribbon</span>() <span class="op">+</span></span>
<span id="cb51-9"><a href="small-worlds-and-large-worlds.html#cb51-9"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">9</span>)) <span class="op">+</span></span>
<span id="cb51-10"><a href="small-worlds-and-large-worlds.html#cb51-10"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">9</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">1</span>),</span>
<span id="cb51-11"><a href="small-worlds-and-large-worlds.html#cb51-11"></a>                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;1/9&quot;</span>, <span class="st">&quot;1/3&quot;</span>, <span class="st">&quot;1/2&quot;</span>, <span class="st">&quot;2/3&quot;</span>, <span class="st">&quot;1&quot;</span>)) <span class="op">+</span></span>
<span id="cb51-12"><a href="small-worlds-and-large-worlds.html#cb51-12"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb51-13"><a href="small-worlds-and-large-worlds.html#cb51-13"></a>        <span class="dt">panel.grid.major.x =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb51-14"><a href="small-worlds-and-large-worlds.html#cb51-14"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>b, <span class="dt">ncol =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="02_files/figure-gfm/unnamed-chunk-31-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>As we’ll learn much later in the project, the <span class="math inline">\(\operatorname{Uniform} (0, 1)\)</span> distribution is special in that we can also express it as the beta distribution for which <span class="math inline">\(\alpha = 1 \text{ and } \beta = 1\)</span>. E.g.,</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="small-worlds-and-large-worlds.html#cb52-1"></a><span class="kw">tibble</span>(<span class="dt">parameter_space =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">50</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb52-2"><a href="small-worlds-and-large-worlds.html#cb52-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prob =</span> <span class="kw">dbeta</span>(parameter_space, <span class="dv">1</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb52-3"><a href="small-worlds-and-large-worlds.html#cb52-3"></a><span class="st">  </span></span>
<span id="cb52-4"><a href="small-worlds-and-large-worlds.html#cb52-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> parameter_space, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> prob)) <span class="op">+</span></span>
<span id="cb52-5"><a href="small-worlds-and-large-worlds.html#cb52-5"></a><span class="st">  </span><span class="kw">geom_ribbon</span>() <span class="op">+</span></span>
<span id="cb52-6"><a href="small-worlds-and-large-worlds.html#cb52-6"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;density&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb52-7"><a href="small-worlds-and-large-worlds.html#cb52-7"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="kw">expression</span>(<span class="st">&quot;This is beta&quot;</span><span class="op">*</span>(<span class="dv">1</span><span class="op">*</span><span class="st">&quot;, &quot;</span><span class="op">*</span><span class="dv">1</span>))) <span class="op">+</span></span>
<span id="cb52-8"><a href="small-worlds-and-large-worlds.html#cb52-8"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</span></code></pre></div>
<p><img src="02_files/figure-gfm/unnamed-chunk-32-1.png" width="240" style="display: block; margin: auto;" /></p>
</div>
<div id="rethinking-datum-or-parameter" class="section level4">
<h4><span class="header-section-number">2.3.2.4</span> Rethinking: Datum or parameter?</h4>
<blockquote>
<p>It is typical to conceive of data and parameters as completely different kinds of entities. Data are measured and known; parameters are unknown and must be estimated from data. Usefully, in the Bayesian framework the distinction between a datum and a parameter is not so fundamental. (p. 35)</p>
</blockquote>
<p>For more in this topic, check out McElreath’s lecture, <a href="https://www.youtube.com/watch?v=yakg94HyWdE&amp;frags=pl%2Cwn"><em>Understanding Bayesian statistics without frequentist language</em></a>.</p>
</div>
</div>
<div id="a-model-is-born." class="section level3">
<h3><span class="header-section-number">2.3.3</span> A model is born.</h3>
<p>We can now describe our observed variables, <span class="math inline">\(w\)</span> and <span class="math inline">\(l\)</span>, with parameters within the binomial likelihood, our shorthand notation for which is</p>
<p><span class="math display">\[w \sim \operatorname{Binomial} (n, p),\]</span></p>
<p>where <span class="math inline">\(n = w + l\)</span>. Our binomial likelihood contains a parameter for an unobserved variable, <span class="math inline">\(p\)</span>. Parameters in Bayesian models are assigned priors and we can report our prior for <span class="math inline">\(p\)</span> as</p>
<p><span class="math display">\[p \sim \operatorname{Uniform} (0, 1),\]</span></p>
<p>which expresses the model assumption that the entire range of possible values for <span class="math inline">\(p\)</span>, <span class="math inline">\([0, 1\)</span>, are equally plausible.</p>
</div>
</div>
<div id="making-the-model-go" class="section level2">
<h2><span class="header-section-number">2.4</span> Making the model go</h2>
<blockquote>
<p>For every unique combination of data, likelihood, parameters, and prior, there is a unique posterior distribution. This distribution contains the relative plausibility of different parameter values, conditional on the data and model. The <em>posterior distribution</em> takes the form of the probability of the parameters, conditional on the data. (p. 36, <em>emphasis</em> added)</p>
</blockquote>
<div id="bayes-theorem." class="section level3">
<h3><span class="header-section-number">2.4.1</span> Bayes’ theorem.</h3>
<p>We already know about our values for <span class="math inline">\(w\)</span>, <span class="math inline">\(l\)</span>, and, by logical necessity, <span class="math inline">\(n\)</span>. Bayes’ theorem will allow us to determine the plausability of various values of <span class="math inline">\(p\)</span>, given <span class="math inline">\(w\)</span> and <span class="math inline">\(l\)</span>, which we can express formally as <span class="math inline">\(\operatorname{Pr} (p | w, l)\)</span>. Building on some of the earlier equations on page 37, Bayes’ theorem tells us that</p>
<p><span class="math display">\[\operatorname{Pr} (p | w, l) = \frac{\operatorname{Pr} (w, l | p) \operatorname{Pr} (p )}{\operatorname{Pr} (w, l)}.\]</span></p>
<blockquote>
<p>And this is Bayes’ theorem. It says that the probability of any particular value of <span class="math inline">\(p\)</span>, considering the data, is equal to the product of the relative plausibility of the data, conditional on <span class="math inline">\(p\)</span>, and the prior plausibility of <span class="math inline">\(p\)</span>, divided by this thing Pr(W, L), which I’ll call the <em>average probability of the data</em>. (p. 37, <em>emphasis</em> in the original)</p>
</blockquote>
<p>We can express this in words as</p>
<p><span class="math display">\[\text{Posterior} = \frac{\text{Probability of the data} \times \text{Prior}}{\text{Average probability of the data}}.\]</span></p>
<p>The average probability of the data is often called the “evidence” or the “average likelihood” and we’ll get a sense of what that means as we go along. “The key lesson is that the posterior is proportional to the product of the prior and the probability of the data” (p. 37). Figure 2.6 will help us see what this means. Here are the preparatory steps for the data.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="small-worlds-and-large-worlds.html#cb53-1"></a>sequence_length &lt;-<span class="st"> </span><span class="fl">1e3</span></span>
<span id="cb53-2"><a href="small-worlds-and-large-worlds.html#cb53-2"></a></span>
<span id="cb53-3"><a href="small-worlds-and-large-worlds.html#cb53-3"></a>d &lt;-</span>
<span id="cb53-4"><a href="small-worlds-and-large-worlds.html#cb53-4"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">probability =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> sequence_length)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb53-5"><a href="small-worlds-and-large-worlds.html#cb53-5"></a><span class="st">  </span><span class="kw">expand</span>(probability, <span class="dt">row =</span> <span class="kw">c</span>(<span class="st">&quot;flat&quot;</span>, <span class="st">&quot;stepped&quot;</span>, <span class="st">&quot;Laplace&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb53-6"><a href="small-worlds-and-large-worlds.html#cb53-6"></a><span class="st">  </span><span class="kw">arrange</span>(row, probability) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb53-7"><a href="small-worlds-and-large-worlds.html#cb53-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prior =</span> <span class="kw">ifelse</span>(row <span class="op">==</span><span class="st"> &quot;flat&quot;</span>, <span class="dv">1</span>,</span>
<span id="cb53-8"><a href="small-worlds-and-large-worlds.html#cb53-8"></a>                        <span class="kw">ifelse</span>(row <span class="op">==</span><span class="st"> &quot;stepped&quot;</span>, <span class="kw">rep</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">each =</span> sequence_length <span class="op">/</span><span class="st"> </span><span class="dv">2</span>),</span>
<span id="cb53-9"><a href="small-worlds-and-large-worlds.html#cb53-9"></a>                               <span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(probability <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>) <span class="op">/</span><span class="st"> </span><span class="fl">.25</span>) <span class="op">/</span><span class="st"> </span>( <span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.25</span>))),</span>
<span id="cb53-10"><a href="small-worlds-and-large-worlds.html#cb53-10"></a>         <span class="dt">likelihood =</span> <span class="kw">dbinom</span>(<span class="dt">x =</span> <span class="dv">6</span>, <span class="dt">size =</span> <span class="dv">9</span>, <span class="dt">prob =</span> probability)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb53-11"><a href="small-worlds-and-large-worlds.html#cb53-11"></a><span class="st">  </span><span class="kw">group_by</span>(row) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb53-12"><a href="small-worlds-and-large-worlds.html#cb53-12"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">posterior =</span> prior <span class="op">*</span><span class="st"> </span>likelihood <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(prior <span class="op">*</span><span class="st"> </span>likelihood)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb53-13"><a href="small-worlds-and-large-worlds.html#cb53-13"></a><span class="st">  </span><span class="kw">pivot_longer</span>(prior<span class="op">:</span>posterior)  <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb53-14"><a href="small-worlds-and-large-worlds.html#cb53-14"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb53-15"><a href="small-worlds-and-large-worlds.html#cb53-15"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">name =</span> <span class="kw">factor</span>(name, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;prior&quot;</span>, <span class="st">&quot;likelihood&quot;</span>, <span class="st">&quot;posterior&quot;</span>)),</span>
<span id="cb53-16"><a href="small-worlds-and-large-worlds.html#cb53-16"></a>         <span class="dt">row  =</span> <span class="kw">factor</span>(row, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;flat&quot;</span>, <span class="st">&quot;stepped&quot;</span>, <span class="st">&quot;Laplace&quot;</span>)))</span></code></pre></div>
<p>To learn more about <code>dplyr::arrange()</code>, chech out <a href="http://r4ds.had.co.nz/transform.html#arrange-rows-with-arrange"><em>R4DS</em>, Chapter 5.3</a>.</p>
<p>In order to avoid unnecessary facet labels for the rows, it was easier to just make each column of the plot separately. We can then use the elegant and powerful syntax from <a href="https://twitter.com/thomasp85">Thomas Lin Pedersen</a>’s <span class="citation">(<a href="#ref-R-patchwork" role="doc-biblioref">2019</a>)</span> <a href="https://patchwork.data-imaginist.com/"><strong>patchwork</strong> package</a> to combine them.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="small-worlds-and-large-worlds.html#cb54-1"></a>p1 &lt;-</span>
<span id="cb54-2"><a href="small-worlds-and-large-worlds.html#cb54-2"></a><span class="st">  </span>d <span class="op">%&gt;%</span></span>
<span id="cb54-3"><a href="small-worlds-and-large-worlds.html#cb54-3"></a><span class="st">  </span><span class="kw">filter</span>(row <span class="op">==</span><span class="st"> &quot;flat&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb54-4"><a href="small-worlds-and-large-worlds.html#cb54-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> probability, <span class="dt">y =</span> value)) <span class="op">+</span></span>
<span id="cb54-5"><a href="small-worlds-and-large-worlds.html#cb54-5"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb54-6"><a href="small-worlds-and-large-worlds.html#cb54-6"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb54-7"><a href="small-worlds-and-large-worlds.html#cb54-7"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb54-8"><a href="small-worlds-and-large-worlds.html#cb54-8"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb54-9"><a href="small-worlds-and-large-worlds.html#cb54-9"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>name, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span>
<span id="cb54-10"><a href="small-worlds-and-large-worlds.html#cb54-10"></a></span>
<span id="cb54-11"><a href="small-worlds-and-large-worlds.html#cb54-11"></a>p2 &lt;-</span>
<span id="cb54-12"><a href="small-worlds-and-large-worlds.html#cb54-12"></a><span class="st">  </span>d <span class="op">%&gt;%</span></span>
<span id="cb54-13"><a href="small-worlds-and-large-worlds.html#cb54-13"></a><span class="st">  </span><span class="kw">filter</span>(row <span class="op">==</span><span class="st"> &quot;stepped&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb54-14"><a href="small-worlds-and-large-worlds.html#cb54-14"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> probability, <span class="dt">y =</span> value)) <span class="op">+</span></span>
<span id="cb54-15"><a href="small-worlds-and-large-worlds.html#cb54-15"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb54-16"><a href="small-worlds-and-large-worlds.html#cb54-16"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb54-17"><a href="small-worlds-and-large-worlds.html#cb54-17"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb54-18"><a href="small-worlds-and-large-worlds.html#cb54-18"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb54-19"><a href="small-worlds-and-large-worlds.html#cb54-19"></a>        <span class="dt">strip.background =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb54-20"><a href="small-worlds-and-large-worlds.html#cb54-20"></a>        <span class="dt">strip.text =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb54-21"><a href="small-worlds-and-large-worlds.html#cb54-21"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>name, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span>
<span id="cb54-22"><a href="small-worlds-and-large-worlds.html#cb54-22"></a></span>
<span id="cb54-23"><a href="small-worlds-and-large-worlds.html#cb54-23"></a>p3 &lt;-</span>
<span id="cb54-24"><a href="small-worlds-and-large-worlds.html#cb54-24"></a><span class="st">  </span>d <span class="op">%&gt;%</span></span>
<span id="cb54-25"><a href="small-worlds-and-large-worlds.html#cb54-25"></a><span class="st">  </span><span class="kw">filter</span>(row <span class="op">==</span><span class="st"> &quot;Laplace&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb54-26"><a href="small-worlds-and-large-worlds.html#cb54-26"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> probability, <span class="dt">y =</span> value)) <span class="op">+</span></span>
<span id="cb54-27"><a href="small-worlds-and-large-worlds.html#cb54-27"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb54-28"><a href="small-worlds-and-large-worlds.html#cb54-28"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.5</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb54-29"><a href="small-worlds-and-large-worlds.html#cb54-29"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb54-30"><a href="small-worlds-and-large-worlds.html#cb54-30"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb54-31"><a href="small-worlds-and-large-worlds.html#cb54-31"></a>        <span class="dt">strip.background =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb54-32"><a href="small-worlds-and-large-worlds.html#cb54-32"></a>        <span class="dt">strip.text =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb54-33"><a href="small-worlds-and-large-worlds.html#cb54-33"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>name, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span>
<span id="cb54-34"><a href="small-worlds-and-large-worlds.html#cb54-34"></a></span>
<span id="cb54-35"><a href="small-worlds-and-large-worlds.html#cb54-35"></a><span class="kw">library</span>(patchwork)</span>
<span id="cb54-36"><a href="small-worlds-and-large-worlds.html#cb54-36"></a></span>
<span id="cb54-37"><a href="small-worlds-and-large-worlds.html#cb54-37"></a>p1 <span class="op">/</span><span class="st"> </span>p2 <span class="op">/</span><span class="st"> </span>p3</span></code></pre></div>
<p><img src="02_files/figure-gfm/unnamed-chunk-34-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>I’m not sure if it’s the same McElreath used in the text, but the formula I used for the triangle-shaped prior is the <a href="https://rdrr.io/cran/rmutil/man/Laplace.html">Laplace distribution</a> with a location of 0.5 and a dispersion of 0.25.</p>
<p>Also, to learn all about <code>dplyr::filter()</code>, check out Baert’s <a href="https://suzan.rbind.io/2018/02/dplyr-tutorial-3/"><em>Data wrangling part 3: Basic and more advanced ways to filter rows</em></a>.</p>
</div>
<div id="motors." class="section level3">
<h3><span class="header-section-number">2.4.2</span> Motors.</h3>
<blockquote>
<p>Various numerical techniques are needed to approximate the mathematics that follows from the definition of Bayes’ theorem. In this book, you’ll meet three different conditioning engines, numerical techniques for computing posterior distributions:</p>
<ol style="list-style-type: decimal">
<li>Grid approximation</li>
<li>Quadratic approximation</li>
<li>Markov chain Monte Carlo (MCMC)</li>
</ol>
<p>There are many other engines, and new ones are being invented all the time. But the three you’ll get to know here are common and widely useful. (p. 39)</p>
</blockquote>
<p>In this translation of McElreath’s text, we will get a little practice with grid approximation and the quadratic approximation. But since our aim is to practice with <strong>brms</strong>, we’ll jump rather quickly into MCMC. This will be awkward at times because it will force us to contend with technical issues in earlier problems in the text than McElreath originally did. I’ll do what I can to bridge the pedagogical gaps.</p>
</div>
<div id="grid-approximation." class="section level3">
<h3><span class="header-section-number">2.4.3</span> Grid approximation.</h3>
<p>Continuing on with our globe-tossing example,</p>
<blockquote>
<p>at any particular value of a parameter, <span class="math inline">\(p&#39;\)</span> , it’s a simple matter to compute the posterior probability: just multiply the prior probability of <span class="math inline">\(p&#39;\)</span> by the likelihood at <span class="math inline">\(p&#39;\)</span>. Repeating this procedure for each value in the grid generates an approximate picture of the exact posterior distribution. This procedure is called <strong>grid approximation</strong>. (pp. 39–40, <strong>emphasis</strong> in the original)</p>
</blockquote>
<p>We just employed grid approximation over the last figure. To get nice smooth lines, we computed the posterior over 1000 evenly-spaced points on the probability space. Here we’ll prepare for Figure 2.7 with 20.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="small-worlds-and-large-worlds.html#cb55-1"></a>(</span>
<span id="cb55-2"><a href="small-worlds-and-large-worlds.html#cb55-2"></a>  d &lt;-</span>
<span id="cb55-3"><a href="small-worlds-and-large-worlds.html#cb55-3"></a><span class="st">    </span><span class="kw">tibble</span>(<span class="dt">p_grid =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">20</span>),      <span class="co"># define grid</span></span>
<span id="cb55-4"><a href="small-worlds-and-large-worlds.html#cb55-4"></a>           <span class="dt">prior  =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">                                       </span><span class="co"># define prior</span></span>
<span id="cb55-5"><a href="small-worlds-and-large-worlds.html#cb55-5"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">likelihood =</span> <span class="kw">dbinom</span>(<span class="dv">6</span>, <span class="dt">size =</span> <span class="dv">9</span>, <span class="dt">prob =</span> p_grid)) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># compute likelihood at each value in grid</span></span>
<span id="cb55-6"><a href="small-worlds-and-large-worlds.html#cb55-6"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">unstd_posterior =</span> likelihood <span class="op">*</span><span class="st"> </span>prior) <span class="op">%&gt;%</span><span class="st">             </span><span class="co"># compute product of likelihood and prior</span></span>
<span id="cb55-7"><a href="small-worlds-and-large-worlds.html#cb55-7"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">posterior =</span> unstd_posterior <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(unstd_posterior))   <span class="co"># standardize the posterior, so it sums to 1</span></span>
<span id="cb55-8"><a href="small-worlds-and-large-worlds.html#cb55-8"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 20 x 5
##    p_grid prior likelihood unstd_posterior   posterior
##     &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;           &lt;dbl&gt;       &lt;dbl&gt;
##  1 0          1 0               0          0          
##  2 0.0526     1 0.00000152      0.00000152 0.000000799
##  3 0.105      1 0.0000819       0.0000819  0.0000431  
##  4 0.158      1 0.000777        0.000777   0.000409   
##  5 0.211      1 0.00360         0.00360    0.00189    
##  6 0.263      1 0.0112          0.0112     0.00587    
##  7 0.316      1 0.0267          0.0267     0.0140     
##  8 0.368      1 0.0529          0.0529     0.0279     
##  9 0.421      1 0.0908          0.0908     0.0478     
## 10 0.474      1 0.138           0.138      0.0728     
## 11 0.526      1 0.190           0.190      0.0999     
## 12 0.579      1 0.236           0.236      0.124      
## 13 0.632      1 0.267           0.267      0.140      
## 14 0.684      1 0.271           0.271      0.143      
## 15 0.737      1 0.245           0.245      0.129      
## 16 0.789      1 0.190           0.190      0.0999     
## 17 0.842      1 0.118           0.118      0.0621     
## 18 0.895      1 0.0503          0.0503     0.0265     
## 19 0.947      1 0.00885         0.00885    0.00466    
## 20 1          1 0               0          0</code></pre>
<p>Here’s the code for the right panel of Figure 2.7.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="small-worlds-and-large-worlds.html#cb57-1"></a>p1 &lt;-</span>
<span id="cb57-2"><a href="small-worlds-and-large-worlds.html#cb57-2"></a><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb57-3"><a href="small-worlds-and-large-worlds.html#cb57-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> p_grid, <span class="dt">y =</span> posterior)) <span class="op">+</span></span>
<span id="cb57-4"><a href="small-worlds-and-large-worlds.html#cb57-4"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb57-5"><a href="small-worlds-and-large-worlds.html#cb57-5"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb57-6"><a href="small-worlds-and-large-worlds.html#cb57-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;20 points&quot;</span>,</span>
<span id="cb57-7"><a href="small-worlds-and-large-worlds.html#cb57-7"></a>       <span class="dt">x =</span> <span class="st">&quot;probability of water&quot;</span>,</span>
<span id="cb57-8"><a href="small-worlds-and-large-worlds.html#cb57-8"></a>       <span class="dt">y =</span> <span class="st">&quot;posterior probability&quot;</span>) <span class="op">+</span></span>
<span id="cb57-9"><a href="small-worlds-and-large-worlds.html#cb57-9"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</span></code></pre></div>
<p>Now here’s the code for the left hand panel of Figure 2.7.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="small-worlds-and-large-worlds.html#cb58-1"></a>p2 &lt;-</span>
<span id="cb58-2"><a href="small-worlds-and-large-worlds.html#cb58-2"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">p_grid =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">5</span>),</span>
<span id="cb58-3"><a href="small-worlds-and-large-worlds.html#cb58-3"></a>         <span class="dt">prior  =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span></span>
<span id="cb58-4"><a href="small-worlds-and-large-worlds.html#cb58-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">likelihood =</span> <span class="kw">dbinom</span>(<span class="dv">6</span>, <span class="dt">size =</span> <span class="dv">9</span>, <span class="dt">prob =</span> p_grid)) <span class="op">%&gt;%</span></span>
<span id="cb58-5"><a href="small-worlds-and-large-worlds.html#cb58-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">unstd_posterior =</span> likelihood <span class="op">*</span><span class="st"> </span>prior) <span class="op">%&gt;%</span></span>
<span id="cb58-6"><a href="small-worlds-and-large-worlds.html#cb58-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">posterior =</span> unstd_posterior <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(unstd_posterior)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb58-7"><a href="small-worlds-and-large-worlds.html#cb58-7"></a><span class="st">  </span></span>
<span id="cb58-8"><a href="small-worlds-and-large-worlds.html#cb58-8"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> p_grid, <span class="dt">y =</span> posterior)) <span class="op">+</span></span>
<span id="cb58-9"><a href="small-worlds-and-large-worlds.html#cb58-9"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb58-10"><a href="small-worlds-and-large-worlds.html#cb58-10"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb58-11"><a href="small-worlds-and-large-worlds.html#cb58-11"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;5 points&quot;</span>,</span>
<span id="cb58-12"><a href="small-worlds-and-large-worlds.html#cb58-12"></a>       <span class="dt">x =</span> <span class="st">&quot;probability of water&quot;</span>,</span>
<span id="cb58-13"><a href="small-worlds-and-large-worlds.html#cb58-13"></a>       <span class="dt">y =</span> <span class="st">&quot;posterior probability&quot;</span>) <span class="op">+</span></span>
<span id="cb58-14"><a href="small-worlds-and-large-worlds.html#cb58-14"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</span></code></pre></div>
<p>Here we combine them and plot!</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="small-worlds-and-large-worlds.html#cb59-1"></a>p2 <span class="op">+</span><span class="st"> </span>p1 <span class="op">+</span><span class="st"> </span><span class="kw">plot_annotation</span>(<span class="dt">title =</span> <span class="st">&quot;More grid points make for smoother approximations&quot;</span>)</span></code></pre></div>
<p><img src="02_files/figure-gfm/unnamed-chunk-38-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>In his <strong>R</strong> code 2.5 box, McElreath encourages us to redo those plots with the two new kinds of priors.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="small-worlds-and-large-worlds.html#cb60-1"></a>prior &lt;-<span class="st"> </span><span class="kw">ifelse</span>( p_grid <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.5</span> , <span class="dv">0</span> , <span class="dv">1</span> ) </span>
<span id="cb60-2"><a href="small-worlds-and-large-worlds.html#cb60-2"></a>prior &lt;-<span class="st"> </span><span class="kw">exp</span>( <span class="dv">-5</span><span class="op">*</span><span class="kw">abs</span>( p_grid <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span> ) )</span></code></pre></div>
<p>Here’s a condensed way to make the four plots all at once.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="small-worlds-and-large-worlds.html#cb61-1"></a><span class="co"># make the data</span></span>
<span id="cb61-2"><a href="small-worlds-and-large-worlds.html#cb61-2"></a><span class="kw">tibble</span>(<span class="dt">n_points =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">20</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb61-3"><a href="small-worlds-and-large-worlds.html#cb61-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p_grid =</span> <span class="kw">map</span>(n_points, <span class="op">~</span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> .))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb61-4"><a href="small-worlds-and-large-worlds.html#cb61-4"></a><span class="st">  </span><span class="kw">unnest</span>(p_grid) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb61-5"><a href="small-worlds-and-large-worlds.html#cb61-5"></a><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(n_points, p_grid),</span>
<span id="cb61-6"><a href="small-worlds-and-large-worlds.html#cb61-6"></a>         <span class="dt">priors =</span> <span class="kw">c</span>(<span class="st">&quot;ifelse(p_grid &lt; 0.5, 0, 1)&quot;</span>, <span class="st">&quot;exp(-5 * abs(p_grid - 0.5))&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb61-7"><a href="small-worlds-and-large-worlds.html#cb61-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prior =</span> <span class="kw">ifelse</span>(priors <span class="op">==</span><span class="st"> &quot;ifelse(p_grid &lt; 0.5, 0, 1)&quot;</span>, </span>
<span id="cb61-8"><a href="small-worlds-and-large-worlds.html#cb61-8"></a>                        <span class="kw">ifelse</span>(p_grid <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb61-9"><a href="small-worlds-and-large-worlds.html#cb61-9"></a>                        <span class="kw">exp</span>(<span class="op">-</span><span class="dv">5</span> <span class="op">*</span><span class="st"> </span><span class="kw">abs</span>(p_grid <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>)))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb61-10"><a href="small-worlds-and-large-worlds.html#cb61-10"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">likelihood =</span> <span class="kw">dbinom</span>(<span class="dv">6</span>, <span class="dt">size =</span> <span class="dv">9</span>, <span class="dt">prob =</span> p_grid)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb61-11"><a href="small-worlds-and-large-worlds.html#cb61-11"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">posterior =</span> likelihood <span class="op">*</span><span class="st"> </span>prior <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(likelihood <span class="op">*</span><span class="st"> </span>prior)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb61-12"><a href="small-worlds-and-large-worlds.html#cb61-12"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n_points =</span> <span class="kw">str_c</span>(<span class="st">&quot;# points = &quot;</span>, n_points),</span>
<span id="cb61-13"><a href="small-worlds-and-large-worlds.html#cb61-13"></a>         <span class="dt">priors   =</span> <span class="kw">str_c</span>(<span class="st">&quot;prior = &quot;</span>, priors)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb61-14"><a href="small-worlds-and-large-worlds.html#cb61-14"></a><span class="st">  </span></span>
<span id="cb61-15"><a href="small-worlds-and-large-worlds.html#cb61-15"></a><span class="st">  </span><span class="co"># plot!</span></span>
<span id="cb61-16"><a href="small-worlds-and-large-worlds.html#cb61-16"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> p_grid, <span class="dt">y =</span> posterior)) <span class="op">+</span></span>
<span id="cb61-17"><a href="small-worlds-and-large-worlds.html#cb61-17"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb61-18"><a href="small-worlds-and-large-worlds.html#cb61-18"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb61-19"><a href="small-worlds-and-large-worlds.html#cb61-19"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;5 points&quot;</span>,</span>
<span id="cb61-20"><a href="small-worlds-and-large-worlds.html#cb61-20"></a>       <span class="dt">x =</span> <span class="st">&quot;probability of water&quot;</span>,</span>
<span id="cb61-21"><a href="small-worlds-and-large-worlds.html#cb61-21"></a>       <span class="dt">y =</span> <span class="st">&quot;posterior probability&quot;</span>) <span class="op">+</span></span>
<span id="cb61-22"><a href="small-worlds-and-large-worlds.html#cb61-22"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb61-23"><a href="small-worlds-and-large-worlds.html#cb61-23"></a><span class="st">  </span><span class="kw">facet_grid</span>(n_points<span class="op">~</span>priors, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="02_files/figure-gfm/unnamed-chunk-40-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="quadratic-approximation." class="section level3">
<h3><span class="header-section-number">2.4.4</span> Quadratic approximation.</h3>
<blockquote>
<p>Under quite general conditions, the region near the peak of the posterior distribution will be nearly Gaussian–or “normal”–in shape. This means the posterior distribution can be usefully approximated by a Gaussian distribution. A Gaussian distribution is convenient, because it can be completely described by only two numbers: the location of its center (mean) and its spread (variance).</p>
<p>A Gaussian approximation is called “<em>quadratic approximation</em>” because the logarithm of a Gaussian distribution forms a parabola. And a parabola is a quadratic function. So this approximation essentially represents any log-posterior with a parabola. (p. 42, <em>emphasis</em> added)</p>
</blockquote>
<p>Though McElreath will use the quadratic approximation fir the first half of the text, we won’t use it much past this chapter. Here, though, we’ll apply the quadratic approximation to the globe tossing data with the <code>rethinking::quap()</code> function.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="small-worlds-and-large-worlds.html#cb62-1"></a><span class="kw">library</span>(rethinking)</span>
<span id="cb62-2"><a href="small-worlds-and-large-worlds.html#cb62-2"></a></span>
<span id="cb62-3"><a href="small-worlds-and-large-worlds.html#cb62-3"></a>globe_qa &lt;-<span class="st"> </span><span class="kw">quap</span>(</span>
<span id="cb62-4"><a href="small-worlds-and-large-worlds.html#cb62-4"></a>  <span class="kw">alist</span>(</span>
<span id="cb62-5"><a href="small-worlds-and-large-worlds.html#cb62-5"></a>    W <span class="op">~</span><span class="st"> </span><span class="kw">dbinom</span>(W <span class="op">+</span><span class="st"> </span>L, p),  <span class="co"># binomial likelihood </span></span>
<span id="cb62-6"><a href="small-worlds-and-large-worlds.html#cb62-6"></a>    p <span class="op">~</span><span class="st"> </span><span class="kw">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)        <span class="co"># uniform prior</span></span>
<span id="cb62-7"><a href="small-worlds-and-large-worlds.html#cb62-7"></a>  ), </span>
<span id="cb62-8"><a href="small-worlds-and-large-worlds.html#cb62-8"></a>  <span class="dt">data =</span> <span class="kw">list</span>(<span class="dt">W =</span> <span class="dv">6</span>, <span class="dt">L =</span> <span class="dv">3</span>)</span>
<span id="cb62-9"><a href="small-worlds-and-large-worlds.html#cb62-9"></a>)</span>
<span id="cb62-10"><a href="small-worlds-and-large-worlds.html#cb62-10"></a></span>
<span id="cb62-11"><a href="small-worlds-and-large-worlds.html#cb62-11"></a><span class="co"># display summary of quadratic approximation </span></span>
<span id="cb62-12"><a href="small-worlds-and-large-worlds.html#cb62-12"></a><span class="kw">precis</span>(globe_qa)</span></code></pre></div>
<pre><code>##        mean        sd      5.5%     94.5%
## p 0.6666666 0.1571338 0.4155364 0.9177967</code></pre>
<p>In preparation for Figure 2.8, here’s the model with <span class="math inline">\(n = 18\)</span> and <span class="math inline">\(n = 36\)</span>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="small-worlds-and-large-worlds.html#cb64-1"></a>globe_qa_<span class="dv">18</span> &lt;-</span>
<span id="cb64-2"><a href="small-worlds-and-large-worlds.html#cb64-2"></a><span class="st">  </span><span class="kw">quap</span>(</span>
<span id="cb64-3"><a href="small-worlds-and-large-worlds.html#cb64-3"></a>    <span class="kw">alist</span>(</span>
<span id="cb64-4"><a href="small-worlds-and-large-worlds.html#cb64-4"></a>      w <span class="op">~</span><span class="st"> </span><span class="kw">dbinom</span>(<span class="dv">9</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>, p),</span>
<span id="cb64-5"><a href="small-worlds-and-large-worlds.html#cb64-5"></a>      p <span class="op">~</span><span class="st"> </span><span class="kw">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb64-6"><a href="small-worlds-and-large-worlds.html#cb64-6"></a>    ), <span class="dt">data =</span> <span class="kw">list</span>(<span class="dt">w =</span> <span class="dv">6</span> <span class="op">*</span><span class="st"> </span><span class="dv">2</span>))</span>
<span id="cb64-7"><a href="small-worlds-and-large-worlds.html#cb64-7"></a></span>
<span id="cb64-8"><a href="small-worlds-and-large-worlds.html#cb64-8"></a>globe_qa_<span class="dv">36</span> &lt;-</span>
<span id="cb64-9"><a href="small-worlds-and-large-worlds.html#cb64-9"></a><span class="st">  </span><span class="kw">quap</span>(</span>
<span id="cb64-10"><a href="small-worlds-and-large-worlds.html#cb64-10"></a>    <span class="kw">alist</span>(</span>
<span id="cb64-11"><a href="small-worlds-and-large-worlds.html#cb64-11"></a>      w <span class="op">~</span><span class="st"> </span><span class="kw">dbinom</span>(<span class="dv">9</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>, p),</span>
<span id="cb64-12"><a href="small-worlds-and-large-worlds.html#cb64-12"></a>      p <span class="op">~</span><span class="st"> </span><span class="kw">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb64-13"><a href="small-worlds-and-large-worlds.html#cb64-13"></a>    ), <span class="dt">data =</span> <span class="kw">list</span>(<span class="dt">w =</span> <span class="dv">6</span> <span class="op">*</span><span class="st"> </span><span class="dv">4</span>))</span>
<span id="cb64-14"><a href="small-worlds-and-large-worlds.html#cb64-14"></a></span>
<span id="cb64-15"><a href="small-worlds-and-large-worlds.html#cb64-15"></a><span class="kw">precis</span>(globe_qa_<span class="dv">18</span>)</span></code></pre></div>
<pre><code>##        mean        sd      5.5%     94.5%
## p 0.6666663 0.1111104 0.4890903 0.8442422</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="small-worlds-and-large-worlds.html#cb66-1"></a><span class="kw">precis</span>(globe_qa_<span class="dv">36</span>)</span></code></pre></div>
<pre><code>##       mean         sd      5.5%    94.5%
## p 0.666667 0.07856686 0.5411019 0.792232</code></pre>
<p>Now make Figure 2.8.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="small-worlds-and-large-worlds.html#cb68-1"></a>n_grid &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb68-2"><a href="small-worlds-and-large-worlds.html#cb68-2"></a></span>
<span id="cb68-3"><a href="small-worlds-and-large-worlds.html#cb68-3"></a><span class="co"># wrangle</span></span>
<span id="cb68-4"><a href="small-worlds-and-large-worlds.html#cb68-4"></a><span class="kw">tibble</span>(<span class="dt">w =</span> <span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">12</span>, <span class="dv">24</span>),</span>
<span id="cb68-5"><a href="small-worlds-and-large-worlds.html#cb68-5"></a>       <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">18</span>, <span class="dv">36</span>),</span>
<span id="cb68-6"><a href="small-worlds-and-large-worlds.html#cb68-6"></a>       <span class="dt">s =</span> <span class="kw">c</span>(.<span class="dv">16</span>, <span class="fl">.11</span>, <span class="fl">.08</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb68-7"><a href="small-worlds-and-large-worlds.html#cb68-7"></a><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(w, n, s),</span>
<span id="cb68-8"><a href="small-worlds-and-large-worlds.html#cb68-8"></a>         <span class="dt">p_grid =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> n_grid)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb68-9"><a href="small-worlds-and-large-worlds.html#cb68-9"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prior =</span> <span class="dv">1</span>,</span>
<span id="cb68-10"><a href="small-worlds-and-large-worlds.html#cb68-10"></a>         <span class="dt">m     =</span> <span class="fl">.67</span>)  <span class="op">%&gt;%</span></span>
<span id="cb68-11"><a href="small-worlds-and-large-worlds.html#cb68-11"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">likelihood =</span> <span class="kw">dbinom</span>(w, <span class="dt">size =</span> n, <span class="dt">prob =</span> p_grid)) <span class="op">%&gt;%</span></span>
<span id="cb68-12"><a href="small-worlds-and-large-worlds.html#cb68-12"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">unstd_grid_posterior =</span> likelihood <span class="op">*</span><span class="st"> </span>prior,</span>
<span id="cb68-13"><a href="small-worlds-and-large-worlds.html#cb68-13"></a>         <span class="dt">unstd_quad_posterior =</span> <span class="kw">dnorm</span>(p_grid, m, s)) <span class="op">%&gt;%</span></span>
<span id="cb68-14"><a href="small-worlds-and-large-worlds.html#cb68-14"></a><span class="st">  </span><span class="kw">group_by</span>(w) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb68-15"><a href="small-worlds-and-large-worlds.html#cb68-15"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">grid_posterior =</span> unstd_grid_posterior <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(unstd_grid_posterior),</span>
<span id="cb68-16"><a href="small-worlds-and-large-worlds.html#cb68-16"></a>         <span class="dt">quad_posterior =</span> unstd_quad_posterior <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(unstd_quad_posterior),</span>
<span id="cb68-17"><a href="small-worlds-and-large-worlds.html#cb68-17"></a>         <span class="dt">n              =</span> <span class="kw">str_c</span>(<span class="st">&quot;n = &quot;</span>, n)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb68-18"><a href="small-worlds-and-large-worlds.html#cb68-18"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n =</span> <span class="kw">factor</span>(n, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;n = 9&quot;</span>, <span class="st">&quot;n = 18&quot;</span>, <span class="st">&quot;n = 36&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb68-19"><a href="small-worlds-and-large-worlds.html#cb68-19"></a><span class="st">  </span></span>
<span id="cb68-20"><a href="small-worlds-and-large-worlds.html#cb68-20"></a><span class="st">  </span><span class="co"># plot</span></span>
<span id="cb68-21"><a href="small-worlds-and-large-worlds.html#cb68-21"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> p_grid)) <span class="op">+</span></span>
<span id="cb68-22"><a href="small-worlds-and-large-worlds.html#cb68-22"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> grid_posterior)) <span class="op">+</span></span>
<span id="cb68-23"><a href="small-worlds-and-large-worlds.html#cb68-23"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> quad_posterior),</span>
<span id="cb68-24"><a href="small-worlds-and-large-worlds.html#cb68-24"></a>            <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></span>
<span id="cb68-25"><a href="small-worlds-and-large-worlds.html#cb68-25"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;proportion water&quot;</span>,</span>
<span id="cb68-26"><a href="small-worlds-and-large-worlds.html#cb68-26"></a>       <span class="dt">y =</span> <span class="st">&quot;density&quot;</span>) <span class="op">+</span></span>
<span id="cb68-27"><a href="small-worlds-and-large-worlds.html#cb68-27"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb68-28"><a href="small-worlds-and-large-worlds.html#cb68-28"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>n, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="02_files/figure-gfm/unnamed-chunk-43-1.png" width="768" style="display: block; margin: auto;" /></p>
<blockquote>
<p>This phenomenon, where the quadratic approximation improves with the amount of data, is very common. It’s one of the reasons that so many classical statistical procedures are nervous about small samples: Those procedures use quadratic (or other) approximations that are only known to be safe with infinite data. Often, these approximations are useful with less than infinite data, obviously. But the rate of improvement as sample size increases varies greatly depending upon the details. In some models, the quadratic approximation can remain terrible even with thousands of samples. (p. 44)</p>
</blockquote>
<div id="rethinking-maximum-likelihood-estimation." class="section level4">
<h4><span class="header-section-number">2.4.4.1</span> Rethinking: Maximum likelihood estimation.</h4>
<blockquote>
<p>The quadratic approximation, either with a uniform prior or with a lot of data, is often equivalent to a <strong>maximum likelihood estimate</strong> (MLE) and its <strong>standard error</strong>. The MLE is a very common non-Bayesian parameter estimate. This correspon- dence between a Bayesian approximation and a common non-Bayesian estimator is both a blessing and a curse. It is a blessing, because it allows us to re-interpret a wide range of published non-Bayesian model fits in Bayesian terms. It is a curse, because maximum likelihood estimates have some curious drawbacks, and the quadratic approximation can share them. (p. 44, <strong>emphasis</strong>, in the original)</p>
</blockquote>
<p>Textbooks highlighting the maximum likelihood method for the generalized linear model abound. If this is new to you and you’d like to learn more, perhaps check out Linger and Roback’s <span class="citation">(<a href="#ref-leglerBroadeningYourStatistical2019" role="doc-biblioref">2019</a>)</span> <a href="https://bookdown.org/roback/bookdown-bysh/"><em>Broadening your statistical horizons: Generalized linear models and multilevel models</em></a>, Agresti’s <span class="citation">(<a href="#ref-agrestiFoundationsLinearGeneralized2015" role="doc-biblioref">2015</a>)</span> <a href="https://www.wiley.com/en-us/Foundations+of+Linear+and+Generalized+Linear+Models-p-9781118730034"><em>Foundations of linear and generalized linear models</em></a> or Dunn and Smyth’s <span class="citation">(<a href="#ref-dunn2018generalized" role="doc-biblioref">2018</a>)</span> <a href="https://link.springer.com/book/10.1007/978-1-4419-0118-7"><em>Generalized linear models with examples in R</em></a>.</p>
</div>
</div>
<div id="markov-chain-monte-carlo." class="section level3">
<h3><span class="header-section-number">2.4.5</span> Markov chain Monte Carlo.</h3>
<blockquote>
<p>The most popular [alternative to grid approximation and the quadratic approximation] is <strong>Markov chain Monte Carlo</strong> (MCMC), which is a family of conditioning engines capable of handling highly complex models. It is fair to say that MCMC is largely responsible for the insurgence of Bayesian data analysis that began in the 1990s. While MCMC is older than the 1990s, affordable computer power is not, so we must also thank the en- gineers. <del>Much later in the book (Chapter 9)</del>, you’ll meet simple and precise examples of MCMC model fitting, aimed at helping you understand the technique. (p. 45, <strong>emphasis</strong> in the original)</p>
</blockquote>
<p>The <strong>brms</strong> package uses a version of MCMC to fit Bayesian models. Since one of the main goals of this project is to highlight <strong>brms</strong>, we may as fit a model. This seems like an appropriately named subsection to do so. First we’ll have to load the package.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="small-worlds-and-large-worlds.html#cb69-1"></a><span class="kw">library</span>(brms)</span></code></pre></div>
<p>If you haven’t already installed <strong>brms</strong>, you can find instructions on how to do so <a href="https://github.com/paul-buerkner/brms#how-do-i-install-brms">here</a>.</p>
<p>Here we re-fit the last model from above, the one for which <span class="math inline">\(w = 24\)</span> and <span class="math inline">\(n = 36\)</span>.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="small-worlds-and-large-worlds.html#cb70-1"></a>b2<span class="fl">.1</span> &lt;-</span>
<span id="cb70-2"><a href="small-worlds-and-large-worlds.html#cb70-2"></a><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> <span class="kw">list</span>(<span class="dt">w =</span> <span class="dv">24</span>), </span>
<span id="cb70-3"><a href="small-worlds-and-large-worlds.html#cb70-3"></a>      <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;identity&quot;</span>),</span>
<span id="cb70-4"><a href="small-worlds-and-large-worlds.html#cb70-4"></a>      w <span class="op">|</span><span class="st"> </span><span class="kw">trials</span>(<span class="dv">36</span>) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb70-5"><a href="small-worlds-and-large-worlds.html#cb70-5"></a>      <span class="kw">prior</span>(<span class="kw">beta</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">class =</span> Intercept),</span>
<span id="cb70-6"><a href="small-worlds-and-large-worlds.html#cb70-6"></a>      <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb70-7"><a href="small-worlds-and-large-worlds.html#cb70-7"></a>      <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">.95</span>),</span>
<span id="cb70-8"><a href="small-worlds-and-large-worlds.html#cb70-8"></a>      <span class="dt">seed =</span> <span class="dv">2</span>,</span>
<span id="cb70-9"><a href="small-worlds-and-large-worlds.html#cb70-9"></a>      <span class="dt">file =</span> <span class="st">&quot;fits/b02.01&quot;</span>)</span></code></pre></div>
<p>The model output from <strong>brms</strong> looks like so.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="small-worlds-and-large-worlds.html#cb71-1"></a><span class="kw">print</span>(b2<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = identity 
## Formula: w | trials(36) ~ 1 
##    Data: list(w = 24) (Number of observations: 1) 
## Samples: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
##          total post-warmup samples = 12000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     0.66      0.07     0.50     0.79 1.00     3965     4326
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>There’s a lot going on in that output, which we’ll start to clarify in Chapter 4. For now, focus on the ‘Intercept’ line. As we’ll also learn in Chapter 4, the intercept of a regression model with no predictors is the same as its mean. In the special case of a model using the binomial likelihood, the mean is the probability of a 1 in a given trial, <span class="math inline">\(\theta\)</span>.</p>
<p>Also, with <strong>brms</strong>, there are many ways to summarize the results of a model. The <code>brms::posterior_summary()</code> function is an analogue to <code>rethinking::precis()</code>. We will, however, need to use <code>round()</code> to reduce the output to a reasonable number of decimal places.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="small-worlds-and-large-worlds.html#cb73-1"></a><span class="kw">posterior_summary</span>(b2<span class="fl">.1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb73-2"><a href="small-worlds-and-large-worlds.html#cb73-2"></a><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##             Estimate Est.Error  Q2.5 Q97.5
## b_Intercept     0.66      0.07  0.50  0.79
## lp__           -2.43      0.66 -4.32 -1.97</code></pre>
<p>The <code>b_Intercept</code> row is the probability. Don’t worry about the second line, for now. We’ll cover the details of <strong>brms</strong> model fitting in later chapters. To finish up, why not plot the results of our model and compare them with those from <code>rethinking::quap()</code>, above?</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="small-worlds-and-large-worlds.html#cb75-1"></a><span class="kw">posterior_samples</span>(b2<span class="fl">.1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb75-2"><a href="small-worlds-and-large-worlds.html#cb75-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n =</span> <span class="st">&quot;n = 36&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb75-3"><a href="small-worlds-and-large-worlds.html#cb75-3"></a><span class="st">  </span></span>
<span id="cb75-4"><a href="small-worlds-and-large-worlds.html#cb75-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> b_Intercept)) <span class="op">+</span></span>
<span id="cb75-5"><a href="small-worlds-and-large-worlds.html#cb75-5"></a><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb75-6"><a href="small-worlds-and-large-worlds.html#cb75-6"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;proportion water&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb75-7"><a href="small-worlds-and-large-worlds.html#cb75-7"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></span>
<span id="cb75-8"><a href="small-worlds-and-large-worlds.html#cb75-8"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>n)</span></code></pre></div>
<p><img src="02_files/figure-gfm/unnamed-chunk-47-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>If you’re still confused. Cool. This is just a preview. We’ll start walking through fitting models with <strong>brms</strong> in <a href="geocentric-models.html#geocentric-models">Chapter 4</a> and we’ll learn a lot about regression with the binomial likelihood in Chapter 11.</p>
</div>
</div>
<div id="session-info-1" class="section level2 unnumbered">
<h2>Session info</h2>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="small-worlds-and-large-worlds.html#cb76-1"></a><span class="kw">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 3.6.3 (2020-02-29)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS Catalina 10.15.3
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] parallel  stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] brms_2.13.5          Rcpp_1.0.5           rethinking_2.01      dagitty_0.2-2       
##  [5] rstan_2.19.3         StanHeaders_2.21.0-1 patchwork_1.0.1.9000 forcats_0.5.0       
##  [9] stringr_1.4.0        dplyr_1.0.1          purrr_0.3.4          readr_1.3.1         
## [13] tidyr_1.1.1          tibble_3.0.3         ggplot2_3.3.2        tidyverse_1.3.0     
## 
## loaded via a namespace (and not attached):
##   [1] TH.data_1.0-10       colorspace_1.4-1     ellipsis_0.3.1       ggridges_0.5.2      
##   [5] rsconnect_0.8.16     estimability_1.3     markdown_1.1         base64enc_0.1-3     
##   [9] fs_1.4.1             rstudioapi_0.11      farver_2.0.3         DT_0.13             
##  [13] fansi_0.4.1          mvtnorm_1.1-0        lubridate_1.7.8      xml2_1.3.1          
##  [17] codetools_0.2-16     splines_3.6.3        bridgesampling_1.0-0 knitr_1.28          
##  [21] shinythemes_1.1.2    bayesplot_1.7.1      jsonlite_1.7.0       broom_0.5.5         
##  [25] dbplyr_1.4.2         shiny_1.5.0          compiler_3.6.3       httr_1.4.1          
##  [29] emmeans_1.4.5        backports_1.1.9      assertthat_0.2.1     Matrix_1.2-18       
##  [33] fastmap_1.0.1        cli_2.0.2            later_1.1.0.1        htmltools_0.5.0     
##  [37] prettyunits_1.1.1    tools_3.6.3          igraph_1.2.5         coda_0.19-3         
##  [41] gtable_0.3.0         glue_1.4.2           reshape2_1.4.4       V8_3.0.2            
##  [45] cellranger_1.1.0     vctrs_0.3.4          nlme_3.1-144         crosstalk_1.1.0.1   
##  [49] xfun_0.13            ps_1.3.4             rvest_0.3.5          miniUI_0.1.1.1      
##  [53] mime_0.9             lifecycle_0.2.0      gtools_3.8.2         MASS_7.3-51.5       
##  [57] zoo_1.8-7            scales_1.1.1         colourpicker_1.0     hms_0.5.3           
##  [61] promises_1.1.1       Brobdingnag_1.2-6    sandwich_2.5-1       inline_0.3.15       
##  [65] shinystan_2.5.0      yaml_2.2.1           curl_4.3             gridExtra_2.3       
##  [69] loo_2.3.1            stringi_1.4.6        highr_0.8            dygraphs_1.1.1.6    
##  [73] boot_1.3-24          pkgbuild_1.1.0       shape_1.4.4          rlang_0.4.7         
##  [77] pkgconfig_2.0.3      matrixStats_0.56.0   evaluate_0.14        lattice_0.20-38     
##  [81] rstantools_2.1.1     htmlwidgets_1.5.1    labeling_0.3         processx_3.4.4      
##  [85] tidyselect_1.1.0     plyr_1.8.6           magrittr_1.5         bookdown_0.18       
##  [89] R6_2.4.1             generics_0.0.2       multcomp_1.4-13      DBI_1.1.0           
##  [93] pillar_1.4.6         haven_2.2.0          withr_2.2.0          xts_0.12-0          
##  [97] survival_3.1-12      abind_1.4-5          modelr_0.1.6         crayon_1.3.4        
## [101] utf8_1.1.4           rmarkdown_2.1        grid_3.6.3           readxl_1.3.1        
## [105] callr_3.4.4          threejs_0.3.3        reprex_0.3.0         digest_0.6.25       
## [109] xtable_1.8-4         httpuv_1.5.4         stats4_3.6.3         munsell_0.5.0       
## [113] shinyjs_1.1</code></pre>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-agrestiFoundationsLinearGeneralized2015">
<p>Agresti, A. (2015). <em>Foundations of linear and generalized linear models</em>. John Wiley &amp; Sons. <a href="https://www.wiley.com/en-us/Foundations+of+Linear+and+Generalized+Linear+Models-p-9781118730034">https://www.wiley.com/en-us/Foundations+of+Linear+and+Generalized+Linear+Models-p-9781118730034</a></p>
</div>
<div id="ref-borgesjlJardinSenderosQue1941">
<p>Borges, JL. (1941). El jardin de senderos que se bifurcan. Buenos Aires: Sur. Translated by D. A. Yates (1964). In <em>Labyrinths: Selected Stories &amp; Other Writings</em> (pp. 19–29). New Directions.</p>
</div>
<div id="ref-dunn2018generalized">
<p>Dunn, P. K., &amp; Smyth, G. K. (2018). <em>Generalized linear models with examples in R</em>. Springer. <a href="https://link.springer.com/book/10.1007/978-1-4419-0118-7">https://link.springer.com/book/10.1007/978-1-4419-0118-7</a></p>
</div>
<div id="ref-gelmanGardenForkingPaths2013">
<p>Gelman, A., &amp; Loken, E. (2013). <em>The garden of forking paths: Why multiple comparisons can be a problem, even when there is no “fishing expedition” or “p-hacking” and the research hypothesis was posited ahead of time</em>. 17. <a href="https://stat.columbia.edu/~gelman/research/unpublished/p_hacking.pdf">https://stat.columbia.edu/~gelman/research/unpublished/p_hacking.pdf</a></p>
</div>
<div id="ref-grolemundDataScience2017">
<p>Grolemund, G., &amp; Wickham, H. (2017). <em>R for data science</em>. O’Reilly. <a href="https://r4ds.had.co.nz">https://r4ds.had.co.nz</a></p>
</div>
<div id="ref-leglerBroadeningYourStatistical2019">
<p>Legler, J., &amp; Roback, P. (2019). <em>Broadening your statistical horizons: Generalized linear models and multilevel models</em>. <a href="https://bookdown.org/roback/bookdown-bysh/">https://bookdown.org/roback/bookdown-bysh/</a></p>
</div>
<div id="ref-mcelreathStatisticalRethinkingBayesian2020">
<p>McElreath, R. (2020b). <em>Statistical rethinking: A Bayesian course with examples in R and Stan</em> (Second edition). CRC Press. <a href="https://xcelab.net/rm/statistical-rethinking/">https://xcelab.net/rm/statistical-rethinking/</a></p>
</div>
<div id="ref-R-tibble">
<p>Müller, K., &amp; Wickham, H. (2020). <em>tibble: Simple data frames</em>. <a href="https://CRAN.R-project.org/package=tibble">https://CRAN.R-project.org/package=tibble</a></p>
</div>
<div id="ref-R-patchwork">
<p>Pedersen, T. L. (2019). <em>patchwork: The composer of plots</em>. <a href="https://CRAN.R-project.org/package=patchwork">https://CRAN.R-project.org/package=patchwork</a></p>
</div>
<div id="ref-pengProgrammingDataScience2019">
<p>Peng, R. D. (2019). <em>R programming for data science</em>. <a href="https://bookdown.org/rdpeng/rprogdatascience/">https://bookdown.org/rdpeng/rprogdatascience/</a></p>
</div>
<div id="ref-PivotDataWide2020">
<p><em>Pivot data from wide to long pivot_longer</em>. (2020). <a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">https://tidyr.tidyverse.org/reference/pivot_longer.html</a></p>
</div>
<div id="ref-Pivoting2020">
<p><em>Pivoting</em>. (2020). <a href="https://tidyr.tidyverse.org/articles/pivot.html">https://tidyr.tidyverse.org/articles/pivot.html</a></p>
</div>
<div id="ref-wickhamGgplot2ElegantGraphics2016">
<p>Wickham, H. (2016). <em>ggplot2: Elegant graphics for data analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a></p>
</div>
<div id="ref-R-ggplot2">
<p>Wickham, H., Chang, W., Henry, L., Pedersen, T. L., Takahashi, K., Wilke, C., Woo, K., Yutani, H., &amp; Dunnington, D. (2020). <em>ggplot2: Create elegant data visualisations using the grammar of graphics</em>. <a href="https://CRAN.R-project.org/package=ggplot2">https://CRAN.R-project.org/package=ggplot2</a></p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="the-golem-of-prague.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sampling-the-imaginary.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
