<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>15 Missing Data and Other Opportunities | Statistical rethinking with brms, ggplot2, and the tidyverse: Second edition</title>
  <meta name="description" content="This book is an attempt to re-express the code in the second edition of McElreath’s textbook, ‘Statistical rethinking.’ His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="15 Missing Data and Other Opportunities | Statistical rethinking with brms, ggplot2, and the tidyverse: Second edition" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This book is an attempt to re-express the code in the second edition of McElreath’s textbook, ‘Statistical rethinking.’ His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="github-repo" content="ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="15 Missing Data and Other Opportunities | Statistical rethinking with brms, ggplot2, and the tidyverse: Second edition" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This book is an attempt to re-express the code in the second edition of McElreath’s textbook, ‘Statistical rethinking.’ His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2022-09-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="adventures-in-covariance.html"/>
<link rel="next" href="generalized-linear-madness.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />
<link href="libs/tabwid-1.1.0/tabwid.css" rel="stylesheet" />
<link href="libs/tabwid-1.1.0/scrool.css" rel="stylesheet" />
<script src="libs/twitter-widget-0.0.1/widgets.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#my-assumptions-about-you"><i class="fa fa-check"></i>My assumptions about you</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-and-understand-this-project"><i class="fa fa-check"></i>How to use and understand this project</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-setup"><i class="fa fa-check"></i><strong>R</strong> setup</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#we-have-updates"><i class="fa fa-check"></i>We have updates</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.1.0."><i class="fa fa-check"></i>Version 0.1.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.1.1."><i class="fa fa-check"></i>Version 0.1.1.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.2.0."><i class="fa fa-check"></i>Version 0.2.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.3.0."><i class="fa fa-check"></i>Version 0.3.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#were-not-done-yet-and-i-could-use-your-help."><i class="fa fa-check"></i>We’re not done yet and I could use your help.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#thank-yous-are-in-order"><i class="fa fa-check"></i>Thank-you’s are in order</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license-and-citation"><i class="fa fa-check"></i>License and citation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#you-can-do-this-too"><i class="fa fa-check"></i>You can do this, too</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="the-golem-of-prague.html"><a href="the-golem-of-prague.html"><i class="fa fa-check"></i><b>1</b> The Golem of Prague</a>
<ul>
<li class="chapter" data-level="" data-path="the-golem-of-prague.html"><a href="the-golem-of-prague.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html"><i class="fa fa-check"></i><b>2</b> Small Worlds and Large Worlds</a>
<ul>
<li class="chapter" data-level="2.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#the-garden-of-forking-data"><i class="fa fa-check"></i><b>2.1</b> The garden of forking data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#counting-possibilities."><i class="fa fa-check"></i><b>2.1.1</b> Counting possibilities.</a></li>
<li class="chapter" data-level="2.1.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#combining-other-information."><i class="fa fa-check"></i><b>2.1.2</b> Combining other information.</a></li>
<li class="chapter" data-level="2.1.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#from-counts-to-probability."><i class="fa fa-check"></i><b>2.1.3</b> From counts to probability.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#building-a-model"><i class="fa fa-check"></i><b>2.2</b> Building a model</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#a-data-story."><i class="fa fa-check"></i><b>2.2.1</b> A data story.</a></li>
<li class="chapter" data-level="2.2.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#bayesian-updating."><i class="fa fa-check"></i><b>2.2.2</b> Bayesian updating.</a></li>
<li class="chapter" data-level="2.2.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#evaluate."><i class="fa fa-check"></i><b>2.2.3</b> Evaluate.</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#components-of-the-model"><i class="fa fa-check"></i><b>2.3</b> Components of the model</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#variables."><i class="fa fa-check"></i><b>2.3.1</b> Variables.</a></li>
<li class="chapter" data-level="2.3.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#definitions."><i class="fa fa-check"></i><b>2.3.2</b> Definitions.</a></li>
<li class="chapter" data-level="2.3.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#a-model-is-born."><i class="fa fa-check"></i><b>2.3.3</b> A model is born.</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#making-the-model-go"><i class="fa fa-check"></i><b>2.4</b> Making the model go</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#bayes-theorem."><i class="fa fa-check"></i><b>2.4.1</b> Bayes’ theorem.</a></li>
<li class="chapter" data-level="2.4.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#motors."><i class="fa fa-check"></i><b>2.4.2</b> Motors.</a></li>
<li class="chapter" data-level="2.4.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#grid-approximation."><i class="fa fa-check"></i><b>2.4.3</b> Grid approximation.</a></li>
<li class="chapter" data-level="2.4.4" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#quadratic-approximation."><i class="fa fa-check"></i><b>2.4.4</b> Quadratic approximation.</a></li>
<li class="chapter" data-level="2.4.5" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#markov-chain-monte-carlo."><i class="fa fa-check"></i><b>2.4.5</b> Markov chain Monte Carlo.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html"><i class="fa fa-check"></i><b>3</b> Sampling the Imaginary</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-from-a-grid-approximate-posterior"><i class="fa fa-check"></i><b>3.1</b> Sampling from a grid-approximate posterior</a></li>
<li class="chapter" data-level="3.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-to-summarize"><i class="fa fa-check"></i><b>3.2</b> Sampling to summarize</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#intervals-of-defined-boundaries."><i class="fa fa-check"></i><b>3.2.1</b> Intervals of defined boundaries.</a></li>
<li class="chapter" data-level="3.2.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#intervals-of-defined-mass."><i class="fa fa-check"></i><b>3.2.2</b> Intervals of defined mass.</a></li>
<li class="chapter" data-level="3.2.3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#point-estimates."><i class="fa fa-check"></i><b>3.2.3</b> Point estimates.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-to-simulate-prediction"><i class="fa fa-check"></i><b>3.3</b> Sampling to simulate prediction</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#dummy-data."><i class="fa fa-check"></i><b>3.3.1</b> Dummy data.</a></li>
<li class="chapter" data-level="3.3.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#model-checking."><i class="fa fa-check"></i><b>3.3.2</b> Model checking.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#summary-lets-practice-with-brms"><i class="fa fa-check"></i><b>3.4</b> <del>Summary</del> Let’s practice with <strong>brms</strong></a></li>
<li class="chapter" data-level="" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="geocentric-models.html"><a href="geocentric-models.html"><i class="fa fa-check"></i><b>4</b> Geocentric Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="geocentric-models.html"><a href="geocentric-models.html#why-normal-distributions-are-normal"><i class="fa fa-check"></i><b>4.1</b> Why normal distributions are normal</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="geocentric-models.html"><a href="geocentric-models.html#normal-by-addition."><i class="fa fa-check"></i><b>4.1.1</b> Normal by addition.</a></li>
<li class="chapter" data-level="4.1.2" data-path="geocentric-models.html"><a href="geocentric-models.html#normal-by-multiplication."><i class="fa fa-check"></i><b>4.1.2</b> Normal by multiplication.</a></li>
<li class="chapter" data-level="4.1.3" data-path="geocentric-models.html"><a href="geocentric-models.html#normal-by-log-multiplication."><i class="fa fa-check"></i><b>4.1.3</b> Normal by log-multiplication.</a></li>
<li class="chapter" data-level="4.1.4" data-path="geocentric-models.html"><a href="geocentric-models.html#using-gaussian-distributions."><i class="fa fa-check"></i><b>4.1.4</b> Using Gaussian distributions.</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="geocentric-models.html"><a href="geocentric-models.html#a-language-for-describing-models"><i class="fa fa-check"></i><b>4.2</b> A language for describing models</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="geocentric-models.html"><a href="geocentric-models.html#re-describing-the-globe-tossing-model."><i class="fa fa-check"></i><b>4.2.1</b> Re-describing the globe tossing model.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="geocentric-models.html"><a href="geocentric-models.html#a-gaussian-model-of-height"><i class="fa fa-check"></i><b>4.3</b> A Gaussian model of height</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="geocentric-models.html"><a href="geocentric-models.html#the-data."><i class="fa fa-check"></i><b>4.3.1</b> The data.</a></li>
<li class="chapter" data-level="4.3.2" data-path="geocentric-models.html"><a href="geocentric-models.html#the-model."><i class="fa fa-check"></i><b>4.3.2</b> The model.</a></li>
<li class="chapter" data-level="4.3.3" data-path="geocentric-models.html"><a href="geocentric-models.html#grid-approximation-of-the-posterior-distribution."><i class="fa fa-check"></i><b>4.3.3</b> Grid approximation of the posterior distribution.</a></li>
<li class="chapter" data-level="4.3.4" data-path="geocentric-models.html"><a href="geocentric-models.html#sampling-from-the-posterior."><i class="fa fa-check"></i><b>4.3.4</b> Sampling from the posterior.</a></li>
<li class="chapter" data-level="4.3.5" data-path="geocentric-models.html"><a href="geocentric-models.html#finding-the-posterior-distribution-with-quap-brm."><i class="fa fa-check"></i><b>4.3.5</b> Finding the posterior distribution with <del><code>quap</code></del> <code>brm()</code>.</a></li>
<li class="chapter" data-level="4.3.6" data-path="geocentric-models.html"><a href="geocentric-models.html#sampling-from-a-quap-brm-fit."><i class="fa fa-check"></i><b>4.3.6</b> Sampling from a <del><code>quap()</code></del> <code>brm()</code> fit.</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="geocentric-models.html"><a href="geocentric-models.html#linear-prediction"><i class="fa fa-check"></i><b>4.4</b> Linear prediction</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="geocentric-models.html"><a href="geocentric-models.html#the-linear-model-strategy."><i class="fa fa-check"></i><b>4.4.1</b> The linear model strategy.</a></li>
<li class="chapter" data-level="4.4.2" data-path="geocentric-models.html"><a href="geocentric-models.html#finding-the-posterior-distribution."><i class="fa fa-check"></i><b>4.4.2</b> Finding the posterior distribution.</a></li>
<li class="chapter" data-level="4.4.3" data-path="geocentric-models.html"><a href="geocentric-models.html#interpreting-the-posterior-distribution."><i class="fa fa-check"></i><b>4.4.3</b> Interpreting the posterior distribution.</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="geocentric-models.html"><a href="geocentric-models.html#curves-from-lines"><i class="fa fa-check"></i><b>4.5</b> Curves from lines</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="geocentric-models.html"><a href="geocentric-models.html#polynomial-regression."><i class="fa fa-check"></i><b>4.5.1</b> Polynomial regression.</a></li>
<li class="chapter" data-level="4.5.2" data-path="geocentric-models.html"><a href="geocentric-models.html#splines."><i class="fa fa-check"></i><b>4.5.2</b> Splines.</a></li>
<li class="chapter" data-level="4.5.3" data-path="geocentric-models.html"><a href="geocentric-models.html#smooth-functions-for-a-rough-world."><i class="fa fa-check"></i><b>4.5.3</b> Smooth functions for a rough world.</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="geocentric-models.html"><a href="geocentric-models.html#summary-first-bonus-smooth-functions-with-brmss"><i class="fa fa-check"></i><b>4.6</b> <del>Summary</del> First bonus: Smooth functions with <code>brms::s()</code></a></li>
<li class="chapter" data-level="4.7" data-path="geocentric-models.html"><a href="geocentric-models.html#second-bonus-group-predictors-with-matrix-columns"><i class="fa fa-check"></i><b>4.7</b> Second bonus: Group predictors with matrix columns</a></li>
<li class="chapter" data-level="" data-path="geocentric-models.html"><a href="geocentric-models.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html"><i class="fa fa-check"></i><b>5</b> The Many Variables &amp; The Spurious Waffles</a>
<ul>
<li class="chapter" data-level="5.1" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#spurious-associations"><i class="fa fa-check"></i><b>5.1</b> Spurious associations</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#think-before-you-regress."><i class="fa fa-check"></i><b>5.1.1</b> Think before you regress.</a></li>
<li class="chapter" data-level="5.1.2" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#testable-implications."><i class="fa fa-check"></i><b>5.1.2</b> Testable implications.</a></li>
<li class="chapter" data-level="5.1.3" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#multiple-regression-notation."><i class="fa fa-check"></i><b>5.1.3</b> Multiple regression notation.</a></li>
<li class="chapter" data-level="5.1.4" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#approximating-the-posterior."><i class="fa fa-check"></i><b>5.1.4</b> Approximating the posterior.</a></li>
<li class="chapter" data-level="5.1.5" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#plotting-multivariate-posteriors."><i class="fa fa-check"></i><b>5.1.5</b> Plotting multivariate posteriors.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#masked-relationship"><i class="fa fa-check"></i><b>5.2</b> Masked relationship</a></li>
<li class="chapter" data-level="5.3" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#categorical-variables"><i class="fa fa-check"></i><b>5.3</b> Categorical variables</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#binary-categories."><i class="fa fa-check"></i><b>5.3.1</b> Binary categories.</a></li>
<li class="chapter" data-level="5.3.2" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#many-categories."><i class="fa fa-check"></i><b>5.3.2</b> Many categories.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#summary-bonus-we-can-model-categorical-variables-in-more-ways-than-one"><i class="fa fa-check"></i><b>5.4</b> <del>Summary</del> Bonus: We can model categorical variables in more ways than one</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#you-can-use-a-dummy."><i class="fa fa-check"></i><b>5.4.1</b> You can use a dummy.</a></li>
<li class="chapter" data-level="5.4.2" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#consider-contrast-coding."><i class="fa fa-check"></i><b>5.4.2</b> Consider contrast coding.</a></li>
<li class="chapter" data-level="5.4.3" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#theres-always-the-multilevel-anova-approach."><i class="fa fa-check"></i><b>5.4.3</b> There’s always the multilevel ANOVA approach.</a></li>
<li class="chapter" data-level="5.4.4" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#would-you-like-to-learn-more"><i class="fa fa-check"></i><b>5.4.4</b> Would you like to learn more?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html"><i class="fa fa-check"></i><b>6</b> The Haunted DAG &amp; The Causal Terror</a>
<ul>
<li class="chapter" data-level="6.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#multicollinearity"><i class="fa fa-check"></i><b>6.1</b> Multicollinearity</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#multicollinear-legs."><i class="fa fa-check"></i><b>6.1.1</b> Multicollinear legs.</a></li>
<li class="chapter" data-level="6.1.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#multicollinear-milk."><i class="fa fa-check"></i><b>6.1.2</b> Multicollinear <code>milk</code>.</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#post-treatment-bias"><i class="fa fa-check"></i><b>6.2</b> Post-treatment bias</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#a-prior-is-born."><i class="fa fa-check"></i><b>6.2.1</b> A prior is born.</a></li>
<li class="chapter" data-level="6.2.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#blocked-by-consequence."><i class="fa fa-check"></i><b>6.2.2</b> Blocked by consequence.</a></li>
<li class="chapter" data-level="6.2.3" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#fungus-and-d-separation."><i class="fa fa-check"></i><b>6.2.3</b> Fungus and <span class="math inline">\(d\)</span>-separation.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#collider-bias"><i class="fa fa-check"></i><b>6.3</b> Collider bias</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#collider-of-false-sorrow."><i class="fa fa-check"></i><b>6.3.1</b> Collider of false sorrow.</a></li>
<li class="chapter" data-level="6.3.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#the-haunted-dag."><i class="fa fa-check"></i><b>6.3.2</b> The haunted DAG.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#confronting-confounding"><i class="fa fa-check"></i><b>6.4</b> Confronting confounding</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#shutting-the-backdoor."><i class="fa fa-check"></i><b>6.4.1</b> Shutting the backdoor.</a></li>
<li class="chapter" data-level="6.4.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#two-roads."><i class="fa fa-check"></i><b>6.4.2</b> Two roads.</a></li>
<li class="chapter" data-level="6.4.3" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#backdoor-waffles."><i class="fa fa-check"></i><b>6.4.3</b> Backdoor waffles.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#summary-and-a-little-more-practice"><i class="fa fa-check"></i><b>6.5</b> Summary [and a little more practice]</a></li>
<li class="chapter" data-level="" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ulysses-compass.html"><a href="ulysses-compass.html"><i class="fa fa-check"></i><b>7</b> Ulysses’ Compass</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#the-problem-with-parameters"><i class="fa fa-check"></i><b>7.1</b> The problem with parameters</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#more-parameters-almost-always-improve-fit."><i class="fa fa-check"></i><b>7.1.1</b> More parameters (almost) always improve fit.</a></li>
<li class="chapter" data-level="7.1.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#too-few-parameters-hurts-too."><i class="fa fa-check"></i><b>7.1.2</b> Too few parameters hurts, too.</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#entropy-and-accuracy"><i class="fa fa-check"></i><b>7.2</b> Entropy and accuracy</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#firing-the-weatherperson."><i class="fa fa-check"></i><b>7.2.1</b> Firing the weatherperson.</a></li>
<li class="chapter" data-level="7.2.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#information-and-uncertainty."><i class="fa fa-check"></i><b>7.2.2</b> Information and uncertainty.</a></li>
<li class="chapter" data-level="7.2.3" data-path="ulysses-compass.html"><a href="ulysses-compass.html#from-entropy-to-accuracy."><i class="fa fa-check"></i><b>7.2.3</b> From entropy to accuracy.</a></li>
<li class="chapter" data-level="7.2.4" data-path="ulysses-compass.html"><a href="ulysses-compass.html#estimating-divergence."><i class="fa fa-check"></i><b>7.2.4</b> Estimating divergence.</a></li>
<li class="chapter" data-level="7.2.5" data-path="ulysses-compass.html"><a href="ulysses-compass.html#scoring-the-right-data."><i class="fa fa-check"></i><b>7.2.5</b> Scoring the right data.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ulysses-compass.html"><a href="ulysses-compass.html#golem-taming-regularization"><i class="fa fa-check"></i><b>7.3</b> Golem taming: regularization</a></li>
<li class="chapter" data-level="7.4" data-path="ulysses-compass.html"><a href="ulysses-compass.html#predicting-predictive-accuracy"><i class="fa fa-check"></i><b>7.4</b> Predicting predictive accuracy</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#cross-validation."><i class="fa fa-check"></i><b>7.4.1</b> Cross-validation.</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="ulysses-compass.html"><a href="ulysses-compass.html#information-criteria"><i class="fa fa-check"></i><b>7.5</b> Information criteria</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#comparing-cv-psis-and-waic."><i class="fa fa-check"></i><b>7.5.1</b> Comparing CV, PSIS, and WAIC.</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="ulysses-compass.html"><a href="ulysses-compass.html#model-comparison"><i class="fa fa-check"></i><b>7.6</b> Model comparison</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#model-mis-selection."><i class="fa fa-check"></i><b>7.6.1</b> Model mis-selection.</a></li>
<li class="chapter" data-level="7.6.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#outliers-and-other-illusions."><i class="fa fa-check"></i><b>7.6.2</b> Outliers and other illusions.</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="ulysses-compass.html"><a href="ulysses-compass.html#summary-bonus-r2-talk"><i class="fa fa-check"></i><b>7.7</b> <del>Summary</del> Bonus: <span class="math inline">\(R^2\)</span> talk</a></li>
<li class="chapter" data-level="" data-path="ulysses-compass.html"><a href="ulysses-compass.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="conditional-manatees.html"><a href="conditional-manatees.html"><i class="fa fa-check"></i><b>8</b> Conditional Manatees</a>
<ul>
<li class="chapter" data-level="8.1" data-path="conditional-manatees.html"><a href="conditional-manatees.html#building-an-interaction"><i class="fa fa-check"></i><b>8.1</b> Building an interaction</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="conditional-manatees.html"><a href="conditional-manatees.html#making-a-rugged-model."><i class="fa fa-check"></i><b>8.1.1</b> Making a rugged model.</a></li>
<li class="chapter" data-level="8.1.2" data-path="conditional-manatees.html"><a href="conditional-manatees.html#adding-an-indicator-variable-isnt-enough."><i class="fa fa-check"></i><b>8.1.2</b> Adding an indicator variable isn’t enough.</a></li>
<li class="chapter" data-level="8.1.3" data-path="conditional-manatees.html"><a href="conditional-manatees.html#adding-an-interaction-does-work."><i class="fa fa-check"></i><b>8.1.3</b> Adding an interaction does work.</a></li>
<li class="chapter" data-level="8.1.4" data-path="conditional-manatees.html"><a href="conditional-manatees.html#plotting-the-interaction."><i class="fa fa-check"></i><b>8.1.4</b> Plotting the interaction.</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="conditional-manatees.html"><a href="conditional-manatees.html#symmetry-of-interactions"><i class="fa fa-check"></i><b>8.2</b> Symmetry of interactions</a></li>
<li class="chapter" data-level="8.3" data-path="conditional-manatees.html"><a href="conditional-manatees.html#continuous-interactions"><i class="fa fa-check"></i><b>8.3</b> Continuous interactions</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="conditional-manatees.html"><a href="conditional-manatees.html#a-winter-flower."><i class="fa fa-check"></i><b>8.3.1</b> A winter flower.</a></li>
<li class="chapter" data-level="8.3.2" data-path="conditional-manatees.html"><a href="conditional-manatees.html#the-models."><i class="fa fa-check"></i><b>8.3.2</b> The models.</a></li>
<li class="chapter" data-level="8.3.3" data-path="conditional-manatees.html"><a href="conditional-manatees.html#plotting-posterior-predictions."><i class="fa fa-check"></i><b>8.3.3</b> Plotting posterior predictions.</a></li>
<li class="chapter" data-level="8.3.4" data-path="conditional-manatees.html"><a href="conditional-manatees.html#plotting-prior-predictions."><i class="fa fa-check"></i><b>8.3.4</b> Plotting prior predictions.</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="conditional-manatees.html"><a href="conditional-manatees.html#summary-bonus-conditional_effects"><i class="fa fa-check"></i><b>8.4</b> <del>Summary</del> Bonus: <code>conditional_effects()</code></a></li>
<li class="chapter" data-level="" data-path="conditional-manatees.html"><a href="conditional-manatees.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>9</b> Markov Chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#good-king-markov-and-his-island-kingdom"><i class="fa fa-check"></i><b>9.1</b> Good King Markov and his island kingdom</a></li>
<li class="chapter" data-level="9.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#metropolis-algorithms"><i class="fa fa-check"></i><b>9.2</b> Metropolis algorithms</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#gibbs-sampling."><i class="fa fa-check"></i><b>9.2.1</b> Gibbs sampling.</a></li>
<li class="chapter" data-level="9.2.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#high-dimensional-problems."><i class="fa fa-check"></i><b>9.2.2</b> High-dimensional problems.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#hamiltonian-monte-carlo"><i class="fa fa-check"></i><b>9.3</b> Hamiltonian Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#another-parable."><i class="fa fa-check"></i><b>9.3.1</b> Another parable.</a></li>
<li class="chapter" data-level="9.3.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#particles-in-space."><i class="fa fa-check"></i><b>9.3.2</b> Particles in space.</a></li>
<li class="chapter" data-level="9.3.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#limitations."><i class="fa fa-check"></i><b>9.3.3</b> Limitations.</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#easy-hmc-ulam-brm"><i class="fa fa-check"></i><b>9.4</b> Easy HMC: <del>ulam</del> <code>brm()</code></a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#preparation."><i class="fa fa-check"></i><b>9.4.1</b> Preparation.</a></li>
<li class="chapter" data-level="9.4.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#sampling-from-the-posterior.-1"><i class="fa fa-check"></i><b>9.4.2</b> Sampling from the posterior.</a></li>
<li class="chapter" data-level="9.4.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#sampling-again-in-parallel."><i class="fa fa-check"></i><b>9.4.3</b> Sampling again, in parallel.</a></li>
<li class="chapter" data-level="9.4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#visualization."><i class="fa fa-check"></i><b>9.4.4</b> Visualization.</a></li>
<li class="chapter" data-level="9.4.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#checking-the-chain."><i class="fa fa-check"></i><b>9.4.5</b> Checking the chain.</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#care-and-feeding-of-your-markov-chain"><i class="fa fa-check"></i><b>9.5</b> Care and feeding of your Markov chain</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#how-many-samples-do-you-need"><i class="fa fa-check"></i><b>9.5.1</b> How many samples do you need?</a></li>
<li class="chapter" data-level="9.5.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#how-many-chains-do-you-need"><i class="fa fa-check"></i><b>9.5.2</b> How many chains do you need?</a></li>
<li class="chapter" data-level="9.5.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#taming-a-wild-chain."><i class="fa fa-check"></i><b>9.5.3</b> Taming a wild chain.</a></li>
<li class="chapter" data-level="9.5.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#non-identifiable-parameters."><i class="fa fa-check"></i><b>9.5.4</b> Non-identifiable parameters.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>10</b> Big Entropy and the Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="10.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#maximum-entropy"><i class="fa fa-check"></i><b>10.1</b> Maximum entropy</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#gaussian."><i class="fa fa-check"></i><b>10.1.1</b> Gaussian.</a></li>
<li class="chapter" data-level="10.1.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#binomial."><i class="fa fa-check"></i><b>10.1.2</b> Binomial.</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#generalized-linear-models"><i class="fa fa-check"></i><b>10.2</b> Generalized linear models</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#meet-the-family."><i class="fa fa-check"></i><b>10.2.1</b> Meet the family.</a></li>
<li class="chapter" data-level="10.2.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#linking-linear-models-to-distributions."><i class="fa fa-check"></i><b>10.2.2</b> Linking linear models to distributions.</a></li>
<li class="chapter" data-level="10.2.3" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#omitted-variable-bias-again."><i class="fa fa-check"></i><b>10.2.3</b> Omitted variable bias again.</a></li>
<li class="chapter" data-level="10.2.4" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#absolute-and-relative-differences."><i class="fa fa-check"></i><b>10.2.4</b> Absolute and relative differences.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html"><i class="fa fa-check"></i><b>11</b> God Spiked the Integers</a>
<ul>
<li class="chapter" data-level="11.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#binomial-regression"><i class="fa fa-check"></i><b>11.1</b> Binomial regression</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#logistic-regression-prosocial-chimpanzees."><i class="fa fa-check"></i><b>11.1.1</b> Logistic regression: Prosocial chimpanzees.</a></li>
<li class="chapter" data-level="11.1.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#relative-shark-and-absolute-deer."><i class="fa fa-check"></i><b>11.1.2</b> Relative shark and absolute deer.</a></li>
<li class="chapter" data-level="11.1.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#aggregated-binomial-chimpanzees-again-condensed."><i class="fa fa-check"></i><b>11.1.3</b> Aggregated binomial: Chimpanzees again, condensed.</a></li>
<li class="chapter" data-level="11.1.4" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#aggregated-binomial-graduate-school-admissions."><i class="fa fa-check"></i><b>11.1.4</b> Aggregated binomial: Graduate school admissions.</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#poisson-regression"><i class="fa fa-check"></i><b>11.2</b> Poisson regression</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#example-oceanic-tool-complexity."><i class="fa fa-check"></i><b>11.2.1</b> Example: Oceanic tool complexity.</a></li>
<li class="chapter" data-level="11.2.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#negative-binomial-gamma-poisson-models."><i class="fa fa-check"></i><b>11.2.2</b> Negative binomial (gamma-Poisson) models.</a></li>
<li class="chapter" data-level="11.2.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#example-exposure-and-the-offset."><i class="fa fa-check"></i><b>11.2.3</b> Example: Exposure and the offset.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#multinomial-and-categorical-models"><i class="fa fa-check"></i><b>11.3</b> Multinomial and categorical models</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#predictors-matched-to-outcomes."><i class="fa fa-check"></i><b>11.3.1</b> Predictors matched to outcomes.</a></li>
<li class="chapter" data-level="11.3.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#predictors-matched-to-observations."><i class="fa fa-check"></i><b>11.3.2</b> Predictors matched to observations.</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#summary"><i class="fa fa-check"></i><b>11.4</b> Summary</a></li>
<li class="chapter" data-level="11.5" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#bonus-survival-analysis"><i class="fa fa-check"></i><b>11.5</b> Bonus: Survival analysis</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#survival-summary."><i class="fa fa-check"></i><b>11.5.1</b> Survival summary.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html"><i class="fa fa-check"></i><b>12</b> Monsters and Mixtures</a>
<ul>
<li class="chapter" data-level="12.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#over-dispersed-counts"><i class="fa fa-check"></i><b>12.1</b> Over-dispersed counts</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#beta-binomial."><i class="fa fa-check"></i><b>12.1.1</b> Beta-binomial.</a></li>
<li class="chapter" data-level="12.1.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#negative-binomial-or-gamma-poisson."><i class="fa fa-check"></i><b>12.1.2</b> Negative-binomial or gamma-Poisson.</a></li>
<li class="chapter" data-level="12.1.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#over-dispersion-entropy-and-information-criteria."><i class="fa fa-check"></i><b>12.1.3</b> Over-dispersion, entropy, and information criteria.</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#zero-inflated-outcomes"><i class="fa fa-check"></i><b>12.2</b> Zero-inflated outcomes</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#example-zero-inflated-poisson."><i class="fa fa-check"></i><b>12.2.1</b> Example: Zero-inflated Poisson.</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#ordered-categorical-outcomes"><i class="fa fa-check"></i><b>12.3</b> Ordered categorical outcomes</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#example-moral-intuition."><i class="fa fa-check"></i><b>12.3.1</b> Example: Moral intuition.</a></li>
<li class="chapter" data-level="12.3.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#describing-an-ordered-distribution-with-intercepts."><i class="fa fa-check"></i><b>12.3.2</b> Describing an ordered distribution with intercepts.</a></li>
<li class="chapter" data-level="12.3.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#adding-predictor-variables."><i class="fa fa-check"></i><b>12.3.3</b> Adding predictor variables.</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#ordered-categorical-predictors"><i class="fa fa-check"></i><b>12.4</b> Ordered categorical predictors</a></li>
<li class="chapter" data-level="12.5" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#summary-1"><i class="fa fa-check"></i><b>12.5</b> Summary</a></li>
<li class="chapter" data-level="" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="models-with-memory.html"><a href="models-with-memory.html"><i class="fa fa-check"></i><b>13</b> Models With Memory</a>
<ul>
<li class="chapter" data-level="13.1" data-path="models-with-memory.html"><a href="models-with-memory.html#example-multilevel-tadpoles"><i class="fa fa-check"></i><b>13.1</b> Example: Multilevel tadpoles</a></li>
<li class="chapter" data-level="13.2" data-path="models-with-memory.html"><a href="models-with-memory.html#varying-effects-and-the-underfittingoverfitting-trade-off"><i class="fa fa-check"></i><b>13.2</b> Varying effects and the underfitting/overfitting trade-off</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="models-with-memory.html"><a href="models-with-memory.html#the-model.-1"><i class="fa fa-check"></i><b>13.2.1</b> The model.</a></li>
<li class="chapter" data-level="13.2.2" data-path="models-with-memory.html"><a href="models-with-memory.html#assign-values-to-the-parameters."><i class="fa fa-check"></i><b>13.2.2</b> Assign values to the parameters.</a></li>
<li class="chapter" data-level="13.2.3" data-path="models-with-memory.html"><a href="models-with-memory.html#sumulate-survivors."><i class="fa fa-check"></i><b>13.2.3</b> Sumulate survivors.</a></li>
<li class="chapter" data-level="13.2.4" data-path="models-with-memory.html"><a href="models-with-memory.html#compute-the-no-pooling-estimates."><i class="fa fa-check"></i><b>13.2.4</b> Compute the no-pooling estimates.</a></li>
<li class="chapter" data-level="13.2.5" data-path="models-with-memory.html"><a href="models-with-memory.html#compute-the-partial-pooling-estimates."><i class="fa fa-check"></i><b>13.2.5</b> Compute the partial-pooling estimates.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="models-with-memory.html"><a href="models-with-memory.html#more-than-one-type-of-cluster"><i class="fa fa-check"></i><b>13.3</b> More than one type of cluster</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="models-with-memory.html"><a href="models-with-memory.html#multilevel-chimpanzees."><i class="fa fa-check"></i><b>13.3.1</b> Multilevel chimpanzees.</a></li>
<li class="chapter" data-level="13.3.2" data-path="models-with-memory.html"><a href="models-with-memory.html#even-more-clusters."><i class="fa fa-check"></i><b>13.3.2</b> Even more clusters.</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="models-with-memory.html"><a href="models-with-memory.html#divergent-transitions-and-non-centered-priors"><i class="fa fa-check"></i><b>13.4</b> Divergent transitions and non-centered priors</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="models-with-memory.html"><a href="models-with-memory.html#the-devils-funnel."><i class="fa fa-check"></i><b>13.4.1</b> The Devil’s Funnel.</a></li>
<li class="chapter" data-level="13.4.2" data-path="models-with-memory.html"><a href="models-with-memory.html#non-centered-chimpanzees."><i class="fa fa-check"></i><b>13.4.2</b> Non-centered chimpanzees.</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="models-with-memory.html"><a href="models-with-memory.html#multilevel-posterior-predictions"><i class="fa fa-check"></i><b>13.5</b> Multilevel posterior predictions</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="models-with-memory.html"><a href="models-with-memory.html#posterior-prediction-for-same-clusters."><i class="fa fa-check"></i><b>13.5.1</b> Posterior prediction for same clusters.</a></li>
<li class="chapter" data-level="13.5.2" data-path="models-with-memory.html"><a href="models-with-memory.html#posterior-prediction-for-new-clusters."><i class="fa fa-check"></i><b>13.5.2</b> Posterior prediction for new clusters.</a></li>
<li class="chapter" data-level="13.5.3" data-path="models-with-memory.html"><a href="models-with-memory.html#post-stratification."><i class="fa fa-check"></i><b>13.5.3</b> Post-stratification.</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="models-with-memory.html"><a href="models-with-memory.html#summary-bonus-post-stratification-in-an-example"><i class="fa fa-check"></i><b>13.6</b> <del>Summary</del> Bonus: Post-stratification in an example</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="models-with-memory.html"><a href="models-with-memory.html#meet-the-data."><i class="fa fa-check"></i><b>13.6.1</b> Meet the data.</a></li>
<li class="chapter" data-level="13.6.2" data-path="models-with-memory.html"><a href="models-with-memory.html#settle-the-mr-part-of-mrp."><i class="fa fa-check"></i><b>13.6.2</b> Settle the MR part of MRP.</a></li>
<li class="chapter" data-level="13.6.3" data-path="models-with-memory.html"><a href="models-with-memory.html#post-stratify-to-put-the-p-in-mrp."><i class="fa fa-check"></i><b>13.6.3</b> Post-stratify to put the P in MRP.</a></li>
<li class="chapter" data-level="13.6.4" data-path="models-with-memory.html"><a href="models-with-memory.html#wrap-this-mrp-up."><i class="fa fa-check"></i><b>13.6.4</b> Wrap this MRP up.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="models-with-memory.html"><a href="models-with-memory.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html"><i class="fa fa-check"></i><b>14</b> Adventures in Covariance</a>
<ul>
<li class="chapter" data-level="14.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#varying-slopes-by-construction"><i class="fa fa-check"></i><b>14.1</b> Varying slopes by construction</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#simulate-the-population."><i class="fa fa-check"></i><b>14.1.1</b> Simulate the population.</a></li>
<li class="chapter" data-level="14.1.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#simulate-observations."><i class="fa fa-check"></i><b>14.1.2</b> Simulate observations.</a></li>
<li class="chapter" data-level="14.1.3" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#the-varying-slopes-model."><i class="fa fa-check"></i><b>14.1.3</b> The varying slopes model.</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#advanced-varying-slopes"><i class="fa fa-check"></i><b>14.2</b> Advanced varying slopes</a></li>
<li class="chapter" data-level="14.3" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#instruments-and-causal-designs"><i class="fa fa-check"></i><b>14.3</b> Instruments and causal designs</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#instrumental-variables."><i class="fa fa-check"></i><b>14.3.1</b> Instrumental variables.</a></li>
<li class="chapter" data-level="14.3.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#other-designs."><i class="fa fa-check"></i><b>14.3.2</b> Other designs.</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#social-relations-as-correlated-varying-effects"><i class="fa fa-check"></i><b>14.4</b> Social relations as correlated varying effects</a></li>
<li class="chapter" data-level="14.5" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#continuous-categories-and-the-gaussian-process"><i class="fa fa-check"></i><b>14.5</b> Continuous categories and the Gaussian process</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#example-spatial-autocorrelation-in-oceanic-tools."><i class="fa fa-check"></i><b>14.5.1</b> Example: Spatial autocorrelation in Oceanic tools.</a></li>
<li class="chapter" data-level="14.5.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#example-phylogenetic-distance."><i class="fa fa-check"></i><b>14.5.2</b> Example: Phylogenetic distance.</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#summary-bonus-multilevel-growth-models-and-the-melsm"><i class="fa fa-check"></i><b>14.6</b> <del>Summary</del> Bonus: Multilevel growth models and the MELSM</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#borrow-some-data."><i class="fa fa-check"></i><b>14.6.1</b> Borrow some data.</a></li>
<li class="chapter" data-level="14.6.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#conventional-multilevel-growth-model."><i class="fa fa-check"></i><b>14.6.2</b> Conventional multilevel growth model.</a></li>
<li class="chapter" data-level="14.6.3" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#learn-more-about-your-data-with-the-melsm."><i class="fa fa-check"></i><b>14.6.3</b> Learn more about your data with the MELSM.</a></li>
<li class="chapter" data-level="14.6.4" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#time-to-go-multivariate."><i class="fa fa-check"></i><b>14.6.4</b> Time to go multivariate.</a></li>
<li class="chapter" data-level="14.6.5" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#growth-modelmelsm-wrap-up."><i class="fa fa-check"></i><b>14.6.5</b> Growth model/MELSM wrap-up.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#session-info-13"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html"><i class="fa fa-check"></i><b>15</b> Missing Data and Other Opportunities</a>
<ul>
<li class="chapter" data-level="15.1" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#measurement-error"><i class="fa fa-check"></i><b>15.1</b> Measurement error</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#error-on-the-outcome."><i class="fa fa-check"></i><b>15.1.1</b> Error on the outcome.</a></li>
<li class="chapter" data-level="15.1.2" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#error-on-both-outcome-and-predictor."><i class="fa fa-check"></i><b>15.1.2</b> Error on both outcome and predictor.</a></li>
<li class="chapter" data-level="15.1.3" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#measurement-terrors."><i class="fa fa-check"></i><b>15.1.3</b> Measurement terrors.</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#missing-data"><i class="fa fa-check"></i><b>15.2</b> Missing data</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#dag-ate-my-homework."><i class="fa fa-check"></i><b>15.2.1</b> DAG ate my homework.</a></li>
<li class="chapter" data-level="15.2.2" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#imputing-primates."><i class="fa fa-check"></i><b>15.2.2</b> Imputing primates.</a></li>
<li class="chapter" data-level="15.2.3" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#where-is-your-god-now"><i class="fa fa-check"></i><b>15.2.3</b> Where is your god now?</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#categorical-errors-and-discrete-absences"><i class="fa fa-check"></i><b>15.3</b> Categorical errors and discrete absences</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#discrete-cats."><i class="fa fa-check"></i><b>15.3.1</b> Discrete cats.</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#summary-2"><i class="fa fa-check"></i><b>15.4</b> Summary</a></li>
<li class="chapter" data-level="15.5" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#bonus-bayesian-meta-analysis-with-odds-ratios"><i class="fa fa-check"></i><b>15.5</b> Bonus: Bayesian meta-analysis with odds ratios</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#how-do-meta-analyses-fit-into-the-picture"><i class="fa fa-check"></i><b>15.5.1</b> How do meta-analyses fit into the picture?</a></li>
<li class="chapter" data-level="15.5.2" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#we-need-some-data."><i class="fa fa-check"></i><b>15.5.2</b> We need some data.</a></li>
<li class="chapter" data-level="15.5.3" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#our-effect-size-will-be-an-odds-ratio."><i class="fa fa-check"></i><b>15.5.3</b> Our effect size will be an odds ratio.</a></li>
<li class="chapter" data-level="15.5.4" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#log-odds-odds-ratios-and-modeling-effect-sizes."><i class="fa fa-check"></i><b>15.5.4</b> Log-odds, odds ratios, and modeling effect sizes.</a></li>
<li class="chapter" data-level="15.5.5" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#compute-the-study-specific-effect-sizes."><i class="fa fa-check"></i><b>15.5.5</b> Compute the study-specific effect sizes.</a></li>
<li class="chapter" data-level="15.5.6" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#fit-the-bayesian-meta-analysis."><i class="fa fa-check"></i><b>15.5.6</b> Fit the Bayesian meta-analysis.</a></li>
<li class="chapter" data-level="15.5.7" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#fit-the-bayesian-muiltilevel-alternative."><i class="fa fa-check"></i><b>15.5.7</b> Fit the Bayesian muiltilevel alternative.</a></li>
<li class="chapter" data-level="15.5.8" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#relative-to-the-muiltilevel-model-meta-analyses-have-limitations."><i class="fa fa-check"></i><b>15.5.8</b> Relative to the muiltilevel model, meta-analyses have limitations.</a></li>
<li class="chapter" data-level="15.5.9" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#parting-thoughts."><i class="fa fa-check"></i><b>15.5.9</b> Parting thoughts.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#session-info-14"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html"><i class="fa fa-check"></i><b>16</b> Generalized Linear Madness</a>
<ul>
<li class="chapter" data-level="16.1" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#geometric-people"><i class="fa fa-check"></i><b>16.1</b> Geometric people</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#the-scientific-model."><i class="fa fa-check"></i><b>16.1.1</b> The scientific model.</a></li>
<li class="chapter" data-level="16.1.2" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#the-statistical-model."><i class="fa fa-check"></i><b>16.1.2</b> The statistical model.</a></li>
<li class="chapter" data-level="16.1.3" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#glm-in-disguise."><i class="fa fa-check"></i><b>16.1.3</b> GLM in disguise.</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#hidden-minds-and-observed-behavior"><i class="fa fa-check"></i><b>16.2</b> Hidden minds and observed behavior</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#the-scientific-model.-1"><i class="fa fa-check"></i><b>16.2.1</b> The scientific model.</a></li>
<li class="chapter" data-level="16.2.2" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#the-statistical-model.-1"><i class="fa fa-check"></i><b>16.2.2</b> The statistical model.</a></li>
<li class="chapter" data-level="16.2.3" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#coding-the-statistical-model."><i class="fa fa-check"></i><b>16.2.3</b> Coding the statistical model.</a></li>
<li class="chapter" data-level="16.2.4" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#state-space-models."><i class="fa fa-check"></i><b>16.2.4</b> State space models.</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#ordinary-differential-nut-cracking"><i class="fa fa-check"></i><b>16.3</b> Ordinary differential nut cracking</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#scientific-model."><i class="fa fa-check"></i><b>16.3.1</b> Scientific model.</a></li>
<li class="chapter" data-level="16.3.2" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#statistical-model."><i class="fa fa-check"></i><b>16.3.2</b> Statistical model.</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#population-dynamics"><i class="fa fa-check"></i><b>16.4</b> Population dynamics</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#the-scientific-model.-2"><i class="fa fa-check"></i><b>16.4.1</b> The scientific model.</a></li>
<li class="chapter" data-level="16.4.2" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#the-statistical-model.-2"><i class="fa fa-check"></i><b>16.4.2</b> The statistical model.</a></li>
<li class="chapter" data-level="16.4.3" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#lynx-lessons-bonus-practice-with-the-autoregressive-model."><i class="fa fa-check"></i><b>16.4.3</b> <del>Lynx lessons</del> Bonus: Practice with the autoregressive model.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#session-info-15"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html"><i class="fa fa-check"></i><b>17</b> <del>Horoscopes</del> Insights</a>
<ul>
<li class="chapter" data-level="17.1" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#use-r-notebooks"><i class="fa fa-check"></i><b>17.1</b> Use R Notebooks</a></li>
<li class="chapter" data-level="17.2" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#save-your-model-fits"><i class="fa fa-check"></i><b>17.2</b> Save your model fits</a></li>
<li class="chapter" data-level="17.3" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#build-your-models-slowly"><i class="fa fa-check"></i><b>17.3</b> Build your models slowly</a></li>
<li class="chapter" data-level="17.4" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#look-at-your-data"><i class="fa fa-check"></i><b>17.4</b> Look at your data</a></li>
<li class="chapter" data-level="17.5" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#consider-using-the-0-intercept-syntax"><i class="fa fa-check"></i><b>17.5</b> Consider using the <code>0 + Intercept</code> syntax</a></li>
<li class="chapter" data-level="17.6" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#annotate-your-workflow"><i class="fa fa-check"></i><b>17.6</b> Annotate your workflow</a></li>
<li class="chapter" data-level="17.7" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#annotate-your-code"><i class="fa fa-check"></i><b>17.7</b> Annotate your code</a></li>
<li class="chapter" data-level="17.8" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#break-up-your-workflow"><i class="fa fa-check"></i><b>17.8</b> Break up your workflow</a></li>
<li class="chapter" data-level="17.9" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#code-in-public"><i class="fa fa-check"></i><b>17.9</b> Code in public</a></li>
<li class="chapter" data-level="17.10" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#check-out-social-media"><i class="fa fa-check"></i><b>17.10</b> Check out social media</a></li>
<li class="chapter" data-level="17.11" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#extra-rethinking-related-resources"><i class="fa fa-check"></i><b>17.11</b> Extra <em>Rethinking</em>-related resources</a></li>
<li class="chapter" data-level="17.12" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#but-like-how-do-i-do-this-for-real"><i class="fa fa-check"></i><b>17.12</b> <em>But, like, how do I do this for real?</em></a></li>
<li class="chapter" data-level="17.13" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#parting-wisdom"><i class="fa fa-check"></i><b>17.13</b> Parting wisdom</a></li>
<li class="chapter" data-level="" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#session-info-16"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Statistical rethinking</em> with brms, ggplot2, and the tidyverse: Second edition</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="missing-data-and-other-opportunities" class="section level1 hasAnchor" number="15">
<h1><span class="header-section-number">15</span> Missing Data and Other Opportunities<a href="missing-data-and-other-opportunities.html#missing-data-and-other-opportunities" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>For the opening example, we’re playing with the conditional probability</p>
<p><span class="math display">\[
\text{Pr(burnt down | burnt up)} = \frac{\text{Pr(burnt up, burnt down)}}{\text{Pr(burnt up)}}.
\]</span></p>
<p>Given McElreath’s setup, it works out that</p>
<p><span class="math display">\[
\text{Pr(burnt down | burnt up)} = \frac{1/3}{1/2} = \frac{2}{3}.
\]</span></p>
<p>We might express the math toward the bottom of page 489 in tibble form like this.</p>
<div class="sourceCode" id="cb1924"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1924-1"><a href="missing-data-and-other-opportunities.html#cb1924-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1924-2"><a href="missing-data-and-other-opportunities.html#cb1924-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1924-3"><a href="missing-data-and-other-opportunities.html#cb1924-3" aria-hidden="true" tabindex="-1"></a>p_pancake <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span></span>
<span id="cb1924-4"><a href="missing-data-and-other-opportunities.html#cb1924-4" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb1924-5"><a href="missing-data-and-other-opportunities.html#cb1924-5" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span></span>
<span id="cb1924-6"><a href="missing-data-and-other-opportunities.html#cb1924-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">pancake =</span> <span class="fu">c</span>(<span class="st">&quot;BB&quot;</span>, <span class="st">&quot;BU&quot;</span>, <span class="st">&quot;UU&quot;</span>),</span>
<span id="cb1924-7"><a href="missing-data-and-other-opportunities.html#cb1924-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">p_burnt =</span> <span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">5</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1924-8"><a href="missing-data-and-other-opportunities.html#cb1924-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">p_burnt_up =</span> p_burnt <span class="sc">*</span> p_pancake)</span>
<span id="cb1924-9"><a href="missing-data-and-other-opportunities.html#cb1924-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   pancake p_burnt p_burnt_up
##   &lt;chr&gt;     &lt;dbl&gt;      &lt;dbl&gt;
## 1 BB          1        0.333
## 2 BU          0.5      0.167
## 3 UU          0        0</code></pre>
<div class="sourceCode" id="cb1926"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1926-1"><a href="missing-data-and-other-opportunities.html#cb1926-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb1926-2"><a href="missing-data-and-other-opportunities.html#cb1926-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">p (burnt_down | burnt_up)</span><span class="st">`</span> <span class="ot">=</span> p_pancake <span class="sc">/</span> <span class="fu">sum</span>(p_burnt_up))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   `p (burnt_down | burnt_up)`
##                         &lt;dbl&gt;
## 1                       0.667</code></pre>
<p>I understood McElreath’s simulation (<strong>R</strong> code 15.1) better after breaking it apart. The first part of <code>sim_pancake()</code> takes one random draw from the integers 1, 2, and 3. It just so happens that if we set <code>set.seed(1)</code>, the code returns a 1.</p>
<div class="sourceCode" id="cb1928"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1928-1"><a href="missing-data-and-other-opportunities.html#cb1928-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1928-2"><a href="missing-data-and-other-opportunities.html#cb1928-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">size =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>So here’s what it looks like if we use seeds <code>2:11</code>.</p>
<div class="sourceCode" id="cb1930"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1930-1"><a href="missing-data-and-other-opportunities.html#cb1930-1" aria-hidden="true" tabindex="-1"></a>take_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(seed) {</span>
<span id="cb1930-2"><a href="missing-data-and-other-opportunities.html#cb1930-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb1930-3"><a href="missing-data-and-other-opportunities.html#cb1930-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb1930-4"><a href="missing-data-and-other-opportunities.html#cb1930-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1930-5"><a href="missing-data-and-other-opportunities.html#cb1930-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1930-6"><a href="missing-data-and-other-opportunities.html#cb1930-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">seed =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">11</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1930-7"><a href="missing-data-and-other-opportunities.html#cb1930-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value_returned =</span> <span class="fu">map_dbl</span>(seed, take_sample))</span></code></pre></div>
<pre><code>## # A tibble: 10 × 2
##     seed value_returned
##    &lt;int&gt;          &lt;dbl&gt;
##  1     2              1
##  2     3              1
##  3     4              3
##  4     5              2
##  5     6              1
##  6     7              2
##  7     8              3
##  8     9              3
##  9    10              3
## 10    11              2</code></pre>
<p>Each of those <code>value_returned</code> values stands for one of the three pancakes: 1 = BB, 2 = BU, and 3 = UU. In the next line, McElreath made slick use of a matrix to specify that. Here’s what the matrix looks like.</p>
<div class="sourceCode" id="cb1932"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1932-1"><a href="missing-data-and-other-opportunities.html#cb1932-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    1    0
## [2,]    1    0    0</code></pre>
<p>See how the three columns are identified as <code>[,1]</code>, <code>[,2]</code>, and <code>[,3]</code>? If, say, we wanted to subset the values in the second column, we’d execute</p>
<div class="sourceCode" id="cb1934"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1934-1"><a href="missing-data-and-other-opportunities.html#cb1934-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">3</span>)[, <span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] 1 0</code></pre>
<p>which returns a numeric vector.</p>
<div class="sourceCode" id="cb1936"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1936-1"><a href="missing-data-and-other-opportunities.html#cb1936-1" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">3</span>)[, <span class="dv">2</span>] <span class="sc">%&gt;%</span> <span class="fu">str</span>()</span></code></pre></div>
<pre><code>##  num [1:2] 1 0</code></pre>
<p>That <code>1 0</code> corresponds to the pancake with one burnt (i.e., 1) and one unburnt (i.e., 0) side. So when McElreath then executed <code>sample(sides)</code>, he randomly sampled from one of those two values. In the case of <code>pancake == 2</code>, he randomly sampled one the pancake with one burnt and one unburnt side. Had he sampled from <code>pancake == 1</code>, he would have sampled from the pancake with both sides burnt.</p>
<p>Going forward, let’s amend McElreath’s <code>sim_pancake()</code> function so it will take a <code>seed</code> argument, which will allow us to make the output reproducible.</p>
<div class="sourceCode" id="cb1938"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1938-1"><a href="missing-data-and-other-opportunities.html#cb1938-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate a `pancake` and return randomly ordered `sides`</span></span>
<span id="cb1938-2"><a href="missing-data-and-other-opportunities.html#cb1938-2" aria-hidden="true" tabindex="-1"></a>sim_pancake <span class="ot">&lt;-</span> <span class="cf">function</span>(seed) {</span>
<span id="cb1938-3"><a href="missing-data-and-other-opportunities.html#cb1938-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1938-4"><a href="missing-data-and-other-opportunities.html#cb1938-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb1938-5"><a href="missing-data-and-other-opportunities.html#cb1938-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1938-6"><a href="missing-data-and-other-opportunities.html#cb1938-6" aria-hidden="true" tabindex="-1"></a>  pancake <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">size =</span> <span class="dv">1</span>)</span>
<span id="cb1938-7"><a href="missing-data-and-other-opportunities.html#cb1938-7" aria-hidden="true" tabindex="-1"></a>  sides   <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">3</span>)[, pancake]</span>
<span id="cb1938-8"><a href="missing-data-and-other-opportunities.html#cb1938-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample</span>(sides)</span>
<span id="cb1938-9"><a href="missing-data-and-other-opportunities.html#cb1938-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1938-10"><a href="missing-data-and-other-opportunities.html#cb1938-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Let’s take this baby for a whirl.</p>
<div class="sourceCode" id="cb1939"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1939-1"><a href="missing-data-and-other-opportunities.html#cb1939-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many simulations would you like?</span></span>
<span id="cb1939-2"><a href="missing-data-and-other-opportunities.html#cb1939-2" aria-hidden="true" tabindex="-1"></a>n_sim <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb1939-3"><a href="missing-data-and-other-opportunities.html#cb1939-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1939-4"><a href="missing-data-and-other-opportunities.html#cb1939-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb1939-5"><a href="missing-data-and-other-opportunities.html#cb1939-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">seed =</span> <span class="dv">1</span><span class="sc">:</span>n_sim) <span class="sc">%&gt;%</span> </span>
<span id="cb1939-6"><a href="missing-data-and-other-opportunities.html#cb1939-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">burnt =</span> <span class="fu">map</span>(seed, sim_pancake)) <span class="sc">%&gt;%</span> </span>
<span id="cb1939-7"><a href="missing-data-and-other-opportunities.html#cb1939-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(burnt) <span class="sc">%&gt;%</span> </span>
<span id="cb1939-8"><a href="missing-data-and-other-opportunities.html#cb1939-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">side =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;up&quot;</span>, <span class="st">&quot;down&quot;</span>), <span class="at">times =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="dv">2</span>))</span></code></pre></div>
<p>Take a look at what we’ve done.</p>
<div class="sourceCode" id="cb1940"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1940-1"><a href="missing-data-and-other-opportunities.html#cb1940-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d, <span class="at">n =</span> <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##     seed burnt side 
##    &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;
##  1     1     1 up   
##  2     1     1 down 
##  3     2     1 up   
##  4     2     1 down 
##  5     3     1 up   
##  6     3     1 down 
##  7     4     0 up   
##  8     4     0 down 
##  9     5     1 up   
## 10     5     0 down</code></pre>
<p>Now we use <code>pivot_wider()</code> and <code>summarise()</code> to get the value we’ve been working for.</p>
<div class="sourceCode" id="cb1942"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1942-1"><a href="missing-data-and-other-opportunities.html#cb1942-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb1942-2"><a href="missing-data-and-other-opportunities.html#cb1942-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> side, <span class="at">values_from =</span> burnt) <span class="sc">%&gt;%</span> </span>
<span id="cb1942-3"><a href="missing-data-and-other-opportunities.html#cb1942-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">p (burnt_down | burnt_up)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(up <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> down <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">/</span> (<span class="fu">sum</span>(up)))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   `p (burnt_down | burnt_up)`
##                         &lt;dbl&gt;
## 1                       0.658</code></pre>
<p>The results are within rounding error of the ideal 2/3.</p>
<blockquote>
<p>Probability theory is not difficult mathematically. It is just counting. But it is hard to interpret and apply. Doing so often seems to require some cleverness, and authors have an incentive to solve problems in clever ways, just to show off. But we don’t need that cleverness, if we ruthlessly apply conditional probability….</p>
<p>In this chapter, [we’ll] meet two commonplace applications of this assume-and-deduce strategy. The first is the incorporation of <strong>measurement error</strong> into our models. The second is the estimation of <strong>missing data</strong> through <strong>Bayesian imputation</strong>….</p>
<p>In neither application do [we] have to intuit the consequences of measurement errors nor the implications of missing values in order to design the models. All [we] have to do is state your information about the error or about the variables with missing values. Logic does the rest. <span class="citation">(<a href="#ref-mcelreathStatisticalRethinkingBayesian2020" role="doc-biblioref">McElreath, 2020, p. 490</a>, <strong>emphasis</strong> in the original)</span></p>
</blockquote>
<div id="measurement-error" class="section level2 hasAnchor" number="15.1">
<h2><span class="header-section-number">15.1</span> Measurement error<a href="missing-data-and-other-opportunities.html#measurement-error" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s grab those <code>WaffleDivorce</code> data from back in <a href="the-many-variables-the-spurious-waffles.html#spurious-associations">Chapter 5</a>.</p>
<div class="sourceCode" id="cb1944"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1944-1"><a href="missing-data-and-other-opportunities.html#cb1944-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(WaffleDivorce, <span class="at">package =</span> <span class="st">&quot;rethinking&quot;</span>)</span>
<span id="cb1944-2"><a href="missing-data-and-other-opportunities.html#cb1944-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> WaffleDivorce</span>
<span id="cb1944-3"><a href="missing-data-and-other-opportunities.html#cb1944-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(WaffleDivorce)</span></code></pre></div>
<p>In anticipation of <strong>R</strong> code 15.3 and 15.5, wrangle the data a little.</p>
<div class="sourceCode" id="cb1945"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1945-1"><a href="missing-data-and-other-opportunities.html#cb1945-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb1945-2"><a href="missing-data-and-other-opportunities.html#cb1945-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb1945-3"><a href="missing-data-and-other-opportunities.html#cb1945-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">D_obs =</span> (Divorce <span class="sc">-</span> <span class="fu">mean</span>(Divorce)) <span class="sc">/</span> <span class="fu">sd</span>(Divorce),</span>
<span id="cb1945-4"><a href="missing-data-and-other-opportunities.html#cb1945-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">D_sd  =</span> Divorce.SE <span class="sc">/</span> <span class="fu">sd</span>(Divorce),</span>
<span id="cb1945-5"><a href="missing-data-and-other-opportunities.html#cb1945-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">M     =</span> (Marriage <span class="sc">-</span> <span class="fu">mean</span>(Marriage)) <span class="sc">/</span> <span class="fu">sd</span>(Marriage),</span>
<span id="cb1945-6"><a href="missing-data-and-other-opportunities.html#cb1945-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">A     =</span> (MedianAgeMarriage <span class="sc">-</span> <span class="fu">mean</span>(MedianAgeMarriage)) <span class="sc">/</span> <span class="fu">sd</span>(MedianAgeMarriage),</span>
<span id="cb1945-7"><a href="missing-data-and-other-opportunities.html#cb1945-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">M_obs =</span> M,</span>
<span id="cb1945-8"><a href="missing-data-and-other-opportunities.html#cb1945-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">M_sd  =</span> Marriage.SE <span class="sc">/</span> <span class="fu">sd</span>(Marriage))</span></code></pre></div>
<p>For the plots in this chapter, we’ll use the dark themes from the <a href="https://CRAN.R-project.org/package=ggdark"><strong>ggdark</strong> package</a> <span class="citation">(<a href="#ref-R-ggdark" role="doc-biblioref">Grantham, 2019</a>)</span>. Our primary theme will be <code>ggdark::dark_theme_bw()</code>. One way to use the <code>dark_theme_bw()</code> function is to make it part of the code for an individual plot, such as <code>ggplot() + geom_point() + dark_theme_bw()</code>. Another way is to make <code>dark_theme_bw()</code> the default setting with <code>ggplot2::theme_set()</code>. That will be our method.</p>
<div class="sourceCode" id="cb1946"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1946-1"><a href="missing-data-and-other-opportunities.html#cb1946-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdark)</span>
<span id="cb1946-2"><a href="missing-data-and-other-opportunities.html#cb1946-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1946-3"><a href="missing-data-and-other-opportunities.html#cb1946-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(</span>
<span id="cb1946-4"><a href="missing-data-and-other-opportunities.html#cb1946-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dark_theme_bw</span>() <span class="sc">+</span></span>
<span id="cb1946-5"><a href="missing-data-and-other-opportunities.html#cb1946-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb1946-6"><a href="missing-data-and-other-opportunities.html#cb1946-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb1946-7"><a href="missing-data-and-other-opportunities.html#cb1946-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1946-8"><a href="missing-data-and-other-opportunities.html#cb1946-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1946-9"><a href="missing-data-and-other-opportunities.html#cb1946-9" aria-hidden="true" tabindex="-1"></a><span class="co"># to reset the default ggplot2 theme to its default parameters, execute both:</span></span>
<span id="cb1946-10"><a href="missing-data-and-other-opportunities.html#cb1946-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot2::theme_set(theme_gray())</span></span>
<span id="cb1946-11"><a href="missing-data-and-other-opportunities.html#cb1946-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ggdark::invert_geom_defaults()</span></span></code></pre></div>
<p>For the rest of our color palette, we’ll use colors from the <a href="https://github.com/sjmgarnier/viridis"><strong>viridis</strong> package</a> <span class="citation">(<a href="#ref-R-viridis" role="doc-biblioref">Garnier, 2021</a>)</span>, which provides a variety of colorblind-safe color palettes <span class="citation">(see <a href="#ref-rudisViridisColorPalettes2018" role="doc-biblioref">Rudis et al., 2018</a>)</span>.</p>
<div class="sourceCode" id="cb1947"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1947-1"><a href="missing-data-and-other-opportunities.html#cb1947-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span></code></pre></div>
<p>The <code>viridis_pal()</code> function gives a list of colors within a given palette. The colors in each palette fall on a spectrum. Within <code>viridis_pal()</code>, the <code>option</code> argument allows one to select a given spectrum, “C”, in our case. The final parentheses, <code>()</code>, allows one to determine how many discrete colors one would like to break the spectrum up by. We’ll choose 7.</p>
<div class="sourceCode" id="cb1948"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1948-1"><a href="missing-data-and-other-opportunities.html#cb1948-1" aria-hidden="true" tabindex="-1"></a><span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)</span></code></pre></div>
<pre><code>## [1] &quot;#0D0887FF&quot; &quot;#5D01A6FF&quot; &quot;#9C179EFF&quot; &quot;#CC4678FF&quot; &quot;#ED7953FF&quot; &quot;#FDB32FFF&quot; &quot;#F0F921FF&quot;</code></pre>
<p>With a little data wrangling, we can put the colors of our palette in a tibble and display them in a plot.</p>
<div class="sourceCode" id="cb1950"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1950-1"><a href="missing-data-and-other-opportunities.html#cb1950-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">factor       =</span> <span class="st">&quot;a&quot;</span>,</span>
<span id="cb1950-2"><a href="missing-data-and-other-opportunities.html#cb1950-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">number       =</span> <span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>),</span>
<span id="cb1950-3"><a href="missing-data-and-other-opportunities.html#cb1950-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">color_number =</span> <span class="fu">str_c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="st">&quot;. &quot;</span>, <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb1950-4"><a href="missing-data-and-other-opportunities.html#cb1950-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1950-5"><a href="missing-data-and-other-opportunities.html#cb1950-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> factor, <span class="at">y =</span> number)) <span class="sc">+</span></span>
<span id="cb1950-6"><a href="missing-data-and-other-opportunities.html#cb1950-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> number)) <span class="sc">+</span></span>
<span id="cb1950-7"><a href="missing-data-and-other-opportunities.html#cb1950-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> color_number, <span class="at">color =</span> number <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;5&quot;</span>, <span class="st">&quot;6&quot;</span>, <span class="st">&quot;7&quot;</span>))) <span class="sc">+</span></span>
<span id="cb1950-8"><a href="missing-data-and-other-opportunities.html#cb1950-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;white&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1950-9"><a href="missing-data-and-other-opportunities.html#cb1950-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>, <span class="at">discrete =</span> T, <span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1950-10"><a href="missing-data-and-other-opportunities.html#cb1950-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1950-11"><a href="missing-data-and-other-opportunities.html#cb1950-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb1950-12"><a href="missing-data-and-other-opportunities.html#cb1950-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Behold: viridis C!&quot;</span>)</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-18-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Now, let’s make use of our custom theme and reproduce/reimagine Figure 15.1.a.</p>
<div class="sourceCode" id="cb1951"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1951-1"><a href="missing-data-and-other-opportunities.html#cb1951-1" aria-hidden="true" tabindex="-1"></a>color <span class="ot">&lt;-</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">7</span>]</span>
<span id="cb1951-2"><a href="missing-data-and-other-opportunities.html#cb1951-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1951-3"><a href="missing-data-and-other-opportunities.html#cb1951-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1951-4"><a href="missing-data-and-other-opportunities.html#cb1951-4" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span></span>
<span id="cb1951-5"><a href="missing-data-and-other-opportunities.html#cb1951-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> MedianAgeMarriage, </span>
<span id="cb1951-6"><a href="missing-data-and-other-opportunities.html#cb1951-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> Divorce,</span>
<span id="cb1951-7"><a href="missing-data-and-other-opportunities.html#cb1951-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymin =</span> Divorce <span class="sc">-</span> Divorce.SE, </span>
<span id="cb1951-8"><a href="missing-data-and-other-opportunities.html#cb1951-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymax =</span> Divorce <span class="sc">+</span> Divorce.SE)) <span class="sc">+</span></span>
<span id="cb1951-9"><a href="missing-data-and-other-opportunities.html#cb1951-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">shape =</span> <span class="dv">20</span>, <span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">color =</span> color) <span class="sc">+</span></span>
<span id="cb1951-10"><a href="missing-data-and-other-opportunities.html#cb1951-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Median age marriage&quot;</span> , </span>
<span id="cb1951-11"><a href="missing-data-and-other-opportunities.html#cb1951-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Divorce rate&quot;</span>)</span></code></pre></div>
<p>Notice how <code>viridis_pal(option = "C")(7)[7]</code> called the seventh color in the color scheme, <code>"#F0F921FF"</code>. For Figure 15.1.b, we’ll select the sixth color in the palette by coding <code>viridis_pal(option = "C")(7)[6]</code>. We’ll then combine the two subplots with <strong>patchwork</strong>.</p>
<div class="sourceCode" id="cb1952"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1952-1"><a href="missing-data-and-other-opportunities.html#cb1952-1" aria-hidden="true" tabindex="-1"></a>color <span class="ot">&lt;-</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">6</span>]</span>
<span id="cb1952-2"><a href="missing-data-and-other-opportunities.html#cb1952-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1952-3"><a href="missing-data-and-other-opportunities.html#cb1952-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1952-4"><a href="missing-data-and-other-opportunities.html#cb1952-4" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span></span>
<span id="cb1952-5"><a href="missing-data-and-other-opportunities.html#cb1952-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(Population), </span>
<span id="cb1952-6"><a href="missing-data-and-other-opportunities.html#cb1952-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> Divorce,</span>
<span id="cb1952-7"><a href="missing-data-and-other-opportunities.html#cb1952-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymin =</span> Divorce <span class="sc">-</span> Divorce.SE, </span>
<span id="cb1952-8"><a href="missing-data-and-other-opportunities.html#cb1952-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">ymax =</span> Divorce <span class="sc">+</span> Divorce.SE)) <span class="sc">+</span></span>
<span id="cb1952-9"><a href="missing-data-and-other-opportunities.html#cb1952-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">shape =</span> <span class="dv">20</span>, <span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">color =</span> color) <span class="sc">+</span></span>
<span id="cb1952-10"><a href="missing-data-and-other-opportunities.html#cb1952-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1952-11"><a href="missing-data-and-other-opportunities.html#cb1952-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;log population&quot;</span>)</span>
<span id="cb1952-12"><a href="missing-data-and-other-opportunities.html#cb1952-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1952-13"><a href="missing-data-and-other-opportunities.html#cb1952-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb1952-14"><a href="missing-data-and-other-opportunities.html#cb1952-14" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-20-1.png" width="696" style="display: block; margin: auto;" /></p>
<p>Just like in the text, our plot shows states with larger populations tend to have smaller measurement error. The relation between measurement error and <code>MedianAgeMarriage</code> is less apparent.</p>
<div id="rethinking-generative-thinking-bayesian-inference." class="section level4 hasAnchor" number="15.1.0.1">
<h4><span class="header-section-number">15.1.0.1</span> Rethinking: Generative thinking, Bayesian inference.<a href="missing-data-and-other-opportunities.html#rethinking-generative-thinking-bayesian-inference." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Bayesian models are <em>generative</em>, meaning they can be used to simulate observations just as well as they can be used to estimate parameters. One benefit of this fact is that a statistical model can be developed by thinking hard about how the data might have arisen. This includes sampling and measurement, as well as the nature of the process we are studying. Then let Bayesian updating discover the implications. (p. 491, <em>emphasis</em> in the original)</p>
</blockquote>
</div>
<div id="error-on-the-outcome." class="section level3 hasAnchor" number="15.1.1">
<h3><span class="header-section-number">15.1.1</span> Error on the outcome.<a href="missing-data-and-other-opportunities.html#error-on-the-outcome." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now make a DAG of our data with <strong>ggdag</strong>.</p>
<div class="sourceCode" id="cb1953"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1953-1"><a href="missing-data-and-other-opportunities.html#cb1953-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdag)</span>
<span id="cb1953-2"><a href="missing-data-and-other-opportunities.html#cb1953-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1953-3"><a href="missing-data-and-other-opportunities.html#cb1953-3" aria-hidden="true" tabindex="-1"></a>dag_coords <span class="ot">&lt;-</span></span>
<span id="cb1953-4"><a href="missing-data-and-other-opportunities.html#cb1953-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;Dobs&quot;</span>, <span class="st">&quot;eD&quot;</span>),</span>
<span id="cb1953-5"><a href="missing-data-and-other-opportunities.html#cb1953-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">x    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb1953-6"><a href="missing-data-and-other-opportunities.html#cb1953-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb1953-7"><a href="missing-data-and-other-opportunities.html#cb1953-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1953-8"><a href="missing-data-and-other-opportunities.html#cb1953-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dagify</span>(M    <span class="sc">~</span> A,</span>
<span id="cb1953-9"><a href="missing-data-and-other-opportunities.html#cb1953-9" aria-hidden="true" tabindex="-1"></a>       D    <span class="sc">~</span> A <span class="sc">+</span> M,</span>
<span id="cb1953-10"><a href="missing-data-and-other-opportunities.html#cb1953-10" aria-hidden="true" tabindex="-1"></a>       Dobs <span class="sc">~</span> D <span class="sc">+</span> eD,</span>
<span id="cb1953-11"><a href="missing-data-and-other-opportunities.html#cb1953-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">coords =</span> dag_coords) <span class="sc">%&gt;%</span></span>
<span id="cb1953-12"><a href="missing-data-and-other-opportunities.html#cb1953-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1953-13"><a href="missing-data-and-other-opportunities.html#cb1953-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;D&quot;</span>, <span class="st">&quot;eD&quot;</span>), <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1953-14"><a href="missing-data-and-other-opportunities.html#cb1953-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1953-15"><a href="missing-data-and-other-opportunities.html#cb1953-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb1953-16"><a href="missing-data-and-other-opportunities.html#cb1953-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> color),</span>
<span id="cb1953-17"><a href="missing-data-and-other-opportunities.html#cb1953-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">7</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb1953-18"><a href="missing-data-and-other-opportunities.html#cb1953-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>(<span class="at">parse =</span> T, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="fu">expression</span>(<span class="fu">italic</span>(e)[D]), <span class="fu">expression</span>(D[obs]))) <span class="sc">+</span></span>
<span id="cb1953-19"><a href="missing-data-and-other-opportunities.html#cb1953-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">edge_colour =</span> <span class="st">&quot;#FCF9F0&quot;</span>) <span class="sc">+</span></span>
<span id="cb1953-20"><a href="missing-data-and-other-opportunities.html#cb1953-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">2</span>], <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1953-21"><a href="missing-data-and-other-opportunities.html#cb1953-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dark_theme_void</span>()</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-21-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>Note our use of the <code>dark_theme_void()</code> function. But more to the substance of the matter,</p>
<blockquote>
<p>there’s a lot going on here. But we can proceed one step at a time. The left triangle of this DAG is the same system that we worked with back in <a href="the-many-variables-the-spurious-waffles.html#think-before-you-regress.">Chapter 5</a>. Age at marriage (<span class="math inline">\(A\)</span>) influences divorce (<span class="math inline">\(D\)</span>) both directly and indirectly, passing through marriage rate (<span class="math inline">\(M\)</span>). Then we have the observation model. The true divorce rate <span class="math inline">\(D\)</span> cannot be observed, so it is circled as an unobserved node. However we do get to observe <span class="math inline">\(D_\text{obs}\)</span>, which is a function of both the true rate <span class="math inline">\(D\)</span> and some unobserved error <span class="math inline">\(e_\text{D}\)</span>. (p. 492)</p>
</blockquote>
<p>To get a better sense of what we’re about to do, imagine for a moment that each state’s divorce rate is normally distributed with a mean of <code>Divorce</code> and standard deviation <code>Divorce.SE</code>. Those distributions would be like this.</p>
<div class="sourceCode" id="cb1954"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1954-1"><a href="missing-data-and-other-opportunities.html#cb1954-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb1954-2"><a href="missing-data-and-other-opportunities.html#cb1954-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Divorce_distribution =</span> <span class="fu">str_c</span>(<span class="st">&quot;Divorce ~ Normal(&quot;</span>, Divorce, <span class="st">&quot;, &quot;</span>, Divorce.SE, <span class="st">&quot;)&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1954-3"><a href="missing-data-and-other-opportunities.html#cb1954-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Loc, Divorce_distribution) <span class="sc">%&gt;%</span> </span>
<span id="cb1954-4"><a href="missing-data-and-other-opportunities.html#cb1954-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##   Loc         Divorce_distribution
## 1  AL Divorce ~ Normal(12.7, 0.79)
## 2  AK Divorce ~ Normal(12.5, 2.05)
## 3  AZ Divorce ~ Normal(10.8, 0.74)
## 4  AR Divorce ~ Normal(13.5, 1.22)
## 5  CA    Divorce ~ Normal(8, 0.24)
## 6  CO Divorce ~ Normal(11.6, 0.94)</code></pre>
<blockquote>
<p>Here’s how to define the error distribution for each divorce rate. For each observed value <span class="math inline">\(D_{\text{OBS},i}\)</span>, there will be one parameter, <span class="math inline">\(D_{\text{TRUE},i}\)</span>, defined by:</p>
<p><span class="math display">\[D_{\text{OBS},i} \sim \operatorname{Normal}(D_{\text{TRUE},i}, D_{\text{SE},i})\]</span></p>
<p>All this does is define the measurement <span class="math inline">\(D_{\text{OBS},i}\)</span> as having the specified Gaussian distribution centered on the unknown parameter <span class="math inline">\(D_{\text{TRUE},i}\)</span>. So the above defines a probability for each State <span class="math inline">\(i\)</span>’s observed divorce rate, given a known measurement error. (p. 493)</p>
</blockquote>
<p>Our model will follow the form</p>
<p><span class="math display">\[\begin{align*}
\color{#5D01A6FF}{\text{Divorce}_{\text{OBS}, i}} &amp; \color{#5D01A6FF}\sim \color{#5D01A6FF}{\operatorname{Normal}(\text{Divorce}_{\text{TRUE}, i}, \text{Divorce}_{\text{SE}, i})} \\
\color{#5D01A6FF}{\text{Divorce}_{\text{TRUE}, i}} &amp; \sim \operatorname{Normal}(\mu_i, \sigma) \\
\mu     &amp; = \alpha + \beta_1 \text A_i + \beta_2 \text M_i \\
\alpha  &amp; \sim \operatorname{Normal}(0, 0.2) \\
\beta_1 &amp; \sim \operatorname{Normal}(0, 0.5) \\
\beta_2 &amp; \sim \operatorname{Normal}(0, 0.5) \\
\sigma  &amp; \sim \operatorname{Exponential}(1).
\end{align*}\]</span></p>
<p>Fire up <strong>brms</strong>.</p>
<div class="sourceCode" id="cb1956"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1956-1"><a href="missing-data-and-other-opportunities.html#cb1956-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span></code></pre></div>
<p>With <strong>brms</strong>, we accommodate measurement error in the criterion using the <code>mi()</code> syntax, following the general form <code>&lt;response&gt; | mi(&lt;se_response&gt;)</code>. This follows a missing data logic, resulting in Bayesian missing data imputation for the criterion values. The <code>mi()</code> syntax is based on the missing data capabilities for <strong>brms</strong>, which we will cover in greater detail in the second half of this chapter.</p>
<div class="sourceCode" id="cb1957"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1957-1"><a href="missing-data-and-other-opportunities.html#cb1957-1" aria-hidden="true" tabindex="-1"></a><span class="co"># put the data into a `list()`</span></span>
<span id="cb1957-2"><a href="missing-data-and-other-opportunities.html#cb1957-2" aria-hidden="true" tabindex="-1"></a>dlist <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1957-3"><a href="missing-data-and-other-opportunities.html#cb1957-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">D_obs =</span> d<span class="sc">$</span>D_obs,</span>
<span id="cb1957-4"><a href="missing-data-and-other-opportunities.html#cb1957-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">D_sd  =</span> d<span class="sc">$</span>D_sd,</span>
<span id="cb1957-5"><a href="missing-data-and-other-opportunities.html#cb1957-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">M     =</span> d<span class="sc">$</span>M,</span>
<span id="cb1957-6"><a href="missing-data-and-other-opportunities.html#cb1957-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">A     =</span> d<span class="sc">$</span>A)</span>
<span id="cb1957-7"><a href="missing-data-and-other-opportunities.html#cb1957-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1957-8"><a href="missing-data-and-other-opportunities.html#cb1957-8" aria-hidden="true" tabindex="-1"></a>b15<span class="fl">.1</span> <span class="ot">&lt;-</span> </span>
<span id="cb1957-9"><a href="missing-data-and-other-opportunities.html#cb1957-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> dlist, </span>
<span id="cb1957-10"><a href="missing-data-and-other-opportunities.html#cb1957-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb1957-11"><a href="missing-data-and-other-opportunities.html#cb1957-11" aria-hidden="true" tabindex="-1"></a>      D_obs <span class="sc">|</span> <span class="fu">mi</span>(D_sd) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> A <span class="sc">+</span> M,</span>
<span id="cb1957-12"><a href="missing-data-and-other-opportunities.html#cb1957-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1957-13"><a href="missing-data-and-other-opportunities.html#cb1957-13" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b),</span>
<span id="cb1957-14"><a href="missing-data-and-other-opportunities.html#cb1957-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb1957-15"><a href="missing-data-and-other-opportunities.html#cb1957-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1957-16"><a href="missing-data-and-other-opportunities.html#cb1957-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">15</span>,</span>
<span id="cb1957-17"><a href="missing-data-and-other-opportunities.html#cb1957-17" aria-hidden="true" tabindex="-1"></a>      <span class="co"># note this line</span></span>
<span id="cb1957-18"><a href="missing-data-and-other-opportunities.html#cb1957-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">latent =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1957-19"><a href="missing-data-and-other-opportunities.html#cb1957-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/b15.01&quot;</span>)</span></code></pre></div>
<p>Check the model summary.</p>
<div class="sourceCode" id="cb1958"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1958-1"><a href="missing-data-and-other-opportunities.html#cb1958-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b15<span class="fl">.1</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: D_obs | mi(D_sd) ~ 1 + A + M 
##    Data: dlist (Number of observations: 50) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    -0.06      0.10    -0.25     0.13 1.00     5458     3312
## A            -0.62      0.16    -0.92    -0.31 1.00     3883     3367
## M             0.05      0.17    -0.28     0.37 1.00     3443     3102
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     0.59      0.11     0.40     0.82 1.00     1654     2060
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>To return the summaries for the <code>D_true[i]</code> parameters, you might execute <code>posterior_summary(b15.1)</code> or <code>b15.1$fit</code>.</p>
<div class="sourceCode" id="cb1960"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1960-1"><a href="missing-data-and-other-opportunities.html#cb1960-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b15<span class="fl">.1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1960-2"><a href="missing-data-and-other-opportunities.html#cb1960-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1960-3"><a href="missing-data-and-other-opportunities.html#cb1960-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>()</span></code></pre></div>
<pre><code>##             Estimate Est.Error   Q2.5  Q97.5
## b_Intercept    -0.06      0.10  -0.25   0.13
## b_A            -0.62      0.16  -0.92  -0.31
## b_M             0.05      0.17  -0.28   0.37
## sigma           0.59      0.11   0.40   0.82
## Yl[1]           1.17      0.37   0.49   1.90
## Yl[2]           0.68      0.54  -0.36   1.75
## Yl[3]           0.43      0.33  -0.22   1.09
## Yl[4]           1.40      0.45   0.54   2.30
## Yl[5]          -0.90      0.13  -1.15  -0.65
## Yl[6]           0.65      0.40  -0.13   1.41
## Yl[7]          -1.37      0.36  -2.10  -0.68
## Yl[8]          -0.34      0.48  -1.29   0.56
## Yl[9]          -1.89      0.60  -3.05  -0.69
## Yl[10]         -0.62      0.16  -0.94  -0.30
## Yl[11]          0.77      0.28   0.21   1.33
## Yl[12]         -0.56      0.48  -1.53   0.35
## Yl[13]          0.17      0.50  -0.81   1.15
## Yl[14]         -0.87      0.23  -1.33  -0.42
## Yl[15]          0.55      0.29  -0.01   1.14
## Yl[16]          0.28      0.38  -0.48   1.05
## Yl[17]          0.50      0.42  -0.34   1.30
## Yl[18]          1.26      0.35   0.59   1.93
## Yl[19]          0.43      0.37  -0.28   1.15
## Yl[20]          0.39      0.53  -0.58   1.45
## Yl[21]         -0.55      0.31  -1.14   0.05
## Yl[22]         -1.11      0.26  -1.62  -0.59
## Yl[23]         -0.27      0.26  -0.77   0.23
## Yl[24]         -1.00      0.30  -1.60  -0.41
## Yl[25]          0.43      0.41  -0.36   1.25
## Yl[26]         -0.03      0.32  -0.65   0.59
## Yl[27]         -0.02      0.52  -1.06   1.03
## Yl[28]         -0.15      0.40  -0.96   0.61
## Yl[29]         -0.26      0.50  -1.19   0.75
## Yl[30]         -1.80      0.23  -2.26  -1.33
## Yl[31]          0.16      0.43  -0.68   1.02
## Yl[32]         -1.66      0.16  -1.99  -1.34
## Yl[33]          0.12      0.24  -0.36   0.59
## Yl[34]         -0.06      0.51  -1.08   0.90
## Yl[35]         -0.13      0.23  -0.58   0.33
## Yl[36]          1.28      0.42   0.46   2.15
## Yl[37]          0.23      0.35  -0.44   0.92
## Yl[38]         -1.03      0.22  -1.45  -0.60
## Yl[39]         -0.91      0.54  -1.95   0.18
## Yl[40]         -0.68      0.33  -1.33  -0.03
## Yl[41]          0.24      0.56  -0.86   1.37
## Yl[42]          0.74      0.35   0.06   1.45
## Yl[43]          0.19      0.18  -0.17   0.56
## Yl[44]          0.80      0.42  -0.03   1.60
## Yl[45]         -0.40      0.51  -1.37   0.63
## Yl[46]         -0.39      0.26  -0.91   0.12
## Yl[47]          0.13      0.30  -0.46   0.71
## Yl[48]          0.56      0.47  -0.35   1.49
## Yl[49]         -0.64      0.28  -1.19  -0.11
## Yl[50]          0.86      0.58  -0.30   1.99
## lprior         -1.37      0.46  -2.47  -0.73
## lp__          -78.16      6.55 -91.61 -66.09</code></pre>
<p>Our rows <code>Yl[1]</code> through <code>Yl[50]</code> correspond to what <strong>rethinking</strong> named <code>D_true[1]</code> through <code>D_true[50]</code>. Here’s the code for our Figure 15.2.a.</p>
<div class="sourceCode" id="cb1962"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1962-1"><a href="missing-data-and-other-opportunities.html#cb1962-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1962-2"><a href="missing-data-and-other-opportunities.html#cb1962-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1962-3"><a href="missing-data-and-other-opportunities.html#cb1962-3" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;AL&quot;</span>, <span class="st">&quot;AR&quot;</span>, <span class="st">&quot;ME&quot;</span>, <span class="st">&quot;NH&quot;</span>, <span class="st">&quot;RI&quot;</span>, <span class="st">&quot;DC&quot;</span>, <span class="st">&quot;VT&quot;</span>, <span class="st">&quot;AK&quot;</span>, <span class="st">&quot;SD&quot;</span>, <span class="st">&quot;UT&quot;</span>, <span class="st">&quot;ID&quot;</span>, <span class="st">&quot;ND&quot;</span>, <span class="st">&quot;WY&quot;</span>)</span>
<span id="cb1962-4"><a href="missing-data-and-other-opportunities.html#cb1962-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1962-5"><a href="missing-data-and-other-opportunities.html#cb1962-5" aria-hidden="true" tabindex="-1"></a>d_est <span class="ot">&lt;-</span></span>
<span id="cb1962-6"><a href="missing-data-and-other-opportunities.html#cb1962-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">posterior_summary</span>(b15<span class="fl">.1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1962-7"><a href="missing-data-and-other-opportunities.html#cb1962-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1962-8"><a href="missing-data-and-other-opportunities.html#cb1962-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1962-9"><a href="missing-data-and-other-opportunities.html#cb1962-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">D_est =</span> Estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb1962-10"><a href="missing-data-and-other-opportunities.html#cb1962-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, D_est) <span class="sc">%&gt;%</span> </span>
<span id="cb1962-11"><a href="missing-data-and-other-opportunities.html#cb1962-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(term, <span class="st">&quot;Yl&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1962-12"><a href="missing-data-and-other-opportunities.html#cb1962-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(d)</span>
<span id="cb1962-13"><a href="missing-data-and-other-opportunities.html#cb1962-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1962-14"><a href="missing-data-and-other-opportunities.html#cb1962-14" aria-hidden="true" tabindex="-1"></a>color <span class="ot">&lt;-</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">5</span>]</span>
<span id="cb1962-15"><a href="missing-data-and-other-opportunities.html#cb1962-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1962-16"><a href="missing-data-and-other-opportunities.html#cb1962-16" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1962-17"><a href="missing-data-and-other-opportunities.html#cb1962-17" aria-hidden="true" tabindex="-1"></a>  d_est <span class="sc">%&gt;%</span></span>
<span id="cb1962-18"><a href="missing-data-and-other-opportunities.html#cb1962-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> D_sd, <span class="at">y =</span> D_est <span class="sc">-</span> D_obs)) <span class="sc">+</span></span>
<span id="cb1962-19"><a href="missing-data-and-other-opportunities.html#cb1962-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb1962-20"><a href="missing-data-and-other-opportunities.html#cb1962-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">color =</span> color) <span class="sc">+</span></span>
<span id="cb1962-21"><a href="missing-data-and-other-opportunities.html#cb1962-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Loc <span class="sc">%in%</span> states),  </span>
<span id="cb1962-22"><a href="missing-data-and-other-opportunities.html#cb1962-22" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">label =</span> Loc), </span>
<span id="cb1962-23"><a href="missing-data-and-other-opportunities.html#cb1962-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">3</span>, <span class="at">seed =</span> <span class="dv">15</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) </span></code></pre></div>
<p>We’ll use a little <code>as_draws_df()</code> + <code>expand()</code> magic to help with our version of Figure 15.2.b.</p>
<div class="sourceCode" id="cb1963"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1963-1"><a href="missing-data-and-other-opportunities.html#cb1963-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb1963-2"><a href="missing-data-and-other-opportunities.html#cb1963-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1963-3"><a href="missing-data-and-other-opportunities.html#cb1963-3" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;AR&quot;</span>, <span class="st">&quot;ME&quot;</span>, <span class="st">&quot;RI&quot;</span>, <span class="st">&quot;ID&quot;</span>, <span class="st">&quot;WY&quot;</span>, <span class="st">&quot;ND&quot;</span>, <span class="st">&quot;MN&quot;</span>)</span>
<span id="cb1963-4"><a href="missing-data-and-other-opportunities.html#cb1963-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1963-5"><a href="missing-data-and-other-opportunities.html#cb1963-5" aria-hidden="true" tabindex="-1"></a>color <span class="ot">&lt;-</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">4</span>]</span>
<span id="cb1963-6"><a href="missing-data-and-other-opportunities.html#cb1963-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1963-7"><a href="missing-data-and-other-opportunities.html#cb1963-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1963-8"><a href="missing-data-and-other-opportunities.html#cb1963-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_draws_df</span>(b15<span class="fl">.1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1963-9"><a href="missing-data-and-other-opportunities.html#cb1963-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand</span>(<span class="fu">nesting</span>(b_Intercept, b_A),</span>
<span id="cb1963-10"><a href="missing-data-and-other-opportunities.html#cb1963-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">A =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="fl">3.5</span>, <span class="at">to =</span> <span class="fl">3.5</span>, <span class="at">length.out =</span> <span class="dv">50</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1963-11"><a href="missing-data-and-other-opportunities.html#cb1963-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fitted =</span> b_Intercept <span class="sc">+</span> b_A <span class="sc">*</span> A) <span class="sc">%&gt;%</span> </span>
<span id="cb1963-12"><a href="missing-data-and-other-opportunities.html#cb1963-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1963-13"><a href="missing-data-and-other-opportunities.html#cb1963-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> A)) <span class="sc">+</span></span>
<span id="cb1963-14"><a href="missing-data-and-other-opportunities.html#cb1963-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_lineribbon</span>(<span class="fu">aes</span>(<span class="at">y =</span> fitted),</span>
<span id="cb1963-15"><a href="missing-data-and-other-opportunities.html#cb1963-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">.width =</span> .<span class="dv">95</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;grey20&quot;</span>) <span class="sc">+</span></span>
<span id="cb1963-16"><a href="missing-data-and-other-opportunities.html#cb1963-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> d_est,</span>
<span id="cb1963-17"><a href="missing-data-and-other-opportunities.html#cb1963-17" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">xend =</span> A,</span>
<span id="cb1963-18"><a href="missing-data-and-other-opportunities.html#cb1963-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> D_obs, <span class="at">yend =</span> D_est),</span>
<span id="cb1963-19"><a href="missing-data-and-other-opportunities.html#cb1963-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb1963-20"><a href="missing-data-and-other-opportunities.html#cb1963-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> d_est,</span>
<span id="cb1963-21"><a href="missing-data-and-other-opportunities.html#cb1963-21" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> D_obs),</span>
<span id="cb1963-22"><a href="missing-data-and-other-opportunities.html#cb1963-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> color) <span class="sc">+</span></span>
<span id="cb1963-23"><a href="missing-data-and-other-opportunities.html#cb1963-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> d_est,</span>
<span id="cb1963-24"><a href="missing-data-and-other-opportunities.html#cb1963-24" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> D_est),</span>
<span id="cb1963-25"><a href="missing-data-and-other-opportunities.html#cb1963-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">stroke =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1963-26"><a href="missing-data-and-other-opportunities.html#cb1963-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Loc <span class="sc">%in%</span> states),  </span>
<span id="cb1963-27"><a href="missing-data-and-other-opportunities.html#cb1963-27" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">aes</span>(<span class="at">y =</span> D_obs, <span class="at">label =</span> Loc), </span>
<span id="cb1963-28"><a href="missing-data-and-other-opportunities.html#cb1963-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="dv">3</span>, <span class="at">seed =</span> <span class="dv">15</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb1963-29"><a href="missing-data-and-other-opportunities.html#cb1963-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;median age marriage (std)&quot;</span>,</span>
<span id="cb1963-30"><a href="missing-data-and-other-opportunities.html#cb1963-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;divorce rate (std)&quot;</span>) <span class="sc">+</span></span>
<span id="cb1963-31"><a href="missing-data-and-other-opportunities.html#cb1963-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(d<span class="sc">$</span>A), </span>
<span id="cb1963-32"><a href="missing-data-and-other-opportunities.html#cb1963-32" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">range</span>(d<span class="sc">$</span>D_obs))</span></code></pre></div>
<p>Now combine the two ggplots and plot.</p>
<div class="sourceCode" id="cb1964"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1964-1"><a href="missing-data-and-other-opportunities.html#cb1964-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-28-1.png" width="720" style="display: block; margin: auto;" /></p>
<p>If you look closely, our plot on the left is flipped relative to the one in the text. I’m pretty sure my code is correct, which leaves me to believe McElreath accidentally flipped the ordering in his code and made his <span class="math inline">\(y\)</span>-axis ‘D_obs - D_est.’ Happily, our plot on the right matches up nicely with the one in the text.</p>
</div>
<div id="error-on-both-outcome-and-predictor." class="section level3 hasAnchor" number="15.1.2">
<h3><span class="header-section-number">15.1.2</span> Error on both outcome and predictor.<a href="missing-data-and-other-opportunities.html#error-on-both-outcome-and-predictor." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now we update the DAG to account for measurement error in the predictor.</p>
<div class="sourceCode" id="cb1965"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1965-1"><a href="missing-data-and-other-opportunities.html#cb1965-1" aria-hidden="true" tabindex="-1"></a>dag_coords <span class="ot">&lt;-</span></span>
<span id="cb1965-2"><a href="missing-data-and-other-opportunities.html#cb1965-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;Mobs&quot;</span>, <span class="st">&quot;eM&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;Dobs&quot;</span>, <span class="st">&quot;eD&quot;</span>),</span>
<span id="cb1965-3"><a href="missing-data-and-other-opportunities.html#cb1965-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">x    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb1965-4"><a href="missing-data-and-other-opportunities.html#cb1965-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb1965-5"><a href="missing-data-and-other-opportunities.html#cb1965-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1965-6"><a href="missing-data-and-other-opportunities.html#cb1965-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dagify</span>(M    <span class="sc">~</span> A,</span>
<span id="cb1965-7"><a href="missing-data-and-other-opportunities.html#cb1965-7" aria-hidden="true" tabindex="-1"></a>       D    <span class="sc">~</span> A <span class="sc">+</span> M,</span>
<span id="cb1965-8"><a href="missing-data-and-other-opportunities.html#cb1965-8" aria-hidden="true" tabindex="-1"></a>       Mobs <span class="sc">~</span> M <span class="sc">+</span> eM,</span>
<span id="cb1965-9"><a href="missing-data-and-other-opportunities.html#cb1965-9" aria-hidden="true" tabindex="-1"></a>       Dobs <span class="sc">~</span> D <span class="sc">+</span> eD,</span>
<span id="cb1965-10"><a href="missing-data-and-other-opportunities.html#cb1965-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">coords =</span> dag_coords) <span class="sc">%&gt;%</span></span>
<span id="cb1965-11"><a href="missing-data-and-other-opportunities.html#cb1965-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1965-12"><a href="missing-data-and-other-opportunities.html#cb1965-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;Mobs&quot;</span>, <span class="st">&quot;Dobs&quot;</span>), <span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1965-13"><a href="missing-data-and-other-opportunities.html#cb1965-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1965-14"><a href="missing-data-and-other-opportunities.html#cb1965-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb1965-15"><a href="missing-data-and-other-opportunities.html#cb1965-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> color),</span>
<span id="cb1965-16"><a href="missing-data-and-other-opportunities.html#cb1965-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">7</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb1965-17"><a href="missing-data-and-other-opportunities.html#cb1965-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>(<span class="at">parse =</span> T, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;M&quot;</span>, </span>
<span id="cb1965-18"><a href="missing-data-and-other-opportunities.html#cb1965-18" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">expression</span>(<span class="fu">italic</span>(e)[D]), <span class="fu">expression</span>(<span class="fu">italic</span>(e)[M]), </span>
<span id="cb1965-19"><a href="missing-data-and-other-opportunities.html#cb1965-19" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">expression</span>(D[obs]), <span class="fu">expression</span>(M[obs]))) <span class="sc">+</span></span>
<span id="cb1965-20"><a href="missing-data-and-other-opportunities.html#cb1965-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">edge_colour =</span> <span class="st">&quot;#FCF9F0&quot;</span>) <span class="sc">+</span></span>
<span id="cb1965-21"><a href="missing-data-and-other-opportunities.html#cb1965-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">2</span>], <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1965-22"><a href="missing-data-and-other-opportunities.html#cb1965-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dark_theme_void</span>()</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-29-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>We will express this DAG in an augmented statistical model following the form</p>
<p><span class="math display">\[\begin{align*}
\text{Divorce}_{\text{OBS}, i}  &amp; \sim \operatorname{Normal}(\text{Divorce}_{\text{TRUE}, i}, \text{Divorce}_{\text{SE}, i}) \\
\text{Divorce}_{\text{TRUE}, i} &amp; \sim \operatorname{Normal}(\mu_i, \sigma) \\
\mu_i &amp; = \alpha + \beta_1 \text A_i + \beta_2 \color{#5D01A6FF}{\text{Marriage}_{\text{TRUE}, i}} \\
\color{#5D01A6FF}{\text{Marriage}_{\text{OBS}, i}} &amp; \color{#5D01A6FF}\sim \color{#5D01A6FF}{\operatorname{Normal}(\text{Marriage}_{\text{TRUE}, i}, \text{Marriage}_{\text{SE}, i})} \\
\color{#5D01A6FF}{\text{Marriage}_{\text{TRUE}, i}} &amp; \color{#5D01A6FF}\sim \color{#5D01A6FF}{\operatorname{Normal}(0, 1)} \\
\alpha  &amp; \sim \operatorname{Normal}(0, 0.2) \\
\beta_1 &amp; \sim \operatorname{Normal}(0, 0.5) \\
\beta_2 &amp; \sim \operatorname{Normal}(0, 0.5) \\
\sigma  &amp; \sim \operatorname{Exponential}(1).
\end{align*}\]</span></p>
<p>The current version <strong>brms</strong> allows users to specify error on predictors with an <code>me()</code> statement in the form of <code>me(predictor, sd_predictor)</code> where <code>sd_predictor</code> is a vector in the data denoting the size of the measurement error, presumed to be in a standard-deviation metric.</p>
<div class="sourceCode" id="cb1966"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1966-1"><a href="missing-data-and-other-opportunities.html#cb1966-1" aria-hidden="true" tabindex="-1"></a><span class="co"># put the data into a `list()`</span></span>
<span id="cb1966-2"><a href="missing-data-and-other-opportunities.html#cb1966-2" aria-hidden="true" tabindex="-1"></a>dlist <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1966-3"><a href="missing-data-and-other-opportunities.html#cb1966-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">D_obs =</span> d<span class="sc">$</span>D_obs,</span>
<span id="cb1966-4"><a href="missing-data-and-other-opportunities.html#cb1966-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">D_sd  =</span> d<span class="sc">$</span>D_sd,</span>
<span id="cb1966-5"><a href="missing-data-and-other-opportunities.html#cb1966-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">M_obs =</span> d<span class="sc">$</span>M_obs,</span>
<span id="cb1966-6"><a href="missing-data-and-other-opportunities.html#cb1966-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">M_sd  =</span> d<span class="sc">$</span>M_sd,</span>
<span id="cb1966-7"><a href="missing-data-and-other-opportunities.html#cb1966-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">A     =</span> d<span class="sc">$</span>A)</span>
<span id="cb1966-8"><a href="missing-data-and-other-opportunities.html#cb1966-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1966-9"><a href="missing-data-and-other-opportunities.html#cb1966-9" aria-hidden="true" tabindex="-1"></a>b15<span class="fl">.2</span> <span class="ot">&lt;-</span> </span>
<span id="cb1966-10"><a href="missing-data-and-other-opportunities.html#cb1966-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> dlist, </span>
<span id="cb1966-11"><a href="missing-data-and-other-opportunities.html#cb1966-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb1966-12"><a href="missing-data-and-other-opportunities.html#cb1966-12" aria-hidden="true" tabindex="-1"></a>      D_obs <span class="sc">|</span> <span class="fu">mi</span>(D_sd) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> A <span class="sc">+</span> <span class="fu">me</span>(M_obs, M_sd),</span>
<span id="cb1966-13"><a href="missing-data-and-other-opportunities.html#cb1966-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1966-14"><a href="missing-data-and-other-opportunities.html#cb1966-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b),</span>
<span id="cb1966-15"><a href="missing-data-and-other-opportunities.html#cb1966-15" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> meanme),</span>
<span id="cb1966-16"><a href="missing-data-and-other-opportunities.html#cb1966-16" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb1966-17"><a href="missing-data-and-other-opportunities.html#cb1966-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1966-18"><a href="missing-data-and-other-opportunities.html#cb1966-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">15</span>,</span>
<span id="cb1966-19"><a href="missing-data-and-other-opportunities.html#cb1966-19" aria-hidden="true" tabindex="-1"></a>      <span class="co"># note this line</span></span>
<span id="cb1966-20"><a href="missing-data-and-other-opportunities.html#cb1966-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">latent =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1966-21"><a href="missing-data-and-other-opportunities.html#cb1966-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/b15.02&quot;</span>)</span></code></pre></div>
<p>We’ll use <code>posterior_summary()</code>, again, to get a sense of those <code>depth=2</code> summaries.</p>
<div class="sourceCode" id="cb1967"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1967-1"><a href="missing-data-and-other-opportunities.html#cb1967-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b15<span class="fl">.2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1967-2"><a href="missing-data-and-other-opportunities.html#cb1967-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>Due to space concerns, I’m not going to show the results, here. You can do that on your own. Basically, now in addition to the posterior summaries for the <code>Yl[i]</code> parameters (what McElreath called <span class="math inline">\(D_{\text{TRUE}, i}\)</span>), we now get posterior summaries for <code>Xme_meM_obs[i]</code> (what McElreath called <span class="math inline">\(M_{\text{TRUE}, i}\)</span>). Note that you’ll need to specify <code>save_pars = save_pars(latent = TRUE)</code> in the <code>brm()</code> function in order to save the posterior samples of error-adjusted variables obtained by using the <code>me()</code> argument. Without doing so, functions like <code>predict()</code> may give you trouble. Here’s our version of Figure 15.3.</p>
<div class="sourceCode" id="cb1968"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1968-1"><a href="missing-data-and-other-opportunities.html#cb1968-1" aria-hidden="true" tabindex="-1"></a>color_y <span class="ot">&lt;-</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">7</span>]</span>
<span id="cb1968-2"><a href="missing-data-and-other-opportunities.html#cb1968-2" aria-hidden="true" tabindex="-1"></a>color_p <span class="ot">&lt;-</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">2</span>]</span>
<span id="cb1968-3"><a href="missing-data-and-other-opportunities.html#cb1968-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1968-4"><a href="missing-data-and-other-opportunities.html#cb1968-4" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb1968-5"><a href="missing-data-and-other-opportunities.html#cb1968-5" aria-hidden="true" tabindex="-1"></a><span class="fu">full_join</span>(</span>
<span id="cb1968-6"><a href="missing-data-and-other-opportunities.html#cb1968-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># D</span></span>
<span id="cb1968-7"><a href="missing-data-and-other-opportunities.html#cb1968-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">Loc   =</span> d <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Loc),</span>
<span id="cb1968-8"><a href="missing-data-and-other-opportunities.html#cb1968-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">D_obs =</span> d <span class="sc">%&gt;%</span> <span class="fu">pull</span>(D_obs),</span>
<span id="cb1968-9"><a href="missing-data-and-other-opportunities.html#cb1968-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">D_est =</span> <span class="fu">posterior_summary</span>(b15<span class="fl">.2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1968-10"><a href="missing-data-and-other-opportunities.html#cb1968-10" aria-hidden="true" tabindex="-1"></a>           <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1968-11"><a href="missing-data-and-other-opportunities.html#cb1968-11" aria-hidden="true" tabindex="-1"></a>           <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1968-12"><a href="missing-data-and-other-opportunities.html#cb1968-12" aria-hidden="true" tabindex="-1"></a>           <span class="fu">filter</span>(<span class="fu">str_detect</span>(term, <span class="st">&quot;Yl&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1968-13"><a href="missing-data-and-other-opportunities.html#cb1968-13" aria-hidden="true" tabindex="-1"></a>           <span class="fu">pull</span>(Estimate)) <span class="sc">%&gt;%</span> </span>
<span id="cb1968-14"><a href="missing-data-and-other-opportunities.html#cb1968-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="sc">-</span>Loc, <span class="at">values_to =</span> <span class="st">&quot;d&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1968-15"><a href="missing-data-and-other-opportunities.html#cb1968-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">if_else</span>(name <span class="sc">==</span> <span class="st">&quot;D_obs&quot;</span>, <span class="st">&quot;observed&quot;</span>, <span class="st">&quot;posterior&quot;</span>)),</span>
<span id="cb1968-16"><a href="missing-data-and-other-opportunities.html#cb1968-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># M</span></span>
<span id="cb1968-17"><a href="missing-data-and-other-opportunities.html#cb1968-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">Loc   =</span> d <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Loc),</span>
<span id="cb1968-18"><a href="missing-data-and-other-opportunities.html#cb1968-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">M_obs =</span> d <span class="sc">%&gt;%</span> <span class="fu">pull</span>(M_obs),</span>
<span id="cb1968-19"><a href="missing-data-and-other-opportunities.html#cb1968-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">M_est =</span> <span class="fu">posterior_summary</span>(b15<span class="fl">.2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1968-20"><a href="missing-data-and-other-opportunities.html#cb1968-20" aria-hidden="true" tabindex="-1"></a>           <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1968-21"><a href="missing-data-and-other-opportunities.html#cb1968-21" aria-hidden="true" tabindex="-1"></a>           <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1968-22"><a href="missing-data-and-other-opportunities.html#cb1968-22" aria-hidden="true" tabindex="-1"></a>           <span class="fu">filter</span>(<span class="fu">str_detect</span>(term, <span class="st">&quot;Xme_&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1968-23"><a href="missing-data-and-other-opportunities.html#cb1968-23" aria-hidden="true" tabindex="-1"></a>           <span class="fu">pull</span>(Estimate)) <span class="sc">%&gt;%</span> </span>
<span id="cb1968-24"><a href="missing-data-and-other-opportunities.html#cb1968-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="sc">-</span>Loc, <span class="at">values_to =</span> <span class="st">&quot;m&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1968-25"><a href="missing-data-and-other-opportunities.html#cb1968-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">if_else</span>(name <span class="sc">==</span> <span class="st">&quot;M_obs&quot;</span>, <span class="st">&quot;observed&quot;</span>, <span class="st">&quot;posterior&quot;</span>)),</span>
<span id="cb1968-26"><a href="missing-data-and-other-opportunities.html#cb1968-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Loc&quot;</span>, <span class="st">&quot;name&quot;</span>)</span>
<span id="cb1968-27"><a href="missing-data-and-other-opportunities.html#cb1968-27" aria-hidden="true" tabindex="-1"></a>)  <span class="sc">%&gt;%</span> </span>
<span id="cb1968-28"><a href="missing-data-and-other-opportunities.html#cb1968-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1968-29"><a href="missing-data-and-other-opportunities.html#cb1968-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb1968-30"><a href="missing-data-and-other-opportunities.html#cb1968-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> m, <span class="at">y =</span> d)) <span class="sc">+</span></span>
<span id="cb1968-31"><a href="missing-data-and-other-opportunities.html#cb1968-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> Loc),</span>
<span id="cb1968-32"><a href="missing-data-and-other-opportunities.html#cb1968-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1968-33"><a href="missing-data-and-other-opportunities.html#cb1968-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb1968-34"><a href="missing-data-and-other-opportunities.html#cb1968-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(color_p, color_y)) <span class="sc">+</span></span>
<span id="cb1968-35"><a href="missing-data-and-other-opportunities.html#cb1968-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Shrinkage of both divorce rate and marriage rate&quot;</span>, </span>
<span id="cb1968-36"><a href="missing-data-and-other-opportunities.html#cb1968-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Marriage rate (std)&quot;</span> , </span>
<span id="cb1968-37"><a href="missing-data-and-other-opportunities.html#cb1968-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Divorce rate (std)&quot;</span>)</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-32-1.png" width="364.8" style="display: block; margin: auto;" /></p>
<p>The yellow points are model-implied; the purple ones are of the original data. It turns out our <strong>brms</strong> model regularized just a little more aggressively than McElreath’s <strong>rethinking</strong> model.</p>
<p>Anyway,</p>
<blockquote>
<p>The big take home point for this section is that when you have a distribution of values, don’t reduce it down to a single value to use in a regression. Instead, use the entire distribution. Anytime we use an average value, discarding the uncertainty around that average, we risk overconfidence and spurious inference. This doesn’t only apply to measurement error, but also to cases in which data are averaged before analysis. (p. 497)</p>
</blockquote>
</div>
<div id="measurement-terrors." class="section level3 hasAnchor" number="15.1.3">
<h3><span class="header-section-number">15.1.3</span> Measurement terrors.<a href="missing-data-and-other-opportunities.html#measurement-terrors." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>McElreath invited us to consider a few more DAGs. The first is an instance where both sources of measurement error have a common cause, <span class="math inline">\(P\)</span>.</p>
<div class="sourceCode" id="cb1969"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1969-1"><a href="missing-data-and-other-opportunities.html#cb1969-1" aria-hidden="true" tabindex="-1"></a>dag_coords <span class="ot">&lt;-</span></span>
<span id="cb1969-2"><a href="missing-data-and-other-opportunities.html#cb1969-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;Mobs&quot;</span>, <span class="st">&quot;eM&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;Dobs&quot;</span>, <span class="st">&quot;eD&quot;</span>, <span class="st">&quot;P&quot;</span>),</span>
<span id="cb1969-3"><a href="missing-data-and-other-opportunities.html#cb1969-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">x    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>),</span>
<span id="cb1969-4"><a href="missing-data-and-other-opportunities.html#cb1969-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb1969-5"><a href="missing-data-and-other-opportunities.html#cb1969-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1969-6"><a href="missing-data-and-other-opportunities.html#cb1969-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dagify</span>(M    <span class="sc">~</span> A,</span>
<span id="cb1969-7"><a href="missing-data-and-other-opportunities.html#cb1969-7" aria-hidden="true" tabindex="-1"></a>       D    <span class="sc">~</span> A <span class="sc">+</span> M,</span>
<span id="cb1969-8"><a href="missing-data-and-other-opportunities.html#cb1969-8" aria-hidden="true" tabindex="-1"></a>       Mobs <span class="sc">~</span> M <span class="sc">+</span> eM,</span>
<span id="cb1969-9"><a href="missing-data-and-other-opportunities.html#cb1969-9" aria-hidden="true" tabindex="-1"></a>       Dobs <span class="sc">~</span> D <span class="sc">+</span> eD,</span>
<span id="cb1969-10"><a href="missing-data-and-other-opportunities.html#cb1969-10" aria-hidden="true" tabindex="-1"></a>       eM   <span class="sc">~</span> P,</span>
<span id="cb1969-11"><a href="missing-data-and-other-opportunities.html#cb1969-11" aria-hidden="true" tabindex="-1"></a>       eD   <span class="sc">~</span> P,</span>
<span id="cb1969-12"><a href="missing-data-and-other-opportunities.html#cb1969-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">coords =</span> dag_coords) <span class="sc">%&gt;%</span></span>
<span id="cb1969-13"><a href="missing-data-and-other-opportunities.html#cb1969-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1969-14"><a href="missing-data-and-other-opportunities.html#cb1969-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;Mobs&quot;</span>, <span class="st">&quot;Dobs&quot;</span>, <span class="st">&quot;P&quot;</span>), <span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1969-15"><a href="missing-data-and-other-opportunities.html#cb1969-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1969-16"><a href="missing-data-and-other-opportunities.html#cb1969-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb1969-17"><a href="missing-data-and-other-opportunities.html#cb1969-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> color),</span>
<span id="cb1969-18"><a href="missing-data-and-other-opportunities.html#cb1969-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">7</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb1969-19"><a href="missing-data-and-other-opportunities.html#cb1969-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>(<span class="at">parse =</span> T, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;P&quot;</span>, </span>
<span id="cb1969-20"><a href="missing-data-and-other-opportunities.html#cb1969-20" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">expression</span>(<span class="fu">italic</span>(e)[D]), <span class="fu">expression</span>(<span class="fu">italic</span>(e)[M]), </span>
<span id="cb1969-21"><a href="missing-data-and-other-opportunities.html#cb1969-21" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">expression</span>(D[obs]), <span class="fu">expression</span>(M[obs]))) <span class="sc">+</span></span>
<span id="cb1969-22"><a href="missing-data-and-other-opportunities.html#cb1969-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">edge_colour =</span> <span class="st">&quot;#FCF9F0&quot;</span>) <span class="sc">+</span></span>
<span id="cb1969-23"><a href="missing-data-and-other-opportunities.html#cb1969-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">2</span>], <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1969-24"><a href="missing-data-and-other-opportunities.html#cb1969-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dark_theme_void</span>()</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-33-1.png" width="360" style="display: block; margin: auto;" /></p>
<p>The second instance is when the true marriage rate <span class="math inline">\(M\)</span> has a causal effect on the measurement error for Divorce, <span class="math inline">\(e_\text{D}\)</span>.</p>
<div class="sourceCode" id="cb1970"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1970-1"><a href="missing-data-and-other-opportunities.html#cb1970-1" aria-hidden="true" tabindex="-1"></a>dag_coords <span class="ot">&lt;-</span></span>
<span id="cb1970-2"><a href="missing-data-and-other-opportunities.html#cb1970-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;Mobs&quot;</span>, <span class="st">&quot;eM&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;Dobs&quot;</span>, <span class="st">&quot;eD&quot;</span>),</span>
<span id="cb1970-3"><a href="missing-data-and-other-opportunities.html#cb1970-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">x    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb1970-4"><a href="missing-data-and-other-opportunities.html#cb1970-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb1970-5"><a href="missing-data-and-other-opportunities.html#cb1970-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1970-6"><a href="missing-data-and-other-opportunities.html#cb1970-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dagify</span>(M    <span class="sc">~</span> A,</span>
<span id="cb1970-7"><a href="missing-data-and-other-opportunities.html#cb1970-7" aria-hidden="true" tabindex="-1"></a>       D    <span class="sc">~</span> A <span class="sc">+</span> M,</span>
<span id="cb1970-8"><a href="missing-data-and-other-opportunities.html#cb1970-8" aria-hidden="true" tabindex="-1"></a>       Mobs <span class="sc">~</span> M <span class="sc">+</span> eM,</span>
<span id="cb1970-9"><a href="missing-data-and-other-opportunities.html#cb1970-9" aria-hidden="true" tabindex="-1"></a>       Dobs <span class="sc">~</span> D <span class="sc">+</span> eD,</span>
<span id="cb1970-10"><a href="missing-data-and-other-opportunities.html#cb1970-10" aria-hidden="true" tabindex="-1"></a>       eD   <span class="sc">~</span> M,</span>
<span id="cb1970-11"><a href="missing-data-and-other-opportunities.html#cb1970-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">coords =</span> dag_coords) <span class="sc">%&gt;%</span></span>
<span id="cb1970-12"><a href="missing-data-and-other-opportunities.html#cb1970-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1970-13"><a href="missing-data-and-other-opportunities.html#cb1970-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;Mobs&quot;</span>, <span class="st">&quot;Dobs&quot;</span>), <span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1970-14"><a href="missing-data-and-other-opportunities.html#cb1970-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1970-15"><a href="missing-data-and-other-opportunities.html#cb1970-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb1970-16"><a href="missing-data-and-other-opportunities.html#cb1970-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> color),</span>
<span id="cb1970-17"><a href="missing-data-and-other-opportunities.html#cb1970-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">7</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb1970-18"><a href="missing-data-and-other-opportunities.html#cb1970-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>(<span class="at">parse =</span> T, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;M&quot;</span>, </span>
<span id="cb1970-19"><a href="missing-data-and-other-opportunities.html#cb1970-19" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">expression</span>(<span class="fu">italic</span>(e)[D]), <span class="fu">expression</span>(<span class="fu">italic</span>(e)[M]), </span>
<span id="cb1970-20"><a href="missing-data-and-other-opportunities.html#cb1970-20" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">expression</span>(D[obs]), <span class="fu">expression</span>(M[obs]))) <span class="sc">+</span></span>
<span id="cb1970-21"><a href="missing-data-and-other-opportunities.html#cb1970-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">edge_colour =</span> <span class="st">&quot;#FCF9F0&quot;</span>) <span class="sc">+</span></span>
<span id="cb1970-22"><a href="missing-data-and-other-opportunities.html#cb1970-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">2</span>], <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1970-23"><a href="missing-data-and-other-opportunities.html#cb1970-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dark_theme_void</span>()</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-34-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>The final example is when we have negligible measurement error for <span class="math inline">\(M\)</span> and <span class="math inline">\(D\)</span>, but known nonignorable measurement error for the causal variable <span class="math inline">\(A\)</span>.</p>
<div class="sourceCode" id="cb1971"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1971-1"><a href="missing-data-and-other-opportunities.html#cb1971-1" aria-hidden="true" tabindex="-1"></a>dag_coords <span class="ot">&lt;-</span></span>
<span id="cb1971-2"><a href="missing-data-and-other-opportunities.html#cb1971-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;eA&quot;</span>, <span class="st">&quot;Aobs&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;D&quot;</span>),</span>
<span id="cb1971-3"><a href="missing-data-and-other-opportunities.html#cb1971-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">x    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb1971-4"><a href="missing-data-and-other-opportunities.html#cb1971-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb1971-5"><a href="missing-data-and-other-opportunities.html#cb1971-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1971-6"><a href="missing-data-and-other-opportunities.html#cb1971-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dagify</span>(Aobs <span class="sc">~</span> A <span class="sc">+</span> eA,</span>
<span id="cb1971-7"><a href="missing-data-and-other-opportunities.html#cb1971-7" aria-hidden="true" tabindex="-1"></a>       M    <span class="sc">~</span> A,</span>
<span id="cb1971-8"><a href="missing-data-and-other-opportunities.html#cb1971-8" aria-hidden="true" tabindex="-1"></a>       D    <span class="sc">~</span> A,</span>
<span id="cb1971-9"><a href="missing-data-and-other-opportunities.html#cb1971-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">coords =</span> dag_coords) <span class="sc">%&gt;%</span></span>
<span id="cb1971-10"><a href="missing-data-and-other-opportunities.html#cb1971-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1971-11"><a href="missing-data-and-other-opportunities.html#cb1971-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;eA&quot;</span>), <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1971-12"><a href="missing-data-and-other-opportunities.html#cb1971-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1971-13"><a href="missing-data-and-other-opportunities.html#cb1971-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb1971-14"><a href="missing-data-and-other-opportunities.html#cb1971-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> color),</span>
<span id="cb1971-15"><a href="missing-data-and-other-opportunities.html#cb1971-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">7</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb1971-16"><a href="missing-data-and-other-opportunities.html#cb1971-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>(<span class="at">parse =</span> T, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="fu">expression</span>(<span class="fu">italic</span>(e)[A]), <span class="fu">expression</span>(A[obs]), <span class="st">&quot;D&quot;</span>, <span class="st">&quot;M&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1971-17"><a href="missing-data-and-other-opportunities.html#cb1971-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">edge_colour =</span> <span class="st">&quot;#FCF9F0&quot;</span>) <span class="sc">+</span></span>
<span id="cb1971-18"><a href="missing-data-and-other-opportunities.html#cb1971-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">2</span>], <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1971-19"><a href="missing-data-and-other-opportunities.html#cb1971-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dark_theme_void</span>()</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-35-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>On page 498, we read:</p>
<blockquote>
<p>In this circumstance, it can happen that a naive regression of <span class="math inline">\(D\)</span> on <span class="math inline">\(A_\text{obs}\)</span> and <span class="math inline">\(M\)</span> will strongly suggest that <span class="math inline">\(M\)</span> influences <span class="math inline">\(D\)</span>. The reason is that <span class="math inline">\(M\)</span> contains information about the true <span class="math inline">\(A\)</span>. And <span class="math inline">\(M\)</span> is measured more precisely than <span class="math inline">\(A\)</span> is. It’s like a proxy <span class="math inline">\(A\)</span>. Here’s a small simulation you can toy with that will produce such a frustration:</p>
</blockquote>
<div class="sourceCode" id="cb1972"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1972-1"><a href="missing-data-and-other-opportunities.html#cb1972-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb1972-2"><a href="missing-data-and-other-opportunities.html#cb1972-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1972-3"><a href="missing-data-and-other-opportunities.html#cb1972-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb1972-4"><a href="missing-data-and-other-opportunities.html#cb1972-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1972-5"><a href="missing-data-and-other-opportunities.html#cb1972-5" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span></span>
<span id="cb1972-6"><a href="missing-data-and-other-opportunities.html#cb1972-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">A =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1972-7"><a href="missing-data-and-other-opportunities.html#cb1972-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">M     =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="sc">-</span>A, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb1972-8"><a href="missing-data-and-other-opportunities.html#cb1972-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">D     =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span>  A, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb1972-9"><a href="missing-data-and-other-opportunities.html#cb1972-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">A_obs =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span>  A, <span class="at">sd =</span> <span class="dv">1</span>))</span></code></pre></div>
<p>To get a sense of the havoc ignoring measurement error can cause, we’ll fit to models. These aren’t in the text, but, you know, let’s live a little. The first model will include <code>A</code>, the true predictor for <code>D</code>. The second model will include <code>A_obs</code> instead, the version of <code>A</code> with measurement error added in.</p>
<div class="sourceCode" id="cb1973"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1973-1"><a href="missing-data-and-other-opportunities.html#cb1973-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the model with A containing no measurement error</span></span>
<span id="cb1973-2"><a href="missing-data-and-other-opportunities.html#cb1973-2" aria-hidden="true" tabindex="-1"></a>b15<span class="fl">.2</span>b <span class="ot">&lt;-</span> </span>
<span id="cb1973-3"><a href="missing-data-and-other-opportunities.html#cb1973-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> dat, </span>
<span id="cb1973-4"><a href="missing-data-and-other-opportunities.html#cb1973-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb1973-5"><a href="missing-data-and-other-opportunities.html#cb1973-5" aria-hidden="true" tabindex="-1"></a>      D <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> A <span class="sc">+</span> M,</span>
<span id="cb1973-6"><a href="missing-data-and-other-opportunities.html#cb1973-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1973-7"><a href="missing-data-and-other-opportunities.html#cb1973-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b),</span>
<span id="cb1973-8"><a href="missing-data-and-other-opportunities.html#cb1973-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb1973-9"><a href="missing-data-and-other-opportunities.html#cb1973-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1973-10"><a href="missing-data-and-other-opportunities.html#cb1973-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">15</span>,</span>
<span id="cb1973-11"><a href="missing-data-and-other-opportunities.html#cb1973-11" aria-hidden="true" tabindex="-1"></a>      <span class="co"># note this line</span></span>
<span id="cb1973-12"><a href="missing-data-and-other-opportunities.html#cb1973-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">latent =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1973-13"><a href="missing-data-and-other-opportunities.html#cb1973-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/b15.02b&quot;</span>)</span>
<span id="cb1973-14"><a href="missing-data-and-other-opportunities.html#cb1973-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1973-15"><a href="missing-data-and-other-opportunities.html#cb1973-15" aria-hidden="true" tabindex="-1"></a><span class="co"># The model where A has measurement error, but we ignore it</span></span>
<span id="cb1973-16"><a href="missing-data-and-other-opportunities.html#cb1973-16" aria-hidden="true" tabindex="-1"></a>b15<span class="fl">.2</span>c <span class="ot">&lt;-</span> </span>
<span id="cb1973-17"><a href="missing-data-and-other-opportunities.html#cb1973-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> dat, </span>
<span id="cb1973-18"><a href="missing-data-and-other-opportunities.html#cb1973-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb1973-19"><a href="missing-data-and-other-opportunities.html#cb1973-19" aria-hidden="true" tabindex="-1"></a>      D <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> A_obs <span class="sc">+</span> M,</span>
<span id="cb1973-20"><a href="missing-data-and-other-opportunities.html#cb1973-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.2</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1973-21"><a href="missing-data-and-other-opportunities.html#cb1973-21" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b),</span>
<span id="cb1973-22"><a href="missing-data-and-other-opportunities.html#cb1973-22" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb1973-23"><a href="missing-data-and-other-opportunities.html#cb1973-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb1973-24"><a href="missing-data-and-other-opportunities.html#cb1973-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">15</span>,</span>
<span id="cb1973-25"><a href="missing-data-and-other-opportunities.html#cb1973-25" aria-hidden="true" tabindex="-1"></a>      <span class="co"># note this line</span></span>
<span id="cb1973-26"><a href="missing-data-and-other-opportunities.html#cb1973-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">save_pars =</span> <span class="fu">save_pars</span>(<span class="at">latent =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1973-27"><a href="missing-data-and-other-opportunities.html#cb1973-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/b15.02c&quot;</span>)</span></code></pre></div>
<p>Check the summaries.</p>
<div class="sourceCode" id="cb1974"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1974-1"><a href="missing-data-and-other-opportunities.html#cb1974-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b15<span class="fl">.2</span>b)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: D ~ 1 + A + M 
##    Data: dat (Number of observations: 500) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     0.01      0.04    -0.08     0.09 1.00     3767     2809
## A             0.89      0.06     0.78     1.02 1.00     3063     2879
## M            -0.04      0.04    -0.13     0.04 1.00     3258     2643
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     1.00      0.03     0.95     1.07 1.00     3831     2972
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb1976"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1976-1"><a href="missing-data-and-other-opportunities.html#cb1976-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b15<span class="fl">.2</span>c)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: D ~ 1 + A_obs + M 
##    Data: dat (Number of observations: 500) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     0.05      0.05    -0.05     0.15 1.00     3496     2708
## A_obs         0.29      0.04     0.22     0.37 1.00     3357     2843
## M            -0.35      0.04    -0.43    -0.27 1.00     3219     2478
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     1.14      0.04     1.07     1.22 1.00     3986     3058
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Model <code>b15.2b</code>, where <code>A</code> contains no measurement error, comes close to reproducing the data-generating parameters. The second model, <code>b15.2c</code>, which used <code>A</code> infused with measurement error (i.e., <code>A_obs</code>), is a disaster. A coefficient plot might help the comparison.</p>
<div class="sourceCode" id="cb1978"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1978-1"><a href="missing-data-and-other-opportunities.html#cb1978-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for annotation</span></span>
<span id="cb1978-2"><a href="missing-data-and-other-opportunities.html#cb1978-2" aria-hidden="true" tabindex="-1"></a>text <span class="ot">&lt;-</span></span>
<span id="cb1978-3"><a href="missing-data-and-other-opportunities.html#cb1978-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">fit      =</span> <span class="st">&quot;b15.2b&quot;</span>,</span>
<span id="cb1978-4"><a href="missing-data-and-other-opportunities.html#cb1978-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">term     =</span> <span class="st">&quot;beta[0]&quot;</span>,</span>
<span id="cb1978-5"><a href="missing-data-and-other-opportunities.html#cb1978-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Estimate =</span> <span class="fu">fixef</span>(b15<span class="fl">.2</span>b, <span class="at">probs =</span> .<span class="dv">99</span>)[<span class="st">&quot;Intercept&quot;</span>, <span class="dv">3</span>],</span>
<span id="cb1978-6"><a href="missing-data-and-other-opportunities.html#cb1978-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">label    =</span> <span class="st">&quot;In this plot, we like the yellow posteriors.&quot;</span>)</span>
<span id="cb1978-7"><a href="missing-data-and-other-opportunities.html#cb1978-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1978-8"><a href="missing-data-and-other-opportunities.html#cb1978-8" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb1978-9"><a href="missing-data-and-other-opportunities.html#cb1978-9" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">posterior_summary</span>(b15<span class="fl">.2</span>b) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>),</span>
<span id="cb1978-10"><a href="missing-data-and-other-opportunities.html#cb1978-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">posterior_summary</span>(b15<span class="fl">.2</span>c) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1978-11"><a href="missing-data-and-other-opportunities.html#cb1978-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">&quot;lp__&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1978-12"><a href="missing-data-and-other-opportunities.html#cb1978-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">&quot;lprior&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1978-13"><a href="missing-data-and-other-opportunities.html#cb1978-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fu">str_c</span>(<span class="st">&quot;beta[&quot;</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="st">&quot;]&quot;</span>), <span class="st">&quot;sigma&quot;</span>), <span class="at">times =</span> <span class="dv">2</span>),</span>
<span id="cb1978-14"><a href="missing-data-and-other-opportunities.html#cb1978-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">fit  =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;b15.2b&quot;</span>, <span class="st">&quot;b15.2c&quot;</span>), <span class="at">each =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1978-15"><a href="missing-data-and-other-opportunities.html#cb1978-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1978-16"><a href="missing-data-and-other-opportunities.html#cb1978-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb1978-17"><a href="missing-data-and-other-opportunities.html#cb1978-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">y =</span> fit)) <span class="sc">+</span></span>
<span id="cb1978-18"><a href="missing-data-and-other-opportunities.html#cb1978-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb1978-19"><a href="missing-data-and-other-opportunities.html#cb1978-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> Q2<span class="fl">.5</span>, <span class="at">xmax =</span> Q97<span class="fl">.5</span>, <span class="at">color =</span> fit)) <span class="sc">+</span></span>
<span id="cb1978-20"><a href="missing-data-and-other-opportunities.html#cb1978-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> text,</span>
<span id="cb1978-21"><a href="missing-data-and-other-opportunities.html#cb1978-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">label =</span> label),</span>
<span id="cb1978-22"><a href="missing-data-and-other-opportunities.html#cb1978-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">color =</span> color_y) <span class="sc">+</span></span>
<span id="cb1978-23"><a href="missing-data-and-other-opportunities.html#cb1978-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(color_y, <span class="st">&quot;white&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1978-24"><a href="missing-data-and-other-opportunities.html#cb1978-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;marginal posterior&quot;</span>,</span>
<span id="cb1978-25"><a href="missing-data-and-other-opportunities.html#cb1978-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1978-26"><a href="missing-data-and-other-opportunities.html#cb1978-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1978-27"><a href="missing-data-and-other-opportunities.html#cb1978-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1978-28"><a href="missing-data-and-other-opportunities.html#cb1978-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> term, <span class="at">labeller =</span> label_parsed, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-38-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="missing-data" class="section level2 hasAnchor" number="15.2">
<h2><span class="header-section-number">15.2</span> Missing data<a href="missing-data-and-other-opportunities.html#missing-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>With measurement error, the insight is to realize that any uncertain piece of data can be replaced by a distribution that reflects uncertainty. But sometimes data are simply missing–no measurement is available at all. At first, this seems like a lost cause. What can be done when there is no measurement at all, not even one with error?…</p>
</blockquote>
<blockquote>
<p>So what can we do instead? We can think causally about missingness, and we can use
the model to <strong>impute</strong> missing values. A generative model tells you whether the process that
produced the missing values will also prevent the identification of causal effects. (p. 499, <strong>emphasis</strong> in the original)</p>
</blockquote>
<p>Starting with <a href="https://cran.r-project.org/package=brms/news/news.html">version 2.2.0</a>, <strong>brms</strong> supports Bayesian missing data imputation using adaptations of the <a href="https://cran.r-project.org/package=brms/vignettes/brms_multivariate.html">multivariate syntax</a> <span class="citation">(<a href="#ref-Bürkner2022Multivariate" role="doc-biblioref">Bürkner, 2022c</a>)</span>. Bürkner’s <span class="citation">(<a href="#ref-Bürkner2022HandleMissingValues" role="doc-biblioref">2022</a>)</span> vignette, <a href="https://cran.r-project.org/package=brms/vignettes/brms_missings.html"><em>Handle missing values with brms</em></a>, can provide a nice overview.</p>
<div id="rethinking-missing-data-are-meaningful-data." class="section level4 hasAnchor" number="15.2.0.1">
<h4><span class="header-section-number">15.2.0.1</span> Rethinking: Missing data are meaningful data.<a href="missing-data-and-other-opportunities.html#rethinking-missing-data-are-meaningful-data." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>The fact that a variable has an unobserved value is still an observation. It is data, just with a very special value. The meaning of this value depends upon the context. Consider for example a questionnaire on personal income. If some people refuse to fill in their income, this may be associated with low (or high) income. Therefore a model that tries to predict the missing values can be enlightening. (p. 499)</p>
</blockquote>
</div>
<div id="dag-ate-my-homework." class="section level3 hasAnchor" number="15.2.1">
<h3><span class="header-section-number">15.2.1</span> DAG ate my homework.<a href="missing-data-and-other-opportunities.html#dag-ate-my-homework." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ll start this section off with our version of Figure 15.4. It’s going to take a bit of effort on our part to make a nice representation those four DAGs. Here we make panels a, b, and d.</p>
<div class="sourceCode" id="cb1979"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1979-1"><a href="missing-data-and-other-opportunities.html#cb1979-1" aria-hidden="true" tabindex="-1"></a><span class="co"># panel a</span></span>
<span id="cb1979-2"><a href="missing-data-and-other-opportunities.html#cb1979-2" aria-hidden="true" tabindex="-1"></a>dag_coords <span class="ot">&lt;-</span></span>
<span id="cb1979-3"><a href="missing-data-and-other-opportunities.html#cb1979-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;Hs&quot;</span>, <span class="st">&quot;D&quot;</span>),</span>
<span id="cb1979-4"><a href="missing-data-and-other-opportunities.html#cb1979-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">x    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb1979-5"><a href="missing-data-and-other-opportunities.html#cb1979-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb1979-6"><a href="missing-data-and-other-opportunities.html#cb1979-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1979-7"><a href="missing-data-and-other-opportunities.html#cb1979-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1979-8"><a href="missing-data-and-other-opportunities.html#cb1979-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dagify</span>(H  <span class="sc">~</span> S,</span>
<span id="cb1979-9"><a href="missing-data-and-other-opportunities.html#cb1979-9" aria-hidden="true" tabindex="-1"></a>         Hs <span class="sc">~</span> H <span class="sc">+</span> D,</span>
<span id="cb1979-10"><a href="missing-data-and-other-opportunities.html#cb1979-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">coords =</span> dag_coords) <span class="sc">%&gt;%</span></span>
<span id="cb1979-11"><a href="missing-data-and-other-opportunities.html#cb1979-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1979-12"><a href="missing-data-and-other-opportunities.html#cb1979-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(name <span class="sc">==</span> <span class="st">&quot;H&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1979-13"><a href="missing-data-and-other-opportunities.html#cb1979-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1979-14"><a href="missing-data-and-other-opportunities.html#cb1979-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb1979-15"><a href="missing-data-and-other-opportunities.html#cb1979-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> color),</span>
<span id="cb1979-16"><a href="missing-data-and-other-opportunities.html#cb1979-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">7</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb1979-17"><a href="missing-data-and-other-opportunities.html#cb1979-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>(<span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;D&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;H*&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1979-18"><a href="missing-data-and-other-opportunities.html#cb1979-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">edge_colour =</span> <span class="st">&quot;#FCF9F0&quot;</span>)</span>
<span id="cb1979-19"><a href="missing-data-and-other-opportunities.html#cb1979-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1979-20"><a href="missing-data-and-other-opportunities.html#cb1979-20" aria-hidden="true" tabindex="-1"></a><span class="co"># panel b</span></span>
<span id="cb1979-21"><a href="missing-data-and-other-opportunities.html#cb1979-21" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1979-22"><a href="missing-data-and-other-opportunities.html#cb1979-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dagify</span>(H  <span class="sc">~</span> S,</span>
<span id="cb1979-23"><a href="missing-data-and-other-opportunities.html#cb1979-23" aria-hidden="true" tabindex="-1"></a>         Hs <span class="sc">~</span> H <span class="sc">+</span> D,</span>
<span id="cb1979-24"><a href="missing-data-and-other-opportunities.html#cb1979-24" aria-hidden="true" tabindex="-1"></a>         D  <span class="sc">~</span> S,</span>
<span id="cb1979-25"><a href="missing-data-and-other-opportunities.html#cb1979-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">coords =</span> dag_coords) <span class="sc">%&gt;%</span></span>
<span id="cb1979-26"><a href="missing-data-and-other-opportunities.html#cb1979-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1979-27"><a href="missing-data-and-other-opportunities.html#cb1979-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(name <span class="sc">==</span> <span class="st">&quot;H&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1979-28"><a href="missing-data-and-other-opportunities.html#cb1979-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1979-29"><a href="missing-data-and-other-opportunities.html#cb1979-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb1979-30"><a href="missing-data-and-other-opportunities.html#cb1979-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> color),</span>
<span id="cb1979-31"><a href="missing-data-and-other-opportunities.html#cb1979-31" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">7</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb1979-32"><a href="missing-data-and-other-opportunities.html#cb1979-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>(<span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;D&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;H*&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1979-33"><a href="missing-data-and-other-opportunities.html#cb1979-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">edge_colour =</span> <span class="st">&quot;#FCF9F0&quot;</span>)</span>
<span id="cb1979-34"><a href="missing-data-and-other-opportunities.html#cb1979-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1979-35"><a href="missing-data-and-other-opportunities.html#cb1979-35" aria-hidden="true" tabindex="-1"></a><span class="co"># panel d</span></span>
<span id="cb1979-36"><a href="missing-data-and-other-opportunities.html#cb1979-36" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span></span>
<span id="cb1979-37"><a href="missing-data-and-other-opportunities.html#cb1979-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dagify</span>(H  <span class="sc">~</span> S,</span>
<span id="cb1979-38"><a href="missing-data-and-other-opportunities.html#cb1979-38" aria-hidden="true" tabindex="-1"></a>         Hs <span class="sc">~</span> H <span class="sc">+</span> D,</span>
<span id="cb1979-39"><a href="missing-data-and-other-opportunities.html#cb1979-39" aria-hidden="true" tabindex="-1"></a>         D  <span class="sc">~</span> H,</span>
<span id="cb1979-40"><a href="missing-data-and-other-opportunities.html#cb1979-40" aria-hidden="true" tabindex="-1"></a>         <span class="at">coords =</span> dag_coords) <span class="sc">%&gt;%</span></span>
<span id="cb1979-41"><a href="missing-data-and-other-opportunities.html#cb1979-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1979-42"><a href="missing-data-and-other-opportunities.html#cb1979-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(name <span class="sc">==</span> <span class="st">&quot;H&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1979-43"><a href="missing-data-and-other-opportunities.html#cb1979-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1979-44"><a href="missing-data-and-other-opportunities.html#cb1979-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb1979-45"><a href="missing-data-and-other-opportunities.html#cb1979-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> color),</span>
<span id="cb1979-46"><a href="missing-data-and-other-opportunities.html#cb1979-46" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">7</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb1979-47"><a href="missing-data-and-other-opportunities.html#cb1979-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>(<span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;D&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;H*&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1979-48"><a href="missing-data-and-other-opportunities.html#cb1979-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">edge_colour =</span> <span class="st">&quot;#FCF9F0&quot;</span>)</span></code></pre></div>
<p>Make panel c.</p>
<div class="sourceCode" id="cb1980"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1980-1"><a href="missing-data-and-other-opportunities.html#cb1980-1" aria-hidden="true" tabindex="-1"></a>dag_coords <span class="ot">&lt;-</span></span>
<span id="cb1980-2"><a href="missing-data-and-other-opportunities.html#cb1980-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;Hs&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;X&quot;</span>),</span>
<span id="cb1980-3"><a href="missing-data-and-other-opportunities.html#cb1980-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">x    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="fl">1.5</span>),</span>
<span id="cb1980-4"><a href="missing-data-and-other-opportunities.html#cb1980-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">1.5</span>))</span>
<span id="cb1980-5"><a href="missing-data-and-other-opportunities.html#cb1980-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1980-6"><a href="missing-data-and-other-opportunities.html#cb1980-6" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb1980-7"><a href="missing-data-and-other-opportunities.html#cb1980-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dagify</span>(H  <span class="sc">~</span> S <span class="sc">+</span> X,</span>
<span id="cb1980-8"><a href="missing-data-and-other-opportunities.html#cb1980-8" aria-hidden="true" tabindex="-1"></a>         Hs <span class="sc">~</span> H <span class="sc">+</span> D,</span>
<span id="cb1980-9"><a href="missing-data-and-other-opportunities.html#cb1980-9" aria-hidden="true" tabindex="-1"></a>         D  <span class="sc">~</span> X,</span>
<span id="cb1980-10"><a href="missing-data-and-other-opportunities.html#cb1980-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">coords =</span> dag_coords) <span class="sc">%&gt;%</span></span>
<span id="cb1980-11"><a href="missing-data-and-other-opportunities.html#cb1980-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1980-12"><a href="missing-data-and-other-opportunities.html#cb1980-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;H&quot;</span>, <span class="st">&quot;X&quot;</span>), <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1980-13"><a href="missing-data-and-other-opportunities.html#cb1980-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1980-14"><a href="missing-data-and-other-opportunities.html#cb1980-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb1980-15"><a href="missing-data-and-other-opportunities.html#cb1980-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> color),</span>
<span id="cb1980-16"><a href="missing-data-and-other-opportunities.html#cb1980-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">7</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb1980-17"><a href="missing-data-and-other-opportunities.html#cb1980-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>(<span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;D&quot;</span>, <span class="st">&quot;H&quot;</span>, <span class="st">&quot;S&quot;</span>, <span class="st">&quot;X&quot;</span>, <span class="st">&quot;H*&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1980-18"><a href="missing-data-and-other-opportunities.html#cb1980-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">edge_colour =</span> <span class="st">&quot;#FCF9F0&quot;</span>)</span></code></pre></div>
<p>Now combine, adjust a little, and plot.</p>
<div class="sourceCode" id="cb1981"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1981-1"><a href="missing-data-and-other-opportunities.html#cb1981-1" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> p4) <span class="sc">+</span></span>
<span id="cb1981-2"><a href="missing-data-and-other-opportunities.html#cb1981-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">&quot;a&quot;</span>, <span class="at">tag_prefix =</span> <span class="st">&quot;(&quot;</span>, <span class="at">tag_suffix =</span> <span class="st">&quot;)&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb1981-3"><a href="missing-data-and-other-opportunities.html#cb1981-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">2</span>], <span class="st">&quot;black&quot;</span>)) <span class="sc">&amp;</span></span>
<span id="cb1981-4"><a href="missing-data-and-other-opportunities.html#cb1981-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dark_theme_void</span>() <span class="sc">+</span></span>
<span id="cb1981-5"><a href="missing-data-and-other-opportunities.html#cb1981-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;grey8&quot;</span>),</span>
<span id="cb1981-6"><a href="missing-data-and-other-opportunities.html#cb1981-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="fl">0.15</span>, <span class="fl">0.15</span>, <span class="fl">0.15</span>, <span class="fl">0.15</span>, <span class="st">&quot;in&quot;</span>))</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-41-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>On page 500, we read:</p>
<blockquote>
<p>Consider a sample of students, all of whom own dogs. The students produce homework (<span class="math inline">\(H\)</span>). This homework varies in quality, influenced by how much each student studies (<span class="math inline">\(S\)</span>). We could simulate 100 students, their attributes, and their homework like this:</p>
</blockquote>
<div class="sourceCode" id="cb1982"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1982-1"><a href="missing-data-and-other-opportunities.html#cb1982-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1982-2"><a href="missing-data-and-other-opportunities.html#cb1982-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1982-3"><a href="missing-data-and-other-opportunities.html#cb1982-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb1982-4"><a href="missing-data-and-other-opportunities.html#cb1982-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1982-5"><a href="missing-data-and-other-opportunities.html#cb1982-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb1982-6"><a href="missing-data-and-other-opportunities.html#cb1982-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">s =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1982-7"><a href="missing-data-and-other-opportunities.html#cb1982-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">h   =</span> <span class="fu">rbinom</span>(n, <span class="at">size =</span> <span class="dv">10</span>, <span class="fu">inv_logit_scaled</span>(s)),</span>
<span id="cb1982-8"><a href="missing-data-and-other-opportunities.html#cb1982-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_a =</span> <span class="fu">rbinom</span>(n, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> .<span class="dv">5</span>),</span>
<span id="cb1982-9"><a href="missing-data-and-other-opportunities.html#cb1982-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">d_b =</span> <span class="fu">ifelse</span>(s <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1982-10"><a href="missing-data-and-other-opportunities.html#cb1982-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hm_a =</span> <span class="fu">ifelse</span>(d_a <span class="sc">==</span> <span class="dv">1</span>, <span class="cn">NA</span>, h),</span>
<span id="cb1982-11"><a href="missing-data-and-other-opportunities.html#cb1982-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">hm_b =</span> <span class="fu">ifelse</span>(d_b <span class="sc">==</span> <span class="dv">1</span>, <span class="cn">NA</span>, h))</span>
<span id="cb1982-12"><a href="missing-data-and-other-opportunities.html#cb1982-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1982-13"><a href="missing-data-and-other-opportunities.html#cb1982-13" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code>## # A tibble: 100 × 6
##          s     h   d_a   d_b  hm_a  hm_b
##      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;
##  1  0.259      6     0     1     6    NA
##  2  1.83       8     0     1     8    NA
##  3 -0.340      4     0     0     4     4
##  4  0.897      6     1     1    NA    NA
##  5  0.488      8     1     1    NA    NA
##  6 -1.26       3     1     0    NA     3
##  7  0.0228     3     1     1    NA    NA
##  8  1.09       6     1     1    NA    NA
##  9 -0.132      6     0     0     6     6
## 10 -1.08       3     1     0    NA     3
## # … with 90 more rows</code></pre>
<p>In that code block, we simulated the data corresponding to McElreath’s <strong>R</strong> code 15.8 through 15.10. We have two <code>d</code> and <code>hm</code> variables. <code>d_a</code> and <code>hm_a</code> correspond to McElreath’s <strong>R</strong> code 15.9 and the DAG in panel a. <code>d_b</code> and <code>hm_b</code> correspond to McElreath’s <strong>R</strong> code 15.10 and the DAG in panel b.</p>
<p>This wasn’t in the text, but here we’ll plot <code>h</code>, <code>hm_a</code>, and <code>hm_b</code> to get a sense of how the first two missing data examples compare to the original data.</p>
<div class="sourceCode" id="cb1984"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1984-1"><a href="missing-data-and-other-opportunities.html#cb1984-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1984-2"><a href="missing-data-and-other-opportunities.html#cb1984-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb1984-3"><a href="missing-data-and-other-opportunities.html#cb1984-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> s, <span class="at">y =</span> h)) <span class="sc">+</span> </span>
<span id="cb1984-4"><a href="missing-data-and-other-opportunities.html#cb1984-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">7</span>], <span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1984-5"><a href="missing-data-and-other-opportunities.html#cb1984-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb1984-6"><a href="missing-data-and-other-opportunities.html#cb1984-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;true distribution&quot;</span>)</span>
<span id="cb1984-7"><a href="missing-data-and-other-opportunities.html#cb1984-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1984-8"><a href="missing-data-and-other-opportunities.html#cb1984-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1984-9"><a href="missing-data-and-other-opportunities.html#cb1984-9" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb1984-10"><a href="missing-data-and-other-opportunities.html#cb1984-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> s, <span class="at">y =</span> hm_a)) <span class="sc">+</span> </span>
<span id="cb1984-11"><a href="missing-data-and-other-opportunities.html#cb1984-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">6</span>], <span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1984-12"><a href="missing-data-and-other-opportunities.html#cb1984-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb1984-13"><a href="missing-data-and-other-opportunities.html#cb1984-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;missing completely at random&quot;</span>)</span>
<span id="cb1984-14"><a href="missing-data-and-other-opportunities.html#cb1984-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1984-15"><a href="missing-data-and-other-opportunities.html#cb1984-15" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb1984-16"><a href="missing-data-and-other-opportunities.html#cb1984-16" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb1984-17"><a href="missing-data-and-other-opportunities.html#cb1984-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> s, <span class="at">y =</span> hm_b)) <span class="sc">+</span> </span>
<span id="cb1984-18"><a href="missing-data-and-other-opportunities.html#cb1984-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">6</span>], <span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1984-19"><a href="missing-data-and-other-opportunities.html#cb1984-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb1984-20"><a href="missing-data-and-other-opportunities.html#cb1984-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;missing conditional on s&quot;</span>)</span>
<span id="cb1984-21"><a href="missing-data-and-other-opportunities.html#cb1984-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1984-22"><a href="missing-data-and-other-opportunities.html#cb1984-22" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-43-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>The left panel is the ideal situation letting us learn what we want to know, what is the effect of studying on the grade you’ll get on your homework (<span class="math inline">\(S \rightarrow H\)</span>). Once we enter in a missing data process (i.e., dogs <span class="math inline">\(D\)</span> eating homework), we end up with <span class="math inline">\(H^*\)</span>, the homework left over after the dogs. Thus the homework outcomes we collect are a combination of the full set of homework and the hungry dogs. The middle panel depicts the scenario where the dogs eat the homework completely at random, <span class="math inline">\(H \rightarrow H^* \leftarrow D\)</span>. In the right panel, we consider a scenario where the dogs only and always eat the homework on the occasions the students studied more than average, <span class="math inline">\(H \rightarrow H^* \leftarrow D \leftarrow S\)</span>.</p>
<p>The situation in the third DAG is more complicated. Now homework is conditional on both studying and how noisy it is in a students home, <span class="math inline">\(X\)</span>. Also, our new variable <span class="math inline">\(X\)</span> isn’t measured and whether the dogs eat the homework is also conditional on that unmeasured <span class="math inline">\(X\)</span>. Here’s the new data simulation.</p>
<div class="sourceCode" id="cb1985"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1985-1"><a href="missing-data-and-other-opportunities.html#cb1985-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb1985-2"><a href="missing-data-and-other-opportunities.html#cb1985-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1985-3"><a href="missing-data-and-other-opportunities.html#cb1985-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">501</span>)</span>
<span id="cb1985-4"><a href="missing-data-and-other-opportunities.html#cb1985-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1985-5"><a href="missing-data-and-other-opportunities.html#cb1985-5" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb1985-6"><a href="missing-data-and-other-opportunities.html#cb1985-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>),</span>
<span id="cb1985-7"><a href="missing-data-and-other-opportunities.html#cb1985-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">s =</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1985-8"><a href="missing-data-and-other-opportunities.html#cb1985-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">h =</span> <span class="fu">rbinom</span>(n, <span class="at">size =</span> <span class="dv">10</span>, <span class="fu">inv_logit_scaled</span>(<span class="dv">2</span> <span class="sc">+</span> s <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> x)),</span>
<span id="cb1985-9"><a href="missing-data-and-other-opportunities.html#cb1985-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">d =</span> <span class="fu">ifelse</span>(x <span class="sc">&gt;</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1985-10"><a href="missing-data-and-other-opportunities.html#cb1985-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hm =</span> <span class="fu">ifelse</span>(d <span class="sc">==</span> <span class="dv">1</span>, <span class="cn">NA</span>, h))</span>
<span id="cb1985-11"><a href="missing-data-and-other-opportunities.html#cb1985-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1985-12"><a href="missing-data-and-other-opportunities.html#cb1985-12" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code>## # A tibble: 1,000 × 5
##          x      s     h     d    hm
##      &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt;
##  1  0.577   1.15     10     0    10
##  2  0.617  -0.786     7     0     7
##  3  0.452   0.958     9     0     9
##  4  0.226   0.754     8     0     8
##  5 -0.845   0.689    10     0    10
##  6 -1.43    0.176    10     0    10
##  7 -1.65    0.280    10     0    10
##  8  0.0356 -0.397     8     0     8
##  9  0.184   0.261     7     0     7
## 10  1.22   -1.01      2     1    NA
## # … with 990 more rows</code></pre>
<p>Those data look like this.</p>
<div class="sourceCode" id="cb1987"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1987-1"><a href="missing-data-and-other-opportunities.html#cb1987-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1987-2"><a href="missing-data-and-other-opportunities.html#cb1987-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb1987-3"><a href="missing-data-and-other-opportunities.html#cb1987-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> s, <span class="at">y =</span> h)) <span class="sc">+</span> </span>
<span id="cb1987-4"><a href="missing-data-and-other-opportunities.html#cb1987-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">7</span>], <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1987-5"><a href="missing-data-and-other-opportunities.html#cb1987-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb1987-6"><a href="missing-data-and-other-opportunities.html#cb1987-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;true distribution&quot;</span>)</span>
<span id="cb1987-7"><a href="missing-data-and-other-opportunities.html#cb1987-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1987-8"><a href="missing-data-and-other-opportunities.html#cb1987-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1987-9"><a href="missing-data-and-other-opportunities.html#cb1987-9" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb1987-10"><a href="missing-data-and-other-opportunities.html#cb1987-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> s, <span class="at">y =</span> hm)) <span class="sc">+</span> </span>
<span id="cb1987-11"><a href="missing-data-and-other-opportunities.html#cb1987-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">6</span>], <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1987-12"><a href="missing-data-and-other-opportunities.html#cb1987-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb1987-13"><a href="missing-data-and-other-opportunities.html#cb1987-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;missing conditional on x&quot;</span>)</span>
<span id="cb1987-14"><a href="missing-data-and-other-opportunities.html#cb1987-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1987-15"><a href="missing-data-and-other-opportunities.html#cb1987-15" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-45-1.png" width="528" style="display: block; margin: auto;" /></p>
<p>Fit the model using the data with no missingness.</p>
<div class="sourceCode" id="cb1988"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1988-1"><a href="missing-data-and-other-opportunities.html#cb1988-1" aria-hidden="true" tabindex="-1"></a>b15<span class="fl">.3</span> <span class="ot">&lt;-</span></span>
<span id="cb1988-2"><a href="missing-data-and-other-opportunities.html#cb1988-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d,</span>
<span id="cb1988-3"><a href="missing-data-and-other-opportunities.html#cb1988-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1988-4"><a href="missing-data-and-other-opportunities.html#cb1988-4" aria-hidden="true" tabindex="-1"></a>      h <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">10</span>) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> s,</span>
<span id="cb1988-5"><a href="missing-data-and-other-opportunities.html#cb1988-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1988-6"><a href="missing-data-and-other-opportunities.html#cb1988-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b)),</span>
<span id="cb1988-7"><a href="missing-data-and-other-opportunities.html#cb1988-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1988-8"><a href="missing-data-and-other-opportunities.html#cb1988-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">15</span>,</span>
<span id="cb1988-9"><a href="missing-data-and-other-opportunities.html#cb1988-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/b15.03&quot;</span>)</span></code></pre></div>
<p>Check the results.</p>
<div class="sourceCode" id="cb1989"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1989-1"><a href="missing-data-and-other-opportunities.html#cb1989-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b15<span class="fl">.3</span>)</span></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = logit 
## Formula: h | trials(10) ~ 1 + s 
##    Data: d (Number of observations: 1000) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     1.11      0.02     1.07     1.16 1.00     2773     2809
## s             0.69      0.03     0.64     0.74 1.00     2422     2162
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Since this is not the data-generating model, we shouldn’t be all that surprised the coefficient for <code>s</code> is off (it should be 1). Because this is an example of where we didn’t collect data on <span class="math inline">\(X\)</span>, we can think of our incorrect results as a case of <strong>omitted variable bias</strong>. Here’s what happens when we run the model on <code>hm</code>, the homework variable after the hungry dogs got to it.</p>
<div class="sourceCode" id="cb1991"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1991-1"><a href="missing-data-and-other-opportunities.html#cb1991-1" aria-hidden="true" tabindex="-1"></a>b15<span class="fl">.4</span> <span class="ot">&lt;-</span></span>
<span id="cb1991-2"><a href="missing-data-and-other-opportunities.html#cb1991-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(d <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb1991-3"><a href="missing-data-and-other-opportunities.html#cb1991-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1991-4"><a href="missing-data-and-other-opportunities.html#cb1991-4" aria-hidden="true" tabindex="-1"></a>      h <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">10</span>) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> s,</span>
<span id="cb1991-5"><a href="missing-data-and-other-opportunities.html#cb1991-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1991-6"><a href="missing-data-and-other-opportunities.html#cb1991-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b)),</span>
<span id="cb1991-7"><a href="missing-data-and-other-opportunities.html#cb1991-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1991-8"><a href="missing-data-and-other-opportunities.html#cb1991-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">15</span>,</span>
<span id="cb1991-9"><a href="missing-data-and-other-opportunities.html#cb1991-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/b15.04&quot;</span>)</span></code></pre></div>
<p>Check the results.</p>
<div class="sourceCode" id="cb1992"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1992-1"><a href="missing-data-and-other-opportunities.html#cb1992-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b15<span class="fl">.4</span>)</span></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = logit 
## Formula: h | trials(10) ~ 1 + s 
##    Data: d %&gt;% filter(d == 0) (Number of observations: 820) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     1.80      0.03     1.73     1.86 1.00     2322     2543
## s             0.83      0.03     0.76     0.89 1.00     2266     2557
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Interestingly, both the intercept and the coefficient for <code>s</code> are now less biased. Because both <span class="math inline">\(H\)</span> and <span class="math inline">\(D\)</span> are conditional on <span class="math inline">\(X\)</span>, omitting cases based on <span class="math inline">\(X\)</span> resulted in a model that conditional on <span class="math inline">\(X\)</span>, even though <span class="math inline">\(X\)</span> wasn’t directly in the statistical model. This won’t always be the case. Consider what happens when we have a different missing data mechanism.</p>
<div class="sourceCode" id="cb1994"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1994-1"><a href="missing-data-and-other-opportunities.html#cb1994-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb1994-2"><a href="missing-data-and-other-opportunities.html#cb1994-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb1994-3"><a href="missing-data-and-other-opportunities.html#cb1994-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d =</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(x) <span class="sc">&lt;</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1994-4"><a href="missing-data-and-other-opportunities.html#cb1994-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hm =</span> <span class="fu">ifelse</span>(d <span class="sc">==</span> <span class="dv">1</span>, <span class="cn">NA</span>, h))</span>
<span id="cb1994-5"><a href="missing-data-and-other-opportunities.html#cb1994-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1994-6"><a href="missing-data-and-other-opportunities.html#cb1994-6" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code>## # A tibble: 1,000 × 5
##          x      s     h     d    hm
##      &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt;
##  1  0.577   1.15     10     1    NA
##  2  0.617  -0.786     7     1    NA
##  3  0.452   0.958     9     1    NA
##  4  0.226   0.754     8     1    NA
##  5 -0.845   0.689    10     1    NA
##  6 -1.43    0.176    10     0    10
##  7 -1.65    0.280    10     0    10
##  8  0.0356 -0.397     8     1    NA
##  9  0.184   0.261     7     1    NA
## 10  1.22   -1.01      2     0     2
## # … with 990 more rows</code></pre>
<p>Here’s what then updated data look like.</p>
<div class="sourceCode" id="cb1996"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1996-1"><a href="missing-data-and-other-opportunities.html#cb1996-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb1996-2"><a href="missing-data-and-other-opportunities.html#cb1996-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb1996-3"><a href="missing-data-and-other-opportunities.html#cb1996-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> s, <span class="at">y =</span> h)) <span class="sc">+</span> </span>
<span id="cb1996-4"><a href="missing-data-and-other-opportunities.html#cb1996-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">7</span>], <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1996-5"><a href="missing-data-and-other-opportunities.html#cb1996-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb1996-6"><a href="missing-data-and-other-opportunities.html#cb1996-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;true distribution&quot;</span>)</span>
<span id="cb1996-7"><a href="missing-data-and-other-opportunities.html#cb1996-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1996-8"><a href="missing-data-and-other-opportunities.html#cb1996-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb1996-9"><a href="missing-data-and-other-opportunities.html#cb1996-9" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb1996-10"><a href="missing-data-and-other-opportunities.html#cb1996-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> s, <span class="at">y =</span> hm)) <span class="sc">+</span> </span>
<span id="cb1996-11"><a href="missing-data-and-other-opportunities.html#cb1996-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">6</span>], <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb1996-12"><a href="missing-data-and-other-opportunities.html#cb1996-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb1996-13"><a href="missing-data-and-other-opportunities.html#cb1996-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;missing conditional on x&quot;</span>)</span>
<span id="cb1996-14"><a href="missing-data-and-other-opportunities.html#cb1996-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1996-15"><a href="missing-data-and-other-opportunities.html#cb1996-15" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-49-1.png" width="528" style="display: block; margin: auto;" /></p>
<p>McElreath didn’t fit this model in the text, but he encouraged us to do so on our own (p. 503). Here it is.</p>
<div class="sourceCode" id="cb1997"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1997-1"><a href="missing-data-and-other-opportunities.html#cb1997-1" aria-hidden="true" tabindex="-1"></a>b15<span class="fl">.4</span>b <span class="ot">&lt;-</span></span>
<span id="cb1997-2"><a href="missing-data-and-other-opportunities.html#cb1997-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(d <span class="sc">==</span> <span class="dv">0</span>),</span>
<span id="cb1997-3"><a href="missing-data-and-other-opportunities.html#cb1997-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb1997-4"><a href="missing-data-and-other-opportunities.html#cb1997-4" aria-hidden="true" tabindex="-1"></a>      h <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">10</span>) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> s,</span>
<span id="cb1997-5"><a href="missing-data-and-other-opportunities.html#cb1997-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb1997-6"><a href="missing-data-and-other-opportunities.html#cb1997-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b)),</span>
<span id="cb1997-7"><a href="missing-data-and-other-opportunities.html#cb1997-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb1997-8"><a href="missing-data-and-other-opportunities.html#cb1997-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">15</span>,</span>
<span id="cb1997-9"><a href="missing-data-and-other-opportunities.html#cb1997-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/b15.04b&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1998"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1998-1"><a href="missing-data-and-other-opportunities.html#cb1998-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b15<span class="fl">.4</span>b)</span></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = logit 
## Formula: h | trials(10) ~ 1 + s 
##    Data: d %&gt;% filter(d == 0) (Number of observations: 307) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     0.34      0.04     0.27     0.42 1.00     2926     2620
## s             0.49      0.04     0.41     0.57 1.00     3139     2468
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Yep, “now missingness makes things worse” (p. 503).</p>
<div id="rethinking-naming-completely-at-random." class="section level4 hasAnchor" number="15.2.1.1">
<h4><span class="header-section-number">15.2.1.1</span> Rethinking: Naming completely at random.<a href="missing-data-and-other-opportunities.html#rethinking-naming-completely-at-random." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>McElreath briefly mentioned the terms <strong>missing completely at random</strong> (MCAR), <strong>missing at random</strong> (MAR), and <strong>missing not at random</strong> (MNAR). I share his sentiments; these terms are awful. However, they’re peppered throughout the missing data literature and I recommend you familiarize yourself with them. In his endnote #227, McElreath pointed readers to the authoritative work of <span class="citation">Donald B. Rubin (<a href="#ref-rubinInferenceAndMissingData1976" role="doc-biblioref">1976</a>)</span> and Little and Rubin <span class="citation">(<a href="#ref-littleStatisticalAnalysisMissing2019" role="doc-biblioref">2019</a>, though he referenced the second edition, whereas I’m referencing the third)</span>. <span class="citation">Baraldi &amp; Enders (<a href="#ref-baraldiIntroductionToModernMissingData2010" role="doc-biblioref">2010</a>)</span> is a nice primer, too. Also, the great <a href="https://statistics.fas.harvard.edu/people/donald-b-rubin">Donald Rubin</a> has several lectures available online. Here’s a <a href="https://youtu.be/AH7lvy45k2U">link</a> to a talk on causal inference, which includes bits of insights into missing data analysis and lots of historical tidbits, too.</p>
</div>
</div>
<div id="imputing-primates." class="section level3 hasAnchor" number="15.2.2">
<h3><span class="header-section-number">15.2.2</span> Imputing primates.<a href="missing-data-and-other-opportunities.html#imputing-primates." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We return to the <code>milk</code> data.</p>
<div class="sourceCode" id="cb2000"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2000-1"><a href="missing-data-and-other-opportunities.html#cb2000-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(milk, <span class="at">package =</span> <span class="st">&quot;rethinking&quot;</span>)</span>
<span id="cb2000-2"><a href="missing-data-and-other-opportunities.html#cb2000-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> milk</span>
<span id="cb2000-3"><a href="missing-data-and-other-opportunities.html#cb2000-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(milk)</span>
<span id="cb2000-4"><a href="missing-data-and-other-opportunities.html#cb2000-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2000-5"><a href="missing-data-and-other-opportunities.html#cb2000-5" aria-hidden="true" tabindex="-1"></a><span class="co"># transform</span></span>
<span id="cb2000-6"><a href="missing-data-and-other-opportunities.html#cb2000-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb2000-7"><a href="missing-data-and-other-opportunities.html#cb2000-7" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span></span>
<span id="cb2000-8"><a href="missing-data-and-other-opportunities.html#cb2000-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">neocortex.prop =</span> neocortex.perc <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb2000-9"><a href="missing-data-and-other-opportunities.html#cb2000-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">logmass        =</span> <span class="fu">log</span>(mass)) <span class="sc">%&gt;%</span> </span>
<span id="cb2000-10"><a href="missing-data-and-other-opportunities.html#cb2000-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">k =</span> (kcal.per.g <span class="sc">-</span> <span class="fu">mean</span>(kcal.per.g)) <span class="sc">/</span> <span class="fu">sd</span>(kcal.per.g),</span>
<span id="cb2000-11"><a href="missing-data-and-other-opportunities.html#cb2000-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">b =</span> (neocortex.prop <span class="sc">-</span> <span class="fu">mean</span>(neocortex.prop, <span class="at">na.rm =</span> T)) <span class="sc">/</span> <span class="fu">sd</span>(neocortex.prop, <span class="at">na.rm =</span> T),</span>
<span id="cb2000-12"><a href="missing-data-and-other-opportunities.html#cb2000-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">m =</span> (logmass <span class="sc">-</span> <span class="fu">mean</span>(logmass)) <span class="sc">/</span> <span class="fu">sd</span>(logmass))</span></code></pre></div>
<p>Note how we set <code>na.rm = T</code> within the <code>mean()</code> and <code>sd()</code> functions when computing <code>b</code>. See what happens if you leave that part out. As hinted at above and explicated in the text, we’re missing 12 values for <code>neocortex.prop</code>.</p>
<div class="sourceCode" id="cb2001"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2001-1"><a href="missing-data-and-other-opportunities.html#cb2001-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb2001-2"><a href="missing-data-and-other-opportunities.html#cb2001-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(<span class="fu">is.na</span>(neocortex.prop))</span></code></pre></div>
<pre><code>##   is.na(neocortex.prop)  n
## 1                 FALSE 17
## 2                  TRUE 12</code></pre>
<p>We dropped those values when we fit the models back in <a href="the-many-variables-the-spurious-waffles.html#masked-relationship">Chapter 5</a>. To get a sense of whether this was a bad idea, let’s consider the model with a DAG. Ignoring the missing data, we have this.</p>
<div class="sourceCode" id="cb2003"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2003-1"><a href="missing-data-and-other-opportunities.html#cb2003-1" aria-hidden="true" tabindex="-1"></a>dag_coords <span class="ot">&lt;-</span></span>
<span id="cb2003-2"><a href="missing-data-and-other-opportunities.html#cb2003-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;U&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;B&quot;</span>),</span>
<span id="cb2003-3"><a href="missing-data-and-other-opportunities.html#cb2003-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">x    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb2003-4"><a href="missing-data-and-other-opportunities.html#cb2003-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb2003-5"><a href="missing-data-and-other-opportunities.html#cb2003-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2003-6"><a href="missing-data-and-other-opportunities.html#cb2003-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dagify</span>(M <span class="sc">~</span> U,</span>
<span id="cb2003-7"><a href="missing-data-and-other-opportunities.html#cb2003-7" aria-hidden="true" tabindex="-1"></a>       B <span class="sc">~</span> U,</span>
<span id="cb2003-8"><a href="missing-data-and-other-opportunities.html#cb2003-8" aria-hidden="true" tabindex="-1"></a>       K <span class="sc">~</span> M <span class="sc">+</span> B,</span>
<span id="cb2003-9"><a href="missing-data-and-other-opportunities.html#cb2003-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">coords =</span> dag_coords) <span class="sc">%&gt;%</span></span>
<span id="cb2003-10"><a href="missing-data-and-other-opportunities.html#cb2003-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2003-11"><a href="missing-data-and-other-opportunities.html#cb2003-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(name <span class="sc">==</span> <span class="st">&quot;U&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2003-12"><a href="missing-data-and-other-opportunities.html#cb2003-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2003-13"><a href="missing-data-and-other-opportunities.html#cb2003-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb2003-14"><a href="missing-data-and-other-opportunities.html#cb2003-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> color),</span>
<span id="cb2003-15"><a href="missing-data-and-other-opportunities.html#cb2003-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">7</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb2003-16"><a href="missing-data-and-other-opportunities.html#cb2003-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>() <span class="sc">+</span></span>
<span id="cb2003-17"><a href="missing-data-and-other-opportunities.html#cb2003-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">edge_colour =</span> <span class="st">&quot;#FCF9F0&quot;</span>) <span class="sc">+</span></span>
<span id="cb2003-18"><a href="missing-data-and-other-opportunities.html#cb2003-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">2</span>], <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span></span>
<span id="cb2003-19"><a href="missing-data-and-other-opportunities.html#cb2003-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dark_theme_void</span>()</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-53-1.png" width="240" style="display: block; margin: auto;" /></p>
<p>“<span class="math inline">\(M\)</span> is body mass, <span class="math inline">\(B\)</span> is neocortex percent, <span class="math inline">\(K\)</span> is milk energy, and <span class="math inline">\(U\)</span> is some unobserved variable that renders <span class="math inline">\(M\)</span> and <span class="math inline">\(B\)</span> positively correlated” (p. 504). Because we have missingness in <span class="math inline">\(B\)</span>, our data in hand are actually <span class="math inline">\(B^*\)</span>. McElreath considered three processes that may have generated these missing data. Here are the DAGs.</p>
<div class="sourceCode" id="cb2004"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2004-1"><a href="missing-data-and-other-opportunities.html#cb2004-1" aria-hidden="true" tabindex="-1"></a>dag_coords <span class="ot">&lt;-</span></span>
<span id="cb2004-2"><a href="missing-data-and-other-opportunities.html#cb2004-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;U&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;RB&quot;</span>, <span class="st">&quot;Bs&quot;</span>),</span>
<span id="cb2004-3"><a href="missing-data-and-other-opportunities.html#cb2004-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">x    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb2004-4"><a href="missing-data-and-other-opportunities.html#cb2004-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb2004-5"><a href="missing-data-and-other-opportunities.html#cb2004-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2004-6"><a href="missing-data-and-other-opportunities.html#cb2004-6" aria-hidden="true" tabindex="-1"></a><span class="co"># left</span></span>
<span id="cb2004-7"><a href="missing-data-and-other-opportunities.html#cb2004-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb2004-8"><a href="missing-data-and-other-opportunities.html#cb2004-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dagify</span>(M  <span class="sc">~</span> U,</span>
<span id="cb2004-9"><a href="missing-data-and-other-opportunities.html#cb2004-9" aria-hidden="true" tabindex="-1"></a>         B  <span class="sc">~</span> U,</span>
<span id="cb2004-10"><a href="missing-data-and-other-opportunities.html#cb2004-10" aria-hidden="true" tabindex="-1"></a>         K  <span class="sc">~</span> M <span class="sc">+</span> B,</span>
<span id="cb2004-11"><a href="missing-data-and-other-opportunities.html#cb2004-11" aria-hidden="true" tabindex="-1"></a>         Bs <span class="sc">~</span> RB <span class="sc">+</span> B,</span>
<span id="cb2004-12"><a href="missing-data-and-other-opportunities.html#cb2004-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">coords =</span> dag_coords) <span class="sc">%&gt;%</span></span>
<span id="cb2004-13"><a href="missing-data-and-other-opportunities.html#cb2004-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2004-14"><a href="missing-data-and-other-opportunities.html#cb2004-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;U&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2004-15"><a href="missing-data-and-other-opportunities.html#cb2004-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2004-16"><a href="missing-data-and-other-opportunities.html#cb2004-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb2004-17"><a href="missing-data-and-other-opportunities.html#cb2004-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> color),</span>
<span id="cb2004-18"><a href="missing-data-and-other-opportunities.html#cb2004-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">7</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb2004-19"><a href="missing-data-and-other-opportunities.html#cb2004-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>(<span class="at">parse =</span> T, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="fu">expression</span>(R[B]), <span class="st">&quot;U&quot;</span>, <span class="fu">expression</span>(B<span class="sc">^</span><span class="st">&#39;*&#39;</span>), <span class="st">&quot;K&quot;</span>)) <span class="sc">+</span></span>
<span id="cb2004-20"><a href="missing-data-and-other-opportunities.html#cb2004-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">edge_colour =</span> <span class="st">&quot;#FCF9F0&quot;</span>)</span>
<span id="cb2004-21"><a href="missing-data-and-other-opportunities.html#cb2004-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2004-22"><a href="missing-data-and-other-opportunities.html#cb2004-22" aria-hidden="true" tabindex="-1"></a><span class="co"># middle</span></span>
<span id="cb2004-23"><a href="missing-data-and-other-opportunities.html#cb2004-23" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb2004-24"><a href="missing-data-and-other-opportunities.html#cb2004-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dagify</span>(M  <span class="sc">~</span> U,</span>
<span id="cb2004-25"><a href="missing-data-and-other-opportunities.html#cb2004-25" aria-hidden="true" tabindex="-1"></a>         B  <span class="sc">~</span> U,</span>
<span id="cb2004-26"><a href="missing-data-and-other-opportunities.html#cb2004-26" aria-hidden="true" tabindex="-1"></a>         K  <span class="sc">~</span> M <span class="sc">+</span> B,</span>
<span id="cb2004-27"><a href="missing-data-and-other-opportunities.html#cb2004-27" aria-hidden="true" tabindex="-1"></a>         Bs <span class="sc">~</span> RB <span class="sc">+</span> B,</span>
<span id="cb2004-28"><a href="missing-data-and-other-opportunities.html#cb2004-28" aria-hidden="true" tabindex="-1"></a>         RB <span class="sc">~</span> M,</span>
<span id="cb2004-29"><a href="missing-data-and-other-opportunities.html#cb2004-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">coords =</span> dag_coords) <span class="sc">%&gt;%</span></span>
<span id="cb2004-30"><a href="missing-data-and-other-opportunities.html#cb2004-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2004-31"><a href="missing-data-and-other-opportunities.html#cb2004-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;U&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2004-32"><a href="missing-data-and-other-opportunities.html#cb2004-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2004-33"><a href="missing-data-and-other-opportunities.html#cb2004-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb2004-34"><a href="missing-data-and-other-opportunities.html#cb2004-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> color),</span>
<span id="cb2004-35"><a href="missing-data-and-other-opportunities.html#cb2004-35" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">7</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb2004-36"><a href="missing-data-and-other-opportunities.html#cb2004-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>(<span class="at">parse =</span> T, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="fu">expression</span>(R[B]), <span class="st">&quot;U&quot;</span>, <span class="fu">expression</span>(B<span class="sc">^</span><span class="st">&#39;*&#39;</span>), <span class="st">&quot;K&quot;</span>)) <span class="sc">+</span></span>
<span id="cb2004-37"><a href="missing-data-and-other-opportunities.html#cb2004-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">edge_colour =</span> <span class="st">&quot;#FCF9F0&quot;</span>)</span>
<span id="cb2004-38"><a href="missing-data-and-other-opportunities.html#cb2004-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2004-39"><a href="missing-data-and-other-opportunities.html#cb2004-39" aria-hidden="true" tabindex="-1"></a><span class="co"># right</span></span>
<span id="cb2004-40"><a href="missing-data-and-other-opportunities.html#cb2004-40" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span></span>
<span id="cb2004-41"><a href="missing-data-and-other-opportunities.html#cb2004-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dagify</span>(M  <span class="sc">~</span> U,</span>
<span id="cb2004-42"><a href="missing-data-and-other-opportunities.html#cb2004-42" aria-hidden="true" tabindex="-1"></a>         B  <span class="sc">~</span> U,</span>
<span id="cb2004-43"><a href="missing-data-and-other-opportunities.html#cb2004-43" aria-hidden="true" tabindex="-1"></a>         K  <span class="sc">~</span> M <span class="sc">+</span> B,</span>
<span id="cb2004-44"><a href="missing-data-and-other-opportunities.html#cb2004-44" aria-hidden="true" tabindex="-1"></a>         Bs <span class="sc">~</span> RB <span class="sc">+</span> B,</span>
<span id="cb2004-45"><a href="missing-data-and-other-opportunities.html#cb2004-45" aria-hidden="true" tabindex="-1"></a>         RB <span class="sc">~</span> B,</span>
<span id="cb2004-46"><a href="missing-data-and-other-opportunities.html#cb2004-46" aria-hidden="true" tabindex="-1"></a>         <span class="at">coords =</span> dag_coords) <span class="sc">%&gt;%</span></span>
<span id="cb2004-47"><a href="missing-data-and-other-opportunities.html#cb2004-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2004-48"><a href="missing-data-and-other-opportunities.html#cb2004-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;U&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2004-49"><a href="missing-data-and-other-opportunities.html#cb2004-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2004-50"><a href="missing-data-and-other-opportunities.html#cb2004-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb2004-51"><a href="missing-data-and-other-opportunities.html#cb2004-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> color),</span>
<span id="cb2004-52"><a href="missing-data-and-other-opportunities.html#cb2004-52" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">7</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb2004-53"><a href="missing-data-and-other-opportunities.html#cb2004-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>(<span class="at">parse =</span> T, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="fu">expression</span>(R[B]), <span class="st">&quot;U&quot;</span>, <span class="fu">expression</span>(B<span class="sc">^</span><span class="st">&#39;*&#39;</span>), <span class="st">&quot;K&quot;</span>)) <span class="sc">+</span></span>
<span id="cb2004-54"><a href="missing-data-and-other-opportunities.html#cb2004-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">edge_colour =</span> <span class="st">&quot;#FCF9F0&quot;</span>)</span>
<span id="cb2004-55"><a href="missing-data-and-other-opportunities.html#cb2004-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2004-56"><a href="missing-data-and-other-opportunities.html#cb2004-56" aria-hidden="true" tabindex="-1"></a><span class="co"># combine!</span></span>
<span id="cb2004-57"><a href="missing-data-and-other-opportunities.html#cb2004-57" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3) <span class="sc">&amp;</span></span>
<span id="cb2004-58"><a href="missing-data-and-other-opportunities.html#cb2004-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">2</span>], <span class="st">&quot;black&quot;</span>)) <span class="sc">&amp;</span></span>
<span id="cb2004-59"><a href="missing-data-and-other-opportunities.html#cb2004-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dark_theme_void</span>() <span class="sc">&amp;</span></span>
<span id="cb2004-60"><a href="missing-data-and-other-opportunities.html#cb2004-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;black&quot;</span>),</span>
<span id="cb2004-61"><a href="missing-data-and-other-opportunities.html#cb2004-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;grey8&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey8&quot;</span>),</span>
<span id="cb2004-62"><a href="missing-data-and-other-opportunities.html#cb2004-62" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="st">&quot;in&quot;</span>))</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-54-1.png" width="696" style="display: block; margin: auto;" /></p>
<p>In each of the DAGs, the new variable <span class="math inline">\(R_B\)</span> simply indicates whether a given species has missingness in <span class="math inline">\(B^*\)</span>, much like our dog variable <span class="math inline">\(D\)</span> indicated the missing data in the DAGs from the earlier DAGs. The big difference between then and now is that whereas we had a sense of what was causing the missing data in the earlier examples (i.e., those hungry <span class="math inline">\(D\)</span> dogs), now we only have a generic missing data mechanism, <span class="math inline">\(R_B\)</span>. In the middle of page 505, McElreath asked we consider one more missing data mechanism, this time with a new unmeasured causal variable <span class="math inline">\(V\)</span>.</p>
<div class="sourceCode" id="cb2005"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2005-1"><a href="missing-data-and-other-opportunities.html#cb2005-1" aria-hidden="true" tabindex="-1"></a>dag_coords <span class="ot">&lt;-</span></span>
<span id="cb2005-2"><a href="missing-data-and-other-opportunities.html#cb2005-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;U&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;Bs&quot;</span>, <span class="st">&quot;RB&quot;</span>, <span class="st">&quot;V&quot;</span>),</span>
<span id="cb2005-3"><a href="missing-data-and-other-opportunities.html#cb2005-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">x    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="fl">3.4</span>),</span>
<span id="cb2005-4"><a href="missing-data-and-other-opportunities.html#cb2005-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="fl">1.45</span>))</span>
<span id="cb2005-5"><a href="missing-data-and-other-opportunities.html#cb2005-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2005-6"><a href="missing-data-and-other-opportunities.html#cb2005-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dagify</span>(M  <span class="sc">~</span> U,</span>
<span id="cb2005-7"><a href="missing-data-and-other-opportunities.html#cb2005-7" aria-hidden="true" tabindex="-1"></a>       B  <span class="sc">~</span> U <span class="sc">+</span> V,</span>
<span id="cb2005-8"><a href="missing-data-and-other-opportunities.html#cb2005-8" aria-hidden="true" tabindex="-1"></a>       K  <span class="sc">~</span> M <span class="sc">+</span> B,</span>
<span id="cb2005-9"><a href="missing-data-and-other-opportunities.html#cb2005-9" aria-hidden="true" tabindex="-1"></a>       Bs <span class="sc">~</span> RB <span class="sc">+</span> B,</span>
<span id="cb2005-10"><a href="missing-data-and-other-opportunities.html#cb2005-10" aria-hidden="true" tabindex="-1"></a>       RB <span class="sc">~</span> V,</span>
<span id="cb2005-11"><a href="missing-data-and-other-opportunities.html#cb2005-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">coords =</span> dag_coords) <span class="sc">%&gt;%</span></span>
<span id="cb2005-12"><a href="missing-data-and-other-opportunities.html#cb2005-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2005-13"><a href="missing-data-and-other-opportunities.html#cb2005-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;U&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;V&quot;</span>), <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2005-14"><a href="missing-data-and-other-opportunities.html#cb2005-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2005-15"><a href="missing-data-and-other-opportunities.html#cb2005-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb2005-16"><a href="missing-data-and-other-opportunities.html#cb2005-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> color),</span>
<span id="cb2005-17"><a href="missing-data-and-other-opportunities.html#cb2005-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">7</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb2005-18"><a href="missing-data-and-other-opportunities.html#cb2005-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>(<span class="at">parse =</span> T, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="fu">expression</span>(R[B]), <span class="st">&quot;U&quot;</span>, <span class="st">&quot;V&quot;</span>, <span class="fu">expression</span>(B<span class="sc">^</span><span class="st">&#39;*&#39;</span>), <span class="st">&quot;K&quot;</span>)) <span class="sc">+</span></span>
<span id="cb2005-19"><a href="missing-data-and-other-opportunities.html#cb2005-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">edge_colour =</span> <span class="st">&quot;#FCF9F0&quot;</span>) <span class="sc">+</span></span>
<span id="cb2005-20"><a href="missing-data-and-other-opportunities.html#cb2005-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">2</span>], <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span></span>
<span id="cb2005-21"><a href="missing-data-and-other-opportunities.html#cb2005-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dark_theme_void</span>()</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-55-1.png" width="360" style="display: block; margin: auto;" /></p>
<p>However, our statistical model will follow the form</p>
<p><span class="math display">\[\begin{align*}
K_i     &amp; \sim \operatorname{Normal}(\mu_i, \sigma) \\
\mu_i   &amp; = \alpha + \beta_1 \color{#5D01A6FF}{B_i} + \beta_2 \log M_i \\
\color{#5D01A6FF}{B_i} &amp; \color{#5D01A6FF}\sim \color{#5D01A6FF}{\operatorname{Normal}(\nu, \sigma_B)} \\
\alpha  &amp; \sim \operatorname{Normal}(0, 0.5) \\
\beta_1 &amp; \sim \operatorname{Normal}(0, 0.5) \\
\beta_2 &amp; \sim \operatorname{Normal}(0, 0.5) \\
\sigma  &amp; \sim \operatorname{Exponential}(1) \\
\color{#5D01A6FF}\nu &amp; \color{#5D01A6FF}\sim \color{#5D01A6FF}{\operatorname{Normal}(0, 0.5)} \\
\color{#5D01A6FF}{\sigma_B} &amp; \color{#5D01A6FF}\sim \color{#5D01A6FF}{\operatorname{Exponential}(1)},
\end{align*}\]</span></p>
<p>where we simply presume the missing values in <span class="math inline">\(B_i\)</span>, which was <span class="math inline">\(B^*\)</span> in our DAGs, are unrelated to any of the other variables in the model. But those missing values in <span class="math inline">\(B_i\)</span> values do get their own prior distribution, <span class="math inline">\(\operatorname{Normal}(\nu, \sigma_B)\)</span>. If you look closely, you’ll discover the prior McElreath reported for <span class="math inline">\(\nu\)</span> <span class="math inline">\([\operatorname{Normal}(0.5, 1)]\)</span> does not match up with his <code>rethinking::ulam()</code> code in his <strong>R</strong> code block 15.17, <span class="math inline">\(\operatorname{Normal}(0, 0.5)\)</span>. Here we use the latter.</p>
<p>When writing a multivariate model in <strong>brms</strong>, I find it easier to save the model code by itself and then insert it into the <code>brm()</code> function. Otherwise, things start to feel cluttered.</p>
<div class="sourceCode" id="cb2006"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2006-1"><a href="missing-data-and-other-opportunities.html#cb2006-1" aria-hidden="true" tabindex="-1"></a>b_model <span class="ot">&lt;-</span> </span>
<span id="cb2006-2"><a href="missing-data-and-other-opportunities.html#cb2006-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here&#39;s the primary `k` model</span></span>
<span id="cb2006-3"><a href="missing-data-and-other-opportunities.html#cb2006-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(k <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">mi</span>(b) <span class="sc">+</span> m) <span class="sc">+</span> </span>
<span id="cb2006-4"><a href="missing-data-and-other-opportunities.html#cb2006-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here&#39;s the model for the missing `b` data </span></span>
<span id="cb2006-5"><a href="missing-data-and-other-opportunities.html#cb2006-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(b <span class="sc">|</span> <span class="fu">mi</span>() <span class="sc">~</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb2006-6"><a href="missing-data-and-other-opportunities.html#cb2006-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here we set the residual correlations for the two models to zero</span></span>
<span id="cb2006-7"><a href="missing-data-and-other-opportunities.html#cb2006-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_rescor</span>(<span class="cn">FALSE</span>)</span></code></pre></div>
<p>Note the <code>mi(b)</code> syntax in the <code>k</code> model. This indicates that the predictor, <code>b</code>, has missing values that are themselves being modeled. To get a sense of how to specify the priors for such a model in <strong>brms</strong>, use the <code>get_prior()</code> function.</p>
<div class="sourceCode" id="cb2007"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2007-1"><a href="missing-data-and-other-opportunities.html#cb2007-1" aria-hidden="true" tabindex="-1"></a><span class="fu">get_prior</span>(<span class="at">data =</span> d, </span>
<span id="cb2007-2"><a href="missing-data-and-other-opportunities.html#cb2007-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">family =</span> gaussian,</span>
<span id="cb2007-3"><a href="missing-data-and-other-opportunities.html#cb2007-3" aria-hidden="true" tabindex="-1"></a>          b_model)</span></code></pre></div>
<pre><code>##                    prior     class coef group resp dpar nlpar lb ub       source
##                   (flat)         b                                       default
##                   (flat) Intercept                                       default
##   student_t(3, 0.2, 2.5) Intercept               b                       default
##     student_t(3, 0, 2.5)     sigma               b             0         default
##                   (flat)         b               k                       default
##                   (flat)         b    m          k                  (vectorized)
##                   (flat)         b  mib          k                  (vectorized)
##  student_t(3, -0.3, 2.5) Intercept               k                       default
##     student_t(3, 0, 2.5)     sigma               k             0         default</code></pre>
<p>With the one-step Bayesian imputation procedure in <strong>brms</strong>, you might need to use the <code>resp</code> argument when specifying non-default priors. Now fit the model.</p>
<div class="sourceCode" id="cb2009"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2009-1"><a href="missing-data-and-other-opportunities.html#cb2009-1" aria-hidden="true" tabindex="-1"></a>b15<span class="fl">.5</span> <span class="ot">&lt;-</span> </span>
<span id="cb2009-2"><a href="missing-data-and-other-opportunities.html#cb2009-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d, </span>
<span id="cb2009-3"><a href="missing-data-and-other-opportunities.html#cb2009-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb2009-4"><a href="missing-data-and-other-opportunities.html#cb2009-4" aria-hidden="true" tabindex="-1"></a>      b_model,  <span class="co"># here we insert the model</span></span>
<span id="cb2009-5"><a href="missing-data-and-other-opportunities.html#cb2009-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> k),</span>
<span id="cb2009-6"><a href="missing-data-and-other-opportunities.html#cb2009-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> b),</span>
<span id="cb2009-7"><a href="missing-data-and-other-opportunities.html#cb2009-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b,         <span class="at">resp =</span> k),</span>
<span id="cb2009-8"><a href="missing-data-and-other-opportunities.html#cb2009-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma,     <span class="at">resp =</span> k),</span>
<span id="cb2009-9"><a href="missing-data-and-other-opportunities.html#cb2009-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma,     <span class="at">resp =</span> b)),</span>
<span id="cb2009-10"><a href="missing-data-and-other-opportunities.html#cb2009-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb2009-11"><a href="missing-data-and-other-opportunities.html#cb2009-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">15</span>,</span>
<span id="cb2009-12"><a href="missing-data-and-other-opportunities.html#cb2009-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/b15.05&quot;</span>)</span></code></pre></div>
<p>With a model like this, <code>print()</code> only gives up part of the picture.</p>
<div class="sourceCode" id="cb2010"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2010-1"><a href="missing-data-and-other-opportunities.html#cb2010-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b15<span class="fl">.5</span>)</span></code></pre></div>
<pre><code>##  Family: MV(gaussian, gaussian) 
##   Links: mu = identity; sigma = identity
##          mu = identity; sigma = identity 
## Formula: k ~ 1 + mi(b) + m 
##          b | mi() ~ 1 
##    Data: d (Number of observations: 29) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## k_Intercept     0.03      0.16    -0.30     0.34 1.00     3931     2737
## b_Intercept    -0.05      0.21    -0.45     0.37 1.00     3598     3019
## k_m            -0.54      0.20    -0.92    -0.13 1.00     1903     2868
## k_mib           0.49      0.24     0.00     0.93 1.00     1493     2308
## 
## Family Specific Parameters: 
##         Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma_k     0.85      0.14     0.61     1.15 1.00     1719     2810
## sigma_b     1.01      0.17     0.74     1.42 1.00     2439     2637
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Note that for the parameters summarized in the ‘Population-Level Effects:’ section, the criterion is indexed in the prefix. The parameters in the ‘Family Specific Parameters:’, however, have the criteria indexed in the suffix. I don’t know why. Anyway, we can get a summary of the imputed values with <code>posterior_summary()</code>.</p>
<div class="sourceCode" id="cb2012"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2012-1"><a href="missing-data-and-other-opportunities.html#cb2012-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b15<span class="fl">.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2012-2"><a href="missing-data-and-other-opportunities.html#cb2012-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##               Estimate Est.Error   Q2.5  Q97.5
## b_k_Intercept     0.03      0.16  -0.30   0.34
## b_b_Intercept    -0.05      0.21  -0.45   0.37
## b_k_m            -0.54      0.20  -0.92  -0.13
## bsp_k_mib         0.49      0.24   0.00   0.93
## sigma_k           0.85      0.14   0.61   1.15
## sigma_b           1.01      0.17   0.74   1.42
## Ymi_b[2]         -0.57      0.93  -2.36   1.30
## Ymi_b[3]         -0.70      0.95  -2.50   1.32
## Ymi_b[4]         -0.69      0.96  -2.55   1.28
## Ymi_b[5]         -0.29      0.92  -2.10   1.59
## Ymi_b[9]          0.47      0.93  -1.38   2.28
## Ymi_b[14]        -0.17      0.91  -1.96   1.61
## Ymi_b[15]         0.20      0.89  -1.61   1.95
## Ymi_b[17]         0.27      0.93  -1.67   2.11
## Ymi_b[19]         0.49      0.94  -1.48   2.29
## Ymi_b[21]        -0.45      0.92  -2.23   1.42
## Ymi_b[23]        -0.27      0.90  -2.01   1.57
## Ymi_b[26]         0.14      0.93  -1.80   1.93
## lprior           -4.16      0.80  -6.04  -3.00
## lp__            -81.42      4.06 -90.41 -74.61</code></pre>
<p>The imputed <code>b</code> values are indexed by occasion number from the original data. This is in contrast with McElreath’s <code>precis()</code> output, which simply serially indexes the missing values as <code>B_impute[1]</code>, <code>B_impute[2]</code>, and so on.</p>
<p>Before we move on to the next model, let’s plot to get a sense of what we’ve done.</p>
<div class="sourceCode" id="cb2014"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2014-1"><a href="missing-data-and-other-opportunities.html#cb2014-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_draws_df</span>(b15<span class="fl">.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2014-2"><a href="missing-data-and-other-opportunities.html#cb2014-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">starts_with</span>(<span class="st">&quot;Ymi_b&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2014-3"><a href="missing-data-and-other-opportunities.html#cb2014-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="fu">filter</span>(d, <span class="fu">is.na</span>(b)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(species)) <span class="sc">%&gt;%</span> </span>
<span id="cb2014-4"><a href="missing-data-and-other-opportunities.html#cb2014-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(),</span>
<span id="cb2014-5"><a href="missing-data-and-other-opportunities.html#cb2014-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;species&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2014-6"><a href="missing-data-and-other-opportunities.html#cb2014-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2014-7"><a href="missing-data-and-other-opportunities.html#cb2014-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, </span>
<span id="cb2014-8"><a href="missing-data-and-other-opportunities.html#cb2014-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> <span class="fu">reorder</span>(species, value))) <span class="sc">+</span></span>
<span id="cb2014-9"><a href="missing-data-and-other-opportunities.html#cb2014-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_slab</span>(<span class="at">fill =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">4</span>], </span>
<span id="cb2014-10"><a href="missing-data-and-other-opportunities.html#cb2014-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">height =</span> <span class="fl">1.5</span>, <span class="at">slab_color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">slab_size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb2014-11"><a href="missing-data-and-other-opportunities.html#cb2014-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;imputed values for b&quot;</span>,</span>
<span id="cb2014-12"><a href="missing-data-and-other-opportunities.html#cb2014-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2014-13"><a href="missing-data-and-other-opportunities.html#cb2014-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb2014-14"><a href="missing-data-and-other-opportunities.html#cb2014-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-60-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Here’s the model that drops the cases with NAs on <code>b</code>.</p>
<div class="sourceCode" id="cb2015"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2015-1"><a href="missing-data-and-other-opportunities.html#cb2015-1" aria-hidden="true" tabindex="-1"></a>b15<span class="fl">.6</span> <span class="ot">&lt;-</span> </span>
<span id="cb2015-2"><a href="missing-data-and-other-opportunities.html#cb2015-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d, </span>
<span id="cb2015-3"><a href="missing-data-and-other-opportunities.html#cb2015-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb2015-4"><a href="missing-data-and-other-opportunities.html#cb2015-4" aria-hidden="true" tabindex="-1"></a>      k <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> b <span class="sc">+</span> m,</span>
<span id="cb2015-5"><a href="missing-data-and-other-opportunities.html#cb2015-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb2015-6"><a href="missing-data-and-other-opportunities.html#cb2015-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b),</span>
<span id="cb2015-7"><a href="missing-data-and-other-opportunities.html#cb2015-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma)),</span>
<span id="cb2015-8"><a href="missing-data-and-other-opportunities.html#cb2015-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb2015-9"><a href="missing-data-and-other-opportunities.html#cb2015-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">15</span>,</span>
<span id="cb2015-10"><a href="missing-data-and-other-opportunities.html#cb2015-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/b15.06&quot;</span>)</span></code></pre></div>
<p>If you run this on your computer, you’ll notice the following message at the top: “Rows containing NAs were excluded from the model.” This time <code>print()</code> gives us the same basic summary information as <code>posterior_summary()</code>.</p>
<div class="sourceCode" id="cb2016"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2016-1"><a href="missing-data-and-other-opportunities.html#cb2016-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b15<span class="fl">.6</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: k ~ 1 + b + m 
##    Data: d (Number of observations: 17) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     0.10      0.19    -0.27     0.47 1.00     3526     2465
## b             0.59      0.29    -0.00     1.11 1.00     1895     2382
## m            -0.63      0.25    -1.10    -0.10 1.00     1985     2265
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     0.89      0.20     0.60     1.36 1.00     2112     1803
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>We can’t use McElreath’s <code>plot(coeftab())</code> trick with our <strong>brms</strong> output, but we can still get by.</p>
<div class="sourceCode" id="cb2018"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2018-1"><a href="missing-data-and-other-opportunities.html#cb2018-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wrangle</span></span>
<span id="cb2018-2"><a href="missing-data-and-other-opportunities.html#cb2018-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">fixef</span>(b15<span class="fl">.5</span>) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>),</span>
<span id="cb2018-3"><a href="missing-data-and-other-opportunities.html#cb2018-3" aria-hidden="true" tabindex="-1"></a>          <span class="fu">fixef</span>(b15<span class="fl">.6</span>) <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2018-4"><a href="missing-data-and-other-opportunities.html#cb2018-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">6</span><span class="sc">:</span><span class="dv">7</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2018-5"><a href="missing-data-and-other-opportunities.html#cb2018-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">str_c</span>(<span class="st">&quot;beta[&quot;</span>, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>), <span class="st">&quot;]&quot;</span>),</span>
<span id="cb2018-6"><a href="missing-data-and-other-opportunities.html#cb2018-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">fit  =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;b15.5&quot;</span>, <span class="st">&quot;b15.6&quot;</span>), <span class="at">each =</span> <span class="fu">n</span>() <span class="sc">/</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2018-7"><a href="missing-data-and-other-opportunities.html#cb2018-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2018-8"><a href="missing-data-and-other-opportunities.html#cb2018-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb2018-9"><a href="missing-data-and-other-opportunities.html#cb2018-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">y =</span> fit)) <span class="sc">+</span></span>
<span id="cb2018-10"><a href="missing-data-and-other-opportunities.html#cb2018-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb2018-11"><a href="missing-data-and-other-opportunities.html#cb2018-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> Q2<span class="fl">.5</span>, <span class="at">xmax =</span> Q97<span class="fl">.5</span>)) <span class="sc">+</span></span>
<span id="cb2018-12"><a href="missing-data-and-other-opportunities.html#cb2018-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;marginal posterior&quot;</span>,</span>
<span id="cb2018-13"><a href="missing-data-and-other-opportunities.html#cb2018-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2018-14"><a href="missing-data-and-other-opportunities.html#cb2018-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb2018-15"><a href="missing-data-and-other-opportunities.html#cb2018-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>)) <span class="sc">+</span></span>
<span id="cb2018-16"><a href="missing-data-and-other-opportunities.html#cb2018-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> term, <span class="at">labeller =</span> label_parsed, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-62-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The model using Bayesian imputation (<code>b15.5</code>) used more information, resulting in narrower marginal posteriors for <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span>. Because it wasted perfectly good information, the conventional <code>b15.6</code> model was less certain.</p>
<p>In order to make our version of Figure 15.5, we’ll want to add the summary values for the imputed <code>b</code> data from <code>b15.1</code> to the primary data file <code>d</code>.</p>
<div class="sourceCode" id="cb2019"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2019-1"><a href="missing-data-and-other-opportunities.html#cb2019-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb2019-2"><a href="missing-data-and-other-opportunities.html#cb2019-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb2019-3"><a href="missing-data-and-other-opportunities.html#cb2019-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb2019-4"><a href="missing-data-and-other-opportunities.html#cb2019-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb2019-5"><a href="missing-data-and-other-opportunities.html#cb2019-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">posterior_summary</span>(b15<span class="fl">.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2019-6"><a href="missing-data-and-other-opportunities.html#cb2019-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2019-7"><a href="missing-data-and-other-opportunities.html#cb2019-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2019-8"><a href="missing-data-and-other-opportunities.html#cb2019-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(term, <span class="st">&quot;Ymi&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2019-9"><a href="missing-data-and-other-opportunities.html#cb2019-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">str_extract</span>(term, <span class="st">&quot;(</span><span class="sc">\\</span><span class="st">d)+&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">as.integer</span>()),</span>
<span id="cb2019-10"><a href="missing-data-and-other-opportunities.html#cb2019-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">&quot;row&quot;</span></span>
<span id="cb2019-11"><a href="missing-data-and-other-opportunities.html#cb2019-11" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb2019-12"><a href="missing-data-and-other-opportunities.html#cb2019-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2019-13"><a href="missing-data-and-other-opportunities.html#cb2019-13" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb2019-14"><a href="missing-data-and-other-opportunities.html#cb2019-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(species, k<span class="sc">:</span>Q97<span class="fl">.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2019-15"><a href="missing-data-and-other-opportunities.html#cb2019-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 29
## Columns: 10
## $ species   &lt;fct&gt; Eulemur fulvus, E macaco, E mongoz, E rubriventer, Lemur catta, Alouatta seniculus, A pall…
## $ k         &lt;dbl&gt; -0.9400408, -0.8161263, -1.1259125, -1.0019980, -0.2585112, -1.0639553, -0.5063402, 1.5382…
## $ b         &lt;dbl&gt; -2.080196025, NA, NA, NA, NA, -0.508641289, -0.508641289, 0.010742472, NA, 0.213469683, -1…
## $ m         &lt;dbl&gt; -0.4558357, -0.4150024, -0.3071581, -0.5650254, -0.3874772, 0.1274408, 0.1407505, -0.30715…
## $ row       &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25,…
## $ term      &lt;chr&gt; NA, &quot;Ymi_b[2]&quot;, &quot;Ymi_b[3]&quot;, &quot;Ymi_b[4]&quot;, &quot;Ymi_b[5]&quot;, NA, NA, NA, &quot;Ymi_b[9]&quot;, NA, NA, NA, NA…
## $ Estimate  &lt;dbl&gt; NA, -0.5678872, -0.6967808, -0.6945597, -0.2854329, NA, NA, NA, 0.4708264, NA, NA, NA, NA,…
## $ Est.Error &lt;dbl&gt; NA, 0.9334609, 0.9526624, 0.9647238, 0.9220171, NA, NA, NA, 0.9324121, NA, NA, NA, NA, 0.9…
## $ Q2.5      &lt;dbl&gt; NA, -2.359090, -2.496020, -2.547648, -2.095159, NA, NA, NA, -1.379513, NA, NA, NA, NA, -1.…
## $ Q97.5     &lt;dbl&gt; NA, 1.299267, 1.322437, 1.283558, 1.586077, NA, NA, NA, 2.275757, NA, NA, NA, NA, 1.610158…</code></pre>
<p>Now make Figure 15.5.</p>
<div class="sourceCode" id="cb2021"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2021-1"><a href="missing-data-and-other-opportunities.html#cb2021-1" aria-hidden="true" tabindex="-1"></a>color <span class="ot">&lt;-</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;D&quot;</span>)(<span class="dv">7</span>)[<span class="dv">4</span>]</span>
<span id="cb2021-2"><a href="missing-data-and-other-opportunities.html#cb2021-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2021-3"><a href="missing-data-and-other-opportunities.html#cb2021-3" aria-hidden="true" tabindex="-1"></a><span class="co"># left</span></span>
<span id="cb2021-4"><a href="missing-data-and-other-opportunities.html#cb2021-4" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb2021-5"><a href="missing-data-and-other-opportunities.html#cb2021-5" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb2021-6"><a href="missing-data-and-other-opportunities.html#cb2021-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> k)) <span class="sc">+</span></span>
<span id="cb2021-7"><a href="missing-data-and-other-opportunities.html#cb2021-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> b),</span>
<span id="cb2021-8"><a href="missing-data-and-other-opportunities.html#cb2021-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> color) <span class="sc">+</span></span>
<span id="cb2021-9"><a href="missing-data-and-other-opportunities.html#cb2021-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">xmin =</span> Q2<span class="fl">.5</span>, <span class="at">xmax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb2021-10"><a href="missing-data-and-other-opportunities.html#cb2021-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">fatten =</span> <span class="dv">8</span>, <span class="at">stroke =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb2021-11"><a href="missing-data-and-other-opportunities.html#cb2021-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;neocortex percent (std)&quot;</span>,</span>
<span id="cb2021-12"><a href="missing-data-and-other-opportunities.html#cb2021-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;kcal milk (std)&quot;</span>) <span class="sc">+</span></span>
<span id="cb2021-13"><a href="missing-data-and-other-opportunities.html#cb2021-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(d<span class="sc">$</span>b, <span class="at">na.rm =</span> T))</span>
<span id="cb2021-14"><a href="missing-data-and-other-opportunities.html#cb2021-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2021-15"><a href="missing-data-and-other-opportunities.html#cb2021-15" aria-hidden="true" tabindex="-1"></a><span class="co"># right</span></span>
<span id="cb2021-16"><a href="missing-data-and-other-opportunities.html#cb2021-16" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb2021-17"><a href="missing-data-and-other-opportunities.html#cb2021-17" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb2021-18"><a href="missing-data-and-other-opportunities.html#cb2021-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> m)) <span class="sc">+</span></span>
<span id="cb2021-19"><a href="missing-data-and-other-opportunities.html#cb2021-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> b),</span>
<span id="cb2021-20"><a href="missing-data-and-other-opportunities.html#cb2021-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> color) <span class="sc">+</span></span>
<span id="cb2021-21"><a href="missing-data-and-other-opportunities.html#cb2021-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb2021-22"><a href="missing-data-and-other-opportunities.html#cb2021-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">fatten =</span> <span class="dv">8</span>, <span class="at">stroke =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb2021-23"><a href="missing-data-and-other-opportunities.html#cb2021-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;log body mass (std)&quot;</span>,</span>
<span id="cb2021-24"><a href="missing-data-and-other-opportunities.html#cb2021-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;neocortex percent (std)&quot;</span>) <span class="sc">+</span></span>
<span id="cb2021-25"><a href="missing-data-and-other-opportunities.html#cb2021-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">range</span>(d<span class="sc">$</span>b, <span class="at">na.rm =</span> T))</span>
<span id="cb2021-26"><a href="missing-data-and-other-opportunities.html#cb2021-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2021-27"><a href="missing-data-and-other-opportunities.html#cb2021-27" aria-hidden="true" tabindex="-1"></a><span class="co"># combine and plot!</span></span>
<span id="cb2021-28"><a href="missing-data-and-other-opportunities.html#cb2021-28" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-64-1.png" width="624" style="display: block; margin: auto;" /></p>
<p>“We can improve this model by changing the imputation model to estimate the relationship between the two predictors” (p. 509). In the text, McElreath accomplished this with the model</p>
<p><span class="math display">\[\begin{align*}
K_i   &amp; \sim \operatorname{Normal}(\mu_i, \sigma) \\
\mu_i &amp; = \alpha + \beta_1 \color{#5D01A6FF}{B_i} + \beta_2 \log M_i \\
\color{#5D01A6FF}{\begin{bmatrix} M_i \\ B_i \end{bmatrix}} &amp; \color{#5D01A6FF} \sim \color{#5D01A6FF}{\operatorname{MVNormal}
\begin{pmatrix}
\begin{bmatrix} \mu_M \\\mu_B \end{bmatrix},
\mathbf \Sigma \end{pmatrix}} \\
\alpha  &amp; \sim \operatorname{Normal}(0, 0.5) \\
\beta_1 &amp; \sim \operatorname{Normal}(0, 0.5) \\
\beta_2 &amp; \sim \operatorname{Normal}(0, 0.5) \\
\sigma  &amp; \sim \operatorname{Exponential}(1) \\
\color{#5D01A6FF}{\mu_M} &amp; \color{#5D01A6FF} \sim \color{#5D01A6FF}{\operatorname{Normal}(0, 0.5)} \\
\color{#5D01A6FF}{\mu_B} &amp; \color{#5D01A6FF} \sim \color{#5D01A6FF}{\operatorname{Normal}(0, 0.5)} \\
\color{#5D01A6FF}{\mathbf \Sigma} &amp; \color{#5D01A6FF} = \color{#5D01A6FF}{\operatorname{\mathbf S \mathbf R \mathbf S}} \\
\color{#5D01A6FF}{\mathbf S} &amp; \color{#5D01A6FF} = \color{#5D01A6FF}{\begin{bmatrix} \sigma_M &amp; 0 \\ 0 &amp; \sigma_B \end{bmatrix}} \\
\color{#5D01A6FF}{\mathbf R} &amp; \color{#5D01A6FF} = \color{#5D01A6FF}{\begin{bmatrix} 1 &amp; \rho \\ \rho &amp; 1 \end{bmatrix}} \\
\color{#5D01A6FF}{\sigma_M}  &amp; \color{#5D01A6FF} \sim \color{#5D01A6FF}{\operatorname{Exponential}(1)} \\
\color{#5D01A6FF}{\sigma_B}  &amp; \color{#5D01A6FF} \sim \color{#5D01A6FF}{\operatorname{Exponential}(1)} \\
\color{#5D01A6FF} \rho       &amp; \color{#5D01A6FF} \sim \color{#5D01A6FF}{\operatorname{LKJ}(2)},
\end{align*}\]</span></p>
<p>which expresses the relationship between the two predictors with a residual correlation matrix, <span class="math inline">\(\mathbf \Sigma\)</span>. Importantly, though <span class="math inline">\(\mathbf \Sigma\)</span> involves the variables <span class="math inline">\(B_i\)</span> and <span class="math inline">\(M_i\)</span>, it does not directly involve the criterion, <span class="math inline">\(K_i\)</span>. As it turns out, the current version of <strong>brms</strong> cannot handle a model of this form. When you fit multivariate models with residual correlations, you have to set them for either all variables or none of them. For a little more on this topic, you can skim through the <a href="https://discourse.mc-stan.org/t/brms-and-heterogeneous-residual-covariance-equivalent-of-at-level-function/6637"><em>Brms and heterogeneous residual covariance - equivalent of “at.level” function</em></a> thread on the Stan Forums. Bürkner’s response to the initial question indicated this kind of model will be available in <strong>brms</strong> version 3.0+, which I suspect will entail a substantial reworking of the multivariate syntax. Until then, we can fit the alternative model</p>
<p><span class="math display">\[\begin{align*}
K_i   &amp; \sim \operatorname{Normal}(\mu_i, \sigma) \\
\mu_i &amp; = \alpha + \beta_1 \color{#5D01A6FF}{B_i} + \beta_2 \log M_i \\
\color{#5D01A6FF}{B_i}   &amp; \color{#5D01A6FF} \sim \color{#5D01A6FF}{\operatorname{Normal}(\nu_i, \sigma_B)} \\
\color{#5D01A6FF}{\nu_i} &amp; \color{#5D01A6FF} = \color{#5D01A6FF}{\gamma + \delta_1 \log M_i} \\
\alpha  &amp; \sim \operatorname{Normal}(0, 0.5) \\
\beta_1 &amp; \sim \operatorname{Normal}(0, 0.5) \\
\beta_2 &amp; \sim \operatorname{Normal}(0, 0.5) \\
\sigma  &amp; \sim \operatorname{Exponential}(1) \\
\color{#5D01A6FF}\gamma     &amp; \color{#5D01A6FF} \sim \color{#5D01A6FF}{\operatorname{Normal}(0, 0.5)} \\
\color{#5D01A6FF}{\delta_1} &amp; \color{#5D01A6FF} \sim \color{#5D01A6FF}{\operatorname{Normal}(0, 0.5)} \\
\color{#5D01A6FF}{\sigma_B} &amp; \color{#5D01A6FF} \sim \color{#5D01A6FF}{\operatorname{Exponential}(1)},
\end{align*}\]</span></p>
<p>which captures the relation among the two predictors as a regression of <span class="math inline">\(M_i\)</span> predicting <span class="math inline">\(B_i\)</span>. Here’s how to fit the model with <strong>brms</strong>.</p>
<div class="sourceCode" id="cb2022"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2022-1"><a href="missing-data-and-other-opportunities.html#cb2022-1" aria-hidden="true" tabindex="-1"></a>b_model <span class="ot">&lt;-</span></span>
<span id="cb2022-2"><a href="missing-data-and-other-opportunities.html#cb2022-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mvbf</span>(<span class="fu">bf</span>(k <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">mi</span>(b) <span class="sc">+</span> m), </span>
<span id="cb2022-3"><a href="missing-data-and-other-opportunities.html#cb2022-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">bf</span>(b <span class="sc">|</span> <span class="fu">mi</span>() <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> m), </span>
<span id="cb2022-4"><a href="missing-data-and-other-opportunities.html#cb2022-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">rescor =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2022-5"><a href="missing-data-and-other-opportunities.html#cb2022-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2022-6"><a href="missing-data-and-other-opportunities.html#cb2022-6" aria-hidden="true" tabindex="-1"></a>b15<span class="fl">.7</span> <span class="ot">&lt;-</span> </span>
<span id="cb2022-7"><a href="missing-data-and-other-opportunities.html#cb2022-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d, </span>
<span id="cb2022-8"><a href="missing-data-and-other-opportunities.html#cb2022-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb2022-9"><a href="missing-data-and-other-opportunities.html#cb2022-9" aria-hidden="true" tabindex="-1"></a>      b_model,</span>
<span id="cb2022-10"><a href="missing-data-and-other-opportunities.html#cb2022-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> k),</span>
<span id="cb2022-11"><a href="missing-data-and-other-opportunities.html#cb2022-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> Intercept, <span class="at">resp =</span> b),</span>
<span id="cb2022-12"><a href="missing-data-and-other-opportunities.html#cb2022-12" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b, <span class="at">resp =</span> k),</span>
<span id="cb2022-13"><a href="missing-data-and-other-opportunities.html#cb2022-13" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">class =</span> b, <span class="at">resp =</span> b),</span>
<span id="cb2022-14"><a href="missing-data-and-other-opportunities.html#cb2022-14" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma,     <span class="at">resp =</span> k),</span>
<span id="cb2022-15"><a href="missing-data-and-other-opportunities.html#cb2022-15" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sigma,     <span class="at">resp =</span> b)),</span>
<span id="cb2022-16"><a href="missing-data-and-other-opportunities.html#cb2022-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb2022-17"><a href="missing-data-and-other-opportunities.html#cb2022-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">15</span>,</span>
<span id="cb2022-18"><a href="missing-data-and-other-opportunities.html#cb2022-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/b15.07&quot;</span>)</span></code></pre></div>
<p>Let’s see what we did.</p>
<div class="sourceCode" id="cb2023"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2023-1"><a href="missing-data-and-other-opportunities.html#cb2023-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b15<span class="fl">.7</span>)</span></code></pre></div>
<pre><code>##  Family: MV(gaussian, gaussian) 
##   Links: mu = identity; sigma = identity
##          mu = identity; sigma = identity 
## Formula: k ~ 1 + mi(b) + m 
##          b | mi() ~ 1 + m 
##    Data: d (Number of observations: 29) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Population-Level Effects: 
##             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## k_Intercept     0.03      0.16    -0.29     0.35 1.00     4101     2867
## b_Intercept    -0.05      0.16    -0.37     0.25 1.00     3357     2830
## k_m            -0.65      0.22    -1.08    -0.19 1.00     1951     3038
## b_m             0.60      0.15     0.31     0.88 1.00     4221     2946
## k_mib           0.59      0.26     0.05     1.05 1.00     1623     2359
## 
## Family Specific Parameters: 
##         Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma_k     0.83      0.14     0.60     1.15 1.00     2159     2574
## sigma_b     0.71      0.13     0.51     1.01 1.00     1973     2337
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>We have two intercepts, <code>k_Intercept</code> (<span class="math inline">\(\alpha\)</span>) and <code>b_Intercept</code> (<span class="math inline">\(\gamma\)</span>). Both are near zero because both <code>k</code> and <code>b</code> are standardized. Our <code>k_mib</code> (<span class="math inline">\(\beta_1\)</span>) and <code>k_m</code> (<span class="math inline">\(\beta_2\)</span>) parameters correspond with McElreath’s <code>bB</code> and <code>bM</code> parameters, respectively. Our summaries for them are very similar to his. Notice our summary for <code>b_m</code> (<span class="math inline">\(\delta_1\)</span>). McElreath doesn’t have a parameter exactly like that, but his close analogue is <code>Rho_BM[1,2]</code> (also <code>Rho_BM[2,1]</code>, which is really the same thing). Also, notice how our summary for <code>b_m</code> is almost the same as the summary for McElreath’s <code>Rho_BM[1,2]</code>. This is because a univariable regression coefficient between two standardized variables is in the same metric as a correlation and McElreath’s <code>Rho_BM[1,2]</code> is just that–a correlation. If you fit McElreath’s model with <strong>rethinking</strong> and execute <code>precis(m15.7, depth = 3)</code>, you’ll see that our <code>sigma_k</code> (<span class="math inline">\(\sigma\)</span>) summary corresponds nicely with his summary for <code>sigma</code>. However, our <code>sigma_b</code> (<span class="math inline">\(\sigma_B\)</span>) is not the same as his <code>Sigma_BM[2]</code>. Why? Because whereas our <code>sigma_b</code> is a residual standard deviation after accounting for the effect of <code>m</code> on <code>b</code>, McElreath’s <code>Sigma_BM[2]</code> is just an estimate of the standard deviation of <code>b</code>. Also, notice that whereas McElreath’s output has a <code>Sigma_BM[1]</code> parameter, we have no direct analogue. Why? Because although <code>m</code> is a predictor variable for both <code>k</code> and <code>b</code>, we did not give it its own likelihood. McElreath, in contrast, entered <code>m</code> into the bivariate likelihood with <code>b</code>.</p>
<p>Our workflow for Figure 15.6 is largely the same as for Figure 15.5. The biggest difference is we need to remove the columns <code>term</code> through <code>upper</code> from our earlier model before we can replace them with those from the current model. After that, it’s basically cut and paste.</p>
<div class="sourceCode" id="cb2025"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2025-1"><a href="missing-data-and-other-opportunities.html#cb2025-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb2025-2"><a href="missing-data-and-other-opportunities.html#cb2025-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb2025-3"><a href="missing-data-and-other-opportunities.html#cb2025-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>(term<span class="sc">:</span>Q97<span class="fl">.5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2025-4"><a href="missing-data-and-other-opportunities.html#cb2025-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb2025-5"><a href="missing-data-and-other-opportunities.html#cb2025-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">posterior_summary</span>(b15<span class="fl">.7</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2025-6"><a href="missing-data-and-other-opportunities.html#cb2025-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2025-7"><a href="missing-data-and-other-opportunities.html#cb2025-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rownames_to_column</span>(<span class="st">&quot;term&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2025-8"><a href="missing-data-and-other-opportunities.html#cb2025-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="fu">str_detect</span>(term, <span class="st">&quot;Ymi&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2025-9"><a href="missing-data-and-other-opportunities.html#cb2025-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">row =</span> <span class="fu">str_extract</span>(term, <span class="st">&quot;(</span><span class="sc">\\</span><span class="st">d)+&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">as.integer</span>()),</span>
<span id="cb2025-10"><a href="missing-data-and-other-opportunities.html#cb2025-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">&quot;row&quot;</span></span>
<span id="cb2025-11"><a href="missing-data-and-other-opportunities.html#cb2025-11" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb2025-12"><a href="missing-data-and-other-opportunities.html#cb2025-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2025-13"><a href="missing-data-and-other-opportunities.html#cb2025-13" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb2025-14"><a href="missing-data-and-other-opportunities.html#cb2025-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(species, k<span class="sc">:</span>Q97<span class="fl">.5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2025-15"><a href="missing-data-and-other-opportunities.html#cb2025-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 29
## Columns: 10
## $ species   &lt;fct&gt; Eulemur fulvus, E macaco, E mongoz, E rubriventer, Lemur catta, Alouatta seniculus, A pall…
## $ k         &lt;dbl&gt; -0.9400408, -0.8161263, -1.1259125, -1.0019980, -0.2585112, -1.0639553, -0.5063402, 1.5382…
## $ b         &lt;dbl&gt; -2.080196025, NA, NA, NA, NA, -0.508641289, -0.508641289, 0.010742472, NA, 0.213469683, -1…
## $ m         &lt;dbl&gt; -0.4558357, -0.4150024, -0.3071581, -0.5650254, -0.3874772, 0.1274408, 0.1407505, -0.30715…
## $ row       &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25,…
## $ term      &lt;chr&gt; NA, &quot;Ymi_b[2]&quot;, &quot;Ymi_b[3]&quot;, &quot;Ymi_b[4]&quot;, &quot;Ymi_b[5]&quot;, NA, NA, NA, &quot;Ymi_b[9]&quot;, NA, NA, NA, NA…
## $ Estimate  &lt;dbl&gt; NA, -0.61615091, -0.65191630, -0.79527056, -0.41939200, NA, NA, NA, -0.21407119, NA, NA, N…
## $ Est.Error &lt;dbl&gt; NA, 0.6623568, 0.6823387, 0.6755403, 0.6484805, NA, NA, NA, 0.6984606, NA, NA, NA, NA, 0.6…
## $ Q2.5      &lt;dbl&gt; NA, -1.8763554, -1.9451787, -2.1405244, -1.6934081, NA, NA, NA, -1.5656393, NA, NA, NA, NA…
## $ Q97.5     &lt;dbl&gt; NA, 0.6848422, 0.6939366, 0.5622082, 0.9034718, NA, NA, NA, 1.1770122, NA, NA, NA, NA, 0.6…</code></pre>
<p>Now make Figure 15.6.</p>
<div class="sourceCode" id="cb2027"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2027-1"><a href="missing-data-and-other-opportunities.html#cb2027-1" aria-hidden="true" tabindex="-1"></a>color <span class="ot">&lt;-</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;D&quot;</span>)(<span class="dv">7</span>)[<span class="dv">3</span>]</span>
<span id="cb2027-2"><a href="missing-data-and-other-opportunities.html#cb2027-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2027-3"><a href="missing-data-and-other-opportunities.html#cb2027-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb2027-4"><a href="missing-data-and-other-opportunities.html#cb2027-4" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb2027-5"><a href="missing-data-and-other-opportunities.html#cb2027-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> k)) <span class="sc">+</span></span>
<span id="cb2027-6"><a href="missing-data-and-other-opportunities.html#cb2027-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> b),</span>
<span id="cb2027-7"><a href="missing-data-and-other-opportunities.html#cb2027-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> color) <span class="sc">+</span></span>
<span id="cb2027-8"><a href="missing-data-and-other-opportunities.html#cb2027-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">xmin =</span> Q2<span class="fl">.5</span>, <span class="at">xmax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb2027-9"><a href="missing-data-and-other-opportunities.html#cb2027-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">fatten =</span> <span class="dv">8</span>, <span class="at">stroke =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb2027-10"><a href="missing-data-and-other-opportunities.html#cb2027-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;neocortex percent (std)&quot;</span>,</span>
<span id="cb2027-11"><a href="missing-data-and-other-opportunities.html#cb2027-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;kcal milk (std)&quot;</span>) <span class="sc">+</span></span>
<span id="cb2027-12"><a href="missing-data-and-other-opportunities.html#cb2027-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">range</span>(d<span class="sc">$</span>b, <span class="at">na.rm =</span> T))</span>
<span id="cb2027-13"><a href="missing-data-and-other-opportunities.html#cb2027-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2027-14"><a href="missing-data-and-other-opportunities.html#cb2027-14" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb2027-15"><a href="missing-data-and-other-opportunities.html#cb2027-15" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb2027-16"><a href="missing-data-and-other-opportunities.html#cb2027-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> m)) <span class="sc">+</span></span>
<span id="cb2027-17"><a href="missing-data-and-other-opportunities.html#cb2027-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> b),</span>
<span id="cb2027-18"><a href="missing-data-and-other-opportunities.html#cb2027-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> color) <span class="sc">+</span></span>
<span id="cb2027-19"><a href="missing-data-and-other-opportunities.html#cb2027-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">y =</span> Estimate, <span class="at">ymin =</span> Q2<span class="fl">.5</span>, <span class="at">ymax =</span> Q97<span class="fl">.5</span>),</span>
<span id="cb2027-20"><a href="missing-data-and-other-opportunities.html#cb2027-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">fatten =</span> <span class="dv">8</span>, <span class="at">stroke =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb2027-21"><a href="missing-data-and-other-opportunities.html#cb2027-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;log body mass (std)&quot;</span>,</span>
<span id="cb2027-22"><a href="missing-data-and-other-opportunities.html#cb2027-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;neocortex percent (std)&quot;</span>) <span class="sc">+</span></span>
<span id="cb2027-23"><a href="missing-data-and-other-opportunities.html#cb2027-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">range</span>(d<span class="sc">$</span>b, <span class="at">na.rm =</span> T))</span>
<span id="cb2027-24"><a href="missing-data-and-other-opportunities.html#cb2027-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2027-25"><a href="missing-data-and-other-opportunities.html#cb2027-25" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-68-1.png" width="624" style="display: block; margin: auto;" /></p>
<p>The results further show that our fully standardized regression coefficient (<span class="math inline">\(\delta_1\)</span>) had the same effect on the Bayesian imputation as McElreath’s residual correlation. Our <span class="math inline">\(\delta_1\)</span> coefficient is basically just a correlation in disguise.</p>
<div id="rethinking-multiple-imputations." class="section level4 hasAnchor" number="15.2.2.1">
<h4><span class="header-section-number">15.2.2.1</span> Rethinking: Multiple imputations.<a href="missing-data-and-other-opportunities.html#rethinking-multiple-imputations." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>Missing data imputation has a messy history. There are many forms of imputation… A common non-Bayesian procedure is <strong>multiple imputation</strong>. Multiple imputation was developed in the context of survey non-response, and it actually has a Bayesian justification. But it was invented when Bayesian imputation on the desktop was impractical, so it tries to approximate the full Bayesian solution to a “missing at random” missingness model. If you aren’t comfortable dropping incomplete cases, then you shouldn’t be comfortable using multiple imputation either. The procedure performs multiple draws from an approximate posterior distribution of the missing values, performs separate analyses with these draws, and then combines the analyses in a way that approximates full Bayesian imputation. Multiple imputation is more limited than full Bayesian imputation, so now we just use the real thing. (p. 511)</p>
</blockquote>
<p>We won’t be walking through an example in this ebook, but you should know that <strong>brms</strong> is capable of multiple imputation, too. You can find an example of multiple imputation in Bürkner’s <span class="citation">(<a href="#ref-Bürkner2022HandleMissingValues" role="doc-biblioref">2022</a>)</span> vignette, <a href="https://CRAN.R-project.org/package=brms/vignettes/brms_missings.html"><em>Handle missing values with brms</em></a>. To learn about the origins of this approach, check out the authoritative work by Rubin <span class="citation">(<a href="#ref-rubinMultipleImputation181996" role="doc-biblioref">1996</a>, <a href="#ref-rubinMultipleImputationNonresponse1987" role="doc-biblioref">1987</a>)</span> and Little and Rubin <span class="citation">(<a href="#ref-littleStatisticalAnalysisMissing2019" role="doc-biblioref">2019</a>)</span>.</p>
</div>
</div>
<div id="where-is-your-god-now" class="section level3 hasAnchor" number="15.2.3">
<h3><span class="header-section-number">15.2.3</span> Where is your god now?<a href="missing-data-and-other-opportunities.html#where-is-your-god-now" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>“Sometimes there are no statistical solutions to scientific problems. But even then, careful statistical thinking can be useful because it will tell us that there is no statistical solution” (p. 512).</p>
<p>Let’s load the <code>Moralizing_gods</code> data from <span class="citation">Whitehouse et al. (<a href="#ref-whitehouseComplexSocietiesPrecede2019" role="doc-biblioref">2019</a>)</span><a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a>.</p>
<div class="sourceCode" id="cb2028"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2028-1"><a href="missing-data-and-other-opportunities.html#cb2028-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Moralizing_gods, <span class="at">package =</span> <span class="st">&quot;rethinking&quot;</span>)</span>
<span id="cb2028-2"><a href="missing-data-and-other-opportunities.html#cb2028-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> Moralizing_gods</span>
<span id="cb2028-3"><a href="missing-data-and-other-opportunities.html#cb2028-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(Moralizing_gods)</span></code></pre></div>
<p>Take a look at the new data.</p>
<div class="sourceCode" id="cb2029"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2029-1"><a href="missing-data-and-other-opportunities.html#cb2029-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(d)</span></code></pre></div>
<pre><code>## Rows: 864
## Columns: 5
## $ polity          &lt;fct&gt; Big Island Hawaii, Big Island Hawaii, Big Island Hawaii, Big Island Hawaii, Big Isla…
## $ year            &lt;int&gt; 1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700, 1800, -600, -500, -400, -300, -200, …
## $ population      &lt;dbl&gt; 3.729643, 3.729643, 3.598340, 4.026240, 4.311767, 4.205113, 4.373960, 5.157593, 4.99…
## $ moralizing_gods &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, 1, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ writing         &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</code></pre>
<p>The bulk of the values for <code>moralizing_gods</code> are missing and very few of the remaining values are <code>0</code>’s.</p>
<div class="sourceCode" id="cb2031"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2031-1"><a href="missing-data-and-other-opportunities.html#cb2031-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb2031-2"><a href="missing-data-and-other-opportunities.html#cb2031-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(moralizing_gods) <span class="sc">%&gt;%</span> </span>
<span id="cb2031-3"><a href="missing-data-and-other-opportunities.html#cb2031-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code></pre></div>
<pre><code>##   moralizing_gods   n         %
## 1               0  17  1.967593
## 2               1 319 36.921296
## 3              NA 528 61.111111</code></pre>
<p>To get a sense of how these values are distributed, here’s our version of Figure 15.7.</p>
<div class="sourceCode" id="cb2033"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2033-1"><a href="missing-data-and-other-opportunities.html#cb2033-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb2033-2"><a href="missing-data-and-other-opportunities.html#cb2033-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mg =</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(moralizing_gods), <span class="dv">2</span>, <span class="dv">1</span> <span class="sc">-</span> moralizing_gods),</span>
<span id="cb2033-3"><a href="missing-data-and-other-opportunities.html#cb2033-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">levels =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb2033-4"><a href="missing-data-and-other-opportunities.html#cb2033-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;present&quot;</span>, <span class="st">&quot;absent&quot;</span>, <span class="st">&quot;unknown&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb2033-5"><a href="missing-data-and-other-opportunities.html#cb2033-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2033-6"><a href="missing-data-and-other-opportunities.html#cb2033-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> population, <span class="at">color =</span> mg)) <span class="sc">+</span></span>
<span id="cb2033-7"><a href="missing-data-and-other-opportunities.html#cb2033-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb2033-8"><a href="missing-data-and-other-opportunities.html#cb2033-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="st">&quot;Moralizing gods&quot;</span>, </span>
<span id="cb2033-9"><a href="missing-data-and-other-opportunities.html#cb2033-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;D&quot;</span>)(<span class="dv">7</span>)[<span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">1</span>)]) <span class="sc">+</span></span>
<span id="cb2033-10"><a href="missing-data-and-other-opportunities.html#cb2033-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&#39;&quot;This is a highly non-random missingness pattern&quot; (p. 514).&#39;</span>,</span>
<span id="cb2033-11"><a href="missing-data-and-other-opportunities.html#cb2033-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Time (year)&quot;</span>,</span>
<span id="cb2033-12"><a href="missing-data-and-other-opportunities.html#cb2033-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Population size (log)&quot;</span>) <span class="sc">+</span></span>
<span id="cb2033-13"><a href="missing-data-and-other-opportunities.html#cb2033-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">125</span>, .<span class="dv">67</span>))</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-72-1.png" width="624" style="display: block; margin: auto;" /></p>
<p>Here are the counts broken down by gods and literacy status.</p>
<div class="sourceCode" id="cb2034"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2034-1"><a href="missing-data-and-other-opportunities.html#cb2034-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb2034-2"><a href="missing-data-and-other-opportunities.html#cb2034-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gods     =</span> moralizing_gods,</span>
<span id="cb2034-3"><a href="missing-data-and-other-opportunities.html#cb2034-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">literacy =</span> writing) <span class="sc">%&gt;%</span> </span>
<span id="cb2034-4"><a href="missing-data-and-other-opportunities.html#cb2034-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(gods, literacy) <span class="sc">%&gt;%</span> </span>
<span id="cb2034-5"><a href="missing-data-and-other-opportunities.html#cb2034-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code></pre></div>
<pre><code>##   gods literacy   n          %
## 1    0        0  16  1.8518519
## 2    0        1   1  0.1157407
## 3    1        0   9  1.0416667
## 4    1        1 310 35.8796296
## 5   NA        0 442 51.1574074
## 6   NA        1  86  9.9537037</code></pre>
<p>The bulk of the missing <code>moralizing_gods</code> values are from non-literate polities and the figure above shows that smaller polities also tend to have missing values. We can try to make sense of all this with McElreath’s DAG.</p>
<div class="sourceCode" id="cb2036"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2036-1"><a href="missing-data-and-other-opportunities.html#cb2036-1" aria-hidden="true" tabindex="-1"></a>dag_coords <span class="ot">&lt;-</span></span>
<span id="cb2036-2"><a href="missing-data-and-other-opportunities.html#cb2036-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;P&quot;</span>, <span class="st">&quot;W&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;RG&quot;</span>, <span class="st">&quot;Gs&quot;</span>),</span>
<span id="cb2036-3"><a href="missing-data-and-other-opportunities.html#cb2036-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">x    =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">2.33</span>, <span class="dv">4</span>, <span class="fl">5.67</span>, <span class="dv">7</span>),</span>
<span id="cb2036-4"><a href="missing-data-and-other-opportunities.html#cb2036-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb2036-5"><a href="missing-data-and-other-opportunities.html#cb2036-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2036-6"><a href="missing-data-and-other-opportunities.html#cb2036-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dagify</span>(P  <span class="sc">~</span> G,</span>
<span id="cb2036-7"><a href="missing-data-and-other-opportunities.html#cb2036-7" aria-hidden="true" tabindex="-1"></a>       W  <span class="sc">~</span> P,</span>
<span id="cb2036-8"><a href="missing-data-and-other-opportunities.html#cb2036-8" aria-hidden="true" tabindex="-1"></a>       RG <span class="sc">~</span> W,</span>
<span id="cb2036-9"><a href="missing-data-and-other-opportunities.html#cb2036-9" aria-hidden="true" tabindex="-1"></a>       Gs <span class="sc">~</span> G <span class="sc">+</span> RG,</span>
<span id="cb2036-10"><a href="missing-data-and-other-opportunities.html#cb2036-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">coords =</span> dag_coords) <span class="sc">%&gt;%</span></span>
<span id="cb2036-11"><a href="missing-data-and-other-opportunities.html#cb2036-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2036-12"><a href="missing-data-and-other-opportunities.html#cb2036-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(name <span class="sc">==</span> <span class="st">&quot;G&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2036-13"><a href="missing-data-and-other-opportunities.html#cb2036-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2036-14"><a href="missing-data-and-other-opportunities.html#cb2036-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb2036-15"><a href="missing-data-and-other-opportunities.html#cb2036-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> color),</span>
<span id="cb2036-16"><a href="missing-data-and-other-opportunities.html#cb2036-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">7</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb2036-17"><a href="missing-data-and-other-opportunities.html#cb2036-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>(<span class="at">parse =</span> T, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;G&quot;</span>, <span class="st">&quot;P&quot;</span>, <span class="fu">expression</span>(R[G]), <span class="st">&quot;W&quot;</span>, <span class="fu">expression</span>(G<span class="sc">^</span><span class="st">&#39;*&#39;</span>))) <span class="sc">+</span></span>
<span id="cb2036-18"><a href="missing-data-and-other-opportunities.html#cb2036-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">edge_colour =</span> <span class="st">&quot;#FCF9F0&quot;</span>) <span class="sc">+</span></span>
<span id="cb2036-19"><a href="missing-data-and-other-opportunities.html#cb2036-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">2</span>], <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span></span>
<span id="cb2036-20"><a href="missing-data-and-other-opportunities.html#cb2036-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dark_theme_void</span>()</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-74-1.png" width="264" style="display: block; margin: auto;" /></p>
<blockquote>
<p>Here <span class="math inline">\(P\)</span> is rate of population growth (not the same as the population size variable in the data), <span class="math inline">\(G\)</span> is the presence of belief in moralizing gods (which is unobserved), <span class="math inline">\(G^*\)</span> is the observed variable with missing values, <span class="math inline">\(W\)</span> is writing, and <span class="math inline">\(R_G\)</span> is the missing values indicator. This is an optimistic scenario, because it assumes there are no unobserved confounds among <span class="math inline">\(P\)</span>, <span class="math inline">\(G\)</span>, and <span class="math inline">\(W\)</span>. These are purely observational data, recall. But the goal is to use this example to think through the impact of missing data. If we can’t recover from missing data with the DAG above, adding confounds isn’t going to help. (p. 515)</p>
</blockquote>
<p>Consider the case of Hawaii.</p>
<div class="sourceCode" id="cb2037"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2037-1"><a href="missing-data-and-other-opportunities.html#cb2037-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb2037-2"><a href="missing-data-and-other-opportunities.html#cb2037-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(polity <span class="sc">==</span> <span class="st">&quot;Big Island Hawaii&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2037-3"><a href="missing-data-and-other-opportunities.html#cb2037-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, writing, moralizing_gods)</span></code></pre></div>
<pre><code>##   year writing moralizing_gods
## 1 1000       0              NA
## 2 1100       0              NA
## 3 1200       0              NA
## 4 1300       0              NA
## 5 1400       0              NA
## 6 1500       0              NA
## 7 1600       0              NA
## 8 1700       0              NA
## 9 1800       0               1</code></pre>
<blockquote>
<p>What happened in 1778? Captain James Cook and his crew finally made contact….</p>
<p>After Captain Cook, Hawaii is correctly coded with 1 for belief in moralizing gods. It is also a fact that Hawaii never developed its own writing system. So there is no direct evidence of when moralizing gods appeared in Hawaii. Any imputation model needs to decide how to fill in those <code>NA</code> values. With so much missing data, any imputation model would necessarily make very strong assumptions. (pp. 515–516)</p>
</blockquote>
<div id="rethinking-present-details-about-missing-data." class="section level4 hasAnchor" number="15.2.3.1">
<h4><span class="header-section-number">15.2.3.1</span> Rethinking: Present details about missing data.<a href="missing-data-and-other-opportunities.html#rethinking-present-details-about-missing-data." class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p><em>Clear documentation of missing data and its treatment is necessary</em>. This is best done with a causal model that makes transparent what is being assumed about the source of missing values and simultaneously justifies how they are handled. But the minimum is to report the counts of missing values in each variable and what was done with them. (p. 516, <em>emphasis</em> added)</p>
</blockquote>
<p>I strongly agree with McElreath on this point. When doing peer-reviews, I regularly inquire about missing data and how, if present, they were handled.</p>
</div>
</div>
</div>
<div id="categorical-errors-and-discrete-absences" class="section level2 hasAnchor" number="15.3">
<h2><span class="header-section-number">15.3</span> Categorical errors and discrete absences<a href="missing-data-and-other-opportunities.html#categorical-errors-and-discrete-absences" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>Discrete unobserved variables require discrete parameters. There are two issues with discrete parameters. First, a discrete variable will not produce a smooth surface for Hamiltonian Monte Carlo to glide around on. HMC just doesn’t do discrete variables. Second, other estimation approaches also have problems with discrete parameter spaces, because discrete jumps are difficult to calibrate. Chains tend to get stuck for long periods.</p>
<p>But that doesn’t mean we are stuck. In almost every case, we don’t need to sample discrete parameters at all. Instead we can use a special technique, known to experts as a “weighted average,” to remove discrete parameters from the model. After sampling the other parameters, we can then use their samples to compute the posterior distribution of any dis- crete parameter that we removed. So no information is given up. (pp. 516–517)</p>
</blockquote>
<div id="discrete-cats." class="section level3 hasAnchor" number="15.3.1">
<h3><span class="header-section-number">15.3.1</span> Discrete cats.<a href="missing-data-and-other-opportunities.html#discrete-cats." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here is McElreath’s next DAG.</p>
<div class="sourceCode" id="cb2039"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2039-1"><a href="missing-data-and-other-opportunities.html#cb2039-1" aria-hidden="true" tabindex="-1"></a>dag_coords <span class="ot">&lt;-</span></span>
<span id="cb2039-2"><a href="missing-data-and-other-opportunities.html#cb2039-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;Rc&quot;</span>, <span class="st">&quot;Cs&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;N&quot;</span>),</span>
<span id="cb2039-3"><a href="missing-data-and-other-opportunities.html#cb2039-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">x    =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb2039-4"><a href="missing-data-and-other-opportunities.html#cb2039-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">y    =</span> <span class="dv">1</span>)</span>
<span id="cb2039-5"><a href="missing-data-and-other-opportunities.html#cb2039-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2039-6"><a href="missing-data-and-other-opportunities.html#cb2039-6" aria-hidden="true" tabindex="-1"></a><span class="fu">dagify</span>(Cs <span class="sc">~</span> Rc <span class="sc">+</span> C,</span>
<span id="cb2039-7"><a href="missing-data-and-other-opportunities.html#cb2039-7" aria-hidden="true" tabindex="-1"></a>       N  <span class="sc">~</span> C,</span>
<span id="cb2039-8"><a href="missing-data-and-other-opportunities.html#cb2039-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">coords =</span> dag_coords) <span class="sc">%&gt;%</span></span>
<span id="cb2039-9"><a href="missing-data-and-other-opportunities.html#cb2039-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy_dagitty</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2039-10"><a href="missing-data-and-other-opportunities.html#cb2039-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">color =</span> <span class="fu">ifelse</span>(name <span class="sc">==</span> <span class="st">&quot;C&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2039-11"><a href="missing-data-and-other-opportunities.html#cb2039-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2039-12"><a href="missing-data-and-other-opportunities.html#cb2039-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb2039-13"><a href="missing-data-and-other-opportunities.html#cb2039-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> color),</span>
<span id="cb2039-14"><a href="missing-data-and-other-opportunities.html#cb2039-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="dv">7</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb2039-15"><a href="missing-data-and-other-opportunities.html#cb2039-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_text</span>(<span class="at">parse =</span> T, <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;C&quot;</span>,<span class="fu">expression</span>(R[C]), <span class="fu">expression</span>(C<span class="sc">^</span><span class="st">&quot;*&quot;</span>), <span class="st">&quot;N&quot;</span>)) <span class="sc">+</span></span>
<span id="cb2039-16"><a href="missing-data-and-other-opportunities.html#cb2039-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dag_edges</span>(<span class="at">edge_colour =</span> <span class="st">&quot;#FCF9F0&quot;</span>) <span class="sc">+</span></span>
<span id="cb2039-17"><a href="missing-data-and-other-opportunities.html#cb2039-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">2</span>], <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span></span>
<span id="cb2039-18"><a href="missing-data-and-other-opportunities.html#cb2039-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dark_theme_void</span>()</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-76-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>“The presence/absence of a cat <span class="math inline">\(C\)</span> influences the number of sung notes <span class="math inline">\(N\)</span>. Because of missing values <span class="math inline">\(R_C\)</span> however, we only observe <span class="math inline">\(C^*\)</span>” (p. 517). McElreath’s proposed generative model was</p>
<p><span class="math display">\[\begin{align*}
N_i &amp; \sim \operatorname{Poisson}(\lambda_i) \\
\log \lambda_i &amp; = \alpha + \beta C_i \\
C_i &amp; \sim \operatorname{Bernoulli}(k) \\
R_{C, i} &amp; \sim \operatorname{Bernoulli}(r).
\end{align*}\]</span></p>
<p>We can simulate data along those lines with a few lines of code.</p>
<div class="sourceCode" id="cb2040"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2040-1"><a href="missing-data-and-other-opportunities.html#cb2040-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">9</span>)</span>
<span id="cb2040-2"><a href="missing-data-and-other-opportunities.html#cb2040-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2040-3"><a href="missing-data-and-other-opportunities.html#cb2040-3" aria-hidden="true" tabindex="-1"></a>n_houses <span class="ot">&lt;-</span> 1000L </span>
<span id="cb2040-4"><a href="missing-data-and-other-opportunities.html#cb2040-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb2040-5"><a href="missing-data-and-other-opportunities.html#cb2040-5" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">3</span>)</span>
<span id="cb2040-6"><a href="missing-data-and-other-opportunities.html#cb2040-6" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb2040-7"><a href="missing-data-and-other-opportunities.html#cb2040-7" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb2040-8"><a href="missing-data-and-other-opportunities.html#cb2040-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2040-9"><a href="missing-data-and-other-opportunities.html#cb2040-9" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span></span>
<span id="cb2040-10"><a href="missing-data-and-other-opportunities.html#cb2040-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">cat =</span> <span class="fu">rbinom</span>(n_houses, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> k)) <span class="sc">%&gt;%</span> </span>
<span id="cb2040-11"><a href="missing-data-and-other-opportunities.html#cb2040-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">notes =</span> <span class="fu">rpois</span>(n_houses, <span class="at">lambda =</span> alpha <span class="sc">+</span> beta <span class="sc">*</span> cat),</span>
<span id="cb2040-12"><a href="missing-data-and-other-opportunities.html#cb2040-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">r_c   =</span> <span class="fu">rbinom</span>(n_houses, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> r)) <span class="sc">%&gt;%</span> </span>
<span id="cb2040-13"><a href="missing-data-and-other-opportunities.html#cb2040-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cat_obs =</span> <span class="fu">if_else</span>(r_c <span class="sc">==</span> <span class="dv">1</span>, (<span class="sc">-</span>9L), cat))</span>
<span id="cb2040-14"><a href="missing-data-and-other-opportunities.html#cb2040-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2040-15"><a href="missing-data-and-other-opportunities.html#cb2040-15" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(dat)</span></code></pre></div>
<pre><code>## Rows: 1,000
## Columns: 4
## $ cat     &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0,…
## $ notes   &lt;int&gt; 3, 5, 11, 6, 9, 6, 6, 6, 1, 3, 4, 6, 3, 7, 6, 3, 6, 3, 4, 4, 2, 0, 4, 7, 3, 1, 7, 8, 2, 2, 5…
## $ r_c     &lt;int&gt; 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 1, 0, 0, 0,…
## $ cat_obs &lt;int&gt; 0, 0, 0, 0, 0, 0, -9, 0, 1, 1, 0, -9, 1, -9, 0, 1, 0, 1, 0, 0, 1, -9, -9, -9, -9, -9, 0, -9,…</code></pre>
<p>Note how we constructed <code>cat_obs</code> by replacing several values of <code>cat</code> with <code>-9</code>.</p>
<blockquote>
<p>There is nothing special about this value. The model will skip them. But it is usually good to use some invalid value, so that if you make a mistake in coding, an error will result. In this case, since <code>cat</code> has a Bernoulli distribution, if the model ever asks for the probability of observing -9, there should be an error, because -9 is impossible. (p. 518)</p>
</blockquote>
<p>😢 Sadly, this is as far as I’m going in this section. I still haven’t made sense of McElreath’s <em>weighted average</em> approach to missing data and I’m not sure whether it’s even possible with <strong>brms</strong>. If you have insights in to how one might accommodate categorical missing data with <strong>brms</strong>, share them with the rest of us on <a href="https://github.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed/issues">GitHub</a>.</p>
</div>
</div>
<div id="summary-2" class="section level2 hasAnchor" number="15.4">
<h2><span class="header-section-number">15.4</span> Summary<a href="missing-data-and-other-opportunities.html#summary-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>This chapter has been a quick introduction to the design and implementation of measurement error and missing data models. Measurement error and missing data have causes. Incorporating those causes into the generative model helps us decide how error and missingness impact inference as well as how to design a statistical procedure. (p. 521)</p>
</blockquote>
<p>If modern missing data methods are new to you, you might also check out van Burren’s great online <span class="citation">(<a href="#ref-vanbuurenFlexibleImputationMissing2018" role="doc-biblioref">2018</a>)</span> text, <a href="https://stefvanbuuren.name/fimd/"><em>Flexible imputation of missing data</em></a>. I’m also a fan of Enders’s <span class="citation">(<a href="#ref-enders2010applied" role="doc-biblioref">2010</a>)</span> <a href="http://www.appliedmissingdata.com"><em>Applied missing data analysis</em></a>, for which you can find a free sample chapter <a href="http://www.appliedmissingdata.com/sample-chapter.pdf">here</a>.</p>
</div>
<div id="bonus-bayesian-meta-analysis-with-odds-ratios" class="section level2 hasAnchor" number="15.5">
<h2><span class="header-section-number">15.5</span> Bonus: Bayesian meta-analysis with odds ratios<a href="missing-data-and-other-opportunities.html#bonus-bayesian-meta-analysis-with-odds-ratios" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If your mind isn’t fully blown by those measurement-error and missing-data models, let’s keep building. As it turns out, meta-analyses are often just special kinds of multilevel measurement-error models. Thus, you can use <code>brms::brm()</code> to fit Bayesian meta-analyses, too.</p>
<p>Before we proceed, I should acknowledge that this section is heavily influenced by <a href="https://mvuorre.github.io/#about">Matti Vourre</a>’s great blog post, <a href="https://mvuorre.github.io/posts/2016-09-29-bayesian-meta-analysis/"><em>Bayesian meta-analysis with R, Stan, and brms</em></a>. Since neither editions of McElreath’s text directly address meta-analyses, we’ll also have to borrow a bit from Gelman, Carlin, Stern, Dunson, Vehtari, and Rubin’s <span class="citation">(<a href="#ref-gelman2013bayesian" role="doc-biblioref">2013</a>)</span> <a href="https://stat.columbia.edu/~gelman/book/"><em>Bayesian data analysis, Third edition</em></a>.</p>
<div id="how-do-meta-analyses-fit-into-the-picture" class="section level3 hasAnchor" number="15.5.1">
<h3><span class="header-section-number">15.5.1</span> How do meta-analyses fit into the picture?<a href="missing-data-and-other-opportunities.html#how-do-meta-analyses-fit-into-the-picture" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let Gelman and colleagues introduce the topic:</p>
<blockquote>
<p>Discussions of meta-analysis are sometimes imprecise about the estimands of interest in the analysis, especially when the primary focus is on testing the null hypothesis of no effect in any of the studies to be combined. Our focus is on estimating meaningful parameters, and for this objective there appear to be three possibilities, accepting the overarching assumption that the studies are comparable in some broad sense. The first possibility is that we view the studies as identical replications of each other, in the sense we regard the individuals in all the studies as independent samples from a common population, with the same outcome measures and so on. A second possibility is that the studies are so different that the results of any one study provide no information about the results of any of the others. A third, more general, possibility is that we regard the studies as exchangeable but not necessarily either identical or completely unrelated; in other words we allow differences from study to study, but such that the differences are not expected <em>a priori</em> to have predictable effects favoring one study over another…. this third possibility represents a continuum between the two extremes, and it is this exchangeable model (with unknown hyperparameters characterizing the population distribution) that forms the basis of our Bayesian analysis….</p>
<p>The first potential estimand of a meta-analysis, or a hierarchically structured problem in general, is the mean of the distribution of effect sizes, since this represents the overall ‘average’ effect across all studies that could be regarded as exchangeable with the observed studies. Other possible estimands are the effect size in any of the observed studies and the effect size in another, comparable (exchangeable) unobserved study. (pp. 125–126, <em>emphasis</em> in the original)</p>
</blockquote>
<p>The basic version of a Bayesian meta-analysis follows the form</p>
<p><span class="math display">\[y_j \sim \operatorname{Normal}(\theta_j, \sigma_j),\]</span></p>
<p>where <span class="math inline">\(y_j\)</span> = the point estimate for the effect size of a single study, <span class="math inline">\(j\)</span>, which is presumed to have been a draw from a Normal distribution centered on <span class="math inline">\(\theta_j\)</span>. The data in meta-analyses are typically statistical summaries from individual studies. The one clear lesson from this chapter is that those estimates themselves come with error and those errors should be fully expressed in the meta-analytic model. The standard error from study <span class="math inline">\(j\)</span> is specified <span class="math inline">\(\sigma_j\)</span>, which is also a stand-in for the standard deviation of the Normal distribution from which the point estimate was drawn. Do note, we’re not estimating <span class="math inline">\(\sigma_j\)</span>, here. Those values we take directly from the original studies.</p>
<p>Building on the model, we further presume that study <span class="math inline">\(j\)</span> is itself just one draw from a population of related studies, each of which have their own effect sizes. As such, we presume <span class="math inline">\(\theta_j\)</span> itself has a distribution following the form</p>
<p><span class="math display">\[\theta_j \sim \operatorname{Normal}(\mu, \tau),\]</span></p>
<p>where <span class="math inline">\(\mu\)</span> is the meta-analytic effect (i.e., the population mean) and <span class="math inline">\(\tau\)</span> is the variation around that mean, what you might also think of as <span class="math inline">\(\sigma_\tau\)</span>.</p>
</div>
<div id="we-need-some-data." class="section level3 hasAnchor" number="15.5.2">
<h3><span class="header-section-number">15.5.2</span> We need some data.<a href="missing-data-and-other-opportunities.html#we-need-some-data." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Our data in this section come from the second large-scale replication project by the Many Labs team <span class="citation">(<a href="#ref-kleinManyLabsInvestigating2018" role="doc-biblioref">Klein et al., 2018</a>)</span>. Of the 28 studies replicated in the study, we will focus on the replication of the trolley experiment from <span class="citation">Hauser et al. (<a href="#ref-hauserDissociationMoralJudgments2007" role="doc-biblioref">2007</a>)</span>. Here’s how the study was described by Klein and colleagues:</p>
<blockquote>
<p>According to the principle of double effect, an act that harms other people is more morally permissible if the act is a foreseen side effect rather than the means to the greater good. <span class="citation">Hauser et al. (<a href="#ref-hauserDissociationMoralJudgments2007" role="doc-biblioref">2007</a>)</span> compared participants’ reactions to two scenarios to test whether their judgments followed this principle. In the <em>foreseen-side-effect</em> scenario, a person on an out-of-control train changed the train’s trajectory so that the train killed one person instead of five. In the <em>greater-good</em> scenario, a person pushed a fat man in front of a train, killing him, to save five people. Whereas <span class="math inline">\(89\%\)</span> of participants judged the action in the foreseen-side-effect scenario as permissible <span class="math inline">\((95 \% \; \text{CI} = [87\%, 91\%]),\)</span> only <span class="math inline">\(11\%\)</span> of participants in the greater-good scenario judged it as permissible <span class="math inline">\((95 \% \; \text{CI} = [9\%, 13\%])\)</span>. The difference between the percentages was significant<span class="math inline">\(,\)</span> <span class="math inline">\(\chi^2(1, N = 2,646) = 1,615.96,\)</span> <span class="math inline">\(p &lt; .001,\)</span> <span class="math inline">\(w = .78,\)</span> <span class="math inline">\(d = 2.50,\)</span> <span class="math inline">\(95 \% \; \text{CI} = [2.22, 2.86]\)</span>. Thus, the results provided evidence for the principle of double effect. (p. 459, <em>emphasis</em> in the original)</p>
</blockquote>
<p>You can find supporting materials for the replication project on the Open Science Framework at <a href="https://osf.io/8cd4r/">https://osf.io/8cd4r/</a>. The relevant subset of the data for the replication of Hauser et al. come from the <code>Trolley Dilemma 1 (Hauser et al., 2007)</code> folder within the <code>OSFdata.zip</code> (<a href="https://osf.io/ag2pd/">https://osf.io/ag2pd/</a>). I’ve downloaded the file and saved it on GitHub.</p>
<p>Here we load the data.</p>
<div class="sourceCode" id="cb2042"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2042-1"><a href="missing-data-and-other-opportunities.html#cb2042-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> </span>
<span id="cb2042-2"><a href="missing-data-and-other-opportunities.html#cb2042-2" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed/master/data/Hauser_1_study_by_order_all_CLEAN_CASE.csv&quot;</span>)</span>
<span id="cb2042-3"><a href="missing-data-and-other-opportunities.html#cb2042-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2042-4"><a href="missing-data-and-other-opportunities.html#cb2042-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> </span>
<span id="cb2042-5"><a href="missing-data-and-other-opportunities.html#cb2042-5" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb2042-6"><a href="missing-data-and-other-opportunities.html#cb2042-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y   =</span> <span class="fu">ifelse</span>(variable <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb2042-7"><a href="missing-data-and-other-opportunities.html#cb2042-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">loc =</span> <span class="fu">factor</span>(Location,</span>
<span id="cb2042-8"><a href="missing-data-and-other-opportunities.html#cb2042-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">distinct</span>(d, Location) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Location),</span>
<span id="cb2042-9"><a href="missing-data-and-other-opportunities.html#cb2042-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">59</span>))</span>
<span id="cb2042-10"><a href="missing-data-and-other-opportunities.html#cb2042-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2042-11"><a href="missing-data-and-other-opportunities.html#cb2042-11" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(d)</span></code></pre></div>
<pre><code>## Rows: 6,842
## Columns: 29
## $ uID              &lt;dbl&gt; 65, 68, 102, 126, 145, 263, 267, 298, 309, 318, 350, 356, 376, 431, 438, 447, 483, …
## $ variable         &lt;chr&gt; &quot;Yes&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;…
## $ factor           &lt;chr&gt; &quot;SideEffect&quot;, &quot;SideEffect&quot;, &quot;SideEffect&quot;, &quot;SideEffect&quot;, &quot;SideEffect&quot;, &quot;SideEffect&quot;,…
## $ .id              &lt;chr&gt; &quot;ML2_Slate1_Brazil__Portuguese_execution_illegal_r.csv&quot;, &quot;ML2_Slate1_Brazil__Portug…
## $ source           &lt;chr&gt; &quot;brasilia&quot;, &quot;brasilia&quot;, &quot;brasilia&quot;, &quot;wilfredlaur&quot;, &quot;wilfredlaur&quot;, &quot;ubc&quot;, &quot;ubc&quot;, &quot;to…
## $ haus1.1          &lt;dbl&gt; 1, 1, 1, 1, 1, 2, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 1, 1, 2, 1, 1, 1, 1, 1, 2,…
## $ haus1.1t_1       &lt;dbl&gt; 39.054, 36.792, 56.493, 21.908, 25.635, 50.633, 58.661, 50.137, 51.717, 28.122, 41.…
## $ haus2.1          &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
## $ haus2.1t_1       &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
## $ Source.Global    &lt;chr&gt; &quot;brasilia&quot;, &quot;brasilia&quot;, &quot;brasilia&quot;, &quot;wilfredlaur&quot;, &quot;wilfredlaur&quot;, &quot;ubc&quot;, &quot;ubc&quot;, &quot;to…
## $ Source.Primary   &lt;chr&gt; &quot;brasilia&quot;, &quot;brasilia&quot;, &quot;brasilia&quot;, &quot;wilfredlaur&quot;, &quot;wilfredlaur&quot;, &quot;ubc&quot;, &quot;ubc&quot;, &quot;to…
## $ Source.Secondary &lt;chr&gt; &quot;brasilia&quot;, &quot;brasilia&quot;, &quot;brasilia&quot;, &quot;wilfredlaur&quot;, &quot;wilfredlaur&quot;, &quot;ubc&quot;, &quot;ubc&quot;, &quot;to…
## $ Country          &lt;chr&gt; &quot;Brazil&quot;, &quot;Brazil&quot;, &quot;Brazil&quot;, &quot;Canada&quot;, &quot;Canada&quot;, &quot;Canada&quot;, &quot;Canada&quot;, &quot;Canada&quot;, &quot;Ca…
## $ Location         &lt;chr&gt; &quot;Social and Work Psychology Department, University of Brasilia, DF, Brazil&quot;, &quot;Socia…
## $ Language         &lt;chr&gt; &quot;Portuguese&quot;, &quot;Portuguese&quot;, &quot;Portuguese&quot;, &quot;English&quot;, &quot;English&quot;, &quot;English&quot;, &quot;English…
## $ Weird            &lt;dbl&gt; 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
## $ Execution        &lt;chr&gt; &quot;illegal&quot;, &quot;illegal&quot;, &quot;illegal&quot;, &quot;illegal&quot;, &quot;illegal&quot;, &quot;illegal&quot;, &quot;illegal&quot;, &quot;illeg…
## $ SubjectPool      &lt;chr&gt; &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;Yes&quot;, &quot;Y…
## $ Setting          &lt;chr&gt; &quot;In a classroom&quot;, &quot;In a classroom&quot;, &quot;In a classroom&quot;, &quot;In a lab&quot;, &quot;In a lab&quot;, &quot;In a…
## $ Tablet           &lt;chr&gt; &quot;Computers&quot;, &quot;Computers&quot;, &quot;Computers&quot;, &quot;Computers&quot;, &quot;Computers&quot;, &quot;Computers&quot;, &quot;Comp…
## $ Pencil           &lt;chr&gt; &quot;No, the whole study was on the computer (except maybe consent/debriefing)&quot;, &quot;No, t…
## $ StudyOrderN      &lt;chr&gt; &quot;Hauser|Ross.Slate1|Rottenstrich|Graham|Kay|Inbar|Anderson|VanLange|Huang|Bauer|Cri…
## $ IDiffOrderN      &lt;chr&gt; &quot;ID: Global self-esteem SISE|ID: Mood|ID: Subjective wellbeing|ID: Disgust scale (s…
## $ study.order      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
## $ analysis.type    &lt;chr&gt; &quot;Order&quot;, &quot;Order&quot;, &quot;Order&quot;, &quot;Order&quot;, &quot;Order&quot;, &quot;Order&quot;, &quot;Order&quot;, &quot;Order&quot;, &quot;Order&quot;, &quot;O…
## $ subset           &lt;chr&gt; &quot;all&quot;, &quot;all&quot;, &quot;all&quot;, &quot;all&quot;, &quot;all&quot;, &quot;all&quot;, &quot;all&quot;, &quot;all&quot;, &quot;all&quot;, &quot;all&quot;, &quot;all&quot;, &quot;all&quot;,…
## $ case.include     &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE,…
## $ y                &lt;dbl&gt; 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0,…
## $ loc              &lt;fct&gt; 1, 1, 1, 2, 2, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 3, 4, 4, 3, 4, 4, 4, 4, 3, 3, 4, 4,…</code></pre>
<p>The total sample size is <span class="math inline">\(N = 6{,}842\)</span>.</p>
<div class="sourceCode" id="cb2044"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2044-1"><a href="missing-data-and-other-opportunities.html#cb2044-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb2044-2"><a href="missing-data-and-other-opportunities.html#cb2044-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(uID) <span class="sc">%&gt;%</span> </span>
<span id="cb2044-3"><a href="missing-data-and-other-opportunities.html#cb2044-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##       n
##   &lt;int&gt;
## 1  6842</code></pre>
<p>All cases are to be included.</p>
<div class="sourceCode" id="cb2046"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2046-1"><a href="missing-data-and-other-opportunities.html#cb2046-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb2046-2"><a href="missing-data-and-other-opportunities.html#cb2046-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(case.include)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   case.include     n
##   &lt;lgl&gt;        &lt;int&gt;
## 1 TRUE          6842</code></pre>
<p>The data were collected in 59 locations with sample sizes ranging from 34 to 325.</p>
<div class="sourceCode" id="cb2048"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2048-1"><a href="missing-data-and-other-opportunities.html#cb2048-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb2048-2"><a href="missing-data-and-other-opportunities.html#cb2048-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Location) <span class="sc">%&gt;%</span> </span>
<span id="cb2048-3"><a href="missing-data-and-other-opportunities.html#cb2048-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 59 × 2
##    Location                                                                                               n
##    &lt;chr&gt;                                                                                              &lt;int&gt;
##  1 University of Toronto, Scarborough                                                                   325
##  2 MTurk India Workers                                                                                  308
##  3 MTurk US Workers                                                                                     304
##  4 University of Illinois at Urbana-Champaign, Champaign, IL                                            198
##  5 Eotvos Lorand University, in Budapest, Hungary                                                       180
##  6 Department of Social Psychology, Tilburg University, P.O. Box 90153, Tilburg, 5000 LE, Netherlands   173
##  7 Department of Psychology, San Diego State University, San Diego, CA 92182                            171
##  8 Department of Psychology, Pennsylvania State University Abington, Abington, PA 19001                 166
##  9 American University of Sharjah, United Arab Emirates                                                 162
## 10 University of British Columbia, Vancouver, Canada                                                    147
## # … with 49 more rows</code></pre>
</div>
<div id="our-effect-size-will-be-an-odds-ratio." class="section level3 hasAnchor" number="15.5.3">
<h3><span class="header-section-number">15.5.3</span> Our effect size will be an odds ratio.<a href="missing-data-and-other-opportunities.html#our-effect-size-will-be-an-odds-ratio." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here’s how Klein and colleagues summarized their primary results:</p>
<blockquote>
<p>In the aggregate replication sample <span class="math inline">\((N = 6,842\)</span> after removing participants who responded in less than <span class="math inline">\(4\)</span> s<span class="math inline">\(),\)</span> <span class="math inline">\(71\%\)</span> of participants judged the action in the foreseen-side-effect scenario as permissible, but only <span class="math inline">\(17\%\)</span> of participants in the greater-good scenario judged it as permissible. The difference between the percentages was significant, <span class="math inline">\(p = 2.2 \text e^{-16},\)</span> <span class="math inline">\(\text{OR} = 11.54,\)</span> <span class="math inline">\(d = 1.35,\)</span> <span class="math inline">\(95\% \; \text{CI} = [1.28, 1.41]\)</span>. The replication results were consistent with the double-effect hypothesis, and the effect was about half the magnitude of the original <span class="math inline">\((d = 1.35,\)</span> <span class="math inline">\(95\% \; \text{CI} = [1.28, 1.41],\)</span> vs. original <span class="math inline">\(d = 2.50)\)</span>. (p. 459)</p>
</blockquote>
<p>Here is the breakdown of the outcome and primary experimental condition, which will confirm the two empirical percentages mentioned, above.</p>
<div class="sourceCode" id="cb2050"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2050-1"><a href="missing-data-and-other-opportunities.html#cb2050-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb2050-2"><a href="missing-data-and-other-opportunities.html#cb2050-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(variable, factor) <span class="sc">%&gt;%</span> </span>
<span id="cb2050-3"><a href="missing-data-and-other-opportunities.html#cb2050-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(factor) <span class="sc">%&gt;%</span> </span>
<span id="cb2050-4"><a href="missing-data-and-other-opportunities.html#cb2050-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 4 × 4
## # Groups:   factor [2]
##   variable factor          n percent
##   &lt;chr&gt;    &lt;chr&gt;       &lt;int&gt;   &lt;dbl&gt;
## 1 No       GreaterGood  2781    82.8
## 2 No       SideEffect   1026    29.4
## 3 Yes      GreaterGood   577    17.2
## 4 Yes      SideEffect   2458    70.6</code></pre>
<p>Though the authors presented their overall effect size with a <span class="math inline">\(p\)</span>-value, an odds-ratio (OR), and a Cohen’s <span class="math inline">\(d\)</span> (i.e., a kind of standardized mean difference), we will focus on the OR. The primary data are binomial counts, which are well-handled with logistic regression. When you perform a logistic regression where a control condition is compared with some experimental condition, the difference between those conditions may be expressed as an OR. To get a sense of what that is, we’ll first practice fitting a logistic regression model with the frequentist <code>glm()</code> function. Here are the results based on the subset of data from the first location.</p>
<div class="sourceCode" id="cb2052"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2052-1"><a href="missing-data-and-other-opportunities.html#cb2052-1" aria-hidden="true" tabindex="-1"></a>glm0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="at">data =</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb2052-2"><a href="missing-data-and-other-opportunities.html#cb2052-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(loc <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb2052-3"><a href="missing-data-and-other-opportunities.html#cb2052-3" aria-hidden="true" tabindex="-1"></a>            y <span class="sc">~</span> factor, <span class="at">family =</span> <span class="fu">binomial</span>(logit))</span>
<span id="cb2052-4"><a href="missing-data-and-other-opportunities.html#cb2052-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2052-5"><a href="missing-data-and-other-opportunities.html#cb2052-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm0)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = y ~ factor, family = binomial(logit), data = d %&gt;% 
##     filter(loc == 1))
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.5227  -0.6231  -0.6231   0.8677   1.8626  
## 
## Coefficients:
##                  Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)       -1.5404     0.3673  -4.194 2.74e-05 ***
## factorSideEffect   2.3232     0.4754   4.887 1.02e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 139.47  on 101  degrees of freedom
## Residual deviance: 110.98  on 100  degrees of freedom
## AIC: 114.98
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>Just like with <strong>brms</strong>, the base-<strong>R</strong> <code>glm()</code> function returns the results of a logistic regression model in the log-odds metric. The intercept is the log-odds probability of selecting <em>yes</em> in the study for participants in the <code>GreaterGood</code> condition. The ‘factorSideEffect’ parameter is the difference in log-odds probability for participants in the <code>SideEffect</code> condition. Here’s what happens when you exponentiate that coefficient.</p>
<div class="sourceCode" id="cb2054"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2054-1"><a href="missing-data-and-other-opportunities.html#cb2054-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(glm0)[<span class="dv">2</span>] <span class="sc">%&gt;%</span> <span class="fu">exp</span>()</span></code></pre></div>
<pre><code>## factorSideEffect 
##         10.20833</code></pre>
<p>That, my friends, is an odds ratio (OR). <strong>Odds ratios are simply exponentiated logistic regression coefficients</strong>. The implication of this particular OR is that those in the <code>SideEffect</code> condition have about 10 times the odds of selecting <em>yes</em> compared to those in the <code>GreaterGood</code> condition. In the case of this subset of the data, that’s 18% yeses versus 69%, which seems like a large difference, to me.</p>
<div class="sourceCode" id="cb2056"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2056-1"><a href="missing-data-and-other-opportunities.html#cb2056-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb2056-2"><a href="missing-data-and-other-opportunities.html#cb2056-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(loc <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2056-3"><a href="missing-data-and-other-opportunities.html#cb2056-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(variable, factor) <span class="sc">%&gt;%</span> </span>
<span id="cb2056-4"><a href="missing-data-and-other-opportunities.html#cb2056-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(factor) <span class="sc">%&gt;%</span> </span>
<span id="cb2056-5"><a href="missing-data-and-other-opportunities.html#cb2056-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb2056-6"><a href="missing-data-and-other-opportunities.html#cb2056-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">&quot;Yes&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 4
## # Groups:   factor [2]
##   variable factor          n percent
##   &lt;chr&gt;    &lt;chr&gt;       &lt;int&gt;   &lt;dbl&gt;
## 1 Yes      GreaterGood     9    17.6
## 2 Yes      SideEffect     35    68.6</code></pre>
</div>
<div id="log-odds-odds-ratios-and-modeling-effect-sizes." class="section level3 hasAnchor" number="15.5.4">
<h3><span class="header-section-number">15.5.4</span> Log-odds, odds ratios, and modeling effect sizes.<a href="missing-data-and-other-opportunities.html#log-odds-odds-ratios-and-modeling-effect-sizes." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Though it’s common for researchers to express their effect sizes as odds ratios, we don’t want to work directly with odds ratios in a meta-analysis. <em>Why?</em> Well, think back on why we model binomial data with the logit link. The logit link transforms a bounded <span class="math inline">\([0, 1]\)</span> parameter space into an unbounded parameter space ranging from negative to positive infinity. For us Bayesians, it also provides a context in which our <span class="math inline">\(\beta\)</span> parameters are approximately Gaussian. However, when we exponentiate those approximately Gaussian log-odds coefficients, the resulting odds ratios aren’t so Gaussian any more. This is why, even if our ultimate goal is to express a meta-analytic effect as an OR, we want to work with effect sizes in the log-odds metric. It allows us to use the Bayesian meta-analytic framework outlined by Gelman and colleagues, above,</p>
<p><span class="math display">\[\begin{align*}
y_j      &amp; \sim \operatorname{Normal}(\theta_j, \sigma_j) \\
\theta_j &amp; \sim \operatorname{Normal}(\mu, \tau),
\end{align*}\]</span></p>
<p>where <span class="math inline">\(y_j\)</span> is the point estimate in the <span class="math inline">\(j\)</span>th study still in the log-odds scale. After fitting the model, we can then exponentiate the meta-analytic parameter <span class="math inline">\(\mu\)</span> into the OR metric.</p>
</div>
<div id="compute-the-study-specific-effect-sizes." class="section level3 hasAnchor" number="15.5.5">
<h3><span class="header-section-number">15.5.5</span> Compute the study-specific effect sizes.<a href="missing-data-and-other-opportunities.html#compute-the-study-specific-effect-sizes." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Our <code>d</code> data from the Klein et al replication study includes the un-aggregated data from all of the study locations combined. Before we compute our meta-analysis, we’ll need to compute the study-specific effect sizes and standard errors. Here we do so within a nested tibble.</p>
<div class="sourceCode" id="cb2058"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2058-1"><a href="missing-data-and-other-opportunities.html#cb2058-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb2058-2"><a href="missing-data-and-other-opportunities.html#cb2058-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2058-3"><a href="missing-data-and-other-opportunities.html#cb2058-3" aria-hidden="true" tabindex="-1"></a>glms <span class="ot">&lt;-</span></span>
<span id="cb2058-4"><a href="missing-data-and-other-opportunities.html#cb2058-4" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb2058-5"><a href="missing-data-and-other-opportunities.html#cb2058-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(loc, y, factor) <span class="sc">%&gt;%</span> </span>
<span id="cb2058-6"><a href="missing-data-and-other-opportunities.html#cb2058-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">data =</span> <span class="fu">c</span>(y, factor)) <span class="sc">%&gt;%</span> </span>
<span id="cb2058-7"><a href="missing-data-and-other-opportunities.html#cb2058-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">glm =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">update</span>(glm0, <span class="at">data =</span> .))) <span class="sc">%&gt;%</span> </span>
<span id="cb2058-8"><a href="missing-data-and-other-opportunities.html#cb2058-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">coef =</span> <span class="fu">map</span>(glm, tidy)) <span class="sc">%&gt;%</span> </span>
<span id="cb2058-9"><a href="missing-data-and-other-opportunities.html#cb2058-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>data, <span class="sc">-</span>glm) <span class="sc">%&gt;%</span> </span>
<span id="cb2058-10"><a href="missing-data-and-other-opportunities.html#cb2058-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(coef) <span class="sc">%&gt;%</span> </span>
<span id="cb2058-11"><a href="missing-data-and-other-opportunities.html#cb2058-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">&quot;factorSideEffect&quot;</span>)</span>
<span id="cb2058-12"><a href="missing-data-and-other-opportunities.html#cb2058-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2058-13"><a href="missing-data-and-other-opportunities.html#cb2058-13" aria-hidden="true" tabindex="-1"></a><span class="co"># what did we do?</span></span>
<span id="cb2058-14"><a href="missing-data-and-other-opportunities.html#cb2058-14" aria-hidden="true" tabindex="-1"></a>glms <span class="sc">%&gt;%</span> </span>
<span id="cb2058-15"><a href="missing-data-and-other-opportunities.html#cb2058-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 59 × 6
##    loc   term             estimate std.error statistic p.value
##    &lt;fct&gt; &lt;chr&gt;               &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
##  1 1     factorSideEffect     2.32     0.475      4.89       0
##  2 2     factorSideEffect     3.64     0.644      5.64       0
##  3 3     factorSideEffect     2.37     0.399      5.96       0
##  4 4     factorSideEffect     2.24     0.263      8.54       0
##  5 5     factorSideEffect     2.02     0.505      4.00       0
##  6 6     factorSideEffect     2.49     0.571      4.36       0
##  7 7     factorSideEffect     2.53     0.658      3.84       0
##  8 8     factorSideEffect     1.78     0.459      3.87       0
##  9 9     factorSideEffect     1.81     0.378      4.79       0
## 10 10    factorSideEffect     2.37     0.495      4.79       0
## # … with 49 more rows</code></pre>
<p>In the <code>estimate</code> column we have all the <span class="math inline">\(y_j\)</span> values and <code>std.error</code> contains the corresponding <span class="math inline">\(\sigma_j\)</span> values. Here they are in a plot.</p>
<div class="sourceCode" id="cb2060"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2060-1"><a href="missing-data-and-other-opportunities.html#cb2060-1" aria-hidden="true" tabindex="-1"></a>color <span class="ot">&lt;-</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">5</span>]</span>
<span id="cb2060-2"><a href="missing-data-and-other-opportunities.html#cb2060-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2060-3"><a href="missing-data-and-other-opportunities.html#cb2060-3" aria-hidden="true" tabindex="-1"></a>glms <span class="sc">%&gt;%</span> </span>
<span id="cb2060-4"><a href="missing-data-and-other-opportunities.html#cb2060-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> std.error, <span class="at">y =</span> estimate)) <span class="sc">+</span></span>
<span id="cb2060-5"><a href="missing-data-and-other-opportunities.html#cb2060-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> color) <span class="sc">+</span></span>
<span id="cb2060-6"><a href="missing-data-and-other-opportunities.html#cb2060-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(sigma[<span class="fu">italic</span>(j)]<span class="sc">~</span>(<span class="st">&quot;log-odds&quot;</span>)),</span>
<span id="cb2060-7"><a href="missing-data-and-other-opportunities.html#cb2060-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">italic</span>(y[j])<span class="sc">~</span>(<span class="st">&quot;log-odds&quot;</span>)))</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-85-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="fit-the-bayesian-meta-analysis." class="section level3 hasAnchor" number="15.5.6">
<h3><span class="header-section-number">15.5.6</span> Fit the Bayesian meta-analysis.<a href="missing-data-and-other-opportunities.html#fit-the-bayesian-meta-analysis." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now are data are ready, we can express our first Bayesian meta-analysis with the formula</p>
<p><span class="math display">\[\begin{align*}
\text{estimate}_j &amp; \sim \operatorname{Normal}(\theta_j, \; \text{std.error}_j) \\
\theta_j   &amp; \sim \operatorname{Normal}(\mu, \tau) \\
\mu        &amp; \sim \operatorname{Normal}(0, 1.5) \\
\tau       &amp; \sim \operatorname{Exponential}(1),
\end{align*}\]</span></p>
<p>where the last two lines spell out our priors. As we learned in <a href="god-spiked-the-integers.html#binomial-regression">Section 11.1</a>, the <span class="math inline">\(\operatorname{Normal}(0, 1.5)\)</span> prior in the log-odds space is just about flat on the probability space. If you wanted to be more conservative, consider something like <span class="math inline">\(\operatorname{Normal}(0, 1)\)</span>. Here’s how to fit the model with <strong>brms</strong>.</p>
<div class="sourceCode" id="cb2061"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2061-1"><a href="missing-data-and-other-opportunities.html#cb2061-1" aria-hidden="true" tabindex="-1"></a>b15<span class="fl">.10</span> <span class="ot">&lt;-</span> </span>
<span id="cb2061-2"><a href="missing-data-and-other-opportunities.html#cb2061-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> glms, </span>
<span id="cb2061-3"><a href="missing-data-and-other-opportunities.html#cb2061-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> gaussian,</span>
<span id="cb2061-4"><a href="missing-data-and-other-opportunities.html#cb2061-4" aria-hidden="true" tabindex="-1"></a>      estimate <span class="sc">|</span> <span class="fu">se</span>(std.error) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> loc),</span>
<span id="cb2061-5"><a href="missing-data-and-other-opportunities.html#cb2061-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> Intercept),</span>
<span id="cb2061-6"><a href="missing-data-and-other-opportunities.html#cb2061-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd)),</span>
<span id="cb2061-7"><a href="missing-data-and-other-opportunities.html#cb2061-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb2061-8"><a href="missing-data-and-other-opportunities.html#cb2061-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">15</span>,</span>
<span id="cb2061-9"><a href="missing-data-and-other-opportunities.html#cb2061-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/b15.10&quot;</span>)</span></code></pre></div>
<p><code>se()</code> is one of the <strong>brms</strong> helper functions designed to provide additional information about the criterion variable. Here it informs <code>brm()</code> that each <code>estimate</code> value has an associated measurement error defined in the <code>std.error</code> column. Unlike the <code>mi()</code> function, which we used earlier in the chapter to accommodate measurement error and the Bayesian imputation of missing data, the <code>se()</code> function is specially designed to handle meta-analyses. <code>se()</code> contains a <code>sigma</code> argument which is set to <code>FALSE</code> by default. This will return a model with no estimate for sigma, which is what we want. The uncertainty around the <code>estimate</code>-value for each study <span class="math inline">\(j\)</span> has already been encoded in the data as <code>std.error</code>.</p>
<p>Let’s look at the model results.</p>
<div class="sourceCode" id="cb2062"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2062-1"><a href="missing-data-and-other-opportunities.html#cb2062-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b15<span class="fl">.10</span>)</span></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: estimate | se(std.error) ~ 1 + (1 | loc) 
##    Data: glms (Number of observations: 59) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Group-Level Effects: 
## ~loc (Number of levels: 59) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)     0.43      0.09     0.26     0.61 1.00     1700     2556
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     2.55      0.09     2.38     2.72 1.00     2366     2808
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     0.00      0.00     0.00     0.00   NA       NA       NA
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Our estimate for heterogeneity across studies, <span class="math inline">\(\tau\)</span>, is about 0.4, suggesting modest differences across the studies. The meta-analytic effect, <span class="math inline">\(\mu\)</span>, is about 2.5. Both, recall, are in the log-odds metric. Here we exponentiate <span class="math inline">\(\mu\)</span> to get our odds ratio.</p>
<div class="sourceCode" id="cb2064"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2064-1"><a href="missing-data-and-other-opportunities.html#cb2064-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(b15<span class="fl">.10</span>) <span class="sc">%&gt;%</span> <span class="fu">exp</span>()</span></code></pre></div>
<pre><code>##           Estimate Est.Error     Q2.5    Q97.5
## Intercept 12.78688  1.091067 10.77015 15.15706</code></pre>
<p>If you look back up to the results reported by Klein and colleagues, you’ll see this is rather close to their OR estimate of 11.54.</p>
</div>
<div id="fit-the-bayesian-muiltilevel-alternative." class="section level3 hasAnchor" number="15.5.7">
<h3><span class="header-section-number">15.5.7</span> Fit the Bayesian muiltilevel alternative.<a href="missing-data-and-other-opportunities.html#fit-the-bayesian-muiltilevel-alternative." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We said earlier that meta-analysis is just a special case of the multilevel model, applied to summary data. We typically perform meta-analyses on data summaries because historically it has not been the norm among researchers to make their data publicly available. So effect size summaries were the best we typically had for aggregating study results. However, times are changing (e.g., <a href="https://www.apa.org/monitor/2017/11/trends-open-science.aspx">here</a>, <a href="https://www.blog.google/products/search/making-it-easier-discover-datasets/">here</a>). In this case, Klein and colleagues engaged in open-science practices and reported all their data. Thus we can just directly fit the model</p>
<p><span class="math display">\[\begin{align*}
\text{y}_{ij} &amp; \sim \operatorname{Binomial}(n = 1, p_{ij}) \\
\operatorname{logit}(p_{ij}) &amp; \sim \alpha + \beta \text{factor}_{ij} + u_{\alpha j} + u_{\beta j} \text{factor}_{ij} \\

\begin{bmatrix} u_{\alpha j} \\ u_{\beta j} \end{bmatrix} &amp; \sim \operatorname{MVNormal} \begin{pmatrix} \begin{bmatrix} 0 \\ 0 \end{bmatrix}, \mathbf{SRS} \end{pmatrix} \\

\mathbf S &amp; = \begin{bmatrix} \sigma_\alpha &amp; 0 \\ 0 &amp; \sigma_\beta \end{bmatrix} \\
\mathbf R &amp; = \begin{bmatrix} 0 &amp; \rho_{\alpha \beta} \\ \rho_{\beta \alpha} &amp; 0 \end{bmatrix} \\

\alpha &amp; \sim \operatorname{Normal}(0, 1.5) \\
\beta  &amp; \sim \operatorname{Normal}(0, 1.5) \\
\sigma_\alpha &amp; \sim \operatorname{Exponential}(1) \\
\sigma_\beta  &amp; \sim \operatorname{Exponential}(1) \\
\mathbf R &amp; \sim \operatorname{LKJ}(2),
\end{align*}\]</span></p>
<p>where the criterion variable, <span class="math inline">\(y\)</span>, is nested in <span class="math inline">\(i\)</span> participants within <span class="math inline">\(j\)</span> locations. The <span class="math inline">\(\beta\)</span> parameter is analogous to the meta-analytic effect (<span class="math inline">\(\mu\)</span>) and <span class="math inline">\(\sigma_\beta\)</span> is analogous to the expression of heterogeneity in the meta-analytic effect (<span class="math inline">\(\tau\)</span>). Here is how to fit the model with <strong>brms</strong>.</p>
<div class="sourceCode" id="cb2066"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2066-1"><a href="missing-data-and-other-opportunities.html#cb2066-1" aria-hidden="true" tabindex="-1"></a>b15<span class="fl">.11</span> <span class="ot">&lt;-</span> </span>
<span id="cb2066-2"><a href="missing-data-and-other-opportunities.html#cb2066-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> d, </span>
<span id="cb2066-3"><a href="missing-data-and-other-opportunities.html#cb2066-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial,</span>
<span id="cb2066-4"><a href="missing-data-and-other-opportunities.html#cb2066-4" aria-hidden="true" tabindex="-1"></a>      y <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">1</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept <span class="sc">+</span> factor <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> factor <span class="sc">|</span> loc),</span>
<span id="cb2066-5"><a href="missing-data-and-other-opportunities.html#cb2066-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">1.5</span>), <span class="at">class =</span> b),</span>
<span id="cb2066-6"><a href="missing-data-and-other-opportunities.html#cb2066-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">exponential</span>(<span class="dv">1</span>), <span class="at">class =</span> sd),</span>
<span id="cb2066-7"><a href="missing-data-and-other-opportunities.html#cb2066-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">prior</span>(<span class="fu">lkj</span>(<span class="dv">2</span>), <span class="at">class =</span> cor)),</span>
<span id="cb2066-8"><a href="missing-data-and-other-opportunities.html#cb2066-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">2000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>, <span class="at">cores =</span> <span class="dv">4</span>, <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb2066-9"><a href="missing-data-and-other-opportunities.html#cb2066-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">15</span>,</span>
<span id="cb2066-10"><a href="missing-data-and-other-opportunities.html#cb2066-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/b15.11&quot;</span>)</span></code></pre></div>
<p>The results for the focal parameters are very similar to those from <code>b15.10</code>.</p>
<div class="sourceCode" id="cb2067"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2067-1"><a href="missing-data-and-other-opportunities.html#cb2067-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(b15<span class="fl">.11</span>)</span></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = logit 
## Formula: y | trials(1) ~ 0 + Intercept + factor + (1 + factor | loc) 
##    Data: d (Number of observations: 6842) 
##   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup draws = 4000
## 
## Group-Level Effects: 
## ~loc (Number of levels: 59) 
##                                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)                       0.42      0.07     0.30     0.57 1.00     1593     2426
## sd(factorSideEffect)                0.48      0.09     0.32     0.67 1.00      918     1642
## cor(Intercept,factorSideEffect)    -0.31      0.19    -0.63     0.09 1.01     1014     1909
## 
## Population-Level Effects: 
##                  Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept           -1.67      0.08    -1.82    -1.53 1.00     1516     1806
## factorSideEffect     2.57      0.09     2.40     2.75 1.00     1509     1846
## 
## Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Here’s the multilevel version of the effect size as an odds ratio.</p>
<div class="sourceCode" id="cb2069"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2069-1"><a href="missing-data-and-other-opportunities.html#cb2069-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(b15<span class="fl">.11</span>)[<span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>] <span class="sc">%&gt;%</span> <span class="fu">exp</span>()</span></code></pre></div>
<pre><code>## Estimate     Q2.5    Q97.5 
## 13.09258 11.01871 15.70430</code></pre>
<p>Here we compare the study specific effect sizes, <span class="math inline">\(\theta_j\)</span>, by our two modeling approaches.</p>
<div class="sourceCode" id="cb2071"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2071-1"><a href="missing-data-and-other-opportunities.html#cb2071-1" aria-hidden="true" tabindex="-1"></a>color <span class="ot">&lt;-</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">3</span>]</span>
<span id="cb2071-2"><a href="missing-data-and-other-opportunities.html#cb2071-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2071-3"><a href="missing-data-and-other-opportunities.html#cb2071-3" aria-hidden="true" tabindex="-1"></a><span class="co"># how many levels are there?</span></span>
<span id="cb2071-4"><a href="missing-data-and-other-opportunities.html#cb2071-4" aria-hidden="true" tabindex="-1"></a>n_loc <span class="ot">&lt;-</span> <span class="fu">distinct</span>(d, loc) <span class="sc">%&gt;%</span> <span class="fu">count</span>() <span class="sc">%&gt;%</span> <span class="fu">pull</span>(n)</span>
<span id="cb2071-5"><a href="missing-data-and-other-opportunities.html#cb2071-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2071-6"><a href="missing-data-and-other-opportunities.html#cb2071-6" aria-hidden="true" tabindex="-1"></a><span class="co"># rank by meta-analysis</span></span>
<span id="cb2071-7"><a href="missing-data-and-other-opportunities.html#cb2071-7" aria-hidden="true" tabindex="-1"></a>ranks <span class="ot">&lt;-</span></span>
<span id="cb2071-8"><a href="missing-data-and-other-opportunities.html#cb2071-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">Estimate =</span> <span class="fu">coef</span>(b15<span class="fl">.10</span>)<span class="sc">$</span>loc[, <span class="dv">1</span>, <span class="st">&quot;Intercept&quot;</span>],</span>
<span id="cb2071-9"><a href="missing-data-and-other-opportunities.html#cb2071-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">index    =</span> <span class="dv">1</span><span class="sc">:</span>n_loc) <span class="sc">%&gt;%</span> </span>
<span id="cb2071-10"><a href="missing-data-and-other-opportunities.html#cb2071-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Estimate) <span class="sc">%&gt;%</span> </span>
<span id="cb2071-11"><a href="missing-data-and-other-opportunities.html#cb2071-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="dv">1</span><span class="sc">:</span>n_loc)</span>
<span id="cb2071-12"><a href="missing-data-and-other-opportunities.html#cb2071-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2071-13"><a href="missing-data-and-other-opportunities.html#cb2071-13" aria-hidden="true" tabindex="-1"></a><span class="co"># combine parameter summaries</span></span>
<span id="cb2071-14"><a href="missing-data-and-other-opportunities.html#cb2071-14" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">coef</span>(b15<span class="fl">.10</span>)<span class="sc">$</span>loc[, , <span class="st">&quot;Intercept&quot;</span>],</span>
<span id="cb2071-15"><a href="missing-data-and-other-opportunities.html#cb2071-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">coef</span>(b15<span class="fl">.11</span>)<span class="sc">$</span>loc[, , <span class="st">&quot;factorSideEffect&quot;</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb2071-16"><a href="missing-data-and-other-opportunities.html#cb2071-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2071-17"><a href="missing-data-and-other-opportunities.html#cb2071-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_loc, <span class="at">times =</span> <span class="dv">2</span>),</span>
<span id="cb2071-18"><a href="missing-data-and-other-opportunities.html#cb2071-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">type  =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;meta-analysis&quot;</span>, <span class="st">&quot;multilevel model&quot;</span>), <span class="at">each =</span> n_loc)) <span class="sc">%&gt;%</span> </span>
<span id="cb2071-19"><a href="missing-data-and-other-opportunities.html#cb2071-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add the ranks</span></span>
<span id="cb2071-20"><a href="missing-data-and-other-opportunities.html#cb2071-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(ranks, <span class="sc">-</span>Estimate), </span>
<span id="cb2071-21"><a href="missing-data-and-other-opportunities.html#cb2071-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="st">&quot;index&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2071-22"><a href="missing-data-and-other-opportunities.html#cb2071-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2071-23"><a href="missing-data-and-other-opportunities.html#cb2071-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">xmin =</span> Q2<span class="fl">.5</span>, <span class="at">xmax =</span> Q97<span class="fl">.5</span>, <span class="at">y =</span> rank)) <span class="sc">+</span></span>
<span id="cb2071-24"><a href="missing-data-and-other-opportunities.html#cb2071-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">fatten =</span> <span class="dv">1</span>, <span class="at">color =</span> color) <span class="sc">+</span></span>
<span id="cb2071-25"><a href="missing-data-and-other-opportunities.html#cb2071-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="fu">expression</span>(log<span class="sc">-</span>odds<span class="sc">~</span>effect<span class="sc">~</span>size<span class="sc">~</span>(theta[<span class="fu">italic</span>(j)])), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">4.5</span>)) <span class="sc">+</span></span>
<span id="cb2071-26"><a href="missing-data-and-other-opportunities.html#cb2071-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2071-27"><a href="missing-data-and-other-opportunities.html#cb2071-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> type)</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-90-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The results are very similar. You might be curious how to show these results in a more conventional looking forest plot where the names of the groups (typically studies) for the <span class="math inline">\(\theta_j\)</span> values are listed on the left, the point estimate and 95% interval summaries are listed on the right, and the summary for the population level effect, <span class="math inline">\(\mu\)</span>, is listed beneath all all the <span class="math inline">\(\theta_j\)</span>’s. That’ll require some prep work. First we’ll need to reformat the location names. I’ll save the results in an object called <code>labs</code>.</p>
<div class="sourceCode" id="cb2072"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2072-1"><a href="missing-data-and-other-opportunities.html#cb2072-1" aria-hidden="true" tabindex="-1"></a>labs <span class="ot">&lt;-</span></span>
<span id="cb2072-2"><a href="missing-data-and-other-opportunities.html#cb2072-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb2072-3"><a href="missing-data-and-other-opportunities.html#cb2072-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lab =</span> <span class="fu">case_when</span>(</span>
<span id="cb2072-4"><a href="missing-data-and-other-opportunities.html#cb2072-4" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Social and Work Psychology Department, University of Brasilia, DF, Brazil&quot;</span> <span class="sc">~</span> <span class="st">&quot;University of Brasilia&quot;</span>,</span>
<span id="cb2072-5"><a href="missing-data-and-other-opportunities.html#cb2072-5" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Wilfrid Laurier University, Waterloo, Ontario, Canada&quot;</span> <span class="sc">~</span> <span class="st">&quot;Wilfrid Laurier University&quot;</span>,</span>
<span id="cb2072-6"><a href="missing-data-and-other-opportunities.html#cb2072-6" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;University of British Columbia, Vancouver, Canada&quot;</span> <span class="sc">~</span> <span class="st">&quot;University of British Columbia&quot;</span>,</span>
<span id="cb2072-7"><a href="missing-data-and-other-opportunities.html#cb2072-7" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;University of Toronto, Scarborough&quot;</span> <span class="sc">~</span> <span class="st">&quot;University of Toronto&quot;</span>,</span>
<span id="cb2072-8"><a href="missing-data-and-other-opportunities.html#cb2072-8" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Division of Social Science, The Hong Kong University of Science and Technology, Hong Kong, China&quot;</span> <span class="sc">~</span> <span class="st">&quot;Hong Kong University of Science and Technology&quot;</span>,</span>
<span id="cb2072-9"><a href="missing-data-and-other-opportunities.html#cb2072-9" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Chinese Academy of Science, Beijing, China&quot;</span> <span class="sc">~</span> <span class="st">&quot;Chinese Academy of Science&quot;</span>,</span>
<span id="cb2072-10"><a href="missing-data-and-other-opportunities.html#cb2072-10" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Shanghai International Studies University, SISU Intercultural Institute, Shanghai, China&quot;</span> <span class="sc">~</span> <span class="st">&quot;Shanghai International Studies University&quot;</span>,</span>
<span id="cb2072-11"><a href="missing-data-and-other-opportunities.html#cb2072-11" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Guangdong Literature &amp; Art Vocational College, Guangzhou, China&quot;</span> <span class="sc">~</span> <span class="st">&quot;Guangdong Literature &amp; Art Vocational College&quot;</span>,</span>
<span id="cb2072-12"><a href="missing-data-and-other-opportunities.html#cb2072-12" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;The University of J. E. Purkyně, Ústí nad Labem, Czech Republic&quot;</span> <span class="sc">~</span> <span class="st">&quot;The University of J. E. Purkyně&quot;</span>,</span>
<span id="cb2072-13"><a href="missing-data-and-other-opportunities.html#cb2072-13" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;University of Leuven, Belgium&quot;</span> <span class="sc">~</span> <span class="st">&quot;University of Leuven&quot;</span>,</span>
<span id="cb2072-14"><a href="missing-data-and-other-opportunities.html#cb2072-14" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Department of Experimental and Applied Psychology, VU Amsterdam, 1081BT, Amsterdam, The Netherlands&quot;</span> <span class="sc">~</span> <span class="st">&quot;VU Amsterdam&quot;</span>,</span>
<span id="cb2072-15"><a href="missing-data-and-other-opportunities.html#cb2072-15" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Department of Social Psychology, Tilburg University, P.O. Box 90153, Tilburg, 5000 LE, Netherlands&quot;</span> <span class="sc">~</span> <span class="st">&quot;Department of Social Psychology, Tilburg University&quot;</span>,</span>
<span id="cb2072-16"><a href="missing-data-and-other-opportunities.html#cb2072-16" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Eindhoven University of Technology, Eindhoven, Netherlands&quot;</span> <span class="sc">~</span> <span class="st">&quot;Eindhoven University of Technology&quot;</span>,</span>
<span id="cb2072-17"><a href="missing-data-and-other-opportunities.html#cb2072-17" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Department of Communication and Information Sciences, P.O. Box 90153, Tilburg, 5000 LE, Netherlands&quot;</span> <span class="sc">~</span> <span class="st">&quot;Department of Communication and Information Sciences, Tilburg University&quot;</span>,</span>
<span id="cb2072-18"><a href="missing-data-and-other-opportunities.html#cb2072-18" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;University of Navarra, Spain&quot;</span> <span class="sc">~</span> <span class="st">&quot;University of Navarra&quot;</span>,</span>
<span id="cb2072-19"><a href="missing-data-and-other-opportunities.html#cb2072-19" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;University of Lausanne, Switzerland&quot;</span> <span class="sc">~</span> <span class="st">&quot;University of Lausanne&quot;</span>,</span>
<span id="cb2072-20"><a href="missing-data-and-other-opportunities.html#cb2072-20" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Université de Poitiers, France&quot;</span> <span class="sc">~</span> <span class="st">&quot;Université de Poitiers&quot;</span>,</span>
<span id="cb2072-21"><a href="missing-data-and-other-opportunities.html#cb2072-21" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Eotvos Lorand University, in Budapest, Hungary&quot;</span> <span class="sc">~</span> <span class="st">&quot;Eotvos Lorand University&quot;</span>,</span>
<span id="cb2072-22"><a href="missing-data-and-other-opportunities.html#cb2072-22" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;MTurk India Workers&quot;</span> <span class="sc">~</span> <span class="st">&quot;MTurk India Workers&quot;</span>,</span>
<span id="cb2072-23"><a href="missing-data-and-other-opportunities.html#cb2072-23" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;University of Winchester, Winchester, Hampshire, England&quot;</span> <span class="sc">~</span> <span class="st">&quot;University of Winchester&quot;</span>,</span>
<span id="cb2072-24"><a href="missing-data-and-other-opportunities.html#cb2072-24" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Doshisha University, Kyoto, Japan&quot;</span> <span class="sc">~</span> <span class="st">&quot;Doshisha University&quot;</span>,</span>
<span id="cb2072-25"><a href="missing-data-and-other-opportunities.html#cb2072-25" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Victoria University of Wellington, New Zealand&quot;</span> <span class="sc">~</span> <span class="st">&quot;Victoria University of Wellington&quot;</span>,</span>
<span id="cb2072-26"><a href="missing-data-and-other-opportunities.html#cb2072-26" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;University of Social Sciences and Humanities, Wroclaw, Poland&quot;</span> <span class="sc">~</span> <span class="st">&quot;University of Social Sciences and Humanities&quot;</span>,</span>
<span id="cb2072-27"><a href="missing-data-and-other-opportunities.html#cb2072-27" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Department of Psychology, SWPS University of Social Sciences and Humanities Campus Sopot, Sopot, Poland&quot;</span> <span class="sc">~</span> <span class="st">&quot;SWPS University of Social Sciences and Humanities Campus Sopot&quot;</span>,</span>
<span id="cb2072-28"><a href="missing-data-and-other-opportunities.html#cb2072-28" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;badania.net&quot;</span> <span class="sc">~</span> <span class="st">&quot;badania.net&quot;</span>,</span>
<span id="cb2072-29"><a href="missing-data-and-other-opportunities.html#cb2072-29" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Universidade do Porto, Portugal&quot;</span> <span class="sc">~</span> <span class="st">&quot;Universidade do Porto&quot;</span>,</span>
<span id="cb2072-30"><a href="missing-data-and-other-opportunities.html#cb2072-30" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;University of Belgrade, Belgrade, Serbia&quot;</span> <span class="sc">~</span> <span class="st">&quot;University of Belgrade&quot;</span>,</span>
<span id="cb2072-31"><a href="missing-data-and-other-opportunities.html#cb2072-31" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;University of Johannesburg, Johanneburg, South Africa&quot;</span> <span class="sc">~</span> <span class="st">&quot;University of Johannesburg&quot;</span>,</span>
<span id="cb2072-32"><a href="missing-data-and-other-opportunities.html#cb2072-32" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Santiago, Chile&quot;</span> <span class="sc">~</span> <span class="st">&quot;Santiago, Chile&quot;</span>,</span>
<span id="cb2072-33"><a href="missing-data-and-other-opportunities.html#cb2072-33" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Universidad de Costa Rica, Costa Rica&quot;</span> <span class="sc">~</span> <span class="st">&quot;Universidad de Costa Rica&quot;</span>,</span>
<span id="cb2072-34"><a href="missing-data-and-other-opportunities.html#cb2072-34" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;National Autonomous University of Mexico in Mexico City&quot;</span> <span class="sc">~</span> <span class="st">&quot;National Autonomous University of Mexico&quot;</span>,</span>
<span id="cb2072-35"><a href="missing-data-and-other-opportunities.html#cb2072-35" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;University of the Republic, Montevideo, Uruguay&quot;</span> <span class="sc">~</span> <span class="st">&quot;University of the Republic&quot;</span>,</span>
<span id="cb2072-36"><a href="missing-data-and-other-opportunities.html#cb2072-36" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Lund University, Lund, Sweden&quot;</span> <span class="sc">~</span> <span class="st">&quot;Lund University&quot;</span>,</span>
<span id="cb2072-37"><a href="missing-data-and-other-opportunities.html#cb2072-37" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Academia Sinica, Taiwan National Taiwan Normal University, Taiwan&quot;</span> <span class="sc">~</span> <span class="st">&quot;Taiwan National Taiwan Normal University&quot;</span>,</span>
<span id="cb2072-38"><a href="missing-data-and-other-opportunities.html#cb2072-38" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Bilgi University, Istanbul, Turkey&quot;</span> <span class="sc">~</span> <span class="st">&quot;Bilgi University&quot;</span>,</span>
<span id="cb2072-39"><a href="missing-data-and-other-opportunities.html#cb2072-39" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Koç University, Istanbul, Turkey&quot;</span> <span class="sc">~</span> <span class="st">&quot;Koç University&quot;</span>,</span>
<span id="cb2072-40"><a href="missing-data-and-other-opportunities.html#cb2072-40" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;American University of Sharjah, United Arab Emirates&quot;</span> <span class="sc">~</span> <span class="st">&quot;American University of Sharjah&quot;</span>,</span>
<span id="cb2072-41"><a href="missing-data-and-other-opportunities.html#cb2072-41" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;University of Hawaii, Honolulu, HI&quot;</span> <span class="sc">~</span> <span class="st">&quot;University of Hawaii&quot;</span>,</span>
<span id="cb2072-42"><a href="missing-data-and-other-opportunities.html#cb2072-42" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Social Science and Policy Studies Department, Worcester Polytechnic Institute, Worcester, MA 01609&quot;</span> <span class="sc">~</span> <span class="st">&quot;Worcester Polytechnic Institute&quot;</span>,</span>
<span id="cb2072-43"><a href="missing-data-and-other-opportunities.html#cb2072-43" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Department of Psychology, Washington and Lee University, Lexington, VA 24450&quot;</span> <span class="sc">~</span> <span class="st">&quot;Washington and Lee University&quot;</span>,</span>
<span id="cb2072-44"><a href="missing-data-and-other-opportunities.html#cb2072-44" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Department of Psychology, San Diego State University, San Diego, CA 92182&quot;</span> <span class="sc">~</span> <span class="st">&quot;San Diego State University&quot;</span>,</span>
<span id="cb2072-45"><a href="missing-data-and-other-opportunities.html#cb2072-45" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Tufts&quot;</span> <span class="sc">~</span> <span class="st">&quot;Tufts&quot;</span>,</span>
<span id="cb2072-46"><a href="missing-data-and-other-opportunities.html#cb2072-46" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;University of Florida, Florida&quot;</span> <span class="sc">~</span> <span class="st">&quot;University of Florida&quot;</span>,</span>
<span id="cb2072-47"><a href="missing-data-and-other-opportunities.html#cb2072-47" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;University of Illinois at Urbana-Champaign, Champaign, IL&quot;</span> <span class="sc">~</span> <span class="st">&quot;University of Illinois at Urbana-Champaign&quot;</span>,</span>
<span id="cb2072-48"><a href="missing-data-and-other-opportunities.html#cb2072-48" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Pacific Lutheran University, Tacoma, WA&quot;</span> <span class="sc">~</span> <span class="st">&quot;Pacific Lutheran University&quot;</span>,</span>
<span id="cb2072-49"><a href="missing-data-and-other-opportunities.html#cb2072-49" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;University of Virginia, VA&quot;</span> <span class="sc">~</span> <span class="st">&quot;University of Virginia&quot;</span>,</span>
<span id="cb2072-50"><a href="missing-data-and-other-opportunities.html#cb2072-50" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Marian University, Indianapolis, IN&quot;</span> <span class="sc">~</span> <span class="st">&quot;Marian University&quot;</span>,</span>
<span id="cb2072-51"><a href="missing-data-and-other-opportunities.html#cb2072-51" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Department of Psychology, Ithaca College, Ithaca, NY 14850&quot;</span> <span class="sc">~</span> <span class="st">&quot;Ithaca College&quot;</span>,</span>
<span id="cb2072-52"><a href="missing-data-and-other-opportunities.html#cb2072-52" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;University of Michigan&quot;</span> <span class="sc">~</span> <span class="st">&quot;University of Michigan&quot;</span>,</span>
<span id="cb2072-53"><a href="missing-data-and-other-opportunities.html#cb2072-53" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Department of Psychology, Pennsylvania State University Abington, Abington, PA 19001&quot;</span> <span class="sc">~</span> <span class="st">&quot;Pennsylvania State University Abington&quot;</span>,</span>
<span id="cb2072-54"><a href="missing-data-and-other-opportunities.html#cb2072-54" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Department of Psychology, Texas A&amp;M University, College Station, TX 77843&quot;</span> <span class="sc">~</span> <span class="st">&quot;Texas A&amp;M University&quot;</span>,</span>
<span id="cb2072-55"><a href="missing-data-and-other-opportunities.html#cb2072-55" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;William Paterson University, Wayne, NJ&quot;</span> <span class="sc">~</span> <span class="st">&quot;William Paterson University&quot;</span>,</span>
<span id="cb2072-56"><a href="missing-data-and-other-opportunities.html#cb2072-56" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Department of Cognitive Science, Occidental College, Los Angeles, CA&quot;</span> <span class="sc">~</span> <span class="st">&quot;Occidental College&quot;</span>,</span>
<span id="cb2072-57"><a href="missing-data-and-other-opportunities.html#cb2072-57" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;The Pennsylvania State University&quot;</span> <span class="sc">~</span> <span class="st">&quot;The Pennsylvania State University&quot;</span>,</span>
<span id="cb2072-58"><a href="missing-data-and-other-opportunities.html#cb2072-58" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;MTurk US Workers&quot;</span> <span class="sc">~</span> <span class="st">&quot;MTurk US Workers&quot;</span>,</span>
<span id="cb2072-59"><a href="missing-data-and-other-opportunities.html#cb2072-59" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;University of Graz AND the Universty of Vienna&quot;</span> <span class="sc">~</span> <span class="st">&quot;University of Graz and the Universty of Vienna&quot;</span>,</span>
<span id="cb2072-60"><a href="missing-data-and-other-opportunities.html#cb2072-60" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;University of Potsdam, Germany&quot;</span> <span class="sc">~</span> <span class="st">&quot;University of Potsdam&quot;</span>,</span>
<span id="cb2072-61"><a href="missing-data-and-other-opportunities.html#cb2072-61" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Open University of Hong Kong&quot;</span> <span class="sc">~</span> <span class="st">&quot;Open University of Hong Kong&quot;</span>,</span>
<span id="cb2072-62"><a href="missing-data-and-other-opportunities.html#cb2072-62" aria-hidden="true" tabindex="-1"></a>    Location <span class="sc">==</span> <span class="st">&quot;Concepción, Chile&quot;</span> <span class="sc">~</span> <span class="st">&quot;Concepción&quot;</span></span>
<span id="cb2072-63"><a href="missing-data-and-other-opportunities.html#cb2072-63" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb2072-64"><a href="missing-data-and-other-opportunities.html#cb2072-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(loc, lab)</span>
<span id="cb2072-65"><a href="missing-data-and-other-opportunities.html#cb2072-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2072-66"><a href="missing-data-and-other-opportunities.html#cb2072-66" aria-hidden="true" tabindex="-1"></a><span class="co"># what is this?</span></span>
<span id="cb2072-67"><a href="missing-data-and-other-opportunities.html#cb2072-67" aria-hidden="true" tabindex="-1"></a>labs <span class="sc">%&gt;%</span> </span>
<span id="cb2072-68"><a href="missing-data-and-other-opportunities.html#cb2072-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 59
## Columns: 2
## $ loc &lt;fct&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 2…
## $ lab &lt;chr&gt; &quot;University of Brasilia&quot;, &quot;Wilfrid Laurier University&quot;, &quot;University of British Columbia&quot;, &quot;Unive…</code></pre>
<p>Now we’ll do some tricky wrangling with the output from <code>coef()</code> and <code>fixef()</code> to arrange the odds ratio summaries for the population average and the location-specific results.</p>
<div class="sourceCode" id="cb2074"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2074-1"><a href="missing-data-and-other-opportunities.html#cb2074-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this will help us format the labels on the secondary y-axis</span></span>
<span id="cb2074-2"><a href="missing-data-and-other-opportunities.html#cb2074-2" aria-hidden="true" tabindex="-1"></a>my_format <span class="ot">&lt;-</span> <span class="cf">function</span>(number) {</span>
<span id="cb2074-3"><a href="missing-data-and-other-opportunities.html#cb2074-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formatC</span>(number, <span class="at">digits =</span> <span class="dv">2</span>, <span class="at">format =</span> <span class="st">&quot;f&quot;</span>)</span>
<span id="cb2074-4"><a href="missing-data-and-other-opportunities.html#cb2074-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2074-5"><a href="missing-data-and-other-opportunities.html#cb2074-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2074-6"><a href="missing-data-and-other-opportunities.html#cb2074-6" aria-hidden="true" tabindex="-1"></a><span class="co"># grab the theta_j summaries</span></span>
<span id="cb2074-7"><a href="missing-data-and-other-opportunities.html#cb2074-7" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span></span>
<span id="cb2074-8"><a href="missing-data-and-other-opportunities.html#cb2074-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>(b15<span class="fl">.11</span>)<span class="sc">$</span>loc[, , <span class="st">&quot;factorSideEffect&quot;</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb2074-9"><a href="missing-data-and-other-opportunities.html#cb2074-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2074-10"><a href="missing-data-and-other-opportunities.html#cb2074-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">loc =</span> <span class="fu">distinct</span>(d, loc) <span class="sc">%&gt;%</span> <span class="fu">pull</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb2074-11"><a href="missing-data-and-other-opportunities.html#cb2074-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Estimate)</span>
<span id="cb2074-12"><a href="missing-data-and-other-opportunities.html#cb2074-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2074-13"><a href="missing-data-and-other-opportunities.html#cb2074-13" aria-hidden="true" tabindex="-1"></a><span class="co"># grab the mu summary</span></span>
<span id="cb2074-14"><a href="missing-data-and-other-opportunities.html#cb2074-14" aria-hidden="true" tabindex="-1"></a>average <span class="ot">&lt;-</span></span>
<span id="cb2074-15"><a href="missing-data-and-other-opportunities.html#cb2074-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fixef</span>(b15<span class="fl">.11</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2074-16"><a href="missing-data-and-other-opportunities.html#cb2074-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2074-17"><a href="missing-data-and-other-opportunities.html#cb2074-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2074-18"><a href="missing-data-and-other-opportunities.html#cb2074-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">loc =</span> <span class="st">&quot;Average&quot;</span>)</span>
<span id="cb2074-19"><a href="missing-data-and-other-opportunities.html#cb2074-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2074-20"><a href="missing-data-and-other-opportunities.html#cb2074-20" aria-hidden="true" tabindex="-1"></a><span class="co"># combine and wrangle</span></span>
<span id="cb2074-21"><a href="missing-data-and-other-opportunities.html#cb2074-21" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span></span>
<span id="cb2074-22"><a href="missing-data-and-other-opportunities.html#cb2074-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(groups, average) <span class="sc">%&gt;%</span> </span>
<span id="cb2074-23"><a href="missing-data-and-other-opportunities.html#cb2074-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank     =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">59</span>, <span class="dv">0</span>),</span>
<span id="cb2074-24"><a href="missing-data-and-other-opportunities.html#cb2074-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">Estimate =</span> <span class="fu">exp</span>(Estimate),</span>
<span id="cb2074-25"><a href="missing-data-and-other-opportunities.html#cb2074-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">Q2.5     =</span> <span class="fu">exp</span>(Q2<span class="fl">.5</span>),</span>
<span id="cb2074-26"><a href="missing-data-and-other-opportunities.html#cb2074-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">Q97.5    =</span> <span class="fu">exp</span>(Q97<span class="fl">.5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2074-27"><a href="missing-data-and-other-opportunities.html#cb2074-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(labs, <span class="at">by =</span> <span class="st">&quot;loc&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2074-28"><a href="missing-data-and-other-opportunities.html#cb2074-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(rank) <span class="sc">%&gt;%</span> </span>
<span id="cb2074-29"><a href="missing-data-and-other-opportunities.html#cb2074-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label   =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(lab), <span class="st">&quot;POPULATION AVERAGE&quot;</span>, lab),</span>
<span id="cb2074-30"><a href="missing-data-and-other-opportunities.html#cb2074-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">summary =</span> <span class="fu">str_c</span>(<span class="fu">my_format</span>(Estimate), <span class="st">&quot; [&quot;</span>, <span class="fu">my_format</span>(Q2<span class="fl">.5</span>), <span class="st">&quot;, &quot;</span>, <span class="fu">my_format</span>(Q97<span class="fl">.5</span>), <span class="st">&quot;]&quot;</span>))</span>
<span id="cb2074-31"><a href="missing-data-and-other-opportunities.html#cb2074-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2074-32"><a href="missing-data-and-other-opportunities.html#cb2074-32" aria-hidden="true" tabindex="-1"></a><span class="co"># what have we done?</span></span>
<span id="cb2074-33"><a href="missing-data-and-other-opportunities.html#cb2074-33" aria-hidden="true" tabindex="-1"></a>post <span class="sc">%&gt;%</span> </span>
<span id="cb2074-34"><a href="missing-data-and-other-opportunities.html#cb2074-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 60
## Columns: 9
## $ Estimate  &lt;dbl&gt; 13.092577, 5.981954, 7.261304, 7.908484, 7.940200, 7.994296, 8.289460, 8.495253, 8.677920,…
## $ Est.Error &lt;dbl&gt; 0.0923085, 0.2430214, 0.3488498, 0.3550866, 0.3343224, 0.2276796, 0.3426444, 0.3233599, 0.…
## $ Q2.5      &lt;dbl&gt; 11.018709, 3.700239, 3.582407, 3.810026, 4.057040, 5.087872, 4.255794, 4.484809, 4.808533,…
## $ Q97.5     &lt;dbl&gt; 15.704304, 9.587316, 14.224359, 15.928584, 15.237924, 12.512837, 16.466681, 15.919058, 15.…
## $ loc       &lt;chr&gt; &quot;Average&quot;, &quot;19&quot;, &quot;38&quot;, &quot;32&quot;, &quot;8&quot;, &quot;55&quot;, &quot;5&quot;, &quot;34&quot;, &quot;9&quot;, &quot;22&quot;, &quot;6&quot;, &quot;58&quot;, &quot;24&quot;, &quot;7&quot;, &quot;50&quot;, …
## $ rank      &lt;dbl&gt; 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, …
## $ lab       &lt;chr&gt; NA, &quot;MTurk India Workers&quot;, &quot;University of Hawaii&quot;, &quot;University of the Republic&quot;, &quot;Guangdon…
## $ label     &lt;chr&gt; &quot;POPULATION AVERAGE&quot;, &quot;MTurk India Workers&quot;, &quot;University of Hawaii&quot;, &quot;University of the Re…
## $ summary   &lt;chr&gt; &quot;13.09 [11.02, 15.70]&quot;, &quot;5.98 [3.70, 9.59]&quot;, &quot;7.26 [3.58, 14.22]&quot;, &quot;7.91 [3.81, 15.93]&quot;, &quot;…</code></pre>
<p>Here’s our custom forest plot.</p>
<div class="sourceCode" id="cb2076"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2076-1"><a href="missing-data-and-other-opportunities.html#cb2076-1" aria-hidden="true" tabindex="-1"></a>post <span class="sc">%&gt;%</span> </span>
<span id="cb2076-2"><a href="missing-data-and-other-opportunities.html#cb2076-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Estimate, <span class="at">xmin =</span> Q2<span class="fl">.5</span>, <span class="at">xmax =</span> Q97<span class="fl">.5</span>, <span class="at">y =</span> rank)) <span class="sc">+</span></span>
<span id="cb2076-3"><a href="missing-data-and-other-opportunities.html#cb2076-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_interval</span>(<span class="fu">aes</span>(<span class="at">color =</span> label <span class="sc">==</span> <span class="st">&quot;POPULATION AVERAGE&quot;</span>),</span>
<span id="cb2076-4"><a href="missing-data-and-other-opportunities.html#cb2076-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb2076-5"><a href="missing-data-and-other-opportunities.html#cb2076-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> <span class="dv">1</span> <span class="sc">-</span> Est.Error, <span class="at">color =</span> label <span class="sc">==</span> <span class="st">&quot;POPULATION AVERAGE&quot;</span>),</span>
<span id="cb2076-6"><a href="missing-data-and-other-opportunities.html#cb2076-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">shape =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb2076-7"><a href="missing-data-and-other-opportunities.html#cb2076-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>, <span class="at">begin =</span> .<span class="dv">33</span>, <span class="at">end =</span> .<span class="dv">67</span>) <span class="sc">+</span></span>
<span id="cb2076-8"><a href="missing-data-and-other-opportunities.html#cb2076-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">3.5</span>)) <span class="sc">+</span></span>
<span id="cb2076-9"><a href="missing-data-and-other-opportunities.html#cb2076-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;odds ratio&quot;</span>, <span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span> <span class="sc">*</span> <span class="dv">10</span>, <span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.005</span>, <span class="fl">0.005</span>))) <span class="sc">+</span></span>
<span id="cb2076-10"><a href="missing-data-and-other-opportunities.html#cb2076-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">59</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">60</span>), <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb2076-11"><a href="missing-data-and-other-opportunities.html#cb2076-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">pull</span>(post, label),</span>
<span id="cb2076-12"><a href="missing-data-and-other-opportunities.html#cb2076-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sec.axis =</span> <span class="fu">dup_axis</span>(<span class="at">labels =</span> <span class="fu">pull</span>(post, summary))) <span class="sc">+</span></span>
<span id="cb2076-13"><a href="missing-data-and-other-opportunities.html#cb2076-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Times&quot;</span>),</span>
<span id="cb2076-14"><a href="missing-data-and-other-opportunities.html#cb2076-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb2076-15"><a href="missing-data-and-other-opportunities.html#cb2076-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y.right =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">7</span>),</span>
<span id="cb2076-16"><a href="missing-data-and-other-opportunities.html#cb2076-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb2076-17"><a href="missing-data-and-other-opportunities.html#cb2076-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;grey8&quot;</span>),</span>
<span id="cb2076-18"><a href="missing-data-and-other-opportunities.html#cb2076-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">&quot;transparent&quot;</span>))</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-93-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>You may have noticed this plot is based on the results of our multilevel model, <code>b15.11</code>. We could have done the same basic thing with the results from the more conventional meta-analysis model, <code>b15.10</code>, too.</p>
<p>I’m not aware this it typical in random effect meta-analyses, but it might be useful to further clarify the meaning of the two primary parameters, <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\tau\)</span>. Like with the forest plot, above, we could examine these with either <code>b15.10</code> or <code>b15.11</code>. For kicks, we’ll use <code>b15.10</code> (the conventional Bayesian meta-analysis). In the output from <code>as_draws_df(b15.10)</code>, <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\tau\)</span> are in the columns named <code>b_Intercept</code> and <code>sd_loc__Intercept</code>, respectively.</p>
<div class="sourceCode" id="cb2077"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2077-1"><a href="missing-data-and-other-opportunities.html#cb2077-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(b15<span class="fl">.10</span>)</span>
<span id="cb2077-2"><a href="missing-data-and-other-opportunities.html#cb2077-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2077-3"><a href="missing-data-and-other-opportunities.html#cb2077-3" aria-hidden="true" tabindex="-1"></a>post <span class="sc">%&gt;%</span> </span>
<span id="cb2077-4"><a href="missing-data-and-other-opportunities.html#cb2077-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(b_Intercept<span class="sc">:</span>sd_loc__Intercept) <span class="sc">%&gt;%</span> </span>
<span id="cb2077-5"><a href="missing-data-and-other-opportunities.html#cb2077-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   b_Intercept sd_loc__Intercept
##         &lt;dbl&gt;             &lt;dbl&gt;
## 1        2.53             0.442
## 2        2.50             0.369
## 3        2.68             0.424
## 4        2.50             0.310
## 5        2.48             0.366
## 6        2.61             0.544</code></pre>
<p>If you scroll back above, you’ll see our random effect meta-analysis explicitly presumed our empirical effect-size estimates <span class="math inline">\(y_j\)</span> are approximations of the true effect sizes <span class="math inline">\(\theta_j\)</span>, which are themselves normally distributed in the population of possible effect sizes from similar studies: <span class="math inline">\(\theta_j \sim \operatorname{Normal}(\mu, \tau)\)</span>. Why not use our posterior draws to simulate draws from <span class="math inline">\(\operatorname{Normal}(\mu, \tau)\)</span> to get a sense of what this distribution might look like? Recall that the parameters are in the log-odds metric. We’ll present the distribution in that metric and as odds ratios.</p>
<div class="sourceCode" id="cb2079"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2079-1"><a href="missing-data-and-other-opportunities.html#cb2079-1" aria-hidden="true" tabindex="-1"></a>color <span class="ot">&lt;-</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">6</span>]</span>
<span id="cb2079-2"><a href="missing-data-and-other-opportunities.html#cb2079-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb2079-3"><a href="missing-data-and-other-opportunities.html#cb2079-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2079-4"><a href="missing-data-and-other-opportunities.html#cb2079-4" aria-hidden="true" tabindex="-1"></a>post <span class="sc">%&gt;%</span> </span>
<span id="cb2079-5"><a href="missing-data-and-other-opportunities.html#cb2079-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">lo =</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="at">mean =</span> b_Intercept, <span class="at">sd =</span> sd_loc__Intercept),</span>
<span id="cb2079-6"><a href="missing-data-and-other-opportunities.html#cb2079-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">or =</span> <span class="fu">rnorm</span>(<span class="fu">n</span>(), <span class="at">mean =</span> b_Intercept, <span class="at">sd =</span> sd_loc__Intercept) <span class="sc">%&gt;%</span> <span class="fu">exp</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb2079-7"><a href="missing-data-and-other-opportunities.html#cb2079-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="fl">1e3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2079-8"><a href="missing-data-and-other-opportunities.html#cb2079-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(lo<span class="sc">:</span>or, <span class="at">values_to =</span> <span class="st">&quot;effect size&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2079-9"><a href="missing-data-and-other-opportunities.html#cb2079-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;log-odds&quot;</span>, <span class="st">&quot;odds ratio&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb2079-10"><a href="missing-data-and-other-opportunities.html#cb2079-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2079-11"><a href="missing-data-and-other-opportunities.html#cb2079-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">effect size</span><span class="st">`</span>, <span class="at">y =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb2079-12"><a href="missing-data-and-other-opportunities.html#cb2079-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dots</span>(<span class="at">color =</span> color, <span class="at">fill =</span> color) <span class="sc">+</span></span>
<span id="cb2079-13"><a href="missing-data-and-other-opportunities.html#cb2079-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2079-14"><a href="missing-data-and-other-opportunities.html#cb2079-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">Normal</span>(mu<span class="sc">*</span><span class="st">&#39;, &#39;</span><span class="sc">*</span>tau))) <span class="sc">+</span></span>
<span id="cb2079-15"><a href="missing-data-and-other-opportunities.html#cb2079-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;Times&quot;</span>),</span>
<span id="cb2079-16"><a href="missing-data-and-other-opportunities.html#cb2079-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">&quot;transparent&quot;</span>)) <span class="sc">+</span></span>
<span id="cb2079-17"><a href="missing-data-and-other-opportunities.html#cb2079-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-95-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Both panels show 1,000 draws, each of which is depicted by a single dot. If we were to run this experiment 1,000 times and compute the effect size separately for each one, this is what we’d expect those distributions of effect sizes to look like. Seems like there’s a lot of variation in there, eh? The next time you observe your fellow scientists debating over whether a study replicated or not, keep these distributions in mind. Once you start thinking about distributions, replication becomes a tricky notion.</p>
</div>
<div id="relative-to-the-muiltilevel-model-meta-analyses-have-limitations." class="section level3 hasAnchor" number="15.5.8">
<h3><span class="header-section-number">15.5.8</span> Relative to the muiltilevel model, meta-analyses have limitations.<a href="missing-data-and-other-opportunities.html#relative-to-the-muiltilevel-model-meta-analyses-have-limitations." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Although the Bayesian meta-analysis and multilevel models produced very similar results for the effect size, the two are not equivalent. Because the meta-analysis was based on summary information from the effect sizes along, it does not offer all of the insights available from the multilevel model. Other than the random effects, the only population parameters offered by the meta-analysis are the effect size, <span class="math inline">\(\mu\)</span>, and the standard deviation around that effect size, <span class="math inline">\(\tau\)</span>. These parameters are equivalent to our multilevel model parameters <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\sigma_\beta\)</span>, respectively. In addition, the multilevel model added group-level parameter for the average performance in the control condition, <span class="math inline">\(\alpha\)</span>, the population-level standard deviation around that mean, <span class="math inline">\(\sigma_\alpha\)</span>, and the correlation between the group-specific <span class="math inline">\(\alpha_j\)</span>’s and <span class="math inline">\(\beta_j\)</span>’s, which we called <span class="math inline">\(\rho_{\alpha \beta}\)</span>.</p>
<p>To build a sense of why we might to want these parameters, too, we’ll extract the posterior draws for the multilevel model <code>b15.11</code>.</p>
<div class="sourceCode" id="cb2080"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2080-1"><a href="missing-data-and-other-opportunities.html#cb2080-1" aria-hidden="true" tabindex="-1"></a>post <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(b15<span class="fl">.11</span>)</span></code></pre></div>
<p>Here we’ll make a scatter plot the posterior means of the random intercepts, <span class="math inline">\(\alpha_j\)</span>’s, and the random slopes, <span class="math inline">\(\beta_j\)</span>’s.</p>
<div class="sourceCode" id="cb2081"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2081-1"><a href="missing-data-and-other-opportunities.html#cb2081-1" aria-hidden="true" tabindex="-1"></a>color <span class="ot">&lt;-</span> <span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">&quot;C&quot;</span>)(<span class="dv">7</span>)[<span class="dv">7</span>]</span>
<span id="cb2081-2"><a href="missing-data-and-other-opportunities.html#cb2081-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2081-3"><a href="missing-data-and-other-opportunities.html#cb2081-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span></span>
<span id="cb2081-4"><a href="missing-data-and-other-opportunities.html#cb2081-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(</span>
<span id="cb2081-5"><a href="missing-data-and-other-opportunities.html#cb2081-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># intercepts</span></span>
<span id="cb2081-6"><a href="missing-data-and-other-opportunities.html#cb2081-6" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">%&gt;%</span> </span>
<span id="cb2081-7"><a href="missing-data-and-other-opportunities.html#cb2081-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="st">`</span><span class="at">r_loc[1,Intercept]</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">r_loc[59,Intercept]</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2081-8"><a href="missing-data-and-other-opportunities.html#cb2081-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_names</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">59</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2081-9"><a href="missing-data-and-other-opportunities.html#cb2081-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">iter =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb2081-10"><a href="missing-data-and-other-opportunities.html#cb2081-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="sc">-</span>iter, <span class="at">values_to =</span> <span class="st">&quot;intercepts&quot;</span>),</span>
<span id="cb2081-11"><a href="missing-data-and-other-opportunities.html#cb2081-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># slopes</span></span>
<span id="cb2081-12"><a href="missing-data-and-other-opportunities.html#cb2081-12" aria-hidden="true" tabindex="-1"></a>  post <span class="sc">%&gt;%</span> </span>
<span id="cb2081-13"><a href="missing-data-and-other-opportunities.html#cb2081-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="st">`</span><span class="at">r_loc[1,factorSideEffect]</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">r_loc[59,factorSideEffect]</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2081-14"><a href="missing-data-and-other-opportunities.html#cb2081-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_names</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">59</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2081-15"><a href="missing-data-and-other-opportunities.html#cb2081-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">iter =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb2081-16"><a href="missing-data-and-other-opportunities.html#cb2081-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="sc">-</span>iter, <span class="at">values_to =</span> <span class="st">&quot;slopes&quot;</span>),</span>
<span id="cb2081-17"><a href="missing-data-and-other-opportunities.html#cb2081-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;iter&quot;</span>, <span class="st">&quot;name&quot;</span>)</span>
<span id="cb2081-18"><a href="missing-data-and-other-opportunities.html#cb2081-18" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb2081-19"><a href="missing-data-and-other-opportunities.html#cb2081-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2081-20"><a href="missing-data-and-other-opportunities.html#cb2081-20" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize by the means</span></span>
<span id="cb2081-21"><a href="missing-data-and-other-opportunities.html#cb2081-21" aria-hidden="true" tabindex="-1"></a>c <span class="sc">%&gt;%</span> </span>
<span id="cb2081-22"><a href="missing-data-and-other-opportunities.html#cb2081-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb2081-23"><a href="missing-data-and-other-opportunities.html#cb2081-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">intercepts =</span> <span class="fu">mean</span>(intercepts),</span>
<span id="cb2081-24"><a href="missing-data-and-other-opportunities.html#cb2081-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">slopes =</span> <span class="fu">mean</span>(slopes)) <span class="sc">%&gt;%</span> </span>
<span id="cb2081-25"><a href="missing-data-and-other-opportunities.html#cb2081-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2081-26"><a href="missing-data-and-other-opportunities.html#cb2081-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot!</span></span>
<span id="cb2081-27"><a href="missing-data-and-other-opportunities.html#cb2081-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> intercepts, <span class="at">y =</span> slopes)) <span class="sc">+</span></span>
<span id="cb2081-28"><a href="missing-data-and-other-opportunities.html#cb2081-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> color) <span class="sc">+</span></span>
<span id="cb2081-29"><a href="missing-data-and-other-opportunities.html#cb2081-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(alpha[<span class="fu">italic</span>(j)]),</span>
<span id="cb2081-30"><a href="missing-data-and-other-opportunities.html#cb2081-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(beta[<span class="fu">italic</span>(j)]))</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-97-1.png" width="312" style="display: block; margin: auto;" /></p>
<p>This provides some information, which we wouldn’t get from a meta-analysis. However, the plot is a little deceiving. First, it doesn’t provide an expression of the uncertainty on the effects. Second, it doesn’t give full justice to the correlation between the two effects, <span class="math inline">\(\rho_{\alpha \beta}\)</span>. If you look back up at the <code>print()</code> output from <a href="missing-data-and-other-opportunities.html#fit-the-bayesian-muiltilevel-alternative.">Section 15.5.7</a>, you’ll see that correlation was about -0.31. We can take some cues from <a href="adventures-in-covariance.html#social-relations-as-correlated-varying-effects">Section 14.4</a> and express the bivariate posteriors as ellipses, rather than simple mean-level points.</p>
<div class="sourceCode" id="cb2082"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2082-1"><a href="missing-data-and-other-opportunities.html#cb2082-1" aria-hidden="true" tabindex="-1"></a>c <span class="sc">%&gt;%</span> </span>
<span id="cb2082-2"><a href="missing-data-and-other-opportunities.html#cb2082-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> intercepts, <span class="at">y =</span> slopes)) <span class="sc">+</span></span>
<span id="cb2082-3"><a href="missing-data-and-other-opportunities.html#cb2082-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="fu">aes</span>(<span class="at">group =</span> name),</span>
<span id="cb2082-4"><a href="missing-data-and-other-opportunities.html#cb2082-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;polygon&quot;</span>, <span class="at">level =</span> .<span class="dv">05</span>, <span class="at">size =</span> <span class="dv">0</span>, </span>
<span id="cb2082-5"><a href="missing-data-and-other-opportunities.html#cb2082-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> color, <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb2082-6"><a href="missing-data-and-other-opportunities.html#cb2082-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="at">level =</span> .<span class="dv">95</span>, <span class="at">color =</span> color) <span class="sc">+</span></span>
<span id="cb2082-7"><a href="missing-data-and-other-opportunities.html#cb2082-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(alpha[<span class="fu">italic</span>(j)]),</span>
<span id="cb2082-8"><a href="missing-data-and-other-opportunities.html#cb2082-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(beta[<span class="fu">italic</span>(j)]))</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-98-1.png" width="312" style="display: block; margin: auto;" /></p>
<p>The small semitransparent ellipses depict the inner-most 5% of each of the <span class="math inline">\(j\)</span>-level bivariate posteriors. The larger ellipse is the 95% boundary, collapsing across all levels of <span class="math inline">\(j\)</span>. Both kinds of summaries help depict the negative correlation between the <span class="math inline">\(\alpha_j\)</span>’s and <span class="math inline">\(\beta_j\)</span>’s. That negative correlation means suggests the studies which had larger effect sizes for the control condition tended to have smaller effect sizes for the experimental condition. There’s no way you would know that from the meta-analysis approach.</p>
<p>Another way to explore the relation between the model intercepts and slopes is to plot their implications on the probability scale. The way we parameterized the model, the greater-good condition is expressed the <span class="math inline">\(\alpha_j\)</span> and the side-effect condition is expressed as <span class="math inline">\(\alpha_j + \beta_j\)</span>. If we were working directly with the <code>as_draws_df()</code> output, we’d have to do fancy conversions with the <code>inv_logit_scaled()</code> function. An easier way is to just use <code>fitted()</code>.</p>
<div class="sourceCode" id="cb2083"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2083-1"><a href="missing-data-and-other-opportunities.html#cb2083-1" aria-hidden="true" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">inv_logit_scaled</span>(<span class="fu">c</span>(<span class="fu">fixef</span>(b15<span class="fl">.11</span>)[<span class="dv">1</span>, <span class="dv">1</span>], <span class="fu">fixef</span>(b15<span class="fl">.11</span>)[<span class="dv">1</span>, <span class="dv">1</span>] <span class="sc">+</span> <span class="fu">fixef</span>(b15<span class="fl">.11</span>)[<span class="dv">2</span>, <span class="dv">1</span>])), <span class="dv">1</span>)</span>
<span id="cb2083-2"><a href="missing-data-and-other-opportunities.html#cb2083-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2083-3"><a href="missing-data-and-other-opportunities.html#cb2083-3" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(loc, factor)</span>
<span id="cb2083-4"><a href="missing-data-and-other-opportunities.html#cb2083-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2083-5"><a href="missing-data-and-other-opportunities.html#cb2083-5" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(b15<span class="fl">.11</span>,</span>
<span id="cb2083-6"><a href="missing-data-and-other-opportunities.html#cb2083-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">newdata =</span> nd) <span class="sc">%&gt;%</span> </span>
<span id="cb2083-7"><a href="missing-data-and-other-opportunities.html#cb2083-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2083-8"><a href="missing-data-and-other-opportunities.html#cb2083-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(nd) <span class="sc">%&gt;%</span> </span>
<span id="cb2083-9"><a href="missing-data-and-other-opportunities.html#cb2083-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">factor =</span> <span class="fu">if_else</span>(factor <span class="sc">==</span> <span class="st">&quot;SideEffect&quot;</span>, <span class="st">&quot;Side effect&quot;</span>, <span class="st">&quot;Greater good&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2083-10"><a href="missing-data-and-other-opportunities.html#cb2083-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2083-11"><a href="missing-data-and-other-opportunities.html#cb2083-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> factor, <span class="at">y =</span> Estimate, <span class="at">group =</span> loc)) <span class="sc">+</span></span>
<span id="cb2083-12"><a href="missing-data-and-other-opportunities.html#cb2083-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">color =</span> color) <span class="sc">+</span></span>
<span id="cb2083-13"><a href="missing-data-and-other-opportunities.html#cb2083-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;probability&quot;</span>, <span class="at">limits =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>,</span>
<span id="cb2083-14"><a href="missing-data-and-other-opportunities.html#cb2083-14" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> breaks, <span class="at">labels =</span> <span class="fu">round</span>(breaks, <span class="at">digits =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb2083-15"><a href="missing-data-and-other-opportunities.html#cb2083-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb2083-16"><a href="missing-data-and-other-opportunities.html#cb2083-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="dv">0</span>),</span>
<span id="cb2083-17"><a href="missing-data-and-other-opportunities.html#cb2083-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="15_files/figure-html/unnamed-chunk-99-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>Each of the 59 levels of our grouping variable <code>loc</code> is depicted in one of those 59 lines. Sadly, this approach doesn’t do a good job expressing the uncertainty in those lines. Each one is based on the posterior mean. Regardless, this plot offers more insights that were not available from the meta-analysis.</p>
</div>
<div id="parting-thoughts." class="section level3 hasAnchor" number="15.5.9">
<h3><span class="header-section-number">15.5.9</span> Parting thoughts.<a href="missing-data-and-other-opportunities.html#parting-thoughts." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are other things you might do with these data. For example, you might inspect how much the effect size varies between those from WEIRD and non-WEIRD countries. You might also model the data as clustered by <code>Language</code> rather than by <code>Location</code>. But I think we’ve gone far enough to get you started.</p>
<p>If you’d like to learn more about these methods, do check out Vourre’s <a href="https://mvuorre.github.io/posts/2016-09-29-bayesian-meta-analysis/"><em>Bayesian meta-analysis with R, Stan, and brms</em></a>. You might also read Williams, Rast, and Bürkner’s <span class="citation">(<a href="#ref-williamsBayesianMetaanalysisWeakly2018" role="doc-biblioref">2018</a>)</span> manuscript, <a href="https://psyarxiv.com/7tbrm/"><em>Bayesian meta-analysis with weakly informative prior distributions</em></a>. For an alternative workflow, consider the <a href="https://github.com/wwiecek/baggr"><strong>baggr</strong> package</a> <span class="citation">(<a href="#ref-R-baggr" role="doc-biblioref">Wiecek &amp; Meager, 2022</a>)</span>, which is designed to fit hierarchical Bayesian meta-analyses with Stan under the hood. Also, I’m not aware that <strong>brms</strong> currently offers a convenient way to fit a meta-analysis model that takes selection bias into account. However, the thread in the Stan forums called <a href="https://discourse.mc-stan.org/t/bayesian-random-effects-meta-analysis-with-selection-models-publication-bias/21419"><em>Bayesian random-effects meta-analysis with selection models (publication bias)</em></a> provides the Stan code for such a model.</p>
</div>
</div>
<div id="session-info-14" class="section level2 unnumbered hasAnchor">
<h2>Session info<a href="missing-data-and-other-opportunities.html#session-info-14" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb2084"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2084-1"><a href="missing-data-and-other-opportunities.html#cb2084-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.2.0 (2022-04-22)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Big Sur/Monterey 10.16
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] broom_1.0.1       tidybayes_3.0.2   ggrepel_0.9.1     brms_2.18.0       Rcpp_1.0.9       
##  [6] ggdag_0.2.6       patchwork_1.1.2   viridis_0.6.2     viridisLite_0.4.1 ggdark_0.2.1     
## [11] forcats_0.5.1     stringr_1.4.1     dplyr_1.0.10      purrr_0.3.4       readr_2.1.2      
## [16] tidyr_1.2.1       tibble_3.1.8      ggplot2_3.3.6     tidyverse_1.3.2  
## 
## loaded via a namespace (and not attached):
##   [1] readxl_1.4.1         backports_1.4.1      plyr_1.8.7           igraph_1.3.4         svUnit_1.0.6        
##   [6] splines_4.2.0        crosstalk_1.2.0      TH.data_1.1-1        rstantools_2.2.0     inline_0.3.19       
##  [11] digest_0.6.29        htmltools_0.5.3      fansi_1.0.3          magrittr_2.0.3       checkmate_2.1.0     
##  [16] googlesheets4_1.0.1  tzdb_0.3.0           graphlayouts_0.8.1   modelr_0.1.8         RcppParallel_5.1.5  
##  [21] matrixStats_0.62.0   vroom_1.5.7          sandwich_3.0-2       xts_0.12.1           prettyunits_1.1.1   
##  [26] colorspace_2.0-3     rvest_1.0.2          ggdist_3.2.0         haven_2.5.1          xfun_0.33           
##  [31] callr_3.7.1          crayon_1.5.1         jsonlite_1.8.0       lme4_1.1-30          survival_3.4-0      
##  [36] zoo_1.8-10           glue_1.6.2           polyclip_1.10-0      gtable_0.3.1         gargle_1.2.0        
##  [41] emmeans_1.8.0        V8_4.2.1             distributional_0.3.1 pkgbuild_1.3.1       rstan_2.21.7        
##  [46] abind_1.4-5          scales_1.2.1         mvtnorm_1.1-3        emo_0.0.0.9000       DBI_1.1.3           
##  [51] miniUI_0.1.1.1       xtable_1.8-4         bit_4.0.4            StanHeaders_2.21.0-7 stats4_4.2.0        
##  [56] DT_0.24              htmlwidgets_1.5.4    httr_1.4.4           threejs_0.3.3        arrayhelpers_1.1-0  
##  [61] posterior_1.3.1      ellipsis_0.3.2       pkgconfig_2.0.3      loo_2.5.1            farver_2.1.1        
##  [66] sass_0.4.2           dbplyr_2.2.1         utf8_1.2.2           tidyselect_1.1.2     labeling_0.4.2      
##  [71] rlang_1.0.6          reshape2_1.4.4       later_1.3.0          munsell_0.5.0        dagitty_0.3-1       
##  [76] cellranger_1.1.0     tools_4.2.0          cachem_1.0.6         cli_3.4.0            generics_0.1.3      
##  [81] ggridges_0.5.3       evaluate_0.16        fastmap_1.1.0        bit64_4.0.5          processx_3.7.0      
##  [86] knitr_1.40           fs_1.5.2             tidygraph_1.2.1      ggraph_2.0.6         nlme_3.1-159        
##  [91] projpred_2.2.1       mime_0.12            xml2_1.3.3           compiler_4.2.0       bayesplot_1.9.0     
##  [96] shinythemes_1.2.0    rstudioapi_0.13      gamm4_0.2-6          curl_4.3.2           reprex_2.0.2        
## [101] tweenr_2.0.0         bslib_0.4.0          stringi_1.7.8        ps_1.7.1             highr_0.9           
## [106] Brobdingnag_1.2-8    lattice_0.20-45      Matrix_1.4-1         nloptr_2.0.3         markdown_1.1        
## [111] shinyjs_2.1.0        tensorA_0.36.2       vctrs_0.4.1          pillar_1.8.1         lifecycle_1.0.2     
## [116] jquerylib_0.1.4      bridgesampling_1.1-2 estimability_1.4.1   httpuv_1.6.5         R6_2.5.1            
## [121] bookdown_0.28        promises_1.2.0.1     gridExtra_2.3        codetools_0.2-18     boot_1.3-28         
## [126] colourpicker_1.1.1   MASS_7.3-58.1        gtools_3.9.3         assertthat_0.2.1     withr_2.5.0         
## [131] shinystan_2.6.0      multcomp_1.4-20      mgcv_1.8-40          parallel_4.2.0       hms_1.1.1           
## [136] grid_4.2.0           minqa_1.2.4          coda_0.19-4          rmarkdown_2.16       googledrive_2.0.0   
## [141] ggforce_0.3.4        shiny_1.7.2          lubridate_1.8.0      base64enc_0.1-3      dygraphs_1.1.1.6</code></pre>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-baraldiIntroductionToModernMissingData2010" class="csl-entry">
Baraldi, A. N., &amp; Enders, C. K. (2010). An introduction to modern missing data analyses. <em>Journal of School Psychology</em>, <em>48</em>(1), 5–37. <a href="https://doi.org/10.1016/j.jsp.2009.10.001">https://doi.org/10.1016/j.jsp.2009.10.001</a>
</div>
<div id="ref-beheim2021TreatmentOfMissingData" class="csl-entry">
Beheim, B., Atkinson, Q. D., Bulbulia, J., Gervais, W., Gray, R. D., Henrich, J., Lang, M., Monroe, M. W., Muthukrishna, M., Norenzayan, A., et al. (2021). Treatment of missing data determined conclusions regarding moralizing gods. <em>Nature</em>, <em>595</em>(7866), E29–E34. <a href="https://doi.org/10.1038/s41586-019-1043-4">https://doi.org/10.1038/s41586-019-1043-4</a>
</div>
<div id="ref-Bürkner2022Multivariate" class="csl-entry">
Bürkner, P.-C. (2022c). <em>Estimating multivariate models with brms</em>. <a href="https://CRAN.R-project.org/package=brms/vignettes/brms_multivariate.html">https://CRAN.R-project.org/package=brms/vignettes/brms_multivariate.html</a>
</div>
<div id="ref-Bürkner2022HandleMissingValues" class="csl-entry">
Bürkner, P.-C. (2022). <em>Handle missing values with brms</em>. <a href="https://CRAN.R-project.org/package=brms/vignettes/brms_missings.html">https://CRAN.R-project.org/package=brms/vignettes/brms_missings.html</a>
</div>
<div id="ref-enders2010applied" class="csl-entry">
Enders, C. K. (2010). <em>Applied missing data analysis</em>. <span>Guilford press</span>. <a href="http://www.appliedmissingdata.com/">http://www.appliedmissingdata.com/</a>
</div>
<div id="ref-R-viridis" class="csl-entry">
Garnier, S. (2021). <em><span class="nocase">viridis</span>: <span>Default</span> color maps from ’matplotlib’</em> [Manual]. <a href="https://CRAN.R-project.org/package=viridis">https://CRAN.R-project.org/package=viridis</a>
</div>
<div id="ref-gelman2013bayesian" class="csl-entry">
Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari, A., &amp; Rubin, D. B. (2013). <em>Bayesian data analysis</em> (Third Edition). <span>CRC press</span>. <a href="https://stat.columbia.edu/~gelman/book/">https://stat.columbia.edu/~gelman/book/</a>
</div>
<div id="ref-R-ggdark" class="csl-entry">
Grantham, N. (2019). <em><span class="nocase">ggdark</span>: <span>Dark</span> mode for ’ggplot2’ themes</em> [Manual]. <a href="https://CRAN.R-project.org/package=ggdark">https://CRAN.R-project.org/package=ggdark</a>
</div>
<div id="ref-hauserDissociationMoralJudgments2007" class="csl-entry">
Hauser, M., Cushman, F., Young, L., Jin, R. K.-X., &amp; Mikhail, J. (2007). A dissociation between moral judgments and justifications. <em>Mind &amp; Language</em>, <em>22</em>(1), 1–21. <a href="https://doi.org/10.1111/j.1468-0017.2006.00297.x">https://doi.org/10.1111/j.1468-0017.2006.00297.x</a>
</div>
<div id="ref-kleinManyLabsInvestigating2018" class="csl-entry">
Klein, R. A., Vianello, M., Hasselman, F., Adams, B. G., Adams, R. B., Alper, S., Aveyard, M., Axt, J. R., Babalola, M. T., Bahník, Š., Batra, R., Berkics, M., Bernstein, M. J., Berry, D. R., Bialobrzeska, O., Binan, E. D., Bocian, K., Brandt, M. J., Busching, R., … Nosek, B. A. (2018). Many <span>Labs</span> 2: <span>Investigating</span> variation in replicability across samples and settings. <em>Advances in Methods and Practices in Psychological Science</em>, <em>1</em>(4), 443–490. <a href="https://doi.org/10.1177/2515245918810225">https://doi.org/10.1177/2515245918810225</a>
</div>
<div id="ref-littleStatisticalAnalysisMissing2019" class="csl-entry">
Little, R. J. A., &amp; Rubin, D. B. (2019). <em>Statistical analysis with missing data</em>. <span>John Wiley &amp; Sons</span>. <a href="https://www.wiley.com/en-us/Statistical+Analysis+with+Missing+Data%2C+3rd+Edition-p-9780470526798">https://www.wiley.com/en-us/Statistical+Analysis+with+Missing+Data%2C+3rd+Edition-p-9780470526798</a>
</div>
<div id="ref-mcelreathStatisticalRethinkingBayesian2020" class="csl-entry">
McElreath, R. (2020). <em>Statistical rethinking: <span>A Bayesian</span> course with examples in <span>R</span> and <span>Stan</span></em> (Second Edition). <span>CRC Press</span>. <a href="https://xcelab.net/rm/statistical-rethinking/">https://xcelab.net/rm/statistical-rethinking/</a>
</div>
<div id="ref-rubinMultipleImputation181996" class="csl-entry">
Rubin, Donald B. (1996). Multiple imputation after 18+ years. <em>Journal of the American Statistical Association</em>, <em>91</em>(434), 473–489. <a href="https://doi.org/10.1080/01621459.1996.10476908">https://doi.org/10.1080/01621459.1996.10476908</a>
</div>
<div id="ref-rubinInferenceAndMissingData1976" class="csl-entry">
Rubin, Donald B. (1976). Inference and missing data. <em>Biometrika</em>, <em>63</em>(3), 581–592. <a href="https://doi.org/10.1093/biomet/63.3.581">https://doi.org/10.1093/biomet/63.3.581</a>
</div>
<div id="ref-rubinMultipleImputationNonresponse1987" class="csl-entry">
Rubin, Donald B. (1987). <em>Multiple imputation for nonresponse in surveys</em>. <span>John Wiley &amp; Sons Inc</span>. <a href="https://doi.org/10.1002/9780470316696">https://doi.org/10.1002/9780470316696</a>
</div>
<div id="ref-rudisViridisColorPalettes2018" class="csl-entry">
Rudis, B., Ross, N., &amp; Garnier, S. (2018). <em>The viridis color palettes</em>. <a href="https://cran.r-project.org/package=viridis/vignettes/intro-to-viridis.html">https://cran.r-project.org/package=viridis/vignettes/intro-to-viridis.html</a>
</div>
<div id="ref-vanbuurenFlexibleImputationMissing2018" class="csl-entry">
van Buuren, S. (2018). <em>Flexible imputation of missing data</em> (Second Edition). <span>CRC Press</span>. <a href="https://stefvanbuuren.name/fimd/">https://stefvanbuuren.name/fimd/</a>
</div>
<div id="ref-whitehouseComplexSocietiesPrecede2019" class="csl-entry">
Whitehouse, H., François, P., Savage, P. E., Currie, T. E., Feeney, K. C., Cioni, E., Purcell, R., Ross, R. M., Larson, J., Baines, J., ter Haar, B., Covey, A., &amp; Turchin, P. (2019). Complex societies precede moralizing gods throughout world history. <em>Nature</em>, <em>568</em>(7751, 7751), 226–229. <a href="https://doi.org/10.1038/s41586-019-1043-4">https://doi.org/10.1038/s41586-019-1043-4</a>
</div>
<div id="ref-R-baggr" class="csl-entry">
Wiecek, W., &amp; Meager, R. (2022). <em><span class="nocase">baggr</span>: <span>Bayesian</span> aggregate treatment effects</em> [Manual]. <a href="https://CRAN.R-project.org/package=baggr">https://CRAN.R-project.org/package=baggr</a>
</div>
<div id="ref-williamsBayesianMetaanalysisWeakly2018" class="csl-entry">
Williams, Donald R., Rast, P., &amp; Bürkner, P.-C. (2018). <em>Bayesian meta-analysis with weakly informative prior distributions</em>. <a href="https://doi.org/10.31234/osf.io/7tbrm">https://doi.org/10.31234/osf.io/7tbrm</a>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="8">
<li id="fn8"><p>As it turns out, the article connected to the <code>Moralizing_gods</code> data, <span class="citation">Whitehouse et al. (<a href="#ref-whitehouseComplexSocietiesPrecede2019" role="doc-biblioref">2019</a>)</span>, has been retracted. You can find the details at <a href="https://retractionwatch.com/2021/07/07/critique-topples-nature-paper-on-belief-in-gods/"><em>Critique topples Nature paper on belief in gods</em></a>, on Retraction Watch. It appears the retraction is, in part, a reaction to this <a href="https://psyarxiv.com/jwa2n/">preprint</a> which, interestingly enough, questions the authors’ missing data methods. The preprint has since been published as <span class="citation">Beheim et al. (<a href="#ref-beheim2021TreatmentOfMissingData" role="doc-biblioref">2021</a>)</span>.<a href="missing-data-and-other-opportunities.html#fnref8" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="adventures-in-covariance.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="generalized-linear-madness.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
