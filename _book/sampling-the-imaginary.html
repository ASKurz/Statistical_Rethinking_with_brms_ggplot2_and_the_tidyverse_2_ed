<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Sampling the Imaginary | Statistical rethinking with brms, ggplot2, and the tidyverse: Second edition</title>
  <meta name="description" content="This book is an attempt to re-express the code in the second edition of McElreath’s textbook, ‘Statistical rethinking.’ His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Sampling the Imaginary | Statistical rethinking with brms, ggplot2, and the tidyverse: Second edition" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This book is an attempt to re-express the code in the second edition of McElreath’s textbook, ‘Statistical rethinking.’ His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="github-repo" content="ASKurz/Statistical_Rethinking_with_brms_ggplot2_and_the_tidyverse_2_ed" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Sampling the Imaginary | Statistical rethinking with brms, ggplot2, and the tidyverse: Second edition" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This book is an attempt to re-express the code in the second edition of McElreath’s textbook, ‘Statistical rethinking.’ His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2022-09-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="small-worlds-and-large-worlds.html"/>
<link rel="next" href="geocentric-models.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/vembedr-0.1.5/css/vembedr.css" rel="stylesheet" />
<link href="libs/tabwid-1.1.0/tabwid.css" rel="stylesheet" />
<link href="libs/tabwid-1.1.0/scrool.css" rel="stylesheet" />
<script src="libs/twitter-widget-0.0.1/widgets.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#my-assumptions-about-you"><i class="fa fa-check"></i>My assumptions about you</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#how-to-use-and-understand-this-project"><i class="fa fa-check"></i>How to use and understand this project</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-setup"><i class="fa fa-check"></i><strong>R</strong> setup</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#we-have-updates"><i class="fa fa-check"></i>We have updates</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.1.0."><i class="fa fa-check"></i>Version 0.1.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.1.1."><i class="fa fa-check"></i>Version 0.1.1.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.2.0."><i class="fa fa-check"></i>Version 0.2.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#version-0.3.0."><i class="fa fa-check"></i>Version 0.3.0.</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#were-not-done-yet-and-i-could-use-your-help."><i class="fa fa-check"></i>We’re not done yet and I could use your help.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#thank-yous-are-in-order"><i class="fa fa-check"></i>Thank-you’s are in order</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license-and-citation"><i class="fa fa-check"></i>License and citation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#you-can-do-this-too"><i class="fa fa-check"></i>You can do this, too</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="the-golem-of-prague.html"><a href="the-golem-of-prague.html"><i class="fa fa-check"></i><b>1</b> The Golem of Prague</a>
<ul>
<li class="chapter" data-level="" data-path="the-golem-of-prague.html"><a href="the-golem-of-prague.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html"><i class="fa fa-check"></i><b>2</b> Small Worlds and Large Worlds</a>
<ul>
<li class="chapter" data-level="2.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#the-garden-of-forking-data"><i class="fa fa-check"></i><b>2.1</b> The garden of forking data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#counting-possibilities."><i class="fa fa-check"></i><b>2.1.1</b> Counting possibilities.</a></li>
<li class="chapter" data-level="2.1.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#combining-other-information."><i class="fa fa-check"></i><b>2.1.2</b> Combining other information.</a></li>
<li class="chapter" data-level="2.1.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#from-counts-to-probability."><i class="fa fa-check"></i><b>2.1.3</b> From counts to probability.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#building-a-model"><i class="fa fa-check"></i><b>2.2</b> Building a model</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#a-data-story."><i class="fa fa-check"></i><b>2.2.1</b> A data story.</a></li>
<li class="chapter" data-level="2.2.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#bayesian-updating."><i class="fa fa-check"></i><b>2.2.2</b> Bayesian updating.</a></li>
<li class="chapter" data-level="2.2.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#evaluate."><i class="fa fa-check"></i><b>2.2.3</b> Evaluate.</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#components-of-the-model"><i class="fa fa-check"></i><b>2.3</b> Components of the model</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#variables."><i class="fa fa-check"></i><b>2.3.1</b> Variables.</a></li>
<li class="chapter" data-level="2.3.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#definitions."><i class="fa fa-check"></i><b>2.3.2</b> Definitions.</a></li>
<li class="chapter" data-level="2.3.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#a-model-is-born."><i class="fa fa-check"></i><b>2.3.3</b> A model is born.</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#making-the-model-go"><i class="fa fa-check"></i><b>2.4</b> Making the model go</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#bayes-theorem."><i class="fa fa-check"></i><b>2.4.1</b> Bayes’ theorem.</a></li>
<li class="chapter" data-level="2.4.2" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#motors."><i class="fa fa-check"></i><b>2.4.2</b> Motors.</a></li>
<li class="chapter" data-level="2.4.3" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#grid-approximation."><i class="fa fa-check"></i><b>2.4.3</b> Grid approximation.</a></li>
<li class="chapter" data-level="2.4.4" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#quadratic-approximation."><i class="fa fa-check"></i><b>2.4.4</b> Quadratic approximation.</a></li>
<li class="chapter" data-level="2.4.5" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#markov-chain-monte-carlo."><i class="fa fa-check"></i><b>2.4.5</b> Markov chain Monte Carlo.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="small-worlds-and-large-worlds.html"><a href="small-worlds-and-large-worlds.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html"><i class="fa fa-check"></i><b>3</b> Sampling the Imaginary</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-from-a-grid-approximate-posterior"><i class="fa fa-check"></i><b>3.1</b> Sampling from a grid-approximate posterior</a></li>
<li class="chapter" data-level="3.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-to-summarize"><i class="fa fa-check"></i><b>3.2</b> Sampling to summarize</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#intervals-of-defined-boundaries."><i class="fa fa-check"></i><b>3.2.1</b> Intervals of defined boundaries.</a></li>
<li class="chapter" data-level="3.2.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#intervals-of-defined-mass."><i class="fa fa-check"></i><b>3.2.2</b> Intervals of defined mass.</a></li>
<li class="chapter" data-level="3.2.3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#point-estimates."><i class="fa fa-check"></i><b>3.2.3</b> Point estimates.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#sampling-to-simulate-prediction"><i class="fa fa-check"></i><b>3.3</b> Sampling to simulate prediction</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#dummy-data."><i class="fa fa-check"></i><b>3.3.1</b> Dummy data.</a></li>
<li class="chapter" data-level="3.3.2" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#model-checking."><i class="fa fa-check"></i><b>3.3.2</b> Model checking.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#summary-lets-practice-with-brms"><i class="fa fa-check"></i><b>3.4</b> <del>Summary</del> Let’s practice with <strong>brms</strong></a></li>
<li class="chapter" data-level="" data-path="sampling-the-imaginary.html"><a href="sampling-the-imaginary.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="geocentric-models.html"><a href="geocentric-models.html"><i class="fa fa-check"></i><b>4</b> Geocentric Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="geocentric-models.html"><a href="geocentric-models.html#why-normal-distributions-are-normal"><i class="fa fa-check"></i><b>4.1</b> Why normal distributions are normal</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="geocentric-models.html"><a href="geocentric-models.html#normal-by-addition."><i class="fa fa-check"></i><b>4.1.1</b> Normal by addition.</a></li>
<li class="chapter" data-level="4.1.2" data-path="geocentric-models.html"><a href="geocentric-models.html#normal-by-multiplication."><i class="fa fa-check"></i><b>4.1.2</b> Normal by multiplication.</a></li>
<li class="chapter" data-level="4.1.3" data-path="geocentric-models.html"><a href="geocentric-models.html#normal-by-log-multiplication."><i class="fa fa-check"></i><b>4.1.3</b> Normal by log-multiplication.</a></li>
<li class="chapter" data-level="4.1.4" data-path="geocentric-models.html"><a href="geocentric-models.html#using-gaussian-distributions."><i class="fa fa-check"></i><b>4.1.4</b> Using Gaussian distributions.</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="geocentric-models.html"><a href="geocentric-models.html#a-language-for-describing-models"><i class="fa fa-check"></i><b>4.2</b> A language for describing models</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="geocentric-models.html"><a href="geocentric-models.html#re-describing-the-globe-tossing-model."><i class="fa fa-check"></i><b>4.2.1</b> Re-describing the globe tossing model.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="geocentric-models.html"><a href="geocentric-models.html#a-gaussian-model-of-height"><i class="fa fa-check"></i><b>4.3</b> A Gaussian model of height</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="geocentric-models.html"><a href="geocentric-models.html#the-data."><i class="fa fa-check"></i><b>4.3.1</b> The data.</a></li>
<li class="chapter" data-level="4.3.2" data-path="geocentric-models.html"><a href="geocentric-models.html#the-model."><i class="fa fa-check"></i><b>4.3.2</b> The model.</a></li>
<li class="chapter" data-level="4.3.3" data-path="geocentric-models.html"><a href="geocentric-models.html#grid-approximation-of-the-posterior-distribution."><i class="fa fa-check"></i><b>4.3.3</b> Grid approximation of the posterior distribution.</a></li>
<li class="chapter" data-level="4.3.4" data-path="geocentric-models.html"><a href="geocentric-models.html#sampling-from-the-posterior."><i class="fa fa-check"></i><b>4.3.4</b> Sampling from the posterior.</a></li>
<li class="chapter" data-level="4.3.5" data-path="geocentric-models.html"><a href="geocentric-models.html#finding-the-posterior-distribution-with-quap-brm."><i class="fa fa-check"></i><b>4.3.5</b> Finding the posterior distribution with <del><code>quap</code></del> <code>brm()</code>.</a></li>
<li class="chapter" data-level="4.3.6" data-path="geocentric-models.html"><a href="geocentric-models.html#sampling-from-a-quap-brm-fit."><i class="fa fa-check"></i><b>4.3.6</b> Sampling from a <del><code>quap()</code></del> <code>brm()</code> fit.</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="geocentric-models.html"><a href="geocentric-models.html#linear-prediction"><i class="fa fa-check"></i><b>4.4</b> Linear prediction</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="geocentric-models.html"><a href="geocentric-models.html#the-linear-model-strategy."><i class="fa fa-check"></i><b>4.4.1</b> The linear model strategy.</a></li>
<li class="chapter" data-level="4.4.2" data-path="geocentric-models.html"><a href="geocentric-models.html#finding-the-posterior-distribution."><i class="fa fa-check"></i><b>4.4.2</b> Finding the posterior distribution.</a></li>
<li class="chapter" data-level="4.4.3" data-path="geocentric-models.html"><a href="geocentric-models.html#interpreting-the-posterior-distribution."><i class="fa fa-check"></i><b>4.4.3</b> Interpreting the posterior distribution.</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="geocentric-models.html"><a href="geocentric-models.html#curves-from-lines"><i class="fa fa-check"></i><b>4.5</b> Curves from lines</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="geocentric-models.html"><a href="geocentric-models.html#polynomial-regression."><i class="fa fa-check"></i><b>4.5.1</b> Polynomial regression.</a></li>
<li class="chapter" data-level="4.5.2" data-path="geocentric-models.html"><a href="geocentric-models.html#splines."><i class="fa fa-check"></i><b>4.5.2</b> Splines.</a></li>
<li class="chapter" data-level="4.5.3" data-path="geocentric-models.html"><a href="geocentric-models.html#smooth-functions-for-a-rough-world."><i class="fa fa-check"></i><b>4.5.3</b> Smooth functions for a rough world.</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="geocentric-models.html"><a href="geocentric-models.html#summary-first-bonus-smooth-functions-with-brmss"><i class="fa fa-check"></i><b>4.6</b> <del>Summary</del> First bonus: Smooth functions with <code>brms::s()</code></a></li>
<li class="chapter" data-level="4.7" data-path="geocentric-models.html"><a href="geocentric-models.html#second-bonus-group-predictors-with-matrix-columns"><i class="fa fa-check"></i><b>4.7</b> Second bonus: Group predictors with matrix columns</a></li>
<li class="chapter" data-level="" data-path="geocentric-models.html"><a href="geocentric-models.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html"><i class="fa fa-check"></i><b>5</b> The Many Variables &amp; The Spurious Waffles</a>
<ul>
<li class="chapter" data-level="5.1" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#spurious-associations"><i class="fa fa-check"></i><b>5.1</b> Spurious associations</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#think-before-you-regress."><i class="fa fa-check"></i><b>5.1.1</b> Think before you regress.</a></li>
<li class="chapter" data-level="5.1.2" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#testable-implications."><i class="fa fa-check"></i><b>5.1.2</b> Testable implications.</a></li>
<li class="chapter" data-level="5.1.3" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#multiple-regression-notation."><i class="fa fa-check"></i><b>5.1.3</b> Multiple regression notation.</a></li>
<li class="chapter" data-level="5.1.4" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#approximating-the-posterior."><i class="fa fa-check"></i><b>5.1.4</b> Approximating the posterior.</a></li>
<li class="chapter" data-level="5.1.5" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#plotting-multivariate-posteriors."><i class="fa fa-check"></i><b>5.1.5</b> Plotting multivariate posteriors.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#masked-relationship"><i class="fa fa-check"></i><b>5.2</b> Masked relationship</a></li>
<li class="chapter" data-level="5.3" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#categorical-variables"><i class="fa fa-check"></i><b>5.3</b> Categorical variables</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#binary-categories."><i class="fa fa-check"></i><b>5.3.1</b> Binary categories.</a></li>
<li class="chapter" data-level="5.3.2" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#many-categories."><i class="fa fa-check"></i><b>5.3.2</b> Many categories.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#summary-bonus-we-can-model-categorical-variables-in-more-ways-than-one"><i class="fa fa-check"></i><b>5.4</b> <del>Summary</del> Bonus: We can model categorical variables in more ways than one</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#you-can-use-a-dummy."><i class="fa fa-check"></i><b>5.4.1</b> You can use a dummy.</a></li>
<li class="chapter" data-level="5.4.2" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#consider-contrast-coding."><i class="fa fa-check"></i><b>5.4.2</b> Consider contrast coding.</a></li>
<li class="chapter" data-level="5.4.3" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#theres-always-the-multilevel-anova-approach."><i class="fa fa-check"></i><b>5.4.3</b> There’s always the multilevel ANOVA approach.</a></li>
<li class="chapter" data-level="5.4.4" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#would-you-like-to-learn-more"><i class="fa fa-check"></i><b>5.4.4</b> Would you like to learn more?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="the-many-variables-the-spurious-waffles.html"><a href="the-many-variables-the-spurious-waffles.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html"><i class="fa fa-check"></i><b>6</b> The Haunted DAG &amp; The Causal Terror</a>
<ul>
<li class="chapter" data-level="6.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#multicollinearity"><i class="fa fa-check"></i><b>6.1</b> Multicollinearity</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#multicollinear-legs."><i class="fa fa-check"></i><b>6.1.1</b> Multicollinear legs.</a></li>
<li class="chapter" data-level="6.1.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#multicollinear-milk."><i class="fa fa-check"></i><b>6.1.2</b> Multicollinear <code>milk</code>.</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#post-treatment-bias"><i class="fa fa-check"></i><b>6.2</b> Post-treatment bias</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#a-prior-is-born."><i class="fa fa-check"></i><b>6.2.1</b> A prior is born.</a></li>
<li class="chapter" data-level="6.2.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#blocked-by-consequence."><i class="fa fa-check"></i><b>6.2.2</b> Blocked by consequence.</a></li>
<li class="chapter" data-level="6.2.3" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#fungus-and-d-separation."><i class="fa fa-check"></i><b>6.2.3</b> Fungus and <span class="math inline">\(d\)</span>-separation.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#collider-bias"><i class="fa fa-check"></i><b>6.3</b> Collider bias</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#collider-of-false-sorrow."><i class="fa fa-check"></i><b>6.3.1</b> Collider of false sorrow.</a></li>
<li class="chapter" data-level="6.3.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#the-haunted-dag."><i class="fa fa-check"></i><b>6.3.2</b> The haunted DAG.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#confronting-confounding"><i class="fa fa-check"></i><b>6.4</b> Confronting confounding</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#shutting-the-backdoor."><i class="fa fa-check"></i><b>6.4.1</b> Shutting the backdoor.</a></li>
<li class="chapter" data-level="6.4.2" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#two-roads."><i class="fa fa-check"></i><b>6.4.2</b> Two roads.</a></li>
<li class="chapter" data-level="6.4.3" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#backdoor-waffles."><i class="fa fa-check"></i><b>6.4.3</b> Backdoor waffles.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#summary-and-a-little-more-practice"><i class="fa fa-check"></i><b>6.5</b> Summary [and a little more practice]</a></li>
<li class="chapter" data-level="" data-path="the-haunted-dag-the-causal-terror.html"><a href="the-haunted-dag-the-causal-terror.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ulysses-compass.html"><a href="ulysses-compass.html"><i class="fa fa-check"></i><b>7</b> Ulysses’ Compass</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#the-problem-with-parameters"><i class="fa fa-check"></i><b>7.1</b> The problem with parameters</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#more-parameters-almost-always-improve-fit."><i class="fa fa-check"></i><b>7.1.1</b> More parameters (almost) always improve fit.</a></li>
<li class="chapter" data-level="7.1.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#too-few-parameters-hurts-too."><i class="fa fa-check"></i><b>7.1.2</b> Too few parameters hurts, too.</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#entropy-and-accuracy"><i class="fa fa-check"></i><b>7.2</b> Entropy and accuracy</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#firing-the-weatherperson."><i class="fa fa-check"></i><b>7.2.1</b> Firing the weatherperson.</a></li>
<li class="chapter" data-level="7.2.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#information-and-uncertainty."><i class="fa fa-check"></i><b>7.2.2</b> Information and uncertainty.</a></li>
<li class="chapter" data-level="7.2.3" data-path="ulysses-compass.html"><a href="ulysses-compass.html#from-entropy-to-accuracy."><i class="fa fa-check"></i><b>7.2.3</b> From entropy to accuracy.</a></li>
<li class="chapter" data-level="7.2.4" data-path="ulysses-compass.html"><a href="ulysses-compass.html#estimating-divergence."><i class="fa fa-check"></i><b>7.2.4</b> Estimating divergence.</a></li>
<li class="chapter" data-level="7.2.5" data-path="ulysses-compass.html"><a href="ulysses-compass.html#scoring-the-right-data."><i class="fa fa-check"></i><b>7.2.5</b> Scoring the right data.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ulysses-compass.html"><a href="ulysses-compass.html#golem-taming-regularization"><i class="fa fa-check"></i><b>7.3</b> Golem taming: regularization</a></li>
<li class="chapter" data-level="7.4" data-path="ulysses-compass.html"><a href="ulysses-compass.html#predicting-predictive-accuracy"><i class="fa fa-check"></i><b>7.4</b> Predicting predictive accuracy</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#cross-validation."><i class="fa fa-check"></i><b>7.4.1</b> Cross-validation.</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="ulysses-compass.html"><a href="ulysses-compass.html#information-criteria"><i class="fa fa-check"></i><b>7.5</b> Information criteria</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#comparing-cv-psis-and-waic."><i class="fa fa-check"></i><b>7.5.1</b> Comparing CV, PSIS, and WAIC.</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="ulysses-compass.html"><a href="ulysses-compass.html#model-comparison"><i class="fa fa-check"></i><b>7.6</b> Model comparison</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="ulysses-compass.html"><a href="ulysses-compass.html#model-mis-selection."><i class="fa fa-check"></i><b>7.6.1</b> Model mis-selection.</a></li>
<li class="chapter" data-level="7.6.2" data-path="ulysses-compass.html"><a href="ulysses-compass.html#outliers-and-other-illusions."><i class="fa fa-check"></i><b>7.6.2</b> Outliers and other illusions.</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="ulysses-compass.html"><a href="ulysses-compass.html#summary-bonus-r2-talk"><i class="fa fa-check"></i><b>7.7</b> <del>Summary</del> Bonus: <span class="math inline">\(R^2\)</span> talk</a></li>
<li class="chapter" data-level="" data-path="ulysses-compass.html"><a href="ulysses-compass.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="conditional-manatees.html"><a href="conditional-manatees.html"><i class="fa fa-check"></i><b>8</b> Conditional Manatees</a>
<ul>
<li class="chapter" data-level="8.1" data-path="conditional-manatees.html"><a href="conditional-manatees.html#building-an-interaction"><i class="fa fa-check"></i><b>8.1</b> Building an interaction</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="conditional-manatees.html"><a href="conditional-manatees.html#making-a-rugged-model."><i class="fa fa-check"></i><b>8.1.1</b> Making a rugged model.</a></li>
<li class="chapter" data-level="8.1.2" data-path="conditional-manatees.html"><a href="conditional-manatees.html#adding-an-indicator-variable-isnt-enough."><i class="fa fa-check"></i><b>8.1.2</b> Adding an indicator variable isn’t enough.</a></li>
<li class="chapter" data-level="8.1.3" data-path="conditional-manatees.html"><a href="conditional-manatees.html#adding-an-interaction-does-work."><i class="fa fa-check"></i><b>8.1.3</b> Adding an interaction does work.</a></li>
<li class="chapter" data-level="8.1.4" data-path="conditional-manatees.html"><a href="conditional-manatees.html#plotting-the-interaction."><i class="fa fa-check"></i><b>8.1.4</b> Plotting the interaction.</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="conditional-manatees.html"><a href="conditional-manatees.html#symmetry-of-interactions"><i class="fa fa-check"></i><b>8.2</b> Symmetry of interactions</a></li>
<li class="chapter" data-level="8.3" data-path="conditional-manatees.html"><a href="conditional-manatees.html#continuous-interactions"><i class="fa fa-check"></i><b>8.3</b> Continuous interactions</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="conditional-manatees.html"><a href="conditional-manatees.html#a-winter-flower."><i class="fa fa-check"></i><b>8.3.1</b> A winter flower.</a></li>
<li class="chapter" data-level="8.3.2" data-path="conditional-manatees.html"><a href="conditional-manatees.html#the-models."><i class="fa fa-check"></i><b>8.3.2</b> The models.</a></li>
<li class="chapter" data-level="8.3.3" data-path="conditional-manatees.html"><a href="conditional-manatees.html#plotting-posterior-predictions."><i class="fa fa-check"></i><b>8.3.3</b> Plotting posterior predictions.</a></li>
<li class="chapter" data-level="8.3.4" data-path="conditional-manatees.html"><a href="conditional-manatees.html#plotting-prior-predictions."><i class="fa fa-check"></i><b>8.3.4</b> Plotting prior predictions.</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="conditional-manatees.html"><a href="conditional-manatees.html#summary-bonus-conditional_effects"><i class="fa fa-check"></i><b>8.4</b> <del>Summary</del> Bonus: <code>conditional_effects()</code></a></li>
<li class="chapter" data-level="" data-path="conditional-manatees.html"><a href="conditional-manatees.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>9</b> Markov Chain Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#good-king-markov-and-his-island-kingdom"><i class="fa fa-check"></i><b>9.1</b> Good King Markov and his island kingdom</a></li>
<li class="chapter" data-level="9.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#metropolis-algorithms"><i class="fa fa-check"></i><b>9.2</b> Metropolis algorithms</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#gibbs-sampling."><i class="fa fa-check"></i><b>9.2.1</b> Gibbs sampling.</a></li>
<li class="chapter" data-level="9.2.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#high-dimensional-problems."><i class="fa fa-check"></i><b>9.2.2</b> High-dimensional problems.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#hamiltonian-monte-carlo"><i class="fa fa-check"></i><b>9.3</b> Hamiltonian Monte Carlo</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#another-parable."><i class="fa fa-check"></i><b>9.3.1</b> Another parable.</a></li>
<li class="chapter" data-level="9.3.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#particles-in-space."><i class="fa fa-check"></i><b>9.3.2</b> Particles in space.</a></li>
<li class="chapter" data-level="9.3.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#limitations."><i class="fa fa-check"></i><b>9.3.3</b> Limitations.</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#easy-hmc-ulam-brm"><i class="fa fa-check"></i><b>9.4</b> Easy HMC: <del>ulam</del> <code>brm()</code></a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#preparation."><i class="fa fa-check"></i><b>9.4.1</b> Preparation.</a></li>
<li class="chapter" data-level="9.4.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#sampling-from-the-posterior.-1"><i class="fa fa-check"></i><b>9.4.2</b> Sampling from the posterior.</a></li>
<li class="chapter" data-level="9.4.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#sampling-again-in-parallel."><i class="fa fa-check"></i><b>9.4.3</b> Sampling again, in parallel.</a></li>
<li class="chapter" data-level="9.4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#visualization."><i class="fa fa-check"></i><b>9.4.4</b> Visualization.</a></li>
<li class="chapter" data-level="9.4.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#checking-the-chain."><i class="fa fa-check"></i><b>9.4.5</b> Checking the chain.</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#care-and-feeding-of-your-markov-chain"><i class="fa fa-check"></i><b>9.5</b> Care and feeding of your Markov chain</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#how-many-samples-do-you-need"><i class="fa fa-check"></i><b>9.5.1</b> How many samples do you need?</a></li>
<li class="chapter" data-level="9.5.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#how-many-chains-do-you-need"><i class="fa fa-check"></i><b>9.5.2</b> How many chains do you need?</a></li>
<li class="chapter" data-level="9.5.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#taming-a-wild-chain."><i class="fa fa-check"></i><b>9.5.3</b> Taming a wild chain.</a></li>
<li class="chapter" data-level="9.5.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#non-identifiable-parameters."><i class="fa fa-check"></i><b>9.5.4</b> Non-identifiable parameters.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>10</b> Big Entropy and the Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="10.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#maximum-entropy"><i class="fa fa-check"></i><b>10.1</b> Maximum entropy</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#gaussian."><i class="fa fa-check"></i><b>10.1.1</b> Gaussian.</a></li>
<li class="chapter" data-level="10.1.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#binomial."><i class="fa fa-check"></i><b>10.1.2</b> Binomial.</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#generalized-linear-models"><i class="fa fa-check"></i><b>10.2</b> Generalized linear models</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#meet-the-family."><i class="fa fa-check"></i><b>10.2.1</b> Meet the family.</a></li>
<li class="chapter" data-level="10.2.2" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#linking-linear-models-to-distributions."><i class="fa fa-check"></i><b>10.2.2</b> Linking linear models to distributions.</a></li>
<li class="chapter" data-level="10.2.3" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#omitted-variable-bias-again."><i class="fa fa-check"></i><b>10.2.3</b> Omitted variable bias again.</a></li>
<li class="chapter" data-level="10.2.4" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#absolute-and-relative-differences."><i class="fa fa-check"></i><b>10.2.4</b> Absolute and relative differences.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="big-entropy-and-the-generalized-linear-model.html"><a href="big-entropy-and-the-generalized-linear-model.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html"><i class="fa fa-check"></i><b>11</b> God Spiked the Integers</a>
<ul>
<li class="chapter" data-level="11.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#binomial-regression"><i class="fa fa-check"></i><b>11.1</b> Binomial regression</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#logistic-regression-prosocial-chimpanzees."><i class="fa fa-check"></i><b>11.1.1</b> Logistic regression: Prosocial chimpanzees.</a></li>
<li class="chapter" data-level="11.1.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#relative-shark-and-absolute-deer."><i class="fa fa-check"></i><b>11.1.2</b> Relative shark and absolute deer.</a></li>
<li class="chapter" data-level="11.1.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#aggregated-binomial-chimpanzees-again-condensed."><i class="fa fa-check"></i><b>11.1.3</b> Aggregated binomial: Chimpanzees again, condensed.</a></li>
<li class="chapter" data-level="11.1.4" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#aggregated-binomial-graduate-school-admissions."><i class="fa fa-check"></i><b>11.1.4</b> Aggregated binomial: Graduate school admissions.</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#poisson-regression"><i class="fa fa-check"></i><b>11.2</b> Poisson regression</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#example-oceanic-tool-complexity."><i class="fa fa-check"></i><b>11.2.1</b> Example: Oceanic tool complexity.</a></li>
<li class="chapter" data-level="11.2.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#negative-binomial-gamma-poisson-models."><i class="fa fa-check"></i><b>11.2.2</b> Negative binomial (gamma-Poisson) models.</a></li>
<li class="chapter" data-level="11.2.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#example-exposure-and-the-offset."><i class="fa fa-check"></i><b>11.2.3</b> Example: Exposure and the offset.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#multinomial-and-categorical-models"><i class="fa fa-check"></i><b>11.3</b> Multinomial and categorical models</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#predictors-matched-to-outcomes."><i class="fa fa-check"></i><b>11.3.1</b> Predictors matched to outcomes.</a></li>
<li class="chapter" data-level="11.3.2" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#predictors-matched-to-observations."><i class="fa fa-check"></i><b>11.3.2</b> Predictors matched to observations.</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#summary"><i class="fa fa-check"></i><b>11.4</b> Summary</a></li>
<li class="chapter" data-level="11.5" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#bonus-survival-analysis"><i class="fa fa-check"></i><b>11.5</b> Bonus: Survival analysis</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#survival-summary."><i class="fa fa-check"></i><b>11.5.1</b> Survival summary.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="god-spiked-the-integers.html"><a href="god-spiked-the-integers.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html"><i class="fa fa-check"></i><b>12</b> Monsters and Mixtures</a>
<ul>
<li class="chapter" data-level="12.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#over-dispersed-counts"><i class="fa fa-check"></i><b>12.1</b> Over-dispersed counts</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#beta-binomial."><i class="fa fa-check"></i><b>12.1.1</b> Beta-binomial.</a></li>
<li class="chapter" data-level="12.1.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#negative-binomial-or-gamma-poisson."><i class="fa fa-check"></i><b>12.1.2</b> Negative-binomial or gamma-Poisson.</a></li>
<li class="chapter" data-level="12.1.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#over-dispersion-entropy-and-information-criteria."><i class="fa fa-check"></i><b>12.1.3</b> Over-dispersion, entropy, and information criteria.</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#zero-inflated-outcomes"><i class="fa fa-check"></i><b>12.2</b> Zero-inflated outcomes</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#example-zero-inflated-poisson."><i class="fa fa-check"></i><b>12.2.1</b> Example: Zero-inflated Poisson.</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#ordered-categorical-outcomes"><i class="fa fa-check"></i><b>12.3</b> Ordered categorical outcomes</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#example-moral-intuition."><i class="fa fa-check"></i><b>12.3.1</b> Example: Moral intuition.</a></li>
<li class="chapter" data-level="12.3.2" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#describing-an-ordered-distribution-with-intercepts."><i class="fa fa-check"></i><b>12.3.2</b> Describing an ordered distribution with intercepts.</a></li>
<li class="chapter" data-level="12.3.3" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#adding-predictor-variables."><i class="fa fa-check"></i><b>12.3.3</b> Adding predictor variables.</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#ordered-categorical-predictors"><i class="fa fa-check"></i><b>12.4</b> Ordered categorical predictors</a></li>
<li class="chapter" data-level="12.5" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#summary-1"><i class="fa fa-check"></i><b>12.5</b> Summary</a></li>
<li class="chapter" data-level="" data-path="monsters-and-mixtures.html"><a href="monsters-and-mixtures.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="models-with-memory.html"><a href="models-with-memory.html"><i class="fa fa-check"></i><b>13</b> Models With Memory</a>
<ul>
<li class="chapter" data-level="13.1" data-path="models-with-memory.html"><a href="models-with-memory.html#example-multilevel-tadpoles"><i class="fa fa-check"></i><b>13.1</b> Example: Multilevel tadpoles</a></li>
<li class="chapter" data-level="13.2" data-path="models-with-memory.html"><a href="models-with-memory.html#varying-effects-and-the-underfittingoverfitting-trade-off"><i class="fa fa-check"></i><b>13.2</b> Varying effects and the underfitting/overfitting trade-off</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="models-with-memory.html"><a href="models-with-memory.html#the-model.-1"><i class="fa fa-check"></i><b>13.2.1</b> The model.</a></li>
<li class="chapter" data-level="13.2.2" data-path="models-with-memory.html"><a href="models-with-memory.html#assign-values-to-the-parameters."><i class="fa fa-check"></i><b>13.2.2</b> Assign values to the parameters.</a></li>
<li class="chapter" data-level="13.2.3" data-path="models-with-memory.html"><a href="models-with-memory.html#sumulate-survivors."><i class="fa fa-check"></i><b>13.2.3</b> Sumulate survivors.</a></li>
<li class="chapter" data-level="13.2.4" data-path="models-with-memory.html"><a href="models-with-memory.html#compute-the-no-pooling-estimates."><i class="fa fa-check"></i><b>13.2.4</b> Compute the no-pooling estimates.</a></li>
<li class="chapter" data-level="13.2.5" data-path="models-with-memory.html"><a href="models-with-memory.html#compute-the-partial-pooling-estimates."><i class="fa fa-check"></i><b>13.2.5</b> Compute the partial-pooling estimates.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="models-with-memory.html"><a href="models-with-memory.html#more-than-one-type-of-cluster"><i class="fa fa-check"></i><b>13.3</b> More than one type of cluster</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="models-with-memory.html"><a href="models-with-memory.html#multilevel-chimpanzees."><i class="fa fa-check"></i><b>13.3.1</b> Multilevel chimpanzees.</a></li>
<li class="chapter" data-level="13.3.2" data-path="models-with-memory.html"><a href="models-with-memory.html#even-more-clusters."><i class="fa fa-check"></i><b>13.3.2</b> Even more clusters.</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="models-with-memory.html"><a href="models-with-memory.html#divergent-transitions-and-non-centered-priors"><i class="fa fa-check"></i><b>13.4</b> Divergent transitions and non-centered priors</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="models-with-memory.html"><a href="models-with-memory.html#the-devils-funnel."><i class="fa fa-check"></i><b>13.4.1</b> The Devil’s Funnel.</a></li>
<li class="chapter" data-level="13.4.2" data-path="models-with-memory.html"><a href="models-with-memory.html#non-centered-chimpanzees."><i class="fa fa-check"></i><b>13.4.2</b> Non-centered chimpanzees.</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="models-with-memory.html"><a href="models-with-memory.html#multilevel-posterior-predictions"><i class="fa fa-check"></i><b>13.5</b> Multilevel posterior predictions</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="models-with-memory.html"><a href="models-with-memory.html#posterior-prediction-for-same-clusters."><i class="fa fa-check"></i><b>13.5.1</b> Posterior prediction for same clusters.</a></li>
<li class="chapter" data-level="13.5.2" data-path="models-with-memory.html"><a href="models-with-memory.html#posterior-prediction-for-new-clusters."><i class="fa fa-check"></i><b>13.5.2</b> Posterior prediction for new clusters.</a></li>
<li class="chapter" data-level="13.5.3" data-path="models-with-memory.html"><a href="models-with-memory.html#post-stratification."><i class="fa fa-check"></i><b>13.5.3</b> Post-stratification.</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="models-with-memory.html"><a href="models-with-memory.html#summary-bonus-post-stratification-in-an-example"><i class="fa fa-check"></i><b>13.6</b> <del>Summary</del> Bonus: Post-stratification in an example</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="models-with-memory.html"><a href="models-with-memory.html#meet-the-data."><i class="fa fa-check"></i><b>13.6.1</b> Meet the data.</a></li>
<li class="chapter" data-level="13.6.2" data-path="models-with-memory.html"><a href="models-with-memory.html#settle-the-mr-part-of-mrp."><i class="fa fa-check"></i><b>13.6.2</b> Settle the MR part of MRP.</a></li>
<li class="chapter" data-level="13.6.3" data-path="models-with-memory.html"><a href="models-with-memory.html#post-stratify-to-put-the-p-in-mrp."><i class="fa fa-check"></i><b>13.6.3</b> Post-stratify to put the P in MRP.</a></li>
<li class="chapter" data-level="13.6.4" data-path="models-with-memory.html"><a href="models-with-memory.html#wrap-this-mrp-up."><i class="fa fa-check"></i><b>13.6.4</b> Wrap this MRP up.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="models-with-memory.html"><a href="models-with-memory.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html"><i class="fa fa-check"></i><b>14</b> Adventures in Covariance</a>
<ul>
<li class="chapter" data-level="14.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#varying-slopes-by-construction"><i class="fa fa-check"></i><b>14.1</b> Varying slopes by construction</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#simulate-the-population."><i class="fa fa-check"></i><b>14.1.1</b> Simulate the population.</a></li>
<li class="chapter" data-level="14.1.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#simulate-observations."><i class="fa fa-check"></i><b>14.1.2</b> Simulate observations.</a></li>
<li class="chapter" data-level="14.1.3" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#the-varying-slopes-model."><i class="fa fa-check"></i><b>14.1.3</b> The varying slopes model.</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#advanced-varying-slopes"><i class="fa fa-check"></i><b>14.2</b> Advanced varying slopes</a></li>
<li class="chapter" data-level="14.3" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#instruments-and-causal-designs"><i class="fa fa-check"></i><b>14.3</b> Instruments and causal designs</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#instrumental-variables."><i class="fa fa-check"></i><b>14.3.1</b> Instrumental variables.</a></li>
<li class="chapter" data-level="14.3.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#other-designs."><i class="fa fa-check"></i><b>14.3.2</b> Other designs.</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#social-relations-as-correlated-varying-effects"><i class="fa fa-check"></i><b>14.4</b> Social relations as correlated varying effects</a></li>
<li class="chapter" data-level="14.5" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#continuous-categories-and-the-gaussian-process"><i class="fa fa-check"></i><b>14.5</b> Continuous categories and the Gaussian process</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#example-spatial-autocorrelation-in-oceanic-tools."><i class="fa fa-check"></i><b>14.5.1</b> Example: Spatial autocorrelation in Oceanic tools.</a></li>
<li class="chapter" data-level="14.5.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#example-phylogenetic-distance."><i class="fa fa-check"></i><b>14.5.2</b> Example: Phylogenetic distance.</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#summary-bonus-multilevel-growth-models-and-the-melsm"><i class="fa fa-check"></i><b>14.6</b> <del>Summary</del> Bonus: Multilevel growth models and the MELSM</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#borrow-some-data."><i class="fa fa-check"></i><b>14.6.1</b> Borrow some data.</a></li>
<li class="chapter" data-level="14.6.2" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#conventional-multilevel-growth-model."><i class="fa fa-check"></i><b>14.6.2</b> Conventional multilevel growth model.</a></li>
<li class="chapter" data-level="14.6.3" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#learn-more-about-your-data-with-the-melsm."><i class="fa fa-check"></i><b>14.6.3</b> Learn more about your data with the MELSM.</a></li>
<li class="chapter" data-level="14.6.4" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#time-to-go-multivariate."><i class="fa fa-check"></i><b>14.6.4</b> Time to go multivariate.</a></li>
<li class="chapter" data-level="14.6.5" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#growth-modelmelsm-wrap-up."><i class="fa fa-check"></i><b>14.6.5</b> Growth model/MELSM wrap-up.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="adventures-in-covariance.html"><a href="adventures-in-covariance.html#session-info-13"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html"><i class="fa fa-check"></i><b>15</b> Missing Data and Other Opportunities</a>
<ul>
<li class="chapter" data-level="15.1" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#measurement-error"><i class="fa fa-check"></i><b>15.1</b> Measurement error</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#error-on-the-outcome."><i class="fa fa-check"></i><b>15.1.1</b> Error on the outcome.</a></li>
<li class="chapter" data-level="15.1.2" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#error-on-both-outcome-and-predictor."><i class="fa fa-check"></i><b>15.1.2</b> Error on both outcome and predictor.</a></li>
<li class="chapter" data-level="15.1.3" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#measurement-terrors."><i class="fa fa-check"></i><b>15.1.3</b> Measurement terrors.</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#missing-data"><i class="fa fa-check"></i><b>15.2</b> Missing data</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#dag-ate-my-homework."><i class="fa fa-check"></i><b>15.2.1</b> DAG ate my homework.</a></li>
<li class="chapter" data-level="15.2.2" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#imputing-primates."><i class="fa fa-check"></i><b>15.2.2</b> Imputing primates.</a></li>
<li class="chapter" data-level="15.2.3" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#where-is-your-god-now"><i class="fa fa-check"></i><b>15.2.3</b> Where is your god now?</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#categorical-errors-and-discrete-absences"><i class="fa fa-check"></i><b>15.3</b> Categorical errors and discrete absences</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#discrete-cats."><i class="fa fa-check"></i><b>15.3.1</b> Discrete cats.</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#summary-2"><i class="fa fa-check"></i><b>15.4</b> Summary</a></li>
<li class="chapter" data-level="15.5" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#bonus-bayesian-meta-analysis-with-odds-ratios"><i class="fa fa-check"></i><b>15.5</b> Bonus: Bayesian meta-analysis with odds ratios</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#how-do-meta-analyses-fit-into-the-picture"><i class="fa fa-check"></i><b>15.5.1</b> How do meta-analyses fit into the picture?</a></li>
<li class="chapter" data-level="15.5.2" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#we-need-some-data."><i class="fa fa-check"></i><b>15.5.2</b> We need some data.</a></li>
<li class="chapter" data-level="15.5.3" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#our-effect-size-will-be-an-odds-ratio."><i class="fa fa-check"></i><b>15.5.3</b> Our effect size will be an odds ratio.</a></li>
<li class="chapter" data-level="15.5.4" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#log-odds-odds-ratios-and-modeling-effect-sizes."><i class="fa fa-check"></i><b>15.5.4</b> Log-odds, odds ratios, and modeling effect sizes.</a></li>
<li class="chapter" data-level="15.5.5" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#compute-the-study-specific-effect-sizes."><i class="fa fa-check"></i><b>15.5.5</b> Compute the study-specific effect sizes.</a></li>
<li class="chapter" data-level="15.5.6" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#fit-the-bayesian-meta-analysis."><i class="fa fa-check"></i><b>15.5.6</b> Fit the Bayesian meta-analysis.</a></li>
<li class="chapter" data-level="15.5.7" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#fit-the-bayesian-muiltilevel-alternative."><i class="fa fa-check"></i><b>15.5.7</b> Fit the Bayesian muiltilevel alternative.</a></li>
<li class="chapter" data-level="15.5.8" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#relative-to-the-muiltilevel-model-meta-analyses-have-limitations."><i class="fa fa-check"></i><b>15.5.8</b> Relative to the muiltilevel model, meta-analyses have limitations.</a></li>
<li class="chapter" data-level="15.5.9" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#parting-thoughts."><i class="fa fa-check"></i><b>15.5.9</b> Parting thoughts.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="missing-data-and-other-opportunities.html"><a href="missing-data-and-other-opportunities.html#session-info-14"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html"><i class="fa fa-check"></i><b>16</b> Generalized Linear Madness</a>
<ul>
<li class="chapter" data-level="16.1" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#geometric-people"><i class="fa fa-check"></i><b>16.1</b> Geometric people</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#the-scientific-model."><i class="fa fa-check"></i><b>16.1.1</b> The scientific model.</a></li>
<li class="chapter" data-level="16.1.2" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#the-statistical-model."><i class="fa fa-check"></i><b>16.1.2</b> The statistical model.</a></li>
<li class="chapter" data-level="16.1.3" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#glm-in-disguise."><i class="fa fa-check"></i><b>16.1.3</b> GLM in disguise.</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#hidden-minds-and-observed-behavior"><i class="fa fa-check"></i><b>16.2</b> Hidden minds and observed behavior</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#the-scientific-model.-1"><i class="fa fa-check"></i><b>16.2.1</b> The scientific model.</a></li>
<li class="chapter" data-level="16.2.2" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#the-statistical-model.-1"><i class="fa fa-check"></i><b>16.2.2</b> The statistical model.</a></li>
<li class="chapter" data-level="16.2.3" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#coding-the-statistical-model."><i class="fa fa-check"></i><b>16.2.3</b> Coding the statistical model.</a></li>
<li class="chapter" data-level="16.2.4" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#state-space-models."><i class="fa fa-check"></i><b>16.2.4</b> State space models.</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#ordinary-differential-nut-cracking"><i class="fa fa-check"></i><b>16.3</b> Ordinary differential nut cracking</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#scientific-model."><i class="fa fa-check"></i><b>16.3.1</b> Scientific model.</a></li>
<li class="chapter" data-level="16.3.2" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#statistical-model."><i class="fa fa-check"></i><b>16.3.2</b> Statistical model.</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#population-dynamics"><i class="fa fa-check"></i><b>16.4</b> Population dynamics</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#the-scientific-model.-2"><i class="fa fa-check"></i><b>16.4.1</b> The scientific model.</a></li>
<li class="chapter" data-level="16.4.2" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#the-statistical-model.-2"><i class="fa fa-check"></i><b>16.4.2</b> The statistical model.</a></li>
<li class="chapter" data-level="16.4.3" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#lynx-lessons-bonus-practice-with-the-autoregressive-model."><i class="fa fa-check"></i><b>16.4.3</b> <del>Lynx lessons</del> Bonus: Practice with the autoregressive model.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="generalized-linear-madness.html"><a href="generalized-linear-madness.html#session-info-15"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html"><i class="fa fa-check"></i><b>17</b> <del>Horoscopes</del> Insights</a>
<ul>
<li class="chapter" data-level="17.1" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#use-r-notebooks"><i class="fa fa-check"></i><b>17.1</b> Use R Notebooks</a></li>
<li class="chapter" data-level="17.2" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#save-your-model-fits"><i class="fa fa-check"></i><b>17.2</b> Save your model fits</a></li>
<li class="chapter" data-level="17.3" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#build-your-models-slowly"><i class="fa fa-check"></i><b>17.3</b> Build your models slowly</a></li>
<li class="chapter" data-level="17.4" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#look-at-your-data"><i class="fa fa-check"></i><b>17.4</b> Look at your data</a></li>
<li class="chapter" data-level="17.5" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#consider-using-the-0-intercept-syntax"><i class="fa fa-check"></i><b>17.5</b> Consider using the <code>0 + Intercept</code> syntax</a></li>
<li class="chapter" data-level="17.6" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#annotate-your-workflow"><i class="fa fa-check"></i><b>17.6</b> Annotate your workflow</a></li>
<li class="chapter" data-level="17.7" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#annotate-your-code"><i class="fa fa-check"></i><b>17.7</b> Annotate your code</a></li>
<li class="chapter" data-level="17.8" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#break-up-your-workflow"><i class="fa fa-check"></i><b>17.8</b> Break up your workflow</a></li>
<li class="chapter" data-level="17.9" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#code-in-public"><i class="fa fa-check"></i><b>17.9</b> Code in public</a></li>
<li class="chapter" data-level="17.10" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#check-out-social-media"><i class="fa fa-check"></i><b>17.10</b> Check out social media</a></li>
<li class="chapter" data-level="17.11" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#extra-rethinking-related-resources"><i class="fa fa-check"></i><b>17.11</b> Extra <em>Rethinking</em>-related resources</a></li>
<li class="chapter" data-level="17.12" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#but-like-how-do-i-do-this-for-real"><i class="fa fa-check"></i><b>17.12</b> <em>But, like, how do I do this for real?</em></a></li>
<li class="chapter" data-level="17.13" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#parting-wisdom"><i class="fa fa-check"></i><b>17.13</b> Parting wisdom</a></li>
<li class="chapter" data-level="" data-path="horoscopes-insights.html"><a href="horoscopes-insights.html#session-info-16"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Statistical rethinking</em> with brms, ggplot2, and the tidyverse: Second edition</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sampling-the-imaginary" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Sampling the Imaginary<a href="sampling-the-imaginary.html#sampling-the-imaginary" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>If you would like to know the probability someone is a vampire given they test positive to the blood-based vampire test, you compute</p>
<p><span class="math display">\[\text{Pr(vampire|positive)} = \frac{\text{Pr(positive|vampire) Pr(vampire)}}{\text{Pr(positive)}}.\]</span></p>
<p>We’ll do so within a tibble.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="sampling-the-imaginary.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb82-2"><a href="sampling-the-imaginary.html#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="sampling-the-imaginary.html#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">pr_positive_vampire =</span> .<span class="dv">95</span>,</span>
<span id="cb82-4"><a href="sampling-the-imaginary.html#cb82-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">pr_positive_mortal  =</span> .<span class="dv">01</span>,</span>
<span id="cb82-5"><a href="sampling-the-imaginary.html#cb82-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">pr_vampire          =</span> .<span class="dv">001</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb82-6"><a href="sampling-the-imaginary.html#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pr_positive =</span> pr_positive_vampire <span class="sc">*</span> pr_vampire <span class="sc">+</span> pr_positive_mortal <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> pr_vampire)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-7"><a href="sampling-the-imaginary.html#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pr_vampire_positive =</span> pr_positive_vampire <span class="sc">*</span> pr_vampire <span class="sc">/</span> pr_positive) <span class="sc">%&gt;%</span> </span>
<span id="cb82-8"><a href="sampling-the-imaginary.html#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 1
## Columns: 5
## $ pr_positive_vampire &lt;dbl&gt; 0.95
## $ pr_positive_mortal  &lt;dbl&gt; 0.01
## $ pr_vampire          &lt;dbl&gt; 0.001
## $ pr_positive         &lt;dbl&gt; 0.01094
## $ pr_vampire_positive &lt;dbl&gt; 0.08683729</code></pre>
<p>Here’s the other way of tackling the vampire problem, this time using the frequency format.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="sampling-the-imaginary.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">pr_vampire          =</span> <span class="dv">100</span> <span class="sc">/</span> <span class="dv">100000</span>,</span>
<span id="cb84-2"><a href="sampling-the-imaginary.html#cb84-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">pr_positive_vampire =</span> <span class="dv">95</span> <span class="sc">/</span> <span class="dv">100</span>,</span>
<span id="cb84-3"><a href="sampling-the-imaginary.html#cb84-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">pr_positive_mortal  =</span> <span class="dv">999</span> <span class="sc">/</span> <span class="dv">99900</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb84-4"><a href="sampling-the-imaginary.html#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pr_positive =</span> <span class="dv">95</span> <span class="sc">+</span> <span class="dv">999</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb84-5"><a href="sampling-the-imaginary.html#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pr_vampire_positive =</span> pr_positive_vampire <span class="sc">*</span> <span class="dv">100</span> <span class="sc">/</span> pr_positive) <span class="sc">%&gt;%</span> </span>
<span id="cb84-6"><a href="sampling-the-imaginary.html#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 1
## Columns: 5
## $ pr_vampire          &lt;dbl&gt; 0.001
## $ pr_positive_vampire &lt;dbl&gt; 0.95
## $ pr_positive_mortal  &lt;dbl&gt; 0.01
## $ pr_positive         &lt;dbl&gt; 1094
## $ pr_vampire_positive &lt;dbl&gt; 0.08683729</code></pre>
<blockquote>
<p>The posterior distribution is a probability distribution. And like all probability distributions, we can imagine drawing <em>samples</em> from it. The sampled events in this case are parameter values. Most parameters have no exact empirical realization. The Bayesian formalism treats parameter distributions as relative plausibility, not as any physical random process. In any event, randomness is always a property of information, never of the real world. But inside the computer, parameters are just as empirical as the outcome of a coin flip or a die toss or an agricultural experiment. The posterior defines the expected frequency that different parameter values will appear, once we start plucking parameters out of it. <span class="citation">(<a href="#ref-mcelreathStatisticalRethinkingBayesian2020" role="doc-biblioref">McElreath, 2020, p. 50</a>, <em>emphasis</em> in the original)</span></p>
</blockquote>
<div id="sampling-from-a-grid-approximate-posterior" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Sampling from a grid-approximate posterior<a href="sampling-the-imaginary.html#sampling-from-a-grid-approximate-posterior" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Once again, here we use grid approximation to generate samples.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="sampling-the-imaginary.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many grid points would you like?</span></span>
<span id="cb86-2"><a href="sampling-the-imaginary.html#cb86-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb86-3"><a href="sampling-the-imaginary.html#cb86-3" aria-hidden="true" tabindex="-1"></a>n_success <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb86-4"><a href="sampling-the-imaginary.html#cb86-4" aria-hidden="true" tabindex="-1"></a>n_trials  <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb86-5"><a href="sampling-the-imaginary.html#cb86-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-6"><a href="sampling-the-imaginary.html#cb86-6" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb86-7"><a href="sampling-the-imaginary.html#cb86-7" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span></span>
<span id="cb86-8"><a href="sampling-the-imaginary.html#cb86-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">p_grid =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> n),</span>
<span id="cb86-9"><a href="sampling-the-imaginary.html#cb86-9" aria-hidden="true" tabindex="-1"></a>         <span class="co"># note we&#39;re still using a flat uniform prior</span></span>
<span id="cb86-10"><a href="sampling-the-imaginary.html#cb86-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">prior  =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb86-11"><a href="sampling-the-imaginary.html#cb86-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">likelihood =</span> <span class="fu">dbinom</span>(n_success, <span class="at">size =</span> n_trials, <span class="at">prob =</span> p_grid)) <span class="sc">%&gt;%</span> </span>
<span id="cb86-12"><a href="sampling-the-imaginary.html#cb86-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">posterior =</span> (likelihood <span class="sc">*</span> prior) <span class="sc">/</span> <span class="fu">sum</span>(likelihood <span class="sc">*</span> prior))</span>
<span id="cb86-13"><a href="sampling-the-imaginary.html#cb86-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 1,000 × 4
##     p_grid prior likelihood posterior
##      &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
##  1 0           1   0         0       
##  2 0.00100     1   8.43e-17  8.43e-19
##  3 0.00200     1   5.38e-15  5.38e-17
##  4 0.00300     1   6.11e-14  6.11e-16
##  5 0.00400     1   3.42e-13  3.42e-15
##  6 0.00501     1   1.30e-12  1.30e-14
##  7 0.00601     1   3.87e-12  3.88e-14
##  8 0.00701     1   9.73e-12  9.74e-14
##  9 0.00801     1   2.16e-11  2.16e-13
## 10 0.00901     1   4.37e-11  4.38e-13
## # … with 990 more rows</code></pre>
<p>Our <code>d</code> data contains all the components in McElreath’s <strong>R</strong> code 3.2 block. Do note we’ve renamed his <code>prob_p</code> and <code>prob_data</code> as <code>prior</code> and <code>likelihood</code>, respectively. Now we’ll use the <code>dplyr::slice_sample()</code> function to sample rows from <code>d</code>, saving them as <code>sample</code>.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="sampling-the-imaginary.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many samples would you like?</span></span>
<span id="cb88-2"><a href="sampling-the-imaginary.html#cb88-2" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb88-3"><a href="sampling-the-imaginary.html#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="sampling-the-imaginary.html#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co"># make it reproducible</span></span>
<span id="cb88-5"><a href="sampling-the-imaginary.html#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb88-6"><a href="sampling-the-imaginary.html#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="sampling-the-imaginary.html#cb88-7" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span></span>
<span id="cb88-8"><a href="sampling-the-imaginary.html#cb88-8" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb88-9"><a href="sampling-the-imaginary.html#cb88-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> n_samples, <span class="at">weight_by =</span> posterior, <span class="at">replace =</span> T)</span>
<span id="cb88-10"><a href="sampling-the-imaginary.html#cb88-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-11"><a href="sampling-the-imaginary.html#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(samples)</span></code></pre></div>
<pre><code>## Rows: 10,000
## Columns: 4
## $ p_grid     &lt;dbl&gt; 0.5645646, 0.6516517, 0.5475475, 0.5905906, 0.5955956, 0.7877878, 0.7267267, 0.…
## $ prior      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ likelihood &lt;dbl&gt; 0.224559942, 0.271902722, 0.209666553, 0.244608692, 0.247990921, 0.191887140, 0…
## $ posterior  &lt;dbl&gt; 2.247847e-03, 2.721749e-03, 2.098764e-03, 2.448535e-03, 2.482392e-03, 1.920792e…</code></pre>
<p>Now we can plot the left panel of Figure 3.1 with <code>geom_point()</code>. But before we do, we’ll need to add a variable numbering the samples.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="sampling-the-imaginary.html#cb90-1" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span> </span>
<span id="cb90-2"><a href="sampling-the-imaginary.html#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_number =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb90-3"><a href="sampling-the-imaginary.html#cb90-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb90-4"><a href="sampling-the-imaginary.html#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sample_number, <span class="at">y =</span> p_grid)) <span class="sc">+</span></span>
<span id="cb90-5"><a href="sampling-the-imaginary.html#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb90-6"><a href="sampling-the-imaginary.html#cb90-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">&quot;proportion of water (p)&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb90-7"><a href="sampling-the-imaginary.html#cb90-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;sample number&quot;</span>)</span></code></pre></div>
<p><img src="03_files/figure-html/unnamed-chunk-6-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>We’ll make the density in the right panel with <code>geom_density()</code>.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="sampling-the-imaginary.html#cb91-1" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span> </span>
<span id="cb91-2"><a href="sampling-the-imaginary.html#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p_grid)) <span class="sc">+</span></span>
<span id="cb91-3"><a href="sampling-the-imaginary.html#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb91-4"><a href="sampling-the-imaginary.html#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;proportion of water (p)&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="03_files/figure-html/unnamed-chunk-7-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>That was based on <code>1e4</code> samples. On page 53, McElreath said the density would converge on the idealized shape if we keep increasing the number of samples. Here’s what it looks like with <code>1e6</code>.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="sampling-the-imaginary.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb92-2"><a href="sampling-the-imaginary.html#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="sampling-the-imaginary.html#cb92-3" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb92-4"><a href="sampling-the-imaginary.html#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="fl">1e6</span>, <span class="at">weight_by =</span> posterior, <span class="at">replace =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb92-5"><a href="sampling-the-imaginary.html#cb92-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p_grid)) <span class="sc">+</span></span>
<span id="cb92-6"><a href="sampling-the-imaginary.html#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb92-7"><a href="sampling-the-imaginary.html#cb92-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;proportion of water (p)&quot;</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="03_files/figure-html/unnamed-chunk-8-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>Yep, that’s more ideal.</p>
</div>
<div id="sampling-to-summarize" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Sampling to summarize<a href="sampling-the-imaginary.html#sampling-to-summarize" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>“Once your model produces a posterior distribution, the model’s work is done. But your work has just begun. It is necessary to summarize and interpret the posterior distribution. Exactly how it is summarized depends upon your purpose” (p. 53).</p>
<div id="intervals-of-defined-boundaries." class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Intervals of defined boundaries.<a href="sampling-the-imaginary.html#intervals-of-defined-boundaries." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To get the proportion of water less than some value of <code>p_grid</code> within the <strong>tidyverse</strong>, you might first <code>filter()</code> by that value and then take the <code>sum()</code> within <code>summarise()</code>.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="sampling-the-imaginary.html#cb93-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb93-2"><a href="sampling-the-imaginary.html#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_grid <span class="sc">&lt;</span> .<span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb93-3"><a href="sampling-the-imaginary.html#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum =</span> <span class="fu">sum</span>(posterior))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##     sum
##   &lt;dbl&gt;
## 1 0.172</code></pre>
<p>To learn more about <code>dplyr::summarise()</code> and related functions, check out Baert’s <a href="https://suzan.rbind.io/2018/04/dplyr-tutorial-4/"><em>Data wrangling part 4: Summarizing and slicing your data</em></a> and <a href="https://r4ds.had.co.nz/transform.html#grouped-summaries-with-summarise">Section 5.6</a> of <em>R4DS</em> <span class="citation">(<a href="#ref-grolemundDataScience2017" role="doc-biblioref">Grolemund &amp; Wickham, 2017</a>)</span>.</p>
<p>If what you want is a frequency based on filtering by <code>samples</code>, then you might use <code>n()</code> within <code>summarise()</code>.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="sampling-the-imaginary.html#cb95-1" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span></span>
<span id="cb95-2"><a href="sampling-the-imaginary.html#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_grid <span class="sc">&lt;</span> .<span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb95-3"><a href="sampling-the-imaginary.html#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum =</span> <span class="fu">n</span>() <span class="sc">/</span> n_samples)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##     sum
##   &lt;dbl&gt;
## 1 0.163</code></pre>
<p>A more explicit approach for the same computation is to follow up <code>count()</code> with <code>mutate()</code>.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="sampling-the-imaginary.html#cb97-1" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span> </span>
<span id="cb97-2"><a href="sampling-the-imaginary.html#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(p_grid <span class="sc">&lt;</span> .<span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb97-3"><a href="sampling-the-imaginary.html#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">probability =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   `p_grid &lt; 0.5`     n probability
##   &lt;lgl&gt;          &lt;int&gt;       &lt;dbl&gt;
## 1 FALSE           8371       0.837
## 2 TRUE            1629       0.163</code></pre>
<p>An even trickier approach for the same is to insert the logical statement <code>p_grid &lt; .5</code> within the <code>mean()</code> function.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="sampling-the-imaginary.html#cb99-1" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span></span>
<span id="cb99-2"><a href="sampling-the-imaginary.html#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum =</span> <span class="fu">mean</span>(p_grid <span class="sc">&lt;</span> .<span class="dv">5</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##     sum
##   &lt;dbl&gt;
## 1 0.163</code></pre>
<p>Much like McElreath discussed in the <strong>Overthinking: Counting with <code>sum</code></strong> box, this works “because R internally converts a logical expression, like <code>samples &lt; 0.5</code>, to a vector of <code>TRUE</code> and <code>FALSE</code> results, one for each element of <code>samples</code>, saying whether or not each element matches the criterion” (p. 54). When we inserted that vector of <code>TRUE</code> and <code>FALSE</code> values within the <code>mean()</code> function, they were then internally converted to a vector of 1’s and 0’s, the mean of which was the probability. Tricky!</p>
<p>To determine the posterior probability between 0.5 and 0.75, you can use <code>&amp;</code> within <code>filter()</code>.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="sampling-the-imaginary.html#cb101-1" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span> </span>
<span id="cb101-2"><a href="sampling-the-imaginary.html#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_grid <span class="sc">&gt;</span> .<span class="dv">5</span> <span class="sc">&amp;</span> p_grid <span class="sc">&lt;</span> .<span class="dv">75</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb101-3"><a href="sampling-the-imaginary.html#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum =</span> <span class="fu">n</span>() <span class="sc">/</span> n_samples)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##     sum
##   &lt;dbl&gt;
## 1 0.606</code></pre>
<p>Just multiply that value by 100 to get a percent.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="sampling-the-imaginary.html#cb103-1" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span> </span>
<span id="cb103-2"><a href="sampling-the-imaginary.html#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_grid <span class="sc">&gt;</span> .<span class="dv">5</span> <span class="sc">&amp;</span> p_grid <span class="sc">&lt;</span> .<span class="dv">75</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb103-3"><a href="sampling-the-imaginary.html#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sum     =</span> <span class="fu">n</span>() <span class="sc">/</span> n_samples,</span>
<span id="cb103-4"><a href="sampling-the-imaginary.html#cb103-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">percent =</span> <span class="fu">n</span>() <span class="sc">/</span> n_samples <span class="sc">*</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##     sum percent
##   &lt;dbl&gt;   &lt;dbl&gt;
## 1 0.606    60.6</code></pre>
<p>And, of course, you can do that with our <code>mean()</code> trick, too.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="sampling-the-imaginary.html#cb105-1" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span></span>
<span id="cb105-2"><a href="sampling-the-imaginary.html#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">percent =</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fu">mean</span>(p_grid <span class="sc">&gt;</span> .<span class="dv">5</span> <span class="sc">&amp;</span> p_grid <span class="sc">&lt;</span> .<span class="dv">75</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   percent
##     &lt;dbl&gt;
## 1    60.6</code></pre>
</div>
<div id="intervals-of-defined-mass." class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Intervals of defined mass.<a href="sampling-the-imaginary.html#intervals-of-defined-mass." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<blockquote>
<p>It is more common to see scientific journals reporting an interval of defined mass, usually known as a <strong>confidence interval</strong>. An interval of posterior probability, such as the ones we are working with, may instead be called a <strong>credible interval</strong>. We’re going to call it a <strong>compatibility interval</strong> instead, in order to avoid the unwarranted implications of “confidence” and “credibility.” What the interval indicates is a range of parameter values compatible with the model and data. The model and data themselves may not inspire confidence, in which case the interval will not either. (p. 54, <strong>emphasis</strong> in the original)</p>
</blockquote>
<p>As a part of this block quote, McElreath linked to endnote 54, which reads: “I learned this term from Sander Greenland and his collaborators. See <span class="citation">Amrhein et al. (<a href="#ref-amrheinScientistsRiseStatistical2019" role="doc-biblioref">2019</a>)</span> and Gelman and Greenland <span class="citation">(<a href="#ref-gelmanAreConfidenceIntervals2019" role="doc-biblioref">2019</a>)</span>” (p. 560).</p>
<p>We’ll create the upper two panels for Figure 3.2 with <code>geom_line()</code>, <code>geom_area()</code>, some careful filtering, and a little patchwork syntax.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="sampling-the-imaginary.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># upper left panel</span></span>
<span id="cb107-2"><a href="sampling-the-imaginary.html#cb107-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb107-3"><a href="sampling-the-imaginary.html#cb107-3" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb107-4"><a href="sampling-the-imaginary.html#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p_grid, <span class="at">y =</span> posterior)) <span class="sc">+</span></span>
<span id="cb107-5"><a href="sampling-the-imaginary.html#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb107-6"><a href="sampling-the-imaginary.html#cb107-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data =</span> d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p_grid <span class="sc">&lt;</span> .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb107-7"><a href="sampling-the-imaginary.html#cb107-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb107-8"><a href="sampling-the-imaginary.html#cb107-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>)</span>
<span id="cb107-9"><a href="sampling-the-imaginary.html#cb107-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-10"><a href="sampling-the-imaginary.html#cb107-10" aria-hidden="true" tabindex="-1"></a><span class="co"># upper right panel</span></span>
<span id="cb107-11"><a href="sampling-the-imaginary.html#cb107-11" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb107-12"><a href="sampling-the-imaginary.html#cb107-12" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb107-13"><a href="sampling-the-imaginary.html#cb107-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p_grid, <span class="at">y =</span> posterior)) <span class="sc">+</span></span>
<span id="cb107-14"><a href="sampling-the-imaginary.html#cb107-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb107-15"><a href="sampling-the-imaginary.html#cb107-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note this next line is the only difference in code from the last plot</span></span>
<span id="cb107-16"><a href="sampling-the-imaginary.html#cb107-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data =</span> d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p_grid <span class="sc">&lt;</span> .<span class="dv">75</span> <span class="sc">&amp;</span> p_grid <span class="sc">&gt;</span> .<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb107-17"><a href="sampling-the-imaginary.html#cb107-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb107-18"><a href="sampling-the-imaginary.html#cb107-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>)</span>
<span id="cb107-19"><a href="sampling-the-imaginary.html#cb107-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-20"><a href="sampling-the-imaginary.html#cb107-20" aria-hidden="true" tabindex="-1"></a><span class="co"># combine</span></span>
<span id="cb107-21"><a href="sampling-the-imaginary.html#cb107-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb107-22"><a href="sampling-the-imaginary.html#cb107-22" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="03_files/figure-html/unnamed-chunk-16-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>We’ll come back for the lower two panels in a bit.</p>
<p>Since we saved our <code>p_grid</code> samples within the well-named <code>samples</code> tibble, we’ll have to index with <code>$</code> within <code>quantile</code>.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="sampling-the-imaginary.html#cb108-1" aria-hidden="true" tabindex="-1"></a>(q_80 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samples<span class="sc">$</span>p_grid, <span class="at">prob =</span> .<span class="dv">8</span>))</span></code></pre></div>
<pre><code>##       80% 
## 0.7627628</code></pre>
<p>That value will come in handy for the lower left panel of Figure 3.2. For an alternative approach, we could <code>select()</code> the <code>samples</code> vector, extract it from the tibble with <code>pull()</code>, and then pump it into <code>quantile()</code>.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="sampling-the-imaginary.html#cb110-1" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span> </span>
<span id="cb110-2"><a href="sampling-the-imaginary.html#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(p_grid) <span class="sc">%&gt;%</span> </span>
<span id="cb110-3"><a href="sampling-the-imaginary.html#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">quantile</span>(<span class="at">prob =</span> .<span class="dv">8</span>)</span></code></pre></div>
<pre><code>##       80% 
## 0.7627628</code></pre>
<p>We might also use <code>quantile()</code> within <code>summarise()</code>.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="sampling-the-imaginary.html#cb112-1" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span> </span>
<span id="cb112-2"><a href="sampling-the-imaginary.html#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">80th percentile</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">quantile</span>(p_grid, <span class="at">p =</span> .<span class="dv">8</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   `80th percentile`
##               &lt;dbl&gt;
## 1             0.763</code></pre>
<p>Here’s the <code>summarise()</code> approach with two probabilities.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="sampling-the-imaginary.html#cb114-1" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span> </span>
<span id="cb114-2"><a href="sampling-the-imaginary.html#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">10th percentile</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">quantile</span>(p_grid, <span class="at">p =</span> .<span class="dv">1</span>),</span>
<span id="cb114-3"><a href="sampling-the-imaginary.html#cb114-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">90th percentile</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">quantile</span>(p_grid, <span class="at">p =</span> .<span class="dv">9</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   `10th percentile` `90th percentile`
##               &lt;dbl&gt;             &lt;dbl&gt;
## 1             0.451             0.815</code></pre>
<p>The <strong>tidyverse</strong> approach is nice in that that family of functions typically returns a data frame. But sometimes you just want your values in a numeric vector for the sake of quick indexing. In that case, base <strong>R</strong> <code>quantile()</code> shines.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="sampling-the-imaginary.html#cb116-1" aria-hidden="true" tabindex="-1"></a>(q_10_and_90 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samples<span class="sc">$</span>p_grid, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">9</span>)))</span></code></pre></div>
<pre><code>##       10%       90% 
## 0.4514515 0.8148148</code></pre>
<p>Now we have our cutoff values saved as <code>q_80</code> and <code>q_10_and_90</code>, we’re ready to make the bottom panels of Figure 3.2.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="sampling-the-imaginary.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lower left panel</span></span>
<span id="cb118-2"><a href="sampling-the-imaginary.html#cb118-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb118-3"><a href="sampling-the-imaginary.html#cb118-3" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb118-4"><a href="sampling-the-imaginary.html#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p_grid, <span class="at">y =</span> posterior)) <span class="sc">+</span></span>
<span id="cb118-5"><a href="sampling-the-imaginary.html#cb118-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb118-6"><a href="sampling-the-imaginary.html#cb118-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data =</span> d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p_grid <span class="sc">&lt;</span> q_80)) <span class="sc">+</span></span>
<span id="cb118-7"><a href="sampling-the-imaginary.html#cb118-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb118-8"><a href="sampling-the-imaginary.html#cb118-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">25</span>, <span class="at">y =</span> .<span class="dv">0025</span>,</span>
<span id="cb118-9"><a href="sampling-the-imaginary.html#cb118-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;lower 80%&quot;</span>) <span class="sc">+</span></span>
<span id="cb118-10"><a href="sampling-the-imaginary.html#cb118-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb118-11"><a href="sampling-the-imaginary.html#cb118-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>)</span>
<span id="cb118-12"><a href="sampling-the-imaginary.html#cb118-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-13"><a href="sampling-the-imaginary.html#cb118-13" aria-hidden="true" tabindex="-1"></a><span class="co"># lower right panel</span></span>
<span id="cb118-14"><a href="sampling-the-imaginary.html#cb118-14" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb118-15"><a href="sampling-the-imaginary.html#cb118-15" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb118-16"><a href="sampling-the-imaginary.html#cb118-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p_grid, <span class="at">y =</span> posterior)) <span class="sc">+</span></span>
<span id="cb118-17"><a href="sampling-the-imaginary.html#cb118-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb118-18"><a href="sampling-the-imaginary.html#cb118-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data =</span> d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(p_grid <span class="sc">&gt;</span> q_10_and_90[<span class="dv">1</span>] <span class="sc">&amp;</span> p_grid <span class="sc">&lt;</span> q_10_and_90[<span class="dv">2</span>])) <span class="sc">+</span></span>
<span id="cb118-19"><a href="sampling-the-imaginary.html#cb118-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb118-20"><a href="sampling-the-imaginary.html#cb118-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">25</span>, <span class="at">y =</span> .<span class="dv">0025</span>,</span>
<span id="cb118-21"><a href="sampling-the-imaginary.html#cb118-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;middle 80%&quot;</span>) <span class="sc">+</span></span>
<span id="cb118-22"><a href="sampling-the-imaginary.html#cb118-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb118-23"><a href="sampling-the-imaginary.html#cb118-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>)</span>
<span id="cb118-24"><a href="sampling-the-imaginary.html#cb118-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-25"><a href="sampling-the-imaginary.html#cb118-25" aria-hidden="true" tabindex="-1"></a><span class="co"># combine</span></span>
<span id="cb118-26"><a href="sampling-the-imaginary.html#cb118-26" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="03_files/figure-html/unnamed-chunk-22-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Now we follow along with McElreath’s <strong>R</strong> code 3.11 to compute a highly skewed posterior. We’ve already defined <code>p_grid</code> and <code>prior</code> within <code>d</code>, above. Here we’ll reuse them and update the rest of the columns.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="sampling-the-imaginary.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># here we update the `dbinom()` parameters</span></span>
<span id="cb119-2"><a href="sampling-the-imaginary.html#cb119-2" aria-hidden="true" tabindex="-1"></a>n_success <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb119-3"><a href="sampling-the-imaginary.html#cb119-3" aria-hidden="true" tabindex="-1"></a>n_trials  <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb119-4"><a href="sampling-the-imaginary.html#cb119-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a href="sampling-the-imaginary.html#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="co"># update `d`</span></span>
<span id="cb119-6"><a href="sampling-the-imaginary.html#cb119-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb119-7"><a href="sampling-the-imaginary.html#cb119-7" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb119-8"><a href="sampling-the-imaginary.html#cb119-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">likelihood =</span> <span class="fu">dbinom</span>(n_success, <span class="at">size =</span> n_trials, <span class="at">prob =</span> p_grid)) <span class="sc">%&gt;%</span> </span>
<span id="cb119-9"><a href="sampling-the-imaginary.html#cb119-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">posterior  =</span> (likelihood <span class="sc">*</span> prior) <span class="sc">/</span> <span class="fu">sum</span>(likelihood <span class="sc">*</span> prior))</span>
<span id="cb119-10"><a href="sampling-the-imaginary.html#cb119-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-11"><a href="sampling-the-imaginary.html#cb119-11" aria-hidden="true" tabindex="-1"></a><span class="co"># make the next part reproducible</span></span>
<span id="cb119-12"><a href="sampling-the-imaginary.html#cb119-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb119-13"><a href="sampling-the-imaginary.html#cb119-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-14"><a href="sampling-the-imaginary.html#cb119-14" aria-hidden="true" tabindex="-1"></a><span class="co"># here&#39;s our new samples tibble</span></span>
<span id="cb119-15"><a href="sampling-the-imaginary.html#cb119-15" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb119-16"><a href="sampling-the-imaginary.html#cb119-16" aria-hidden="true" tabindex="-1"></a>  samples <span class="ot">&lt;-</span></span>
<span id="cb119-17"><a href="sampling-the-imaginary.html#cb119-17" aria-hidden="true" tabindex="-1"></a>    d <span class="sc">%&gt;%</span> </span>
<span id="cb119-18"><a href="sampling-the-imaginary.html#cb119-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_sample</span>(<span class="at">n =</span> n_samples, <span class="at">weight_by =</span> posterior, <span class="at">replace =</span> T)</span>
<span id="cb119-19"><a href="sampling-the-imaginary.html#cb119-19" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 10,000 × 4
##    p_grid prior likelihood posterior
##     &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
##  1  0.717     1     0.368   0.00147 
##  2  0.652     1     0.277   0.00111 
##  3  0.548     1     0.164   0.000656
##  4  1         1     1       0.00400 
##  5  0.991     1     0.973   0.00389 
##  6  0.788     1     0.489   0.00195 
##  7  0.940     1     0.830   0.00332 
##  8  0.817     1     0.545   0.00218 
##  9  0.955     1     0.871   0.00348 
## 10  0.449     1     0.0908  0.000363
## # … with 9,990 more rows</code></pre>
<p>The <code>rethinking::PI()</code> function works like a nice shorthand for <code>quantile()</code>.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="sampling-the-imaginary.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(samples<span class="sc">$</span>p_grid, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">25</span>, .<span class="dv">75</span>))</span></code></pre></div>
<pre><code>##       25%       75% 
## 0.7087087 0.9349349</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="sampling-the-imaginary.html#cb123-1" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">PI</span>(samples<span class="sc">$</span>p_grid, <span class="at">prob =</span> .<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##       25%       75% 
## 0.7087087 0.9349349</code></pre>
<p>Now’s a good time to introduce Matthew Kay’s <span class="citation">(<a href="#ref-R-tidybayes" role="doc-biblioref">2022</a>)</span> <a href="https://mjskay.github.io/tidybayes/"><strong>tidybayes</strong> package</a>, which offers an array of convenience functions for summarizing Bayesian models of the type we’ll be working with in this project. For all the <strong>brms</strong>-related deets, see Kay’s <span class="citation">(<a href="#ref-kayExtractingVisualizingTidy2021" role="doc-biblioref">2021</a>)</span> vignette, <a href="https://mjskay.github.io/tidybayes/articles/tidy-brms.html"><em>Extracting and visualizing tidy draws from brms models</em></a>. Here we start simple.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="sampling-the-imaginary.html#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb125-2"><a href="sampling-the-imaginary.html#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="sampling-the-imaginary.html#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">median_qi</span>(samples<span class="sc">$</span>p_grid, <span class="at">.width =</span> .<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##           y      ymin      ymax .width .point .interval
## 1 0.8428428 0.7087087 0.9349349    0.5 median        qi</code></pre>
<p>The <strong>tidybayes</strong> package contains a <a href="https://mjskay.github.io/tidybayes/articles/tidy-brms.html#point-summaries-and-intervals">family of functions</a> that make it easy to summarize a distribution with a measure of central tendency accompanied by intervals. With <code>median_qi()</code>, we asked for the median and quantile-based intervals–just like we’ve been doing with <code>quantile()</code>. Note how the <code>.width</code> argument within <code>median_qi()</code> worked the same way the <code>prob</code> argument did within <code>rethinking::PI()</code>. With <code>.width = .5</code>, we indicated we wanted a quantile-based 50% interval, which was returned in the <code>ymin</code> and <code>ymax</code> columns. The tidybayes framework makes it easy to request multiple types of intervals. E.g., here we’ll request 50%, 80%, and 99% intervals.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="sampling-the-imaginary.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median_qi</span>(samples<span class="sc">$</span>p_grid, <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">5</span>, .<span class="dv">8</span>, .<span class="dv">99</span>))</span></code></pre></div>
<pre><code>##           y      ymin      ymax .width .point .interval
## 1 0.8428428 0.7087087 0.9349349   0.50 median        qi
## 2 0.8428428 0.5705706 0.9749750   0.80 median        qi
## 3 0.8428428 0.2562563 0.9989990   0.99 median        qi</code></pre>
<p>The <code>.width</code> column in the output indexed which line presented which interval. The value in the <code>y</code> column remained constant across rows. That’s because that column listed the measure of central tendency, the median in this case.</p>
<p>Now let’s use the <code>rethinking::HPDI()</code> function to return 50% highest posterior density intervals (HPDIs).</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="sampling-the-imaginary.html#cb129-1" aria-hidden="true" tabindex="-1"></a>rethinking<span class="sc">::</span><span class="fu">HPDI</span>(samples<span class="sc">$</span>p_grid, <span class="at">prob =</span> .<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##      |0.5      0.5| 
## 0.8418418 0.9989990</code></pre>
<p>The reason I introduce <strong>tidybayes</strong> now is that the functions of the <strong>brms</strong> package only support percentile-based intervals of the type we computed with <code>quantile()</code> and <code>median_qi()</code>. But <strong>tidybayes</strong> also supports HPDIs.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="sampling-the-imaginary.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mode_hdi</span>(samples<span class="sc">$</span>p_grid, <span class="at">.width =</span> .<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##          y      ymin     ymax .width .point .interval
## 1 0.955384 0.8418418 0.998999    0.5   mode       hdi</code></pre>
<p>This time we used the mode as the measure of central tendency. With this family of <strong>tidybayes</strong> functions, you specify the measure of central tendency in the prefix (i.e., <code>mean</code>, <code>median</code>, or <code>mode</code>) and then the type of interval you’d like (i.e., <code>qi</code> or <code>hdi</code>).</p>
<p>If all you want are the intervals without the measure of central tendency or all that other technical information, <strong>tidybayes</strong> also offers the handy <code>qi()</code> and <code>hdi()</code> functions.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="sampling-the-imaginary.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qi</span>(samples<span class="sc">$</span>p_grid, <span class="at">.width =</span> .<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 0.7087087 0.9349349</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="sampling-the-imaginary.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hdi</span>(samples<span class="sc">$</span>p_grid, <span class="at">.width =</span> .<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##           [,1]     [,2]
## [1,] 0.8418418 0.998999</code></pre>
<p>These are nice in that they return simple numeric vectors, making them particularly useful to use as references within <strong>ggplot2</strong> plots. Now we have that skill, we can use it to make Figure 3.3.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="sampling-the-imaginary.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lower left panel</span></span>
<span id="cb137-2"><a href="sampling-the-imaginary.html#cb137-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span></span>
<span id="cb137-3"><a href="sampling-the-imaginary.html#cb137-3" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb137-4"><a href="sampling-the-imaginary.html#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p_grid, <span class="at">y =</span> posterior)) <span class="sc">+</span></span>
<span id="cb137-5"><a href="sampling-the-imaginary.html#cb137-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># check out our sweet `qi()` indexing</span></span>
<span id="cb137-6"><a href="sampling-the-imaginary.html#cb137-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data =</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb137-7"><a href="sampling-the-imaginary.html#cb137-7" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(p_grid <span class="sc">&gt;</span> <span class="fu">qi</span>(samples<span class="sc">$</span>p_grid, <span class="at">.width =</span> .<span class="dv">5</span>)[<span class="dv">1</span>] <span class="sc">&amp;</span> </span>
<span id="cb137-8"><a href="sampling-the-imaginary.html#cb137-8" aria-hidden="true" tabindex="-1"></a>                       p_grid <span class="sc">&lt;</span> <span class="fu">qi</span>(samples<span class="sc">$</span>p_grid, <span class="at">.width =</span> .<span class="dv">5</span>)[<span class="dv">2</span>]),</span>
<span id="cb137-9"><a href="sampling-the-imaginary.html#cb137-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">&quot;grey75&quot;</span>) <span class="sc">+</span></span>
<span id="cb137-10"><a href="sampling-the-imaginary.html#cb137-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb137-11"><a href="sampling-the-imaginary.html#cb137-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;50% Percentile Interval&quot;</span>,</span>
<span id="cb137-12"><a href="sampling-the-imaginary.html#cb137-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb137-13"><a href="sampling-the-imaginary.html#cb137-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>)</span>
<span id="cb137-14"><a href="sampling-the-imaginary.html#cb137-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-15"><a href="sampling-the-imaginary.html#cb137-15" aria-hidden="true" tabindex="-1"></a><span class="co"># lower right panel</span></span>
<span id="cb137-16"><a href="sampling-the-imaginary.html#cb137-16" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span></span>
<span id="cb137-17"><a href="sampling-the-imaginary.html#cb137-17" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb137-18"><a href="sampling-the-imaginary.html#cb137-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p_grid, <span class="at">y =</span> posterior)) <span class="sc">+</span></span>
<span id="cb137-19"><a href="sampling-the-imaginary.html#cb137-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> </span>
<span id="cb137-20"><a href="sampling-the-imaginary.html#cb137-20" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(p_grid <span class="sc">&gt;</span> <span class="fu">hdi</span>(samples<span class="sc">$</span>p_grid, <span class="at">.width =</span> .<span class="dv">5</span>)[<span class="dv">1</span>] <span class="sc">&amp;</span> </span>
<span id="cb137-21"><a href="sampling-the-imaginary.html#cb137-21" aria-hidden="true" tabindex="-1"></a>                       p_grid <span class="sc">&lt;</span> <span class="fu">hdi</span>(samples<span class="sc">$</span>p_grid, <span class="at">.width =</span> .<span class="dv">5</span>)[<span class="dv">2</span>]),</span>
<span id="cb137-22"><a href="sampling-the-imaginary.html#cb137-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">&quot;grey75&quot;</span>) <span class="sc">+</span></span>
<span id="cb137-23"><a href="sampling-the-imaginary.html#cb137-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb137-24"><a href="sampling-the-imaginary.html#cb137-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;50% HPDI&quot;</span>,</span>
<span id="cb137-25"><a href="sampling-the-imaginary.html#cb137-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb137-26"><a href="sampling-the-imaginary.html#cb137-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>)</span>
<span id="cb137-27"><a href="sampling-the-imaginary.html#cb137-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-28"><a href="sampling-the-imaginary.html#cb137-28" aria-hidden="true" tabindex="-1"></a><span class="co"># combine!</span></span>
<span id="cb137-29"><a href="sampling-the-imaginary.html#cb137-29" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span></code></pre></div>
<p><img src="03_files/figure-html/unnamed-chunk-30-1.png" width="528" style="display: block; margin: auto;" /></p>
<p>In the <code>geom_area()</code> line for the HPDI plot, did you notice how we replaced <code>d</code> with <code>.</code>? When using the pipe (i.e., <code>%&gt;%</code>), you can use the <code>.</code> as a placeholder for the original data object. It’s an odd and handy trick to know about. Go <a href="https://magrittr.tidyverse.org/reference/pipe.html">here</a> to learn more.</p>
<blockquote>
<p>So the HPDI has some advantages over the PI. But in most cases, these two types of interval are very similar. They only look so different in this case because the posterior distribution is highly skewed. If we instead used samples from the posterior distribution for six waters in nine tosses, these intervals would be nearly identical. Try it for yourself, using different probability masses, such as <code>prob=0.8</code> and <code>prob=0.95</code>. When the posterior is bell shaped, it hardly matters which type of interval you use. (p. 57)</p>
</blockquote>
<p>Let’s try it out. First we’ll update the simulation for six waters in nine tosses.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="sampling-the-imaginary.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;six waters in nine tosses&quot;</span></span>
<span id="cb138-2"><a href="sampling-the-imaginary.html#cb138-2" aria-hidden="true" tabindex="-1"></a>n_success <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb138-3"><a href="sampling-the-imaginary.html#cb138-3" aria-hidden="true" tabindex="-1"></a>n_trials  <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb138-4"><a href="sampling-the-imaginary.html#cb138-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-5"><a href="sampling-the-imaginary.html#cb138-5" aria-hidden="true" tabindex="-1"></a>new_d <span class="ot">&lt;-</span></span>
<span id="cb138-6"><a href="sampling-the-imaginary.html#cb138-6" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb138-7"><a href="sampling-the-imaginary.html#cb138-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">likelihood =</span> <span class="fu">dbinom</span>(n_success, <span class="at">size =</span> n_trials, <span class="at">prob =</span> p_grid)) <span class="sc">%&gt;%</span> </span>
<span id="cb138-8"><a href="sampling-the-imaginary.html#cb138-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">posterior =</span> (likelihood <span class="sc">*</span> prior) <span class="sc">/</span> <span class="fu">sum</span>(posterior))</span>
<span id="cb138-9"><a href="sampling-the-imaginary.html#cb138-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb138-10"><a href="sampling-the-imaginary.html#cb138-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-11"><a href="sampling-the-imaginary.html#cb138-11" aria-hidden="true" tabindex="-1"></a>new_samples <span class="ot">&lt;-</span></span>
<span id="cb138-12"><a href="sampling-the-imaginary.html#cb138-12" aria-hidden="true" tabindex="-1"></a>  new_d <span class="sc">%&gt;%</span> </span>
<span id="cb138-13"><a href="sampling-the-imaginary.html#cb138-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> n_samples, <span class="at">weight_by =</span> posterior, <span class="at">replace =</span> T)</span></code></pre></div>
<p>Here are the intervals by <code>.width</code> and type of <code>.interval</code>.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="sampling-the-imaginary.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(<span class="fu">mean_hdi</span>(new_samples<span class="sc">$</span>p_grid, <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">8</span>, .<span class="dv">95</span>)),</span>
<span id="cb139-2"><a href="sampling-the-imaginary.html#cb139-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mean_qi</span>(new_samples<span class="sc">$</span>p_grid,  <span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">8</span>, .<span class="dv">95</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb139-3"><a href="sampling-the-imaginary.html#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.width, .interval, ymin<span class="sc">:</span>ymax) <span class="sc">%&gt;%</span> </span>
<span id="cb139-4"><a href="sampling-the-imaginary.html#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(.width) <span class="sc">%&gt;%</span> </span>
<span id="cb139-5"><a href="sampling-the-imaginary.html#cb139-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.double, round, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##   .width .interval ymin ymax
## 1   0.80       hdi 0.49 0.84
## 2   0.80        qi 0.45 0.81
## 3   0.95       hdi 0.37 0.89
## 4   0.95        qi 0.35 0.88</code></pre>
<p>We didn’t need that last <code>mutate_if()</code> line. It just made it easier to compare the <code>ymin</code> and <code>ymax</code> values. Anyway, McElreath was right. This time the differences between the HPDIs and QIs were trivial. Here’s a look at the posterior.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="sampling-the-imaginary.html#cb141-1" aria-hidden="true" tabindex="-1"></a>new_d <span class="sc">%&gt;%</span> </span>
<span id="cb141-2"><a href="sampling-the-imaginary.html#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p_grid)) <span class="sc">+</span></span>
<span id="cb141-3"><a href="sampling-the-imaginary.html#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> posterior)) <span class="sc">+</span></span>
<span id="cb141-4"><a href="sampling-the-imaginary.html#cb141-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Six waters in nine tosses made</span><span class="sc">\n</span><span class="st">for a more symmetrical posterior&quot;</span>,</span>
<span id="cb141-5"><a href="sampling-the-imaginary.html#cb141-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb141-6"><a href="sampling-the-imaginary.html#cb141-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>)</span></code></pre></div>
<p><img src="03_files/figure-html/unnamed-chunk-33-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>Be warned:</p>
<blockquote>
<p>The HPDI also has some disadvantages. HPDI is more computationally intensive than PI and suffers from greater <em>simulation variance</em>, which is a fancy way of saying that it is sensitive to how many samples you draw from the posterior. It is also harder to understand and many scientific audiences will not appreciate its features, while they will immediately understand a percentile interval, as ordinary non-Bayesian intervals are typically interpreted (incorrectly) as percentile intervals (pp. 57–58, <em>emphasis</em> in the original)</p>
</blockquote>
<p>For convenience, we’ll primarily stick to the PI-based intervals in this ebook.</p>
<div id="rethinking-what-do-compatibility-intervals-mean" class="section level4 hasAnchor" number="3.2.2.1">
<h4><span class="header-section-number">3.2.2.1</span> Rethinking: What do compatibility intervals mean?<a href="sampling-the-imaginary.html#rethinking-what-do-compatibility-intervals-mean" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>At the start of this section, McElreath poked a little at frequentist confidence intervals. For an introduction to confidence intervals from the perspective of a frequentist, you might check out Cumming’s <span class="citation">(<a href="#ref-cummingNewStatisticsWhy2014" role="doc-biblioref">2014</a>)</span> <a href="https://journals.sagepub.com/doi/pdf/10.1177/0956797613504966"><em>The new statistics: Why and how</em></a> and the works referenced therein. Though their definition isn’t the most intuitive, I usually use confidence intervals when I wear my frequentist hat.</p>
</div>
</div>
<div id="point-estimates." class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Point estimates.<a href="sampling-the-imaginary.html#point-estimates." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ve been calling point estimates measures of central tendency. If we <code>arrange()</code> our <code>d</code> tibble in descending order by <code>posterior</code>, we’ll see the corresponding <code>p_grid</code> value for its MAP estimate.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="sampling-the-imaginary.html#cb142-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb142-2"><a href="sampling-the-imaginary.html#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(posterior))</span></code></pre></div>
<pre><code>## # A tibble: 1,000 × 4
##    p_grid prior likelihood posterior
##     &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
##  1  1         1      1       0.00400
##  2  0.999     1      0.997   0.00398
##  3  0.998     1      0.994   0.00397
##  4  0.997     1      0.991   0.00396
##  5  0.996     1      0.988   0.00395
##  6  0.995     1      0.985   0.00394
##  7  0.994     1      0.982   0.00392
##  8  0.993     1      0.979   0.00391
##  9  0.992     1      0.976   0.00390
## 10  0.991     1      0.973   0.00389
## # … with 990 more rows</code></pre>
<p>To emphasize it, we can use <code>slice()</code> to select the top row.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="sampling-the-imaginary.html#cb144-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb144-2"><a href="sampling-the-imaginary.html#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(posterior)) <span class="sc">%&gt;%</span> </span>
<span id="cb144-3"><a href="sampling-the-imaginary.html#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   p_grid prior likelihood posterior
##    &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
## 1      1     1          1   0.00400</code></pre>
<p>We can get the mode with <code>mode_hdi()</code> or <code>mode_qi()</code>.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="sampling-the-imaginary.html#cb146-1" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span> <span class="fu">mode_hdi</span>(p_grid)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   p_grid .lower .upper .width .point .interval
##    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1  0.955  0.475      1   0.95 mode   hdi</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="sampling-the-imaginary.html#cb148-1" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span> <span class="fu">mode_qi</span>(p_grid)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##   p_grid .lower .upper .width .point .interval
##    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1  0.955  0.399  0.994   0.95 mode   qi</code></pre>
<p>Those returned a lot of output in addition to the mode. If all you want is the mode itself, you can just use <code>tidybayes::Mode()</code>.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="sampling-the-imaginary.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Mode</span>(samples<span class="sc">$</span>p_grid)</span></code></pre></div>
<pre><code>## [1] 0.955384</code></pre>
<p>Medians and means are typical measures of central tendency, too.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="sampling-the-imaginary.html#cb152-1" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span> </span>
<span id="cb152-2"><a href="sampling-the-imaginary.html#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean   =</span> <span class="fu">mean</span>(p_grid),</span>
<span id="cb152-3"><a href="sampling-the-imaginary.html#cb152-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">median =</span> <span class="fu">median</span>(p_grid))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##    mean median
##   &lt;dbl&gt;  &lt;dbl&gt;
## 1 0.803  0.843</code></pre>
<p>We can inspect the three types of point estimate in the left panel of Figure 3.4. First we’ll bundle the three point estimates together in a tibble.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="sampling-the-imaginary.html#cb154-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb154-2"><a href="sampling-the-imaginary.html#cb154-2" aria-hidden="true" tabindex="-1"></a>  point_estimates <span class="ot">&lt;-</span></span>
<span id="cb154-3"><a href="sampling-the-imaginary.html#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(samples <span class="sc">%&gt;%</span> <span class="fu">mean_qi</span>(p_grid),</span>
<span id="cb154-4"><a href="sampling-the-imaginary.html#cb154-4" aria-hidden="true" tabindex="-1"></a>            samples <span class="sc">%&gt;%</span> <span class="fu">median_qi</span>(p_grid),</span>
<span id="cb154-5"><a href="sampling-the-imaginary.html#cb154-5" aria-hidden="true" tabindex="-1"></a>            samples <span class="sc">%&gt;%</span> <span class="fu">mode_qi</span>(p_grid)) <span class="sc">%&gt;%</span> </span>
<span id="cb154-6"><a href="sampling-the-imaginary.html#cb154-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p_grid, .point) <span class="sc">%&gt;%</span> </span>
<span id="cb154-7"><a href="sampling-the-imaginary.html#cb154-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># these last two columns will help us annotate  </span></span>
<span id="cb154-8"><a href="sampling-the-imaginary.html#cb154-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">x =</span> p_grid <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span>.<span class="dv">03</span>, .<span class="dv">03</span>, <span class="sc">-</span>.<span class="dv">03</span>),</span>
<span id="cb154-9"><a href="sampling-the-imaginary.html#cb154-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">c</span>(.<span class="dv">0005</span>, .<span class="dv">0012</span>, .<span class="dv">002</span>))</span>
<span id="cb154-10"><a href="sampling-the-imaginary.html#cb154-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 4
##   p_grid .point     x      y
##    &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1  0.803 mean   0.773 0.0005
## 2  0.843 median 0.873 0.0012
## 3  0.955 mode   0.925 0.002</code></pre>
<p>Now plot.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="sampling-the-imaginary.html#cb156-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb156-2"><a href="sampling-the-imaginary.html#cb156-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p_grid)) <span class="sc">+</span></span>
<span id="cb156-3"><a href="sampling-the-imaginary.html#cb156-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="fu">aes</span>(<span class="at">y =</span> posterior),</span>
<span id="cb156-4"><a href="sampling-the-imaginary.html#cb156-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="st">&quot;grey75&quot;</span>) <span class="sc">+</span></span>
<span id="cb156-5"><a href="sampling-the-imaginary.html#cb156-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> point_estimates<span class="sc">$</span>p_grid) <span class="sc">+</span></span>
<span id="cb156-6"><a href="sampling-the-imaginary.html#cb156-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> point_estimates,</span>
<span id="cb156-7"><a href="sampling-the-imaginary.html#cb156-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> .point),</span>
<span id="cb156-8"><a href="sampling-the-imaginary.html#cb156-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">angle =</span> <span class="dv">90</span>) <span class="sc">+</span></span>
<span id="cb156-9"><a href="sampling-the-imaginary.html#cb156-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;proportion of water (p)&quot;</span>,</span>
<span id="cb156-10"><a href="sampling-the-imaginary.html#cb156-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;density&quot;</span>) <span class="sc">+</span></span>
<span id="cb156-11"><a href="sampling-the-imaginary.html#cb156-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="03_files/figure-html/unnamed-chunk-40-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>As it turns out “<em>different loss functions imply different point estimates</em>” (p. 59, <em>emphasis</em> in the original).</p>
<p>Let <span class="math inline">\(p\)</span> be the proportion of the Earth covered by water and <span class="math inline">\(d\)</span> be our guess. If McElreath pays us $100 if we guess exactly right but subtracts money from the prize proportional to how far off we are, then our loss is proportional to <span class="math inline">\(d - p\)</span>. If we decide <span class="math inline">\(d = .5\)</span>, we can compute our expected loss.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="sampling-the-imaginary.html#cb157-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb157-2"><a href="sampling-the-imaginary.html#cb157-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">expected loss</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(posterior <span class="sc">*</span> <span class="fu">abs</span>(<span class="fl">0.5</span> <span class="sc">-</span> p_grid)))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   `expected loss`
##             &lt;dbl&gt;
## 1           0.313</code></pre>
<p>What McElreath did with <code>sapply()</code>, we’ll do with <code>purrr::map()</code>. If you haven’t used it, <code>map()</code> is part of a family of similarly-named functions (e.g., <code>map2()</code>) from the <a href="https://purrr.tidyverse.org"><strong>purrr</strong> package</a> <span class="citation">(<a href="#ref-R-purrr" role="doc-biblioref">Henry &amp; Wickham, 2020</a>)</span>, which is itself part of the <a href="https://www.tidyverse.org"><strong>tidyverse</strong></a>. The <code>map()</code> family is the <strong>tidyverse</strong> alternative to the family of <code>apply()</code> functions from the base <strong>R</strong> framework. You can learn more about how to use the <code>map()</code> family <a href="https://purrr.tidyverse.org/reference/map.html">here</a> or <a href="https://jennybc.github.io/purrr-tutorial/ls01_map-name-position-shortcuts.html">here</a> or <a href="https://data.library.virginia.edu/getting-started-with-the-purrr-package-in-r/">here</a>.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="sampling-the-imaginary.html#cb159-1" aria-hidden="true" tabindex="-1"></a>make_loss <span class="ot">&lt;-</span> <span class="cf">function</span>(our_d) {</span>
<span id="cb159-2"><a href="sampling-the-imaginary.html#cb159-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb159-3"><a href="sampling-the-imaginary.html#cb159-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">loss =</span> posterior <span class="sc">*</span> <span class="fu">abs</span>(our_d <span class="sc">-</span> p_grid)) <span class="sc">%&gt;%</span> </span>
<span id="cb159-4"><a href="sampling-the-imaginary.html#cb159-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weighted_average_loss =</span> <span class="fu">sum</span>(loss))</span>
<span id="cb159-5"><a href="sampling-the-imaginary.html#cb159-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb159-6"><a href="sampling-the-imaginary.html#cb159-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-7"><a href="sampling-the-imaginary.html#cb159-7" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb159-8"><a href="sampling-the-imaginary.html#cb159-8" aria-hidden="true" tabindex="-1"></a>  l <span class="ot">&lt;-</span></span>
<span id="cb159-9"><a href="sampling-the-imaginary.html#cb159-9" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb159-10"><a href="sampling-the-imaginary.html#cb159-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p_grid) <span class="sc">%&gt;%</span> </span>
<span id="cb159-11"><a href="sampling-the-imaginary.html#cb159-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">decision =</span> p_grid) <span class="sc">%&gt;%</span> </span>
<span id="cb159-12"><a href="sampling-the-imaginary.html#cb159-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weighted_average_loss =</span> purrr<span class="sc">::</span><span class="fu">map</span>(decision, make_loss)) <span class="sc">%&gt;%</span> </span>
<span id="cb159-13"><a href="sampling-the-imaginary.html#cb159-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(weighted_average_loss) </span>
<span id="cb159-14"><a href="sampling-the-imaginary.html#cb159-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 1,000 × 2
##    decision weighted_average_loss
##       &lt;dbl&gt;                 &lt;dbl&gt;
##  1  0                       0.800
##  2  0.00100                 0.799
##  3  0.00200                 0.798
##  4  0.00300                 0.797
##  5  0.00400                 0.796
##  6  0.00501                 0.795
##  7  0.00601                 0.794
##  8  0.00701                 0.793
##  9  0.00801                 0.792
## 10  0.00901                 0.791
## # … with 990 more rows</code></pre>
<p>Now we’re ready for the right panel of Figure 3.4.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="sampling-the-imaginary.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this will help us find the x and y coordinates for the minimum value</span></span>
<span id="cb161-2"><a href="sampling-the-imaginary.html#cb161-2" aria-hidden="true" tabindex="-1"></a>min_loss <span class="ot">&lt;-</span></span>
<span id="cb161-3"><a href="sampling-the-imaginary.html#cb161-3" aria-hidden="true" tabindex="-1"></a>  l <span class="sc">%&gt;%</span> </span>
<span id="cb161-4"><a href="sampling-the-imaginary.html#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(weighted_average_loss <span class="sc">==</span> <span class="fu">min</span>(weighted_average_loss)) <span class="sc">%&gt;%</span> </span>
<span id="cb161-5"><a href="sampling-the-imaginary.html#cb161-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb161-6"><a href="sampling-the-imaginary.html#cb161-6" aria-hidden="true" tabindex="-1"></a><span class="co"># the plot</span></span>
<span id="cb161-7"><a href="sampling-the-imaginary.html#cb161-7" aria-hidden="true" tabindex="-1"></a>l <span class="sc">%&gt;%</span>   </span>
<span id="cb161-8"><a href="sampling-the-imaginary.html#cb161-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> decision, <span class="at">y =</span> weighted_average_loss)) <span class="sc">+</span></span>
<span id="cb161-9"><a href="sampling-the-imaginary.html#cb161-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="st">&quot;grey75&quot;</span>) <span class="sc">+</span></span>
<span id="cb161-10"><a href="sampling-the-imaginary.html#cb161-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> min_loss[<span class="dv">1</span>], <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb161-11"><a href="sampling-the-imaginary.html#cb161-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> min_loss[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb161-12"><a href="sampling-the-imaginary.html#cb161-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;expected proportional loss&quot;</span>) <span class="sc">+</span></span>
<span id="cb161-13"><a href="sampling-the-imaginary.html#cb161-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="03_files/figure-html/unnamed-chunk-43-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>We saved the exact minimum value as <code>min_loss[1]</code>, which is 0.8408408. Within sampling error, this is the posterior median as depicted by our <code>samples</code>.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="sampling-the-imaginary.html#cb162-1" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span> </span>
<span id="cb162-2"><a href="sampling-the-imaginary.html#cb162-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">posterior_median =</span> <span class="fu">median</span>(p_grid))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   posterior_median
##              &lt;dbl&gt;
## 1            0.843</code></pre>
<p>The quadratic loss <span class="math inline">\((d - p)^2\)</span> suggests we should use the mean instead. Let’s investigate.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="sampling-the-imaginary.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># amend our loss function</span></span>
<span id="cb164-2"><a href="sampling-the-imaginary.html#cb164-2" aria-hidden="true" tabindex="-1"></a>make_loss <span class="ot">&lt;-</span> <span class="cf">function</span>(our_d) {</span>
<span id="cb164-3"><a href="sampling-the-imaginary.html#cb164-3" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb164-4"><a href="sampling-the-imaginary.html#cb164-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">loss =</span> posterior <span class="sc">*</span> (our_d <span class="sc">-</span> p_grid)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb164-5"><a href="sampling-the-imaginary.html#cb164-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">weighted_average_loss =</span> <span class="fu">sum</span>(loss))</span>
<span id="cb164-6"><a href="sampling-the-imaginary.html#cb164-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb164-7"><a href="sampling-the-imaginary.html#cb164-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-8"><a href="sampling-the-imaginary.html#cb164-8" aria-hidden="true" tabindex="-1"></a><span class="co"># remake our `l` data</span></span>
<span id="cb164-9"><a href="sampling-the-imaginary.html#cb164-9" aria-hidden="true" tabindex="-1"></a>l <span class="ot">&lt;-</span></span>
<span id="cb164-10"><a href="sampling-the-imaginary.html#cb164-10" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb164-11"><a href="sampling-the-imaginary.html#cb164-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(p_grid) <span class="sc">%&gt;%</span> </span>
<span id="cb164-12"><a href="sampling-the-imaginary.html#cb164-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">decision =</span> p_grid) <span class="sc">%&gt;%</span> </span>
<span id="cb164-13"><a href="sampling-the-imaginary.html#cb164-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weighted_average_loss =</span> purrr<span class="sc">::</span><span class="fu">map</span>(decision, make_loss)) <span class="sc">%&gt;%</span> </span>
<span id="cb164-14"><a href="sampling-the-imaginary.html#cb164-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(weighted_average_loss)</span>
<span id="cb164-15"><a href="sampling-the-imaginary.html#cb164-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-16"><a href="sampling-the-imaginary.html#cb164-16" aria-hidden="true" tabindex="-1"></a><span class="co"># update to the new minimum loss coordinates</span></span>
<span id="cb164-17"><a href="sampling-the-imaginary.html#cb164-17" aria-hidden="true" tabindex="-1"></a>min_loss <span class="ot">&lt;-</span></span>
<span id="cb164-18"><a href="sampling-the-imaginary.html#cb164-18" aria-hidden="true" tabindex="-1"></a>  l <span class="sc">%&gt;%</span> </span>
<span id="cb164-19"><a href="sampling-the-imaginary.html#cb164-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(weighted_average_loss <span class="sc">==</span> <span class="fu">min</span>(weighted_average_loss)) <span class="sc">%&gt;%</span> </span>
<span id="cb164-20"><a href="sampling-the-imaginary.html#cb164-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb164-21"><a href="sampling-the-imaginary.html#cb164-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-22"><a href="sampling-the-imaginary.html#cb164-22" aria-hidden="true" tabindex="-1"></a><span class="co"># update the plot</span></span>
<span id="cb164-23"><a href="sampling-the-imaginary.html#cb164-23" aria-hidden="true" tabindex="-1"></a>l <span class="sc">%&gt;%</span>   </span>
<span id="cb164-24"><a href="sampling-the-imaginary.html#cb164-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> decision, <span class="at">y =</span> weighted_average_loss)) <span class="sc">+</span></span>
<span id="cb164-25"><a href="sampling-the-imaginary.html#cb164-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">fill =</span> <span class="st">&quot;grey75&quot;</span>) <span class="sc">+</span></span>
<span id="cb164-26"><a href="sampling-the-imaginary.html#cb164-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> min_loss[<span class="dv">1</span>], <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb164-27"><a href="sampling-the-imaginary.html#cb164-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> min_loss[<span class="dv">2</span>], <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">linetype =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb164-28"><a href="sampling-the-imaginary.html#cb164-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;expected proportional loss&quot;</span>) <span class="sc">+</span></span>
<span id="cb164-29"><a href="sampling-the-imaginary.html#cb164-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="03_files/figure-html/unnamed-chunk-45-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>Based on quadratic loss <span class="math inline">\((d - p)^2\)</span>, the exact minimum value is 0.8008008. Within sampling error, this is the posterior mean of our <code>samples</code>.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="sampling-the-imaginary.html#cb165-1" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span> </span>
<span id="cb165-2"><a href="sampling-the-imaginary.html#cb165-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">posterior_meaan =</span> <span class="fu">mean</span>(p_grid))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   posterior_meaan
##             &lt;dbl&gt;
## 1           0.803</code></pre>
<blockquote>
<p>Usually, research scientists don’t think about loss functions. And so any point estimate like the mean or MAP that they may report isn’t intended to support any particular decision, but rather to describe the shape of the posterior. You might argue that the decision to make is whether or not to accept an hypothesis. But the challenge then is to say what the relevant costs and benefits would be, in terms of the knowledge gained or lost. Usually it’s better to communicate as much as you can about the posterior distribution, as well as the data and the model itself, so that others can build upon your work. Premature decisions to accept or reject hypotheses can cost lives. (p. 61)</p>
</blockquote>
<p>In the endnote (62) linked to the end of that quote in the text, McElreath wrote: “See <span class="citation">Hauer (<a href="#ref-hauerHarmDoneTests2004" role="doc-biblioref">2004</a>)</span> for three tales from transportation safety in which testing resulted in premature incorrect decisions and a demonstrable and continuing loss of human life” (p. 561).</p>
</div>
</div>
<div id="sampling-to-simulate-prediction" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Sampling to simulate prediction<a href="sampling-the-imaginary.html#sampling-to-simulate-prediction" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>McElreath’s five good reasons for simulation were</p>
<ol style="list-style-type: decimal">
<li>model design</li>
<li>model checking,</li>
<li>software validation,</li>
<li>research design, and</li>
<li>forecasting.</li>
</ol>
<div id="dummy-data." class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Dummy data.<a href="sampling-the-imaginary.html#dummy-data." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dummy data for the globe tossing model arise from the binomial likelihood. If you let <span class="math inline">\(w\)</span> be a count of water and <span class="math inline">\(n\)</span> be the number of tosses, the binomial likelihood is</p>
<p><span class="math display">\[\operatorname{Pr} (w|n, p) = \frac{n!}{w!(n - w)!} p^w (1 - p)^{n - w}.\]</span></p>
<p>Letting <span class="math inline">\(n = 2\)</span>, <span class="math inline">\(p(w) = .7\)</span>, and <span class="math inline">\(w_\text{observed} = 0 \text{ through }2\)</span>, the densities are:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="sampling-the-imaginary.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">n      =</span> <span class="dv">2</span>,</span>
<span id="cb167-2"><a href="sampling-the-imaginary.html#cb167-2" aria-hidden="true" tabindex="-1"></a>       <span class="st">`</span><span class="at">p(w)</span><span class="st">`</span> <span class="ot">=</span> .<span class="dv">7</span>,</span>
<span id="cb167-3"><a href="sampling-the-imaginary.html#cb167-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">w      =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb167-4"><a href="sampling-the-imaginary.html#cb167-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">density =</span> <span class="fu">dbinom</span>(w, <span class="at">size =</span> n, <span class="at">prob =</span> <span class="st">`</span><span class="at">p(w)</span><span class="st">`</span>))</span></code></pre></div>
<pre><code>## # A tibble: 3 × 4
##       n `p(w)`     w density
##   &lt;dbl&gt;  &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
## 1     2    0.7     0    0.09
## 2     2    0.7     1    0.42
## 3     2    0.7     2    0.49</code></pre>
<p>If we’re going to simulate, we should probably <a href="https://stackoverflow.com/questions/13605271/reasons-for-using-the-set-seed-function">set our seed</a>. Doing so makes the results reproducible.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="sampling-the-imaginary.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb169-2"><a href="sampling-the-imaginary.html#cb169-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-3"><a href="sampling-the-imaginary.html#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">prob =</span> .<span class="dv">7</span>)</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>Here are ten reproducible draws.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="sampling-the-imaginary.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb171-2"><a href="sampling-the-imaginary.html#cb171-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-3"><a href="sampling-the-imaginary.html#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">10</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">prob =</span> .<span class="dv">7</span>)</span></code></pre></div>
<pre><code>##  [1] 2 1 2 2 1 1 2 2 1 1</code></pre>
<p>Now generate 100,000 (i.e., <code>1e5</code>) reproducible dummy observations.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="sampling-the-imaginary.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many would you like?</span></span>
<span id="cb173-2"><a href="sampling-the-imaginary.html#cb173-2" aria-hidden="true" tabindex="-1"></a>n_draws <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb173-3"><a href="sampling-the-imaginary.html#cb173-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-4"><a href="sampling-the-imaginary.html#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb173-5"><a href="sampling-the-imaginary.html#cb173-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-6"><a href="sampling-the-imaginary.html#cb173-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">draws =</span> <span class="fu">rbinom</span>(n_draws, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">prob =</span> .<span class="dv">7</span>))</span>
<span id="cb173-7"><a href="sampling-the-imaginary.html#cb173-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-8"><a href="sampling-the-imaginary.html#cb173-8" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb173-9"><a href="sampling-the-imaginary.html#cb173-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(draws) <span class="sc">%&gt;%</span> </span>
<span id="cb173-10"><a href="sampling-the-imaginary.html#cb173-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">proportion =</span> n <span class="sc">/</span> <span class="fu">nrow</span>(d))</span></code></pre></div>
<pre><code>## # A tibble: 3 × 3
##   draws     n proportion
##   &lt;int&gt; &lt;int&gt;      &lt;dbl&gt;
## 1     0  9000      0.09 
## 2     1 42051      0.421
## 3     2 48949      0.489</code></pre>
<p>As McElreath mused in the text (p. 63), those simulated <code>proportion</code> values are very close to the analytically calculated values in our <code>density</code> column a few code blocks up.</p>
<p>Here’s the simulation updated so <span class="math inline">\(n = 9\)</span>, which we plot in our version of Figure 3.5.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="sampling-the-imaginary.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb175-2"><a href="sampling-the-imaginary.html#cb175-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">draws =</span> <span class="fu">rbinom</span>(n_draws, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> .<span class="dv">7</span>))</span>
<span id="cb175-3"><a href="sampling-the-imaginary.html#cb175-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-4"><a href="sampling-the-imaginary.html#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="co"># the histogram</span></span>
<span id="cb175-5"><a href="sampling-the-imaginary.html#cb175-5" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb175-6"><a href="sampling-the-imaginary.html#cb175-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> draws)) <span class="sc">+</span></span>
<span id="cb175-7"><a href="sampling-the-imaginary.html#cb175-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">center =</span> <span class="dv">0</span>,</span>
<span id="cb175-8"><a href="sampling-the-imaginary.html#cb175-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb175-9"><a href="sampling-the-imaginary.html#cb175-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;dummy water count&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb175-10"><a href="sampling-the-imaginary.html#cb175-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb175-11"><a href="sampling-the-imaginary.html#cb175-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb175-12"><a href="sampling-the-imaginary.html#cb175-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="03_files/figure-html/unnamed-chunk-51-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>McElreath suggested we play around with different values of <code>size</code> and <code>prob</code>. With the next block of code, we’ll simulate nine conditions.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="sampling-the-imaginary.html#cb176-1" aria-hidden="true" tabindex="-1"></a>n_draws <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb176-2"><a href="sampling-the-imaginary.html#cb176-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-3"><a href="sampling-the-imaginary.html#cb176-3" aria-hidden="true" tabindex="-1"></a>simulate_binom <span class="ot">&lt;-</span> <span class="cf">function</span>(n, probability) {</span>
<span id="cb176-4"><a href="sampling-the-imaginary.html#cb176-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb176-5"><a href="sampling-the-imaginary.html#cb176-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbinom</span>(n_draws, <span class="at">size =</span> n, <span class="at">prob =</span> probability) </span>
<span id="cb176-6"><a href="sampling-the-imaginary.html#cb176-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb176-7"><a href="sampling-the-imaginary.html#cb176-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-8"><a href="sampling-the-imaginary.html#cb176-8" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span></span>
<span id="cb176-9"><a href="sampling-the-imaginary.html#cb176-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">n           =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">9</span>),</span>
<span id="cb176-10"><a href="sampling-the-imaginary.html#cb176-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">probability =</span> <span class="fu">c</span>(.<span class="dv">3</span>, .<span class="dv">6</span>, .<span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb176-11"><a href="sampling-the-imaginary.html#cb176-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">draws =</span> <span class="fu">map2</span>(n, probability, simulate_binom)) <span class="sc">%&gt;%</span> </span>
<span id="cb176-12"><a href="sampling-the-imaginary.html#cb176-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb176-13"><a href="sampling-the-imaginary.html#cb176-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n           =</span> <span class="fu">str_c</span>(<span class="st">&quot;n = &quot;</span>, n),</span>
<span id="cb176-14"><a href="sampling-the-imaginary.html#cb176-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">probability =</span> <span class="fu">str_c</span>(<span class="st">&quot;p = &quot;</span>, probability)) <span class="sc">%&gt;%</span> </span>
<span id="cb176-15"><a href="sampling-the-imaginary.html#cb176-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(draws)</span>
<span id="cb176-16"><a href="sampling-the-imaginary.html#cb176-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-17"><a href="sampling-the-imaginary.html#cb176-17" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   n     probability draws
##   &lt;chr&gt; &lt;chr&gt;       &lt;int&gt;
## 1 n = 3 p = 0.3         0
## 2 n = 3 p = 0.3         2
## 3 n = 3 p = 0.3         1
## 4 n = 3 p = 0.3         0
## 5 n = 3 p = 0.3         1
## 6 n = 3 p = 0.3         1</code></pre>
<p>Let’s plot the simulation results.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="sampling-the-imaginary.html#cb178-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb178-2"><a href="sampling-the-imaginary.html#cb178-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> draws)) <span class="sc">+</span></span>
<span id="cb178-3"><a href="sampling-the-imaginary.html#cb178-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">center =</span> <span class="dv">0</span>,</span>
<span id="cb178-4"><a href="sampling-the-imaginary.html#cb178-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb178-5"><a href="sampling-the-imaginary.html#cb178-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;dummy water count&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span> <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb178-6"><a href="sampling-the-imaginary.html#cb178-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb178-7"><a href="sampling-the-imaginary.html#cb178-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb178-8"><a href="sampling-the-imaginary.html#cb178-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb178-9"><a href="sampling-the-imaginary.html#cb178-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(n <span class="sc">~</span> probability)</span></code></pre></div>
<p><img src="03_files/figure-html/unnamed-chunk-53-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="model-checking." class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Model checking.<a href="sampling-the-imaginary.html#model-checking." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you’re new to applied statistics, you might be surprised how often mistakes arise.</p>
<div id="did-the-software-work" class="section level4 hasAnchor" number="3.3.2.1">
<h4><span class="header-section-number">3.3.2.1</span> Did the software work?<a href="sampling-the-imaginary.html#did-the-software-work" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let this haunt your dreams: “There is no way to really be sure that software works correctly” (p. 64).</p>
<p>If you’d like to dive deeper into these dark waters, check out one my favorite talks from StanCon 2018, <a href="https://youtu.be/pKZLJPrZLhU?t=26285"><em>Esther Williams in the Harold Holt Memorial Swimming Pool</em></a>, by the ineffable <a href="https://twitter.com/dan_p_simpson">Dan Simpson</a>. If Simpson doesn’t end up drowning you, see Gabry and Simpson’s talk at the Royal Statistical Society 2018, <a href="https://youtu.be/E8vdXoJId8M"><em>Visualization in Bayesian workflow</em></a>, a follow-up blog called <a href="https://statmodeling.stat.columbia.edu/2019/03/19/maybe-its-time-to-let-the-old-ways-die-or-we-broke-r-hat-so-now-we-have-to-fix-it/"><em>Maybe it’s time to let the old ways die; or We broke R-hat so now we have to fix it</em></a>, and that blog’s associated pre-print by <span class="citation">Vehtari et al. (<a href="#ref-vehtariRanknormalizationFoldingLocalization2019" role="doc-biblioref">2019</a>)</span>, <a href="https://arxiv.org/abs/1903.08008"><em>Rank-normalization, folding, and localization: An improved <span class="math inline">\(\widehat R\)</span> for assessing convergence of MCMC</em></a>.</p>
</div>
<div id="is-the-model-adequate" class="section level4 hasAnchor" number="3.3.2.2">
<h4><span class="header-section-number">3.3.2.2</span> Is the model adequate?<a href="sampling-the-imaginary.html#is-the-model-adequate" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<blockquote>
<p>The implied predictions of the model are uncertain in two ways, and it’s important to be aware of both.</p>
<p>First, there is observation uncertainty. For any unique value of the parameter <span class="math inline">\(p\)</span>, there is a unique implied pattern of observations that the model expects. These patterns of observations are the same gardens of forking data that you explored in the previous chapter. These patterns are also what you sampled in the previous section. There is uncertainty in the predicted observations, because even if you know <span class="math inline">\(p\)</span> with certainty, you won’t know the next globe toss with certainty (unless <span class="math inline">\(p = 0\)</span> or <span class="math inline">\(p = 1\)</span>).</p>
<p>Second, there is uncertainty about <span class="math inline">\(p\)</span>. The posterior distribution over <span class="math inline">\(p\)</span> embodies this uncertainty. And since there is uncertainty about <span class="math inline">\(p\)</span>, there is uncertainty about everything that depends upon <span class="math inline">\(p\)</span>. The uncertainty in <span class="math inline">\(p\)</span> will interact with the sampling variation, when we try to assess what the model tells us about outcomes.</p>
<p>We’d like to <em>propagate</em> the parameter uncertainty–carry it forward–as we evaluate the implied predictions. All that is required is averaging over the posterior density for <span class="math inline">\(p\)</span>, while computing the predictions. For each possible value of the parameter <span class="math inline">\(p\)</span>, there is an implied distribution of outcomes. So if you were to compute the sampling distribution of outcomes at each value of <span class="math inline">\(p\)</span>, then you could average all of these prediction distributions together, using the posterior probabilities of each value of <span class="math inline">\(p\)</span>, to get a <strong>posterior predictive distribution</strong>. (pp. 64–65, <em>emphasis</em> in the original)</p>
</blockquote>
<p>All this is depicted in Figure 3.6. To get ready to make our version, let’s first refresh our original grid approximation <code>d</code>.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="sampling-the-imaginary.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many grid points would you like?</span></span>
<span id="cb179-2"><a href="sampling-the-imaginary.html#cb179-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1001</span></span>
<span id="cb179-3"><a href="sampling-the-imaginary.html#cb179-3" aria-hidden="true" tabindex="-1"></a>n_success <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb179-4"><a href="sampling-the-imaginary.html#cb179-4" aria-hidden="true" tabindex="-1"></a>n_trials  <span class="ot">&lt;-</span> <span class="dv">9</span></span>
<span id="cb179-5"><a href="sampling-the-imaginary.html#cb179-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-6"><a href="sampling-the-imaginary.html#cb179-6" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb179-7"><a href="sampling-the-imaginary.html#cb179-7" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span></span>
<span id="cb179-8"><a href="sampling-the-imaginary.html#cb179-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">p_grid =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> n),</span>
<span id="cb179-9"><a href="sampling-the-imaginary.html#cb179-9" aria-hidden="true" tabindex="-1"></a>         <span class="co"># note we&#39;re still using a flat uniform prior</span></span>
<span id="cb179-10"><a href="sampling-the-imaginary.html#cb179-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">prior  =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb179-11"><a href="sampling-the-imaginary.html#cb179-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">likelihood =</span> <span class="fu">dbinom</span>(n_success, <span class="at">size =</span> n_trials, <span class="at">prob =</span> p_grid)) <span class="sc">%&gt;%</span> </span>
<span id="cb179-12"><a href="sampling-the-imaginary.html#cb179-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">posterior =</span> (likelihood <span class="sc">*</span> prior) <span class="sc">/</span> <span class="fu">sum</span>(likelihood <span class="sc">*</span> prior))</span>
<span id="cb179-13"><a href="sampling-the-imaginary.html#cb179-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 1,001 × 4
##    p_grid prior likelihood posterior
##     &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
##  1  0         1   0         0       
##  2  0.001     1   8.37e-17  8.37e-19
##  3  0.002     1   5.34e-15  5.34e-17
##  4  0.003     1   6.07e-14  6.07e-16
##  5  0.004     1   3.40e-13  3.40e-15
##  6  0.005     1   1.29e-12  1.29e-14
##  7  0.006     1   3.85e-12  3.85e-14
##  8  0.007     1   9.68e-12  9.68e-14
##  9  0.008     1   2.15e-11  2.15e-13
## 10  0.009     1   4.34e-11  4.34e-13
## # … with 991 more rows</code></pre>
<p>We can make our version of the top of Figure 3.6 with a little tricky <code>filter</code>ing.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="sampling-the-imaginary.html#cb181-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> </span>
<span id="cb181-2"><a href="sampling-the-imaginary.html#cb181-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p_grid, <span class="at">y =</span> posterior)) <span class="sc">+</span></span>
<span id="cb181-3"><a href="sampling-the-imaginary.html#cb181-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">color =</span> <span class="st">&quot;grey67&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="sc">+</span></span>
<span id="cb181-4"><a href="sampling-the-imaginary.html#cb181-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span> </span>
<span id="cb181-5"><a href="sampling-the-imaginary.html#cb181-5" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">filter</span>(p_grid <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="at">from =</span> .<span class="dv">1</span>, <span class="at">to =</span> .<span class="dv">9</span>, <span class="at">by =</span> .<span class="dv">1</span>), <span class="dv">3</span> <span class="sc">/</span> <span class="dv">10</span>)),</span>
<span id="cb181-6"><a href="sampling-the-imaginary.html#cb181-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">xend =</span> p_grid, <span class="at">yend =</span> <span class="dv">0</span>, <span class="at">size =</span> posterior),</span>
<span id="cb181-7"><a href="sampling-the-imaginary.html#cb181-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;grey33&quot;</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb181-8"><a href="sampling-the-imaginary.html#cb181-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> . <span class="sc">%&gt;%</span></span>
<span id="cb181-9"><a href="sampling-the-imaginary.html#cb181-9" aria-hidden="true" tabindex="-1"></a>               <span class="fu">filter</span>(p_grid <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="at">from =</span> .<span class="dv">1</span>, <span class="at">to =</span> .<span class="dv">9</span>, <span class="at">by =</span> .<span class="dv">1</span>), <span class="dv">3</span> <span class="sc">/</span> <span class="dv">10</span>))) <span class="sc">+</span></span>
<span id="cb181-10"><a href="sampling-the-imaginary.html#cb181-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, </span>
<span id="cb181-11"><a href="sampling-the-imaginary.html#cb181-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> .<span class="dv">08</span>, <span class="at">y =</span> .<span class="dv">0025</span>,</span>
<span id="cb181-12"><a href="sampling-the-imaginary.html#cb181-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;Posterior probability&quot;</span>) <span class="sc">+</span></span>
<span id="cb181-13"><a href="sampling-the-imaginary.html#cb181-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb181-14"><a href="sampling-the-imaginary.html#cb181-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;probability of water&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span> <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb181-15"><a href="sampling-the-imaginary.html#cb181-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb181-16"><a href="sampling-the-imaginary.html#cb181-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="03_files/figure-html/unnamed-chunk-55-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Note how we weighted the widths of the vertical lines by the <code>posterior</code> density.</p>
<p>We’ll need to do a bit of wrangling before we’re ready to make the plot in the middle panel of Figure 3.6.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="sampling-the-imaginary.html#cb182-1" aria-hidden="true" tabindex="-1"></a>n_draws <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb182-2"><a href="sampling-the-imaginary.html#cb182-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-3"><a href="sampling-the-imaginary.html#cb182-3" aria-hidden="true" tabindex="-1"></a>simulate_binom <span class="ot">&lt;-</span> <span class="cf">function</span>(probability) {</span>
<span id="cb182-4"><a href="sampling-the-imaginary.html#cb182-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb182-5"><a href="sampling-the-imaginary.html#cb182-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbinom</span>(n_draws, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> probability) </span>
<span id="cb182-6"><a href="sampling-the-imaginary.html#cb182-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb182-7"><a href="sampling-the-imaginary.html#cb182-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-8"><a href="sampling-the-imaginary.html#cb182-8" aria-hidden="true" tabindex="-1"></a>d_small <span class="ot">&lt;-</span></span>
<span id="cb182-9"><a href="sampling-the-imaginary.html#cb182-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">probability =</span> <span class="fu">seq</span>(<span class="at">from =</span> .<span class="dv">1</span>, <span class="at">to =</span> .<span class="dv">9</span>, <span class="at">by =</span> .<span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb182-10"><a href="sampling-the-imaginary.html#cb182-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">draws =</span> purrr<span class="sc">::</span><span class="fu">map</span>(probability, simulate_binom)) <span class="sc">%&gt;%</span> </span>
<span id="cb182-11"><a href="sampling-the-imaginary.html#cb182-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(draws) <span class="sc">%&gt;%</span> </span>
<span id="cb182-12"><a href="sampling-the-imaginary.html#cb182-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">label =</span> <span class="fu">str_c</span>(<span class="st">&quot;p = &quot;</span>, probability))</span>
<span id="cb182-13"><a href="sampling-the-imaginary.html#cb182-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-14"><a href="sampling-the-imaginary.html#cb182-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d_small)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   probability draws label  
##         &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;  
## 1         0.1     0 p = 0.1
## 2         0.1     2 p = 0.1
## 3         0.1     0 p = 0.1
## 4         0.1     0 p = 0.1
## 5         0.1     1 p = 0.1
## 6         0.1     1 p = 0.1</code></pre>
<p>Now we’re ready to plot.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="sampling-the-imaginary.html#cb184-1" aria-hidden="true" tabindex="-1"></a>d_small <span class="sc">%&gt;%</span></span>
<span id="cb184-2"><a href="sampling-the-imaginary.html#cb184-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> draws)) <span class="sc">+</span></span>
<span id="cb184-3"><a href="sampling-the-imaginary.html#cb184-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">center =</span> <span class="dv">0</span>,</span>
<span id="cb184-4"><a href="sampling-the-imaginary.html#cb184-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb184-5"><a href="sampling-the-imaginary.html#cb184-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">*</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb184-6"><a href="sampling-the-imaginary.html#cb184-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb184-7"><a href="sampling-the-imaginary.html#cb184-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Sampling distributions&quot;</span>) <span class="sc">+</span></span>
<span id="cb184-8"><a href="sampling-the-imaginary.html#cb184-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb184-9"><a href="sampling-the-imaginary.html#cb184-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb184-10"><a href="sampling-the-imaginary.html#cb184-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> label, <span class="at">ncol =</span> <span class="dv">9</span>) </span></code></pre></div>
<p><img src="03_files/figure-html/unnamed-chunk-57-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>To make the plot at the bottom of Figure 3.6, we’ll redefine our <code>samples</code>, this time including the <code>w</code> variable (see the <strong>R</strong> code 3.26 block in the text).</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="sampling-the-imaginary.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># how many samples would you like?</span></span>
<span id="cb185-2"><a href="sampling-the-imaginary.html#cb185-2" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb185-3"><a href="sampling-the-imaginary.html#cb185-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-4"><a href="sampling-the-imaginary.html#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="co"># make it reproducible</span></span>
<span id="cb185-5"><a href="sampling-the-imaginary.html#cb185-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb185-6"><a href="sampling-the-imaginary.html#cb185-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-7"><a href="sampling-the-imaginary.html#cb185-7" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span></span>
<span id="cb185-8"><a href="sampling-the-imaginary.html#cb185-8" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> </span>
<span id="cb185-9"><a href="sampling-the-imaginary.html#cb185-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> n_samples, <span class="at">weight_by =</span> posterior, <span class="at">replace =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb185-10"><a href="sampling-the-imaginary.html#cb185-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">w =</span> purrr<span class="sc">::</span><span class="fu">map_dbl</span>(p_grid, rbinom, <span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">9</span>))</span>
<span id="cb185-11"><a href="sampling-the-imaginary.html#cb185-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-12"><a href="sampling-the-imaginary.html#cb185-12" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(samples)</span></code></pre></div>
<pre><code>## Rows: 10,000
## Columns: 5
## $ p_grid     &lt;dbl&gt; 0.564, 0.651, 0.487, 0.592, 0.596, 0.787, 0.727, 0.490, 0.751, 0.449, 0.619, 0.…
## $ prior      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ likelihood &lt;dbl&gt; 0.224085305, 0.271795022, 0.151288232, 0.245578315, 0.248256678, 0.192870804, 0…
## $ posterior  &lt;dbl&gt; 2.240853e-03, 2.717950e-03, 1.512882e-03, 2.455783e-03, 2.482567e-03, 1.928708e…
## $ w          &lt;dbl&gt; 4, 7, 3, 3, 7, 6, 8, 2, 6, 4, 5, 5, 8, 6, 4, 6, 8, 2, 6, 9, 9, 7, 4, 8, 9, 8, 6…</code></pre>
<p>Here’s our histogram.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="sampling-the-imaginary.html#cb187-1" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span> </span>
<span id="cb187-2"><a href="sampling-the-imaginary.html#cb187-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> w)) <span class="sc">+</span></span>
<span id="cb187-3"><a href="sampling-the-imaginary.html#cb187-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">center =</span> <span class="dv">0</span>,</span>
<span id="cb187-4"><a href="sampling-the-imaginary.html#cb187-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb187-5"><a href="sampling-the-imaginary.html#cb187-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;number of water samples&quot;</span>,</span>
<span id="cb187-6"><a href="sampling-the-imaginary.html#cb187-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">*</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb187-7"><a href="sampling-the-imaginary.html#cb187-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb187-8"><a href="sampling-the-imaginary.html#cb187-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Posterior predictive distribution&quot;</span>) <span class="sc">+</span></span>
<span id="cb187-9"><a href="sampling-the-imaginary.html#cb187-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>),</span>
<span id="cb187-10"><a href="sampling-the-imaginary.html#cb187-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3000</span>)) <span class="sc">+</span></span>
<span id="cb187-11"><a href="sampling-the-imaginary.html#cb187-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="03_files/figure-html/unnamed-chunk-59-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>In Figure 3.7, McElreath considered the longest sequence of the sample values. We’ve been using <code>rbinom()</code> with the size parameter set to 9 for our simulations. E.g.,</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="sampling-the-imaginary.html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">10</span>, <span class="at">size =</span> <span class="dv">9</span>, <span class="at">prob =</span> .<span class="dv">6</span>)</span></code></pre></div>
<pre><code>##  [1] 7 5 6 8 7 5 6 3 3 4</code></pre>
<p>Notice this collapsed (i.e., aggregated) over the sequences within the individual sets of 9. What we need is to simulate nine individual trials many times over. For example, this</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="sampling-the-imaginary.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbinom</span>(<span class="dv">9</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> .<span class="dv">6</span>)</span></code></pre></div>
<pre><code>## [1] 0 1 1 1 0 0 0 0 0</code></pre>
<p>would be the disaggregated version of just one of the numerals returned by <code>rbinom()</code> when <code>size = 9</code>. So let’s try simulating again with un-aggregated samples. We’ll keep adding to our <code>samples</code> tibble. In addition to the disaggregated <code>draws</code> based on the <span class="math inline">\(p\)</span> values listed in <code>p_grid</code>, we’ll also want to add a row index for each of those <code>p_grid</code> values–it’ll come in handy when we plot.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="sampling-the-imaginary.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make it reproducible</span></span>
<span id="cb192-2"><a href="sampling-the-imaginary.html#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb192-3"><a href="sampling-the-imaginary.html#cb192-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-4"><a href="sampling-the-imaginary.html#cb192-4" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span></span>
<span id="cb192-5"><a href="sampling-the-imaginary.html#cb192-5" aria-hidden="true" tabindex="-1"></a>  samples <span class="sc">%&gt;%</span> </span>
<span id="cb192-6"><a href="sampling-the-imaginary.html#cb192-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">iter  =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),</span>
<span id="cb192-7"><a href="sampling-the-imaginary.html#cb192-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">draws =</span> purrr<span class="sc">::</span><span class="fu">map</span>(p_grid, rbinom, <span class="at">n =</span> <span class="dv">9</span>, <span class="at">size =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb192-8"><a href="sampling-the-imaginary.html#cb192-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(draws)</span>
<span id="cb192-9"><a href="sampling-the-imaginary.html#cb192-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-10"><a href="sampling-the-imaginary.html#cb192-10" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(samples)</span></code></pre></div>
<pre><code>## Rows: 90,000
## Columns: 7
## $ p_grid     &lt;dbl&gt; 0.564, 0.564, 0.564, 0.564, 0.564, 0.564, 0.564, 0.564, 0.564, 0.651, 0.651, 0.…
## $ prior      &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ likelihood &lt;dbl&gt; 0.2240853, 0.2240853, 0.2240853, 0.2240853, 0.2240853, 0.2240853, 0.2240853, 0.…
## $ posterior  &lt;dbl&gt; 0.002240853, 0.002240853, 0.002240853, 0.002240853, 0.002240853, 0.002240853, 0…
## $ w          &lt;dbl&gt; 4, 4, 4, 4, 4, 4, 4, 4, 4, 7, 7, 7, 7, 7, 7, 7, 7, 7, 3, 3, 3, 3, 3, 3, 3, 3, 3…
## $ iter       &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3…
## $ draws      &lt;int&gt; 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1…</code></pre>
<p>The main action is in the <code>draws</code> column.</p>
<p>Now we have to count the longest sequences. The base <strong>R</strong> <a href="https://www.rdocumentation.org/packages/base/versions/3.3/topics/rle"><code>rle()</code> function</a> will help with that. Consider McElreath’s sequence of tosses.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="sampling-the-imaginary.html#cb194-1" aria-hidden="true" tabindex="-1"></a>tosses <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;l&quot;</span>, <span class="st">&quot;w&quot;</span>)</span></code></pre></div>
<p>You can plug that into <code>rle()</code>.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="sampling-the-imaginary.html#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rle</span>(tosses)</span></code></pre></div>
<pre><code>## Run Length Encoding
##   lengths: int [1:7] 1 1 3 1 1 1 1
##   values : chr [1:7] &quot;w&quot; &quot;l&quot; &quot;w&quot; &quot;l&quot; &quot;w&quot; &quot;l&quot; &quot;w&quot;</code></pre>
<p>For our purposes, we’re interested in <code>lengths</code>. That tells us the length of each sequences of the same value. The <code>3</code> corresponds to our run of three <code>w</code>s. The <code>max()</code> function will help us confirm it’s the largest value.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="sampling-the-imaginary.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rle</span>(tosses)<span class="sc">$</span>lengths <span class="sc">%&gt;%</span> <span class="fu">max</span>()</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>Now let’s apply our method to the data and plot.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="sampling-the-imaginary.html#cb199-1" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span> </span>
<span id="cb199-2"><a href="sampling-the-imaginary.html#cb199-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(iter) <span class="sc">%&gt;%</span> </span>
<span id="cb199-3"><a href="sampling-the-imaginary.html#cb199-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">longest_run_length =</span> <span class="fu">rle</span>(draws)<span class="sc">$</span>lengths <span class="sc">%&gt;%</span> <span class="fu">max</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb199-4"><a href="sampling-the-imaginary.html#cb199-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb199-5"><a href="sampling-the-imaginary.html#cb199-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> longest_run_length)) <span class="sc">+</span></span>
<span id="cb199-6"><a href="sampling-the-imaginary.html#cb199-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> longest_run_length <span class="sc">==</span> <span class="dv">3</span>),</span>
<span id="cb199-7"><a href="sampling-the-imaginary.html#cb199-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">center =</span> <span class="dv">0</span>,</span>
<span id="cb199-8"><a href="sampling-the-imaginary.html#cb199-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb199-9"><a href="sampling-the-imaginary.html#cb199-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;D&quot;</span>, <span class="at">end =</span> .<span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb199-10"><a href="sampling-the-imaginary.html#cb199-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;longest run length&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">*</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb199-11"><a href="sampling-the-imaginary.html#cb199-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb199-12"><a href="sampling-the-imaginary.html#cb199-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb199-13"><a href="sampling-the-imaginary.html#cb199-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb199-14"><a href="sampling-the-imaginary.html#cb199-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="03_files/figure-html/unnamed-chunk-66-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>Let’s look at <code>rle()</code> again.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="sampling-the-imaginary.html#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rle</span>(tosses)</span></code></pre></div>
<pre><code>## Run Length Encoding
##   lengths: int [1:7] 1 1 3 1 1 1 1
##   values : chr [1:7] &quot;w&quot; &quot;l&quot; &quot;w&quot; &quot;l&quot; &quot;w&quot; &quot;l&quot; &quot;w&quot;</code></pre>
<p>We can use the length of the output (i.e., 7 in this example) as the numbers of switches from, in this case, “w” and “l”.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="sampling-the-imaginary.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rle</span>(tosses)<span class="sc">$</span>lengths <span class="sc">%&gt;%</span> <span class="fu">length</span>()</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<p>With that new trick, we’re ready to make the right panel of Figure 3.7.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="sampling-the-imaginary.html#cb204-1" aria-hidden="true" tabindex="-1"></a>samples <span class="sc">%&gt;%</span> </span>
<span id="cb204-2"><a href="sampling-the-imaginary.html#cb204-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(iter) <span class="sc">%&gt;%</span> </span>
<span id="cb204-3"><a href="sampling-the-imaginary.html#cb204-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">longest_run_length =</span> <span class="fu">rle</span>(draws)<span class="sc">$</span>lengths <span class="sc">%&gt;%</span> <span class="fu">length</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb204-4"><a href="sampling-the-imaginary.html#cb204-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb204-5"><a href="sampling-the-imaginary.html#cb204-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> longest_run_length)) <span class="sc">+</span></span>
<span id="cb204-6"><a href="sampling-the-imaginary.html#cb204-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill =</span> longest_run_length <span class="sc">==</span> <span class="dv">7</span>),</span>
<span id="cb204-7"><a href="sampling-the-imaginary.html#cb204-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">center =</span> <span class="dv">0</span>,</span>
<span id="cb204-8"><a href="sampling-the-imaginary.html#cb204-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb204-9"><a href="sampling-the-imaginary.html#cb204-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;D&quot;</span>, <span class="at">end =</span> .<span class="dv">9</span>) <span class="sc">+</span></span>
<span id="cb204-10"><a href="sampling-the-imaginary.html#cb204-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;number of switches&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">*</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb204-11"><a href="sampling-the-imaginary.html#cb204-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb204-12"><a href="sampling-the-imaginary.html#cb204-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb204-13"><a href="sampling-the-imaginary.html#cb204-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb204-14"><a href="sampling-the-imaginary.html#cb204-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="03_files/figure-html/unnamed-chunk-69-1.png" width="336" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="summary-lets-practice-with-brms" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> <del>Summary</del> Let’s practice with <strong>brms</strong><a href="sampling-the-imaginary.html#summary-lets-practice-with-brms" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Open <strong>brms</strong>.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="sampling-the-imaginary.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span></code></pre></div>
<p>With <strong>brms</strong>, we’ll fit the primary model of <span class="math inline">\(w = 6\)</span> and <span class="math inline">\(n = 9\)</span> much like we did at the end of <a href="markov-chain-monte-carlo.html#markov-chain-monte-carlo">Chapter 2</a>.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="sampling-the-imaginary.html#cb206-1" aria-hidden="true" tabindex="-1"></a>b3<span class="fl">.1</span> <span class="ot">&lt;-</span></span>
<span id="cb206-2"><a href="sampling-the-imaginary.html#cb206-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">brm</span>(<span class="at">data =</span> <span class="fu">list</span>(<span class="at">w =</span> <span class="dv">6</span>), </span>
<span id="cb206-3"><a href="sampling-the-imaginary.html#cb206-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;identity&quot;</span>),</span>
<span id="cb206-4"><a href="sampling-the-imaginary.html#cb206-4" aria-hidden="true" tabindex="-1"></a>      w <span class="sc">|</span> <span class="fu">trials</span>(<span class="dv">9</span>) <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> Intercept,</span>
<span id="cb206-5"><a href="sampling-the-imaginary.html#cb206-5" aria-hidden="true" tabindex="-1"></a>      <span class="co"># this is a flat prior</span></span>
<span id="cb206-6"><a href="sampling-the-imaginary.html#cb206-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">prior</span>(<span class="fu">beta</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="at">class =</span> b, <span class="at">lb =</span> <span class="dv">0</span>, <span class="at">ub =</span> <span class="dv">1</span>),</span>
<span id="cb206-7"><a href="sampling-the-imaginary.html#cb206-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">iter =</span> <span class="dv">5000</span>, <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb206-8"><a href="sampling-the-imaginary.html#cb206-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> <span class="dv">3</span>,</span>
<span id="cb206-9"><a href="sampling-the-imaginary.html#cb206-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">file =</span> <span class="st">&quot;fits/b03.01&quot;</span>)</span></code></pre></div>
<p>We’ll learn more about the beta distribution in <a href="monsters-and-mixtures.html#monsters-and-mixtures">Chapter 12</a>. But for now, here’s the posterior summary for <code>b_Intercept</code>, the probability of a “w”.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="sampling-the-imaginary.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">posterior_summary</span>(b3<span class="fl">.1</span>)[<span class="st">&quot;b_Intercept&quot;</span>, ] <span class="sc">%&gt;%</span> </span>
<span id="cb207-2"><a href="sampling-the-imaginary.html#cb207-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##  Estimate Est.Error      Q2.5     Q97.5 
##      0.64      0.14      0.35      0.87</code></pre>
<p>As we’ll fully cover in the next chapter, <code>Estimate</code> is the posterior mean, the two <code>Q</code> columns are the quantile-based 95% intervals, and <code>Est.Error</code> is the posterior standard deviation.</p>
<p>Much like the way we used the <code>samples()</code> function to simulate probability values, above, we can do so with the <code>brms::fitted()</code> function. But we will have to specify <code>scale = "linear"</code> in order to return results in the probability metric. By default, <code>brms::fitted()</code> will return summary information. Since we want actual simulation draws, we’ll specify <code>summary = F</code>.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="sampling-the-imaginary.html#cb209-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span></span>
<span id="cb209-2"><a href="sampling-the-imaginary.html#cb209-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitted</span>(b3<span class="fl">.1</span>, </span>
<span id="cb209-3"><a href="sampling-the-imaginary.html#cb209-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">summary =</span> F,</span>
<span id="cb209-4"><a href="sampling-the-imaginary.html#cb209-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">scale =</span> <span class="st">&quot;linear&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb209-5"><a href="sampling-the-imaginary.html#cb209-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb209-6"><a href="sampling-the-imaginary.html#cb209-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_names</span>(<span class="st">&quot;p&quot;</span>)</span>
<span id="cb209-7"><a href="sampling-the-imaginary.html#cb209-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-8"><a href="sampling-the-imaginary.html#cb209-8" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(f)</span></code></pre></div>
<pre><code>## Rows: 16,000
## Columns: 1
## $ p &lt;dbl&gt; 0.6878563, 0.5386513, 0.7030050, 0.6889854, 0.4738290, 0.5879676, 0.5843004, 0.7014505, …</code></pre>
<p>By default, we have a generically-named vector of 4,000 samples. We’ll explain the defaults in later chapters. For now, notice we can view these in a density.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="sampling-the-imaginary.html#cb211-1" aria-hidden="true" tabindex="-1"></a>f <span class="sc">%&gt;%</span> </span>
<span id="cb211-2"><a href="sampling-the-imaginary.html#cb211-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p)) <span class="sc">+</span></span>
<span id="cb211-3"><a href="sampling-the-imaginary.html#cb211-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill =</span> <span class="st">&quot;grey50&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="sc">+</span></span>
<span id="cb211-4"><a href="sampling-the-imaginary.html#cb211-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">x =</span> .<span class="dv">08</span>, <span class="at">y =</span> <span class="fl">2.5</span>,</span>
<span id="cb211-5"><a href="sampling-the-imaginary.html#cb211-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;Posterior probability&quot;</span>) <span class="sc">+</span></span>
<span id="cb211-6"><a href="sampling-the-imaginary.html#cb211-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;probability of water&quot;</span>,</span>
<span id="cb211-7"><a href="sampling-the-imaginary.html#cb211-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, .<span class="dv">5</span>, <span class="dv">1</span>),</span>
<span id="cb211-8"><a href="sampling-the-imaginary.html#cb211-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">limits =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb211-9"><a href="sampling-the-imaginary.html#cb211-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb211-10"><a href="sampling-the-imaginary.html#cb211-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="03_files/figure-html/unnamed-chunk-73-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Looks a lot like the posterior probability density at the top of Figure 3.6, doesn’t it? Much like we did with <code>samples</code>, we can use this distribution of probabilities to predict histograms of <code>w</code> counts. With those in hand, we can make an analogue to the histogram in the bottom panel of Figure 3.6.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="sampling-the-imaginary.html#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the simulation</span></span>
<span id="cb212-2"><a href="sampling-the-imaginary.html#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb212-3"><a href="sampling-the-imaginary.html#cb212-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-4"><a href="sampling-the-imaginary.html#cb212-4" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span></span>
<span id="cb212-5"><a href="sampling-the-imaginary.html#cb212-5" aria-hidden="true" tabindex="-1"></a>  f <span class="sc">%&gt;%</span> </span>
<span id="cb212-6"><a href="sampling-the-imaginary.html#cb212-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">w =</span> <span class="fu">rbinom</span>(<span class="fu">n</span>(), <span class="at">size =</span> n_trials,  <span class="at">prob =</span> p))</span>
<span id="cb212-7"><a href="sampling-the-imaginary.html#cb212-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-8"><a href="sampling-the-imaginary.html#cb212-8" aria-hidden="true" tabindex="-1"></a><span class="co"># the plot</span></span>
<span id="cb212-9"><a href="sampling-the-imaginary.html#cb212-9" aria-hidden="true" tabindex="-1"></a>f <span class="sc">%&gt;%</span> </span>
<span id="cb212-10"><a href="sampling-the-imaginary.html#cb212-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> w)) <span class="sc">+</span></span>
<span id="cb212-11"><a href="sampling-the-imaginary.html#cb212-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">center =</span> <span class="dv">0</span>,</span>
<span id="cb212-12"><a href="sampling-the-imaginary.html#cb212-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="at">size =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb212-13"><a href="sampling-the-imaginary.html#cb212-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">&quot;number of water samples&quot;</span>, <span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">*</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb212-14"><a href="sampling-the-imaginary.html#cb212-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="cn">NULL</span>, <span class="at">breaks =</span> <span class="cn">NULL</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5000</span>)) <span class="sc">+</span></span>
<span id="cb212-15"><a href="sampling-the-imaginary.html#cb212-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Posterior predictive distribution&quot;</span>) <span class="sc">+</span></span>
<span id="cb212-16"><a href="sampling-the-imaginary.html#cb212-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb212-17"><a href="sampling-the-imaginary.html#cb212-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="03_files/figure-html/unnamed-chunk-74-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>As you might imagine, we can use the output from <code>fitted()</code> to return disaggregated batches of 0’s and 1’s, too. And we could even use those disaggregated 0’s and 1’s to examine longest run lengths and numbers of switches as in the analyses for Figure 3.7. I’ll leave those as exercises for the interested reader.</p>
</div>
<div id="session-info-2" class="section level2 unnumbered hasAnchor">
<h2>Session info<a href="sampling-the-imaginary.html#session-info-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="sampling-the-imaginary.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.2.0 (2022-04-22)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Big Sur/Monterey 10.16
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.2/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] brms_2.18.0     Rcpp_1.0.9      tidybayes_3.0.2 patchwork_1.1.2 forcats_0.5.1   stringr_1.4.1  
##  [7] dplyr_1.0.10    purrr_0.3.4     readr_2.1.2     tidyr_1.2.1     tibble_3.1.8    ggplot2_3.3.6  
## [13] tidyverse_1.3.2
## 
## loaded via a namespace (and not attached):
##   [1] readxl_1.4.1         backports_1.4.1      plyr_1.8.7           igraph_1.3.4        
##   [5] splines_4.2.0        svUnit_1.0.6         crosstalk_1.2.0      TH.data_1.1-1       
##   [9] rstantools_2.2.0     inline_0.3.19        digest_0.6.29        htmltools_0.5.3     
##  [13] rethinking_2.21      fansi_1.0.3          magrittr_2.0.3       checkmate_2.1.0     
##  [17] googlesheets4_1.0.1  tzdb_0.3.0           modelr_0.1.8         RcppParallel_5.1.5  
##  [21] matrixStats_0.62.0   sandwich_3.0-2       xts_0.12.1           prettyunits_1.1.1   
##  [25] colorspace_2.0-3     rvest_1.0.2          ggdist_3.2.0         haven_2.5.1         
##  [29] xfun_0.33            callr_3.7.1          crayon_1.5.1         jsonlite_1.8.0      
##  [33] lme4_1.1-30          survival_3.4-0       zoo_1.8-10           glue_1.6.2          
##  [37] gtable_0.3.1         gargle_1.2.0         emmeans_1.8.0        distributional_0.3.1
##  [41] pkgbuild_1.3.1       rstan_2.21.7         shape_1.4.6          abind_1.4-5         
##  [45] scales_1.2.1         mvtnorm_1.1-3        DBI_1.1.3            miniUI_0.1.1.1      
##  [49] viridisLite_0.4.1    xtable_1.8-4         HDInterval_0.2.2     stats4_4.2.0        
##  [53] StanHeaders_2.21.0-7 DT_0.24              htmlwidgets_1.5.4    httr_1.4.4          
##  [57] threejs_0.3.3        arrayhelpers_1.1-0   posterior_1.3.1      ellipsis_0.3.2      
##  [61] pkgconfig_2.0.3      loo_2.5.1            farver_2.1.1         sass_0.4.2          
##  [65] dbplyr_2.2.1         utf8_1.2.2           tidyselect_1.1.2     labeling_0.4.2      
##  [69] rlang_1.0.6          reshape2_1.4.4       later_1.3.0          munsell_0.5.0       
##  [73] cellranger_1.1.0     tools_4.2.0          cachem_1.0.6         cli_3.4.0           
##  [77] generics_0.1.3       broom_1.0.1          ggridges_0.5.3       evaluate_0.16       
##  [81] fastmap_1.1.0        processx_3.7.0       knitr_1.40           fs_1.5.2            
##  [85] nlme_3.1-159         projpred_2.2.1       mime_0.12            xml2_1.3.3          
##  [89] compiler_4.2.0       bayesplot_1.9.0      shinythemes_1.2.0    rstudioapi_0.13     
##  [93] gamm4_0.2-6          reprex_2.0.2         bslib_0.4.0          stringi_1.7.8       
##  [97] highr_0.9            ps_1.7.1             Brobdingnag_1.2-8    lattice_0.20-45     
## [101] Matrix_1.4-1         nloptr_2.0.3         markdown_1.1         shinyjs_2.1.0       
## [105] tensorA_0.36.2       vctrs_0.4.1          pillar_1.8.1         lifecycle_1.0.2     
## [109] jquerylib_0.1.4      bridgesampling_1.1-2 estimability_1.4.1   httpuv_1.6.5        
## [113] R6_2.5.1             bookdown_0.28        promises_1.2.0.1     gridExtra_2.3       
## [117] codetools_0.2-18     boot_1.3-28          colourpicker_1.1.1   MASS_7.3-58.1       
## [121] gtools_3.9.3         assertthat_0.2.1     withr_2.5.0          shinystan_2.6.0     
## [125] multcomp_1.4-20      mgcv_1.8-40          parallel_4.2.0       hms_1.1.1           
## [129] grid_4.2.0           minqa_1.2.4          coda_0.19-4          rmarkdown_2.16      
## [133] cmdstanr_0.5.3       googledrive_2.0.0    shiny_1.7.2          lubridate_1.8.0     
## [137] base64enc_0.1-3      dygraphs_1.1.1.6</code></pre>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-amrheinScientistsRiseStatistical2019" class="csl-entry">
Amrhein, V., Greenland, S., &amp; McShane, B. (2019). Scientists rise up against statistical significance. <em>Nature</em>, <em>567</em>(7748, 7748), 305–307. <a href="https://doi.org/10.1038/d41586-019-00857-9">https://doi.org/10.1038/d41586-019-00857-9</a>
</div>
<div id="ref-cummingNewStatisticsWhy2014" class="csl-entry">
Cumming, G. (2014). The new statistics: <span>Why</span> and how. <em>Psychological Science</em>, <em>25</em>(1), 7–29. <a href="https://doi.org/10.1177/0956797613504966">https://doi.org/10.1177/0956797613504966</a>
</div>
<div id="ref-gelmanAreConfidenceIntervals2019" class="csl-entry">
Gelman, A., &amp; Greenland, S. (2019). Are confidence intervals better termed <span>“uncertainty intervals”</span>? <em>BMJ</em>, l5381. <a href="https://doi.org/10.1136/bmj.l5381">https://doi.org/10.1136/bmj.l5381</a>
</div>
<div id="ref-grolemundDataScience2017" class="csl-entry">
Grolemund, G., &amp; Wickham, H. (2017). <em>R for data science</em>. <span>O’Reilly</span>. <a href="https://r4ds.had.co.nz">https://r4ds.had.co.nz</a>
</div>
<div id="ref-hauerHarmDoneTests2004" class="csl-entry">
Hauer, E. (2004). The harm done by tests of significance. <em>Accident Analysis &amp; Prevention</em>, <em>36</em>(3), 495–500. <a href="https://doi.org/10.1016/S0001-4575(03)00036-8">https://doi.org/10.1016/S0001-4575(03)00036-8</a>
</div>
<div id="ref-R-purrr" class="csl-entry">
Henry, L., &amp; Wickham, H. (2020). <em><span class="nocase">purrr</span>: <span>Functional</span> programming tools</em>. <a href="https://CRAN.R-project.org/package=purrr">https://CRAN.R-project.org/package=purrr</a>
</div>
<div id="ref-kayExtractingVisualizingTidy2021" class="csl-entry">
Kay, M. (2021). <em>Extracting and visualizing tidy draws from brms models</em>. <a href="https://mjskay.github.io/tidybayes/articles/tidy-brms.html">https://mjskay.github.io/tidybayes/articles/tidy-brms.html</a>
</div>
<div id="ref-R-tidybayes" class="csl-entry">
Kay, M. (2022). <em><span class="nocase">tidybayes</span>: <span>Tidy</span> data and ’geoms’ for <span>Bayesian</span> models</em>. <a href="https://CRAN.R-project.org/package=tidybayes">https://CRAN.R-project.org/package=tidybayes</a>
</div>
<div id="ref-mcelreathStatisticalRethinkingBayesian2020" class="csl-entry">
McElreath, R. (2020). <em>Statistical rethinking: <span>A Bayesian</span> course with examples in <span>R</span> and <span>Stan</span></em> (Second Edition). <span>CRC Press</span>. <a href="https://xcelab.net/rm/statistical-rethinking/">https://xcelab.net/rm/statistical-rethinking/</a>
</div>
<div id="ref-vehtariRanknormalizationFoldingLocalization2019" class="csl-entry">
Vehtari, A., Gelman, A., Simpson, D., Carpenter, B., &amp; Bürkner, P.-C. (2019). <em>Rank-normalization, folding, and localization: <span>An</span> improved <span class="math inline">\(\widehat{R}\)</span> for assessing convergence of <span>MCMC</span></em>. <a href="https://arxiv.org/abs/1903.08008?">https://arxiv.org/abs/1903.08008?</a>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="small-worlds-and-large-worlds.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="geocentric-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
