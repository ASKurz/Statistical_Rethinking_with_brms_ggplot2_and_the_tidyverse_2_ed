Chapter 10. Big Entropy and the Generalized Linear Model
================
A Solomon Kurz
2021-03-12

# Big Entropy and the Generalized Linear Model

#### Rethinking: Bayesian updating is entropy maximization.

## Maximum entropy

``` r
library(tidyverse)
library(ghibli)
```

#### Rethinking: What good is intuition?

### Gaussian.

### Binomial.

The binomial likelihood entails

> counting the numbers of ways that a given observation could arise,
> according to our assumptions. The resulting distribution is known as
> the **binomial distribution**. If only two things can happen (blue or
> white marble, for example), and there’s a constant chance *p* of each
> across *n* trials, then the probability of observing *y* events of
> type 1 and *n* − *y* events of type 2 is:
>
> $$\\text{Pr} (y \| n, p) = \\frac{n!}{y! (n - y)!} p^y (1 - p)^{n - y}$$
>
> It may help to note that the fraction with the factorials is just
> saying how many different ordered sequences of *n* outcomes have a
> count of *y*. (p. 307, **emphasis** in the original)

For me, that last sentence made more sense when I walked it out in an
example. To do so, let’s wrap that fraction of factorials into a
function.

``` r
count_ways <- function(n, y) {
  # n = the total number of trials (i.e., the number of rows in your vector)
  # y = the total number of 1s (i.e., successes) in your vector
  (factorial(n) / (factorial(y) * factorial(n - y)))
}
```

Now consider three sequences:

-   0, 0, 0, 0 (i.e., *n* = 4 and *y* = 0)
-   1, 0, 0, 0 (i.e., *n* = 4 and *y* = 1)
-   1, 1, 0, 0 (i.e., *n* = 4 and *y* = 2)

We can organize that information in a little tibble and then demo our
`count_ways()` function.

``` r
tibble(sequence = 1:3,
       n        = 4,
       y        = c(0, 1, 2)) %>% 
  mutate(n_ways = count_ways(n = n, y = y))
```

    ## # A tibble: 3 x 4
    ##   sequence     n     y n_ways
    ##      <int> <dbl> <dbl>  <dbl>
    ## 1        1     4     0      1
    ## 2        2     4     1      4
    ## 3        3     4     2      6

Here’s the pre-Figure 10.3 data McElreath presented on page 308.

``` r
# data
d <-
  tibble(distribution = letters[1:4],
         ww = c(1/4, 2/6, 1/6, 1/8),
         bw = c(1/4, 1/6, 2/6, 4/8),
         wb = c(1/4, 1/6, 2/6, 2/8),
         bb = c(1/4, 2/6, 1/6, 1/8))

# table
d %>% 
  mutate_if(is.numeric, ~MASS::fractions(.) %>% as.character()) %>% 
  flextable::flextable()
```

    ## PhantomJS not found. You can install it with webshot::install_phantomjs(). If it is installed, please make sure the phantomjs executable can be found via the PATH variable.

Those data take just a tiny bit of wrangling before they’re ready to
plot in our version of Figure 10.3.

``` r
d <- 
  d %>% 
  pivot_longer(-distribution,
               names_to = "sequence", 
               values_to = "probability") %>% 
  mutate(sequence = factor(sequence, levels = c("ww", "bw", "wb", "bb")))

d  %>% 
  ggplot(aes(x = sequence, y = probability, group = 1)) +
  geom_point(size = 2, color = ghibli_palette("PonyoMedium")[4]) +
  geom_line(color = ghibli_palette("PonyoMedium")[5]) +
  labs(x = NULL, y = NULL) +
  coord_cartesian(ylim = 0:1) +
  theme(axis.ticks.x = element_blank(),
        panel.background = element_rect(fill = ghibli_palette("PonyoMedium")[2]),
        panel.grid = element_blank(),
        strip.background = element_rect(fill = ghibli_palette("PonyoMedium")[6])) +
  facet_wrap(~ distribution)
```

<img src="10.1.2_files/figure-gfm/unnamed-chunk-6-1.png" width="384" style="display: block; margin: auto;" />
