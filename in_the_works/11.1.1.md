Ch. 11 God Spiked the Integers
================
A Solomon Kurz
2021-03-12

&lt;Note, flextable tables will not render with github\_document. They
should be fine for the final book.&gt;

# God Spiked the Integers

## Binomial regression

### Logistic regression: Prosocial chimpanzees.

Load the [Silk et al.](#ref-silkChimpanzeesAreIndifferent2005)
([2005](#ref-silkChimpanzeesAreIndifferent2005)) `chimpanzees` data.

``` r
data(chimpanzees, package = "rethinking")
d <- chimpanzees
rm(chimpanzees)
```

The data include two experimental conditions, `prosoc_left` and
`condition`, each of which has two levels. This results in four
combinations.

``` r
library(tidyverse)
library(flextable)

d %>% 
  distinct(prosoc_left, condition) %>% 
  mutate(description = c("Two food items on right and no partner",
                         "Two food items on left and no partner",
                         "Two food items on right and partner present",
                         "Two food items on left and partner present")) %>% 
  flextable() %>% 
  width(width = c(1, 1, 4))
```

#### Overthinking: Adding log-probability calculations to a Stan model.

### Relative shark and absolute deer.

### Aggregated binomial: Chimpanzees again, condensed.

### Aggregated binomial: Graduate school admissions.

#### Rethinking: Simpson’s paradox is not a paradox.

## Poisson regression

### Example: Oceanic tool complexity.

#### Overthinking: Modeling tool innovation.

### Negative binomial (gamma-Poisson) models.

### Example: Exposure and the offset.

## Multinomial and categorical models

### Predictors matched to outcomes.

. . .

With the **brms** non-linear syntax, we can fit the model with one *β*
parameter or allow the one *β* parameter to differ for `mu1` and `mu2`.
As to setting a lower bound to the `b` parameter\[s\], we can do that
with the `lb` argument within the `prior()` function. If we fit our
version of `m11.13` by systemically varying these two features, we’ll
end up with the four versions listed in the table below.

``` r
crossing(b  = factor(c("b1 & b2", "b"), levels = c("b1 & b2", "b")),
         lb = factor(c("NA", 0), levels = c("NA", 0))) %>% 
  mutate(fit = str_c("b11.13", letters[1:n()])) %>% 
  select(fit, everything()) %>% 
  
  flextable() %>% 
  width(width = 1.25)
```

    ## PhantomJS not found. You can install it with webshot::install_phantomjs(). If it is installed, please make sure the phantomjs executable can be found via the PATH variable.

## Session info

``` r
sessionInfo()
```

    ## R version 4.0.4 (2021-02-15)
    ## Platform: x86_64-apple-darwin17.0 (64-bit)
    ## Running under: macOS Catalina 10.15.7
    ## 
    ## Matrix products: default
    ## BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
    ## LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
    ## 
    ## locale:
    ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
    ## 
    ## attached base packages:
    ## [1] stats     graphics  grDevices utils     datasets  methods   base     
    ## 
    ## other attached packages:
    ##  [1] flextable_0.6.4 forcats_0.5.1   stringr_1.4.0   dplyr_1.0.4     purrr_0.3.4     readr_1.4.0    
    ##  [7] tidyr_1.1.2     tibble_3.1.0    ggplot2_3.3.3   tidyverse_1.3.0
    ## 
    ## loaded via a namespace (and not attached):
    ##  [1] tidyselect_1.1.0  xfun_0.21         haven_2.3.1       colorspace_2.0-0  vctrs_0.3.6      
    ##  [6] generics_0.1.0    htmltools_0.5.0   base64enc_0.1-3   yaml_2.2.1        utf8_1.1.4       
    ## [11] rlang_0.4.10      pillar_1.5.1      glue_1.4.2        withr_2.4.1       DBI_1.1.0        
    ## [16] gdtools_0.2.2     dbplyr_2.0.0      uuid_0.1-4        modelr_0.1.8      readxl_1.3.1     
    ## [21] lifecycle_1.0.0   munsell_0.5.0     gtable_0.3.0      cellranger_1.1.0  zip_2.1.1        
    ## [26] rvest_0.3.6       evaluate_0.14     knitr_1.30        fansi_0.4.2       broom_0.7.5      
    ## [31] Rcpp_1.0.6        scales_1.1.1      backports_1.2.1   webshot_0.5.2     jsonlite_1.7.2   
    ## [36] systemfonts_1.0.1 fs_1.5.0          hms_0.5.3         digest_0.6.27     stringi_1.5.3    
    ## [41] grid_4.0.4        cli_2.3.1         tools_4.0.4       magrittr_2.0.1    crayon_1.4.1     
    ## [46] pkgconfig_2.0.3   ellipsis_0.3.1    data.table_1.14.0 xml2_1.3.2        reprex_0.3.0     
    ## [51] lubridate_1.7.9.2 officer_0.3.17    assertthat_0.2.1  rmarkdown_2.7     httr_1.4.2       
    ## [56] rstudioapi_0.13   R6_2.5.0          compiler_4.0.4

<div id="refs" class="references csl-bib-body hanging-indent"
line-spacing="2">

<div id="ref-silkChimpanzeesAreIndifferent2005" class="csl-entry">

Silk, J. B., Brosnan, S. F., Vonk, J., Henrich, J., Povinelli, D. J.,
Richardson, A. S., Lambeth, S. P., Mascaro, J., & Schapiro, S. J.
(2005). Chimpanzees are indifferent to the welfare of unrelated group
members. *Nature*, *437*(7063), 1357–1359.
<https://doi.org/10.1038/nature04243>

</div>

</div>
